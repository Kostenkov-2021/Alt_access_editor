<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="description" content=""/>
    <meta name="viewport" content="maximum-scale=1.0" />
    <title> Configuring logging in HTTP mode </title>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-MPK6ZG');</script>
	<!-- End Google Tag Manager -->
    <script type="text/javascript" src="../langs.js"></script>
    <script type="text/javascript">
        !function ( w, d ) {
            var scriptsPath="/localization/";
            if(w.location.pathname.match(/title\.htm$/)){scriptsPath="./js/"}d.writeln("\x3Cscript type='text/javascript' src='"+scriptsPath+d.documentElement.lang+".js'>\x3C/script>");
        }( window, document );
    </script>	
    <script type="text/javascript" src="toc.js"></script>
    
    <script type="text/javascript" src="aiconverter_result.js"></script>
    <link rel="stylesheet" type='text/css' href="typography.css"/>
    <link rel="stylesheet" type='text/css' href="styles.css"/>
    <link rel="shortcut icon" href="favicon.ico"/>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
    <link rel="icon" href="favicon.png" type="image/png"/>

            <!--[if lte IE 9]>
                <link rel="stylesheet" type="text/css" href="bootstrap.css">
            <![endif]-->
            <!--[if lte IE 8]>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.js"></script>
            <![endif]-->
            </head>

<body id="who-content" class="no-js">
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MPK6ZG" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->
	<noscript class="no-js__message">
	<a href="https://support.microsoft.com/en-us/kb/3135465" class="no-js__link">Please enable JavaScript in your browser!</a>
	</noscript>
	<div class="cont">
	<h3 id="t234305" class="heading3">Configuring logging in HTTP mode</h3>
<p class="bodytext">This section explains how to manually configure logging in HTTP mode without using Kaspersky Scan Engine GUI.</p>
<p class="bodytext">See also detailed instructions on <a id="h180103" class="englishcrossreferencetemplate" href="179928.htm" target="_self">enabling logging</a>.</p>
<p class="introheading">Configuring logging</p>
<p class="bodytext">To configure logging, change the parameters in the httpdkavlog.ini logging configuration file (hereinafter referred to as the logging configuration file) located in the <code class="programcharacter">%service_dir%/bin</code> directory. The configuration file consists of several sections.</p>
<p class="introheading">DebugLogging section</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">LogLevel</code>&#8212;Specifies the logging level.<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">0</code><p class="listcontinue2">Disables logging. This is the default value.</p>
</li><li class="listbullet2"><code class="programcharacter">1</code><p class="listcontinue2">Enables full logging mode. Use this mode for debugging purposes.</p>
<p class="warningcontinue2">If you enable full logging mode, consider that the log messages will contain <a id="h206306" class="englishcrossreferencetemplate" href="179925.htm" target="_self">sensitive data</a>.</p>
<p class="attentioncontinue2">In HTTP mode, Kaspersky Scan Engine does not automatically remove log files from previous initializations. If necessary, you can remove these log files manually.</p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">LogFolder</code>&#8212;Specifies the path to a directory where log files are stored. <p class="listcontinue1">The path can be absolute or relative. A relative path is calculated relative to the directory that contains the <code class="programcharacter">kavhttpd</code> binary file.</p>
</li></ul><p class="introheading">SyslogLogging section</p>
<p class="bodytext">The settings below are available only for Linux operating systems.</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">SyslogEnabled</code>&#8212;Specifies whether the Kaspersky Scan Engine sends syslog messages.<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">0</code><p class="listcontinue2">Disables sending of syslog messages. </p>
</li><li class="listbullet2"><code class="programcharacter">1</code><p class="listcontinue2">Enables sending of syslog messages.</p>
<p class="warningcontinue2">If you enable sending syslog messages, consider that these messages will contain sensitive data, such as personal data as defined by GDPR, configuration data of the product, and licensing information.</p>
</li></ul></li></ul><p class="introheading">SyslogDestination section </p>
<p class="bodytext">This element contains a group of settings that specify the format of the logs. If it is necessary to write logs into different locations, you can specify several <code class="programcharacter">SyslogDestination</code> elements. In this case, the values of the <code class="programcharacter">SyslogTarget</code> subelements must vary.</p>
<p class="attentionbody">If <code class="programcharacter">SyslogEnabled</code> (see above) has the value of <code class="programcharacter">1</code>, you must include at least one <code class="programcharacter">SyslogDestination</code> element.</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">SyslogFormat</code>&#8212;Specifies the format of syslog messages. <p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">cef</code>&#8212;Specifies the <code class="programcharacter">cef</code> format of syslog messages.</li><li class="listbullet2"><code class="programcharacter">raw</code>&#8212;Specifies the <code class="programcharacter">raw</code> format of syslog messages. The <code class="programcharacter">raw</code> value is used when the value specified in this element is not <code class="programcharacter">cef</code> or <code class="programcharacter">raw</code>, or no value is specified in this element, or if the logging configuration file does not contain the <code class="programcharacter">SyslogFormat</code> parameter.</li></ul></li><li class="listbullet1"><code class="programcharacter">SyslogTarget</code>&#8212;Specifies the destination address for syslog messages. <p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">%PROTOCOL%%IP%:%PORT%</code>, where:<ul class="listbullet3"><li class="listbullet3"><code class="programcharacter">%PROTOCOL%</code> is a network protocol (use <code class="programcharacter">tcp://</code> or <code class="programcharacter">udp://</code> for this value). </li><li class="listbullet3"><code class="programcharacter">%IP%</code> is an IPv4 address that receives syslog messages. </li><li class="listbullet3"><code class="programcharacter">%PORT%</code> is a port that receives syslog messages.</li></ul><p class="listcontinue2">If you do not specify a protocol as described above, Kaspersky Scan Engine will use the UDP protocol.</p>
</li><li class="listbullet2"><code class="programcharacter">localhost</code>&#8212;Indicates that syslog messages are redirected to <code class="programcharacter">syslogd</code>.</li><li class="listbullet2">Path to a directory where log files with syslog messages are stored. The path must begin with <code class="programcharacter">/var/log/kaspersky</code>.<p class="listcontinue2">The directory contains the <code class="programcharacter">httpd_kav_syslog.log</code> file. Log files with syslog messages created by previous sessions are not removed. If the directory contains an old file, Kaspersky Scan Engine writes new information to this file without deleting the old data. </p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">SyslogEvents</code>&#8212;Specifies events to be logged. <p class="listcontinue1">It is allowed to specify multiple <code class="programcharacter">SyslogEvents</code> values. Each of these values sets the type of event that will be logged into the location specified in the <code class="programcharacter">SyslogTarget</code> attribute. If you specify several values for one destination, separate them with the semicolon symbol (<code class="programcharacter">;</code>).</p>
<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">Audit</code>&#8212;Specifies system audit events.</li><li class="listbullet2"><code class="programcharacter">Init</code>&#8212;Specifies service initialization events. </li><li class="listbullet2"><code class="programcharacter">Deinit</code>&#8212;Specifies service deinitialization events and watchdog events. </li><li class="listbullet2"><code class="programcharacter">Update</code>&#8212;Specifies antivirus database update and reload events.</li><li class="listbullet2"><code class="programcharacter">License</code>&#8212;Specifies license-related events.</li><li class="listbullet2"><code class="programcharacter">Engine</code>&#8212;Specifies antivirus engine events.  These events may be published frequently.</li><li class="listbullet2"><code class="programcharacter">ScanResultClean</code>&#8212;Specifies scan completion events when scanned object considered clean.</li><li class="listbullet2"><code class="programcharacter">ScanResultDetect</code>&#8212;Specifies scan completion events when threat was detected.</li><li class="listbullet2"><code class="programcharacter">ScanResultOther</code>&#8212;Specifies scan completion events when object was not scanned.</li></ul><p class="listcontinue1">If the <code class="programcharacter">SyslogDestination</code> element does not contain the <code class="programcharacter">SyslogEvents</code> child element, all the HTTP events are logged. </p>
<p class="listcontinue1">If the <code class="programcharacter">SyslogDestination</code> settings are incorrect, logging to the specified destination will be disabled.</p>
<p class="listcontinue1">When syslog logging is enabled, system audit is enabled as well. If none of the <code class="programcharacter">SyslogEvents</code> elements contains the <code class="programcharacter">Audit</code> event, system audit settings are set as follows:  <code class="programcharacter">SyslogFormat</code> is set to <code class="programcharacter">raw</code>, <code class="programcharacter">SyslogTarget</code> is set to <code class="programcharacter">localhost</code>, and <code class="programcharacter">SyslogEvents</code> is set to <code class="programcharacter">audit</code>.</p>
</li></ul><p class="attentionbody">Kaspersky Scan Engine can write debug logs and send syslog messages at the same time or separately.</p>
<p class="introheading">Structure of the logging configuration file</p>
<p class="bodytext">Following is an example of a logging configuration file:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">[DebugLogging]</p>
<p class="program">LogLevel=0</p>
<p class="program">LogFolder=logs</p>
<p class="program">[SyslogLogging]</p>
<p class="program">SyslogEnabled=0</p>
<p class="program">[SyslogDestination]</p>
<p class="program">SyslogFormat=raw</p>
<p class="program">SyslogTarget=localhost</p>
<p class="program">SyslogEvents=audit;init;deinit;update;license;engine</p>
<p class="program">[SyslogDestination]</p>
<p class="program">SyslogFormat=cef</p>
<p class="program">SyslogTarget=/var/log/kaspersky/kse_udp_lic_events</p>
<p class="program">SyslogEvents=license;update</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div>
</body>

</html>
