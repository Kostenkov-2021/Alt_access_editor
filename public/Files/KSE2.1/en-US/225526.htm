<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="description" content=""/>
    <meta name="viewport" content="maximum-scale=1.0" />
    <title> Recommended settings for HTTP mode </title>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-MPK6ZG');</script>
	<!-- End Google Tag Manager -->
    <script type="text/javascript" src="../langs.js"></script>
    <script type="text/javascript">
        !function ( w, d ) {
            var scriptsPath="/localization/";
            if(w.location.pathname.match(/title\.htm$/)){scriptsPath="./js/"}d.writeln("\x3Cscript type='text/javascript' src='"+scriptsPath+d.documentElement.lang+".js'>\x3C/script>");
        }( window, document );
    </script>	
    <script type="text/javascript" src="toc.js"></script>
    
    <script type="text/javascript" src="aiconverter_result.js"></script>
    <link rel="stylesheet" type='text/css' href="typography.css"/>
    <link rel="stylesheet" type='text/css' href="styles.css"/>
    <link rel="shortcut icon" href="favicon.ico"/>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
    <link rel="icon" href="favicon.png" type="image/png"/>

            <!--[if lte IE 9]>
                <link rel="stylesheet" type="text/css" href="bootstrap.css">
            <![endif]-->
            <!--[if lte IE 8]>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.js"></script>
            <![endif]-->
            </head>

<body id="who-content" class="no-js">
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MPK6ZG" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->
	<noscript class="no-js__message">
	<a href="https://support.microsoft.com/en-us/kb/3135465" class="no-js__link">Please enable JavaScript in your browser!</a>
	</noscript>
	<div class="cont">
	<h2 id="t240944" class="heading2">Recommended settings for HTTP mode</h2>
<p class="bodytext">This section describes the recommended settings for Kaspersky Scan Engine in HTTP mode.</p>
<p class="bodytext">If you use the Kaspersky Scan Engine GUI, specify the recommended parameters as described in the table below.</p>
<p class="tablename">Recommended settings for HTTP mode in the Kaspersky Scan Engine GUI</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="521" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="193"><p class="tableheading">Settings in the Kaspersky Scan Engine GUI</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="328"><p class="tableheading">Recommended settings</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Service &gt; Keep-alive connection</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">See the description of <code class="programcharacter">KeepAliveSettings</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Service &gt; Connection timeout</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">See the description of <code class="programcharacter">TimeoutMs</code> in <code class="programcharacter">KeepAliveSettings</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Service &gt; Sessions</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">See the description of <code class="programcharacter">MaxHTTPSessionsNum </code>below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Service &gt; Connections</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">See the description of <code class="programcharacter">MaxIncomingConnectionsNum</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Service &gt; Threads</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">Twice the value of <code class="programcharacter">ScannersCount</code></p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Service &gt; Processes</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">Equal to the number of processor cores</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Enable reputation checking</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">Turn on the toggle switch</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Enable Phishing Protection</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">Turn on the toggle switch</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="bodytext">Scanning &gt; Object scan timeout</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">10000 (10 seconds)</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Heuristic analysis level</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="bodytext">Low</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Actions on detected objects</p>
</td>
<td valign="middle" style="border:1px solid #010101;" width="328"><p class="tablebodytext">See the description of <code class="programcharacter">Mode</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Size limit for the received file</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="bodytext">10343 KB (10.1 MB)</p>
<p class="attentionbody">Get an updated value from your TAM at least once a year</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Maximum depth</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">5</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Types of files to scan</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">Select the checkbox:</p>
<ul class="tablelistbullet"><li class="tablelistbullet">Packed objects</li><li class="tablelistbullet">Archives</li><li class="tablelistbullet">Emails databases</li><li class="tablelistbullet">Emails</li></ul></td>
</tr>

</table>
<p class="bodytext">If you do not use the Kaspersky Scan Engine GUI, specify the recommended parameters in the kavhttpd.xml configuration file as described in the table below.</p>
<p class="tablename">Recommended settings for HTTP mode in the configuration file</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="512" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="180"><p class="tableheading">Parameter in kavhttpd.xml</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="332"><p class="tableheading">Recommended settings</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">ScannersCount</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="bodytext">Equal to the number of processor cores</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">ThreadsCount</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="bodytext">Twice the value of <code class="programcharacter">ScannersCount</code></p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">MaxIncomingConnectionsNum</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">See the description of <code class="programcharacter">MaxIncomingConnectionsNum</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">MaxHTTPSessionsNum</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">See the description of <code class="programcharacter">MaxHTTPSessionsNum</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">QueueLen</p>
</td>
<td style="border:1px solid #010101;" width="332"><ul class="tablelistbullet"><li class="tablelistbullet">Greater than or equal to the value of <code class="programcharacter">MaxHTTPSessionsNum</code></li><li class="tablelistbullet">Greater than the <code class="programcharacter">ThreadsCount</code> value</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">MaxTCPFileSize</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">10591440 bytes (10.1 MB)</p>
<p class="attentionbody">Get an updated value from your TAM at least once a year</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">Flags</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">Specify the flags:</p>
<ul class="tablelistbullet"><li class="tablelistbullet">KAV_O_M_PACKED</li><li class="tablelistbullet">KAV_O_M_ARCHIVED</li><li class="tablelistbullet">KAV_O_M_MAILPLAIN</li><li class="tablelistbullet">KAV_O_M_MAILBASES</li><li class="tablelistbullet">KAV_O_M_HEURISTIC_LEVEL_SHALLOW</li><li class="tablelistbullet">KAV_SHT_ENGINE_KSN</li><li class="tablelistbullet">KAV_SHT_ENGINE_APUF</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">Mode</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">See the description of <code class="programcharacter">Mode</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">MaxArchivesScanningDepth</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">5</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">SessionTimeout</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">10000 (10 seconds)</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">KeepAliveSettings</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">See the description of <code class="programcharacter">KeepAliveSettings</code> below</p>
</td>
</tr>

</table>
<p class="bodytext"><a id="h201067" class="englishcrossreferencetemplate" href="201037.htm" target="_self">ScannersCount</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Processes</span>.</p>
<p class="bodytext">The recommended number of scanning processes is equal to the number of processor cores. For example, if Kaspersky Scan Engine is running on a computer with a 4-core processor, set <code class="programcharacter">ScannersCount</code> to <code class="programcharacter">4</code>.</p>
<p class="bodytext">See also subsection &quot;Example of Kaspersky Scan Engine work in HTTP mode depending on the ScannersCount, ThreadsCount, QueueLen, MaxIncomingConnectionsNum, and MaxHTTPSessionsNum settings.&quot;</p>
<p class="bodytext"><a id="h201068" class="englishcrossreferencetemplate" href="201038.htm" target="_self">ThreadsCount</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Threads</span>.</p>
<p class="bodytext">The recommended number of scanning threads depends on the number of scanning processes specified in <code class="programcharacter">ScannersCount</code>: the value of <code class="programcharacter">ThreadsCount</code> is twice the value of <code class="programcharacter">ScannersCount</code>. For example, if Kaspersky Scan Engine is running on a computer with a 4-core processor and <code class="programcharacter">ScannersCount</code> is set to <code class="programcharacter">4</code>, set <code class="programcharacter">ThreadsCount</code> to <code class="programcharacter">8</code>.</p>
<p class="bodytext">See also the subsection &quot;Example of Kaspersky Scan Engine work in HTTP mode depending on the ScannersCount, ThreadsCount, QueueLen, MaxIncomingConnectionsNum, and MaxHTTPSessionsNum settings.&quot;</p>
<p class="bodytext"><a id="h201057" class="englishcrossreferencetemplate" href="201027.htm" target="_self">MaxIncomingConnectionsNum</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Connections</span>.</p>
<p class="bodytext">You can configure this parameter to set the queue length of the incoming TCP connections waiting for connection with HTTPD. See section &quot;<a id="h180043" class="englishcrossreferencetemplate" href="179869.htm" target="_self">Setting up the connection queue in HTTP mode</a>&quot; for connection queue setup details. </p>
<p class="bodytext">For example, you expect, on average, ten simultaneous connections with clients. If <code class="programcharacter">MaxHTTPSessionsNum</code> value is set to 10, all 10 connections simultaneously occurred will be accepted by HTTPD for processing. The 11th incoming TCP connection will wait for connection with HTTPD. At least 11 additional connections can wait for HTTPD acceptance, the 12th additional  connection will cause an error message. So, when setting the value for <code class="programcharacter">MaxIncomingConnectionsNum</code>, consider the value for <code class="programcharacter">MaxHTTPSessionNum</code>: the value specified in <code class="programcharacter">MaxIncomingConnectionsNum</code> should be multiple times bigger than the value specified in <code class="programcharacter">MaxHTTPSessionNum</code>.</p>
<p class="bodytext"><a id="h201058" class="englishcrossreferencetemplate" href="201028.htm" target="_self">MaxHTTPSessionsNum</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings </span>&gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Sessions</span>.</p>
<p class="bodytext">When specifying the value for this parameter, consider the following:</p>
<ul class="listbullet1"><li class="listbullet1">the maximum number of scanning threads (<code class="programcharacter">ThreadsCount</code>).</li><li class="listbullet1">the maximum length of the queue for scan tasks (<code class="programcharacter">QueueLen</code>).</li><li class="listbullet1">the maximum length of the scan waiting queue (<code class="programcharacter">MaxIncomingConnectionsNum</code>).</li><li class="listbullet1">specifics of the НТТPD: in general, HTTPD runs one scanning process for one scan task.</li></ul><p class="listheading">The recommended value is:</p>
<ul class="listbullet1"><li class="listbullet1">greater than or equal to:<ol class="listalpha2"><li class="listalpha2">5*ThreadsCount/4 (when scanning files and URL).</li><li class="listalpha2">3*ThreadsCount/2 (when scanning system memory).</li></ol></li><li class="listbullet1">corresponds to the expected number of HTTP clients that make requests to HTTPD.</li></ul><p class="bodytext">See also the subsection &quot;Example of Kaspersky Scan Engine work in HTTP mode depending on the ScannersCount, ThreadsCount, QueueLen, MaxIncomingConnectionsNum, and MaxHTTPSessionsNum settings.&quot;</p>
<p class="bodytext"><a id="h201069" class="englishcrossreferencetemplate" href="200631.htm" target="_self">QueueLen</a></p>
<p class="bodytext">Since the scan tasks are enqueued from all simultaneously open sessions, consider the <code class="programcharacter">MaxHTTPSessionsNum</code> settings. The queue length should not be less than the <code class="programcharacter">MaxHTTPSessionsNum</code> value. Otherwise, some clients will get an error when opening sessions.</p>
<p class="bodytext">Since the scan tasks are processed by the threads from the queue, the queue length should not be less than the number of threads in <code class="programcharacter">ThreadsCount</code>. Otherwise, some threads will be not in use.</p>
<p class="bodytext">The recommended <code class="programcharacter">QueueLen</code> value is:</p>
<ul class="listbullet1"><li class="listbullet1">greater than the <code class="programcharacter">ThreadsCount</code> value.</li><li class="listbullet1">greater than or equal to <code class="programcharacter">MaxHTTPSessionsNum</code> value.</li></ul><p class="bodytext">See also the subsection &quot;Example of Kaspersky Scan Engine work in HTTP mode depending on the ScannersCount, ThreadsCount, QueueLen, MaxIncomingConnectionsNum, and MaxHTTPSessionsNum settings.&quot;</p>
<p class="bodytext"><a id="h201059" class="englishcrossreferencetemplate" href="201029.htm" target="_self">MaxTCPFileSize</a></p>
<p class="bodytext">During scanning, HTTPD loads the files into the system memory. The greater the file size and the number of active sessions, the more system memory is consumed. The value specified should be less than the RAM size.</p>
<p class="bodytext">To  increase performance, you can specify the maximum size of HTTP messages sent to HTTPD and set the value to 10591440 bytes (10.1 MB). This value provides detecting most of the malware.</p>
<p class="attentionbody">If you have followed the recommendation above, we also recommend consulting with your Technical Account Manager (TAM) once a year to get an updated recommended value, as the average malware size changes from year to year.</p>
<p class="bodytext"><a id="h201061" class="englishcrossreferencetemplate" href="201031.htm" target="_self">Flags</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Types of files to scan</span>, <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Heuristic analysis level </span>and<span class="guicharacter"> Settings</span> &gt; <span class="guicharacter">Scanning </span>&gt;<span class="guicharacter"> Enable reputation checking</span>.</p>
<p class="bodytext">The recommended value for <code class="programcharacter">Flags</code> is the following:</p>
<p class="bodytext"><code class="programcharacter">KAV_O_M_PACKED | KAV_O_M_ARCHIVED | KAV_O_M_MAILPLAIN | KAV_O_M_MAILBASES | KAV_O_M_HEURISTIC_LEVEL_SHALLOW | KAV_SHT_ENGINE_KSN</code></p>
<p class="bodytext">If the<code class="programcharacter"> KAV_SHT_ENGINE_KSN flag </code>is used,<code class="programcharacter"> </code>it is also recommended to enable<code class="programcharacter"> </code>Phishing Protection by using one of the following ways:</p>
<ul class="listbullet1"><li class="listbullet1">In the Flags element of the kavhttpd.xml configuration file, add the <code class="programcharacter">KAV_SHT_ENGINE_APUF</code> flag.</li><li class="listbullet1">On the <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> page of the Kaspersky Scan Engine GUI, turn on the <span class="guicharacter">Enable Phishing Protection</span> toggle switch.</li></ul><p class="bodytext">Phishing Protection is useful when Kaspersky Scan Engine checks URLs.<code class="programcharacter"> </code></p>
<p class="bodytext"><a id="h201071" class="englishcrossreferencetemplate" href="201041.htm" target="_self">Mode</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Actions on detected objects</span>.</p>
<p class="bodytext">If it is expected to specify the object local path (request <code class="programcharacter">scanfile</code> to scan a local file), specify the following:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">KAV_DELETE </code>(if the object is to be deleted without a disinfection attempt).</li><li class="listbullet1"><code class="programcharacter">KAV_CLEAN_DELETE </code>(if the object is to be disinfected or to be deleted, if disinfection is impossible).</li></ul><p class="bodytext">Specify <code class="programcharacter">KAV_SKIP</code> in all other cases.</p>
<p class="bodytext"><a id="h206217" class="englishcrossreferencetemplate" href="207145.htm" target="_self">MaxArchivesScanningDepth</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Maximum depth</span>.</p>
<p class="bodytext">We recommend that you limit the maximum depth of nested archives to be unpacked during scanning. The recommended value for <code class="programcharacter">MaxArchivesScanningDepth</code> is <code class="programcharacter">5</code>.</p>
<p class="bodytext"><a id="h201060" class="englishcrossreferencetemplate" href="201030.htm" target="_self">SessionTimeout</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Object scan timeout</span>.</p>
<p class="bodytext">You can set a timeout for all operations in a session: connection with a client, data receipt, and object checking.  Timeout configuring can be used with the <code class="programcharacter">X-KAV-Timeout</code> header (see <a id="h179922" class="englishcrossreferencetemplate" href="179870.htm" target="_self">Setting the session timeout</a>). </p>
<p class="bodytext">Setting the timeout allows the following:</p>
<ul class="listbullet1"><li class="listbullet1">immediate releasing the scanning thread, if the session time has expired.</li><li class="listbullet1">faster managing the queue of the incoming TCP connections (the queue length is set in <code class="programcharacter">MaxIncomingConnectionsNum</code>).</li></ul><p class="bodytext">Initially, HTTPD receives the data, and then loads the files into the system memory during scanning. The greater the file size and the number of active sessions, the more system memory is consumed. To  increase performance, you can specify the maximum size of HTTP messages sent to HTTPD (see <code class="programcharacter">MaxTCPFileSize</code> above) and limit the session time in <code class="programcharacter">SessionTimeout</code>. This will allow you to skip the large objects or objects requiring a long time for scanning.</p>
<p class="bodytext">Before setting a value to <code class="programcharacter">SessionTimeout</code>, we recommend that you estimate the expected number of HTTP clients requesting the HTTPD, as well as probable length of the incoming TCP connections queue.</p>
<p class="bodytext">Generally, the default value for <code class="programcharacter">SessionTimeout</code> is <code class="programcharacter">10000</code> (10 seconds).</p>
<p class="bodytext"><a id="h207358" class="englishcrossreferencetemplate" href="207348.htm" target="_self">KeepAliveSettings</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Keep-alive connection</span>.</p>
<p class="bodytext">We recommend enabling Keep-Alive. When Keep-Alive is enabled, Kaspersky Scan Engine maintains a persistent connection even after the request has been processed and the session timed out. This gives the following advantages:</p>
<ul class="listbullet1"><li class="listbullet1">reduce network traffic.</li><li class="listbullet1">reduce the use of server resources.</li><li class="listbullet1">reduce latency in processing requests.</li></ul><p class="bodytext">Keep-Alive is especially useful for HTTPS connections that require more CPU time and more client-server interactions.</p>
<p class="bodytext">To enable Keep-Alive, set the <a id="h228936" class="englishcrossreferencetemplate" href="207346.htm" target="_self">Enabled</a> element in <code class="programcharacter">KeepAliveSettings</code> to <code class="programcharacter">1</code>.</p>
<p class="bodytext">To determine the values for <code class="programcharacter"><a id="h228937" class="englishcrossreferencetemplate" href="207350.htm" target="_self">TimeoutMs</a></code> and <code class="programcharacter"><a id="h228938" class="englishcrossreferencetemplate" href="207352.htm" target="_self">MaxRequests</a></code>, estimate the number of clients and the number of requests from clients.</p>
<p class="bodytext">For example, you have estimated that the maximum number of clients is 10, so you set <code class="programcharacter">MaxHTTPSessionsNum</code> to 10. If <code class="programcharacter">TimeoutMs</code> and <code class="programcharacter">MaxRequests</code> are unlimited, and all 10 clients send requests continuously, Kaspersky Scan Engine maintains connections with these 10 clients without limits. As a result, new connections cannot be accepted by HTTPD for processing.</p>
<p class="bodytext">Another example. You have estimated that the maximum number of clients is 10, so you set <code class="programcharacter">MaxHTTPSessionsNum</code> to 10. You have also estimated that the maximum number of requests from one client is 15, so you set <code class="programcharacter">MaxRequests</code> to <code class="programcharacter">15</code>. If you did not set the limit for <code class="programcharacter">TimeoutMs</code>, and clients do not send 15 requests, Kaspersky Scan Engine maintains connections with these 10 clients without limits, so new connections cannot be accepted by HTTPD for processing.</p>
<p class="introheading">Example of Kaspersky Scan Engine work in HTTP mode depending on the ScannersCount, ThreadsCount, QueueLen, MaxIncomingConnectionsNum, and MaxHTTPSessionsNum settings</p>
<p class="bodytext">Let's say Kaspersky Scan Engine is installed on a computer with four CPU cores, there are 15 simultaneous connections to this computer, and Kaspersky Scan Engine is configured as follows:</p>
<ul class="listbullet1"><li class="listbullet1">ScannersCount = 4</li><li class="listbullet1">ThreadsCount = 8</li><li class="listbullet1">QueueLen = 20</li><li class="listbullet1">MaxHTTPSessionsNum = 10</li><li class="listbullet1">MaxIncomingConnectionsNum = 20</li></ul><p class="bodytext">In this case:</p>
<ol class="listnumber1"><li class="listnumber1">Five out of fifteen clients will be enqueued for connection.</li><li class="listnumber1">Ten sessions will open for ten clients.</li><li class="listnumber1">Ten open sessions will form a queue of scan tasks. If the number of scan tasks surpass the value of <code class="programcharacter">QueueLen</code>, the client will receive the error <code class="programcharacter">503 </code>-<code class="programcharacter"> Service overloaded.</code></li><li class="listnumber1">Kaspersky Scan Engine runs four scanning processes.</li><li class="listnumber1">Four scanning processes create eight threads for simultaneous processing of eight scan tasks from the queue (one thread for one scan task).</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div>
</body>

</html>
