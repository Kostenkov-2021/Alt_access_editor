<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="description" content=""/>
    <meta name="viewport" content="maximum-scale=1.0" />
    <title> Manually upgrading Kaspersky Scan Engine 1.0 </title>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-MPK6ZG');</script>
	<!-- End Google Tag Manager -->
    <script type="text/javascript" src="../langs.js"></script>
    <script type="text/javascript">
        !function ( w, d ) {
            var scriptsPath="/localization/";
            if(w.location.pathname.match(/title\.htm$/)){scriptsPath="./js/"}d.writeln("\x3Cscript type='text/javascript' src='"+scriptsPath+d.documentElement.lang+".js'>\x3C/script>");
        }( window, document );
    </script>	
    <script type="text/javascript" src="toc.js"></script>
    
    <script type="text/javascript" src="aiconverter_result.js"></script>
    <link rel="stylesheet" type='text/css' href="typography.css"/>
    <link rel="stylesheet" type='text/css' href="styles.css"/>
    <link rel="shortcut icon" href="favicon.ico"/>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
    <link rel="icon" href="favicon.png" type="image/png"/>


            <!--[if lte IE 9]>
                <link rel="stylesheet" type="text/css" href="bootstrap.css">
            <![endif]-->
            <!--[if lte IE 8]>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.js"></script>
            <![endif]-->
            </head>

<body id="who-content" class="no-js">
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MPK6ZG" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->
	<noscript class="no-js__message">
	<a href="https://support.microsoft.com/en-us/kb/3135465" class="no-js__link">Please enable JavaScript in your browser!</a>
	</noscript>
	<div class="cont">
	<h3 id="t234448" class="heading3">Manually upgrading Kaspersky Scan Engine 1.0</h3>
<p class="procedureheading">To manually upgrade Kaspersky Scan Engine 1.0:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure you have root (administrator) privileges.</li><li class="listnumber1">Stop Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">If you use Kaspersky Scan Engine in ICAP mode, run this command:<p class="listcontinue2"><code class="programcharacter">/etc/init.d/kavicapd stop</code></p>
</li><li class="listbullet2">If you use Kaspersky Scan Engine in HTTP mode, run this command:<p class="listcontinue2"><code class="programcharacter">/etc/init.d/kavhttpd stop</code></p>
</li><li class="listbullet2">If you use Kaspersky Scan Engine GUI, run this command:<p class="listcontinue2"> <code class="programcharacter">/etc/init.d/klScanEngineUI stop</code></p>
</li></ul></li><li class="listnumber1">Create backup copies of the following data:<ul class="listbullet2"><li class="listbullet2">If Kaspersky Scan Engine worked in ICAP mode and you configured ICAP rules in <code class="programcharacter">kavicapd_gui_rules.conf</code>, you need to copy <code class="programcharacter">/opt/kaspersky/ScanEngine/icap_data</code>.</li><li class="listbullet2">If you generated a certificate and a private key to use with the Kaspersky Scan Engine GUI, copy the certificate and the private key.<p class="listcontinue2">You can find information on the location of the certificate and private key in the <code class="programcharacter">SSLCertificatePath</code> and <code class="programcharacter">SSLPrivateKeyPath</code> elements of the <code class="programcharacter">klScanEngineUI.xml</code> file.</p>
</li><li class="listbullet2">The key file (if Kaspersky Scan Engine was activated in <a id="h180864" class="englishcrossreferencetemplate" href="179852.htm" target="_self">offline licensing mode</a>) or the activation code (if Kaspersky Scan Engine was activated in <a id="h180819" class="englishcrossreferencetemplate" href="179855.htm" target="_self">online licensing mode</a>).<p class="listcontinue2">You can find information on the location of the key file or activation code in the <code class="programcharacter">LicensePath</code> element of the <code class="programcharacter">kavhttpd.xml</code> configuration file (if Kaspersky Scan Engine worked in HTTP mode) or <code class="programcharacter">kavicapd.xml</code> configuration file (if Kaspersky Scan Engine worked in ICAP mode).</p>
</li></ul></li><li class="listnumber1">In the <code class="programcharacter">/opt/kaspersky/ScanEngine</code> directory, uninstall Kaspersky Scan Engine with <code class="programcharacter">uninstall.</code><p class="listcontinue1">If you used the Kaspersky Scan Engine GUI, you also need to confirm deletion of data from the <code class="programcharacter">kavebase</code> database. The structure of database in Kaspersky Scan Engine 1.0 differs significantly from the new version, so you cannot use the old database with the new version of Kaspersky Scan Engine.</p>
</li><li class="listnumber1">Remove files form the directory <code class="programcharacter">/opt/kaspersky/ScanEngine/</code> or delete this directory.</li><li class="listnumber1">Install the new version of Kaspersky Scan Engine with the <a id="h193036" class="englishcrossreferencetemplate" href="192977.htm" target="_self">installer</a>.</li><li class="listnumber1">Stop Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">If you used Kaspersky Scan Engine in ICAP mode, run this command:<p class="listcontinue2"><code class="programcharacter">service kavicapd stop</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine in HTTP mode, run this command:<p class="listcontinue2"><code class="programcharacter">service kavhttpd stop</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine GUI, run this command:<p class="listcontinue2">s<code class="programcharacter">ervice klScanEngineUI stop</code></p>
</li></ul></li><li class="listnumber1">Copy data that you backed up earlier:<ul class="listbullet2"><li class="listbullet2">Copy <code class="programcharacter">klScanEngineUI.xml</code> to <code class="programcharacter">/opt/kaspersky/ScanEngine/etc/</code> </li><li class="listbullet2">To be able to use Kaspersky Scan Engine GUI:<ol class="listalpha3"><li class="listalpha3">Go to <code class="programcharacter">/opt/kaspersky/ScanEngine/tools/</code></li><li class="listalpha3">Run the following command:<p class="listcontinue3"><code class="programcharacter">./kav_encrypt -d '%USERNAME%:%PASSWORD%'</code></p>
<p class="listcontinue3">Here, <code class="programcharacter">%USERNAME%</code> and <code class="programcharacter">%PASSWORD%</code> are the username and password used to connect to the <code class="programcharacter">kavebase</code> database.</p>
<p class="listcontinue3">If you forgot the username or password, <a id="h226775" class="expandingblocktemplate" href="javascript:toggleBlock('226775')" target="_self">use the psql utility</a>.</p>
<div id="d226775" class="expandingblock" style="display:none"><p class="bodytext">If you forgot the username or password used to connect to the database, use the psql utility to get the username or to change the password.</p>
<p class="bodytext">To see the database <span class="boldcharacter">username</span>, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">postgres=# \l kavebase</p>
</td>
</tr>

</table>
<p class="bodytext">The psql utility displays information about the database name and its owner (username):</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">List of databases</p>
<p class="program">-[ RECORD 1 ]-----+--------------------------</p>
<p class="program">Name              | kavebase</p>
<p class="program">Owner             | scanengine </p>
</td>
</tr>

</table>
<p class="bodytext">If you forgot the <span class="boldcharacter">password</span>, you need to change it with the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">alter user %USERNAME% with password '%PASSWORD%'; </p>
</td>
</tr>

</table>
<p class="bodytext">Here, <code class="programcharacter">%PASSWORD%</code> is the new password for the <code class="programcharacter">%USERNAME%</code> user.</p>
</div></li></ol></li><li class="listbullet2">If the previous version of Kaspersky Scan Engine worked in ICAP mode and you configured ICAP rules in <code class="programcharacter">kavicapd_gui_rules.conf</code>, copy data from <code class="programcharacter">/opt/kaspersky/ScanEngine/icap_data</code>.</li><li class="listbullet2">If you used Kaspersky Scan Engine GUI and you made copies of the certificate and the private key, place them in the locations that are specified in the <code class="programcharacter">SSLCertificatePath</code> and <code class="programcharacter">SSLPrivateKeyPath</code> elements of the <code class="programcharacter">klScanEngineUI.xml</code> file, respectively.<p class="listcontinue2">Make sure that only users with administrator rights have read access to the certificate and the private key.</p>
</li><li class="listbullet2">Make sure that the key file (if the previous version of Kaspersky Scan Engine was activated in <a id="h180864_2" class="englishcrossreferencetemplate" href="179852.htm" target="_self">offline licensing mode</a>) or the activation code (if the previous version of Kaspersky Scan Engine was activated in <a id="h180819_2" class="englishcrossreferencetemplate" href="179855.htm" target="_self">online licensing mode</a>) is located in the correct directory. <p class="listcontinue2">You can find information on the location of the key file or activation code in the <code class="programcharacter">LicensePath</code> element of the <code class="programcharacter">kavhttpd.xml</code> configuration file (if Kaspersky Scan Engine worked in HTTP mode) or <code class="programcharacter">kavicapd.xml</code> configuration file (if Kaspersky Scan Engine worked in ICAP mode).</p>
</li></ul></li><li class="listnumber1">Run Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">To use Kaspersky Scan Engine in ICAP mode, run <code class="programcharacter">service kavicapd start</code></li><li class="listbullet2">To use Kaspersky Scan Engine in HTTP mode, run <code class="programcharacter">service kavhttpd start</code></li><li class="listbullet2">To use the Kaspersky Scan Engine GUI, run <code class="programcharacter">service klScanEngineUI start</code></li></ul></li><li class="listnumber1">If you are using the Kaspersky Scan Engine GUI, clear your browser cache after the upgrade.</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div>
</body>

</html>
