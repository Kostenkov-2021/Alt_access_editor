<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="description" content=""/>
    <meta name="viewport" content="maximum-scale=1.0" />
    <title> Example of a multipart HTTP request to scan a block of memory </title>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-MPK6ZG');</script>
	<!-- End Google Tag Manager -->
    <script type="text/javascript" src="../langs.js"></script>
    <script type="text/javascript">
        !function ( w, d ) {
            var scriptsPath="/localization/";
            if(w.location.pathname.match(/title\.htm$/)){scriptsPath="./js/"}d.writeln("\x3Cscript type='text/javascript' src='"+scriptsPath+d.documentElement.lang+".js'>\x3C/script>");
        }( window, document );
    </script>	
    <script type="text/javascript" src="toc.js"></script>
    
    <script type="text/javascript" src="aiconverter_result.js"></script>
    <link rel="stylesheet" type='text/css' href="typography.css"/>
    <link rel="stylesheet" type='text/css' href="styles.css"/>
    <link rel="shortcut icon" href="favicon.ico"/>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
    <link rel="icon" href="favicon.png" type="image/png"/>

            <!--[if lte IE 9]>
                <link rel="stylesheet" type="text/css" href="bootstrap.css">
            <![endif]-->
            <!--[if lte IE 8]>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.js"></script>
            <![endif]-->
            </head>

<body id="who-content" class="no-js">
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MPK6ZG" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->
	<noscript class="no-js__message">
	<a href="https://support.microsoft.com/en-us/kb/3135465" class="no-js__link">Please enable JavaScript in your browser!</a>
	</noscript>
	<div class="cont">
	<h4 id="t234341" class="heading4">Example of a multipart HTTP request to scan a block of memory</h4>
<p class="bodytext">In Kaspersky Scan Engine, a multipart HTTP request is an HTTP request that contains request or response headers that were gathered from HTTP traffic related to the object being scanned. You can send multipart HTTP requests to improve the detection rate. </p>
<p class="attentionbody">Kaspersky Scan Engine does not support multipart HTTP requests, as defined in RFC 1341.</p>
<p class="attentionbody">To make multipart HTTP requests, use the KAV protocol version 2 by specifying it in the <code class="programcharacter">X-KAV-ProtocolVersion</code> request header.</p>
<p class="bodytext">The body of a multipart HTTP request must contain no more than three parts. These parts contain the following data:</p>
<ul class="listbullet1"><li class="listbullet1">Request headers (optional)<p class="listcontinue1">This part must begin with the &quot;<code class="programcharacter">Request headers</code>&quot; string followed by <code class="programcharacter">\r\n</code> characters. These characters must be followed by request headers from HTTP traffic related to the object that is being scanned.</p>
</li><li class="listbullet1">Response headers (optional)<p class="listcontinue1">This part must begin with the &quot;<code class="programcharacter">Response headers</code>&quot; string followed by <code class="programcharacter">\r\n</code> characters. These characters must be followed by response headers from HTTP traffic related to the object that is being scanned.</p>
</li><li class="listbullet1">Object for scanning.<p class="listcontinue1">This part can contain the full path to the file to scan (if a request is made to <code class="programcharacter">/scanfile</code>) or a string (if a request is made to <code class="programcharacter">/scanmemory</code>).</p>
</li></ul><p class="bodytext">The following example shows a multipart HTTP request to scan a block of memory:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /scanmemory HTTP/1.0</p>
<p class="program">Content-Length: 753</p>
<p class="program">X-KAV-ProtocolVersion: 2</p>
<p class="program">X-KAV-Timeout: 10</p>
<p class="program"><code class="programcharacter">X-KAV-ObjectURL: http://example.com</code></p>
<p class="program">Content-Type: multipart/mixed; boundary=gc0p4Jq0M2Yt08jU534c0p</p>
<p class="program">&nbsp;</p>
<p class="program">--gc0p4Jq0M2Yt08jU534c0p</p>
<p class="program">Request headers</p>
<p class="program">GET /files/test.exe HTTP/1.1</p>
<p class="program">Host: source.example.com</p>
<p class="program">Accept: application/octet-stream</p>
<p class="program">Referer: http://malicious.example.com/</p>
<p class="program">Host: source.example.com</p>
<p class="program">Connection: Keep-Alive</p>
<p class="program">--gc0p4Jq0M2Yt08jU534c0p</p>
<p class="program">Response headers</p>
<p class="program">HTTP/1.1 200 OK</p>
<p class="program">Content-Type: application/octet-stream</p>
<p class="program">Content-Length: 21541</p>
<p class="program">Date: Mon, 25 Sep 2017 11:01:54 GMT</p>
<p class="program">Last-Modified: Fri, 28 Sep 2017 03:15:02 GMT</p>
<p class="program">--gc0p4Jq0M2Yt08jU534c0p</p>
<p class="program">* Contents of the EICAR test file *</p>
<p class="program">--gc0p4Jq0M2Yt08jU534c0p--</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Date: Fri, 28 Sep 2017 03:15:02 GMT</p>
<p class="program">Server: KAVHTTPD</p>
<p class="program">Content-Length: 64</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">X-KAV-ProtocolVersion: 2</p>
<p class="program">&nbsp;</p>
<p class="program">DETECT EICAR-Test-File</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div>
</body>

</html>
