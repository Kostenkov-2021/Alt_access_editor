<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="description" content=""/>
    <meta name="viewport" content="maximum-scale=1.0" />
    <title> Configuring ArcSight ESM </title>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-MPK6ZG');</script>
	<!-- End Google Tag Manager -->
    <script type="text/javascript" src="../langs.js"></script>
    <script type="text/javascript">
        !function ( w, d ) {
            var scriptsPath="/localization/";
            if(w.location.pathname.match(/title\.htm$/)){scriptsPath="./js/"}d.writeln("\x3Cscript type='text/javascript' src='"+scriptsPath+d.documentElement.lang+".js'>\x3C/script>");
        }( window, document );
    </script>	
    <script type="text/javascript" src="toc.js"></script>
    
    <script type="text/javascript" src="aiconverter_result.js"></script>
    <link rel="stylesheet" type='text/css' href="typography.css"/>
    <link rel="stylesheet" type='text/css' href="styles.css"/>
    <link rel="shortcut icon" href="favicon.ico"/>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
    <link rel="icon" href="favicon.png" type="image/png"/>

            <!--[if lte IE 9]>
                <link rel="stylesheet" type="text/css" href="bootstrap.css">
            <![endif]-->
            <!--[if lte IE 8]>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.js"></script>
            <![endif]-->
            </head>

<body id="who-content" class="no-js">
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MPK6ZG" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->
	<noscript class="no-js__message">
	<a href="https://support.microsoft.com/en-us/kb/3135465" class="no-js__link">Please enable JavaScript in your browser!</a>
	</noscript>
	<div class="cont">
	<h3 id="t234298" class="heading3">Configuring ArcSight ESM</h3>
<p class="bodytext">For ArcSight ESM to receive events from Kaspersky Scan Engine, an ArcSight SmartConnector of the Syslog Daemon type must be installed. You can install ArcSight SmartConnector on any computer that can connect to Kaspersky Scan Engine and to ArcSight ESM.</p>
<p class="procedureheading">To install an ArcSight SmartConnector:</p>
<ol class="listnumber1"><li class="listnumber1">Run the ArcSight SmartConnector installation application.<p class="attentioncontinue1">This application is a component of HP ArcSight and is not included in Kaspersky Scan Engine.</p>
</li><li class="listnumber1">Specify the ArcSight SmartConnector installation directory (hereinafter referred to as <code class="programcharacter">%ARCSIGHT_HOME%</code>).</li><li class="listnumber1">Select <span class="boldcharacter">Don't create links</span>.</li><li class="listnumber1">After unpacking the contents of the binary file, select <span class="boldcharacter">Add a Connector</span>.<p class="picture"><img id="f220907" src="arcsight_add_connector.png" class="linkedpngfiletemplate" alt="&quot;Connector Setup&quot; window. Selected variant &quot;Add a Connector&quot;." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Selecting <span class="boldcharacter">Add a Connector</span></p>
<p class="listcontinue2">If this window is not displayed, run the following command:</p>
<p class="listcontinue2"><code class="programcharacter">%ARCSIGHT_HOME%/current/bin/runagentsetup.sh</code></p>
</li><li class="listnumber1">Select <span class="boldcharacter">Syslog Daemon</span> as the connector type.</li><li class="listnumber1">Specify the parameters of the connector in the <span class="boldcharacter">Enter the parameter details</span> form as follows:<ul class="listbullet2"><li class="listbullet2"><span class="boldcharacter">Network port</span>. Specify the port to which Kaspersky Scan Engine must send detection events.<p class="listcontinue2">You specify the same port in the <a id="h220794" class="englishcrossreferencetemplate" href="220786.htm" target="_self">Kaspersky Scan Engine Syslog settings</a>.</p>
</li><li class="listbullet2"><span class="boldcharacter">IP Address</span>. Specify the IP address to which Kaspersky Scan Engine must send detection events.<p class="listcontinue2">You specify the same IP address in the <a id="h220794_2" class="englishcrossreferencetemplate" href="220786.htm" target="_self">Kaspersky Scan Engine Syslog settings</a>.</p>
<p class="attentioncontinue2">You can specify <span class="boldcharacter">(ALL)</span> if you want Arcsight SmartConnector to receive events from all network interfaces of the computer on which it runs. Note that you cannot specify (ALL) in the Kaspersky Scan Engine configuration file.</p>
</li><li class="listbullet2"><span class="boldcharacter">Protocol</span>. Specify <span class="boldcharacter">Raw TCP</span>.</li><li class="listbullet2"><span class="boldcharacter">Forwarder</span>. Specify <span class="boldcharacter">false</span>.</li></ul><p class="picture"><img id="f220912" src="arcsight_connector_details.png" class="linkedpngfiletemplate" alt="&quot;Connector Setup&quot; window. Network port = 9998, IP Address = (ALL), Protocol = Raw TCP, Forwarder = false." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Defining connector parameters</p>
<p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">Specify <span class="boldcharacter">ArcSight Manager (encrypted)</span> as the type of destination.<p class="picture"><img id="f220950" src="arcsight_destination_type.png" class="linkedpngfiletemplate" alt="&quot;Connector Setup&quot; window. Type of destination. Selected variant &quot;ArcSight Manager (encrypted)&quot;." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Selecting the type of destination</p>
<p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">Specify the parameters of the destination:<ul class="listbullet2"><li class="listbullet2"><span class="boldcharacter">Manager Hostname</span>. Specify the host where ArcSight Manager is running.</li><li class="listbullet2"><span class="boldcharacter">Manager Port</span>. Specify the port where ArcSight Manager is available. The default value is 8443.</li><li class="listbullet2"><span class="boldcharacter">User</span>. Specify the name of the ArcSight ESM user that has rights to register the connector.</li><li class="listbullet2"><span class="boldcharacter">Password</span>. Specify the password of the ArcSight ESM user.</li><li class="listbullet2"><span class="boldcharacter">AUP Master Destination</span>. Specify <span class="boldcharacter">false</span>.</li><li class="listbullet2"><span class="boldcharacter">Filter Out All Events</span>. Specify <span class="boldcharacter">false</span>.</li><li class="listbullet2"><span class="boldcharacter">Enable Demo CA</span>. Specify <span class="boldcharacter">false</span>.</li></ul><p class="picture"><img id="f220984" src="arcsight_destination_parameters.png" class="linkedpngfiletemplate" alt="&quot;Connector Setup&quot; window. Manager Hostname = 127.0.0.1, Manager Port = 8443, User = admin, Password is hidden, AUP Master Destination = false, Filter Out All Events = false, Enable Demo CA = false." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Defining destination parameters</p>
<p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">Specify the connector details:<ul class="listbullet2"><li class="listbullet2">Name (you can specify an arbitrary value).</li><li class="listbullet2">Location (you can specify an arbitrary value).</li><li class="listbullet2">Location of the device that must send events to the connector (you can specify an arbitrary value or leave it empty).</li><li class="listbullet2">Comment about the connector (you can specify an arbitrary value or leave it empty).</li></ul><p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">If the ArcSight Manager parameters are valid, accept importing the certificate from the destination.</li><li class="listnumber1">If the certificate is imported successfully, install the ArcSight SmartConnector service. <p class="listcontinue1">If you do not run the installation as root, the following warning is displayed:</p>
<p class="picture"><img id="f220985" src="arcsight_root_needed.png" class="linkedpngfiletemplate" alt="&quot;Connector Setup&quot; window. Root privileges needed." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">If you do not run the installation as root</p>
<p class="listcontinue1">The <code class="programcharacter">%ARCSIGHT_HOME%/current/logs/agent.log</code> file contains messages about the installation process.</p>
<p class="listcontinue1">You can skip the next step that describes how to specify the service parameters.</p>
<p class="listcontinue1">If you run the installation as root, select <span class="boldcharacter">Install as a service</span>.</p>
<p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">Specify the service parameters.<p class="listcontinue1">We recommend that you set the service name, specified in <span class="boldcharacter">Service Internal Name</span>, to be the same as the connector name.</p>
<p class="picture"><img id="f220986" src="arcsight_service_parameters.png" class="linkedpngfiletemplate" alt="&quot;Connector Setup&quot; window. Service Internal Name = smartConnector, Service Display Name = KL Smart Connector, Start the service automatically = Yes." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Defining service parameters</p>
<p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">To start ArcSight SmartConnector, run the following command:<p class="listcontinue1"><code class="programcharacter">/etc/init.d/arc_$service_name start</code></p>
<p class="listcontinue1">In this command, <code class="programcharacter">$service_name</code> is the service internal name.</p>
</li></ol><p class="bodytext">After the ArcSight ESM configuration is complete, you can <a id="h220794_3" class="englishcrossreferencetemplate" href="220786.htm" target="_self">configure Kaspersky Scan Engine</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div>
</body>

</html>
