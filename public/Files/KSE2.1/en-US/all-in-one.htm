<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="description" content=""/>
    <meta name="viewport" content="maximum-scale=1.0" />
    <title> Kaspersky Scan Engine  Help </title>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-MPK6ZG');</script>
	<!-- End Google Tag Manager -->
    <script type="text/javascript" src="../langs.js"></script>
    <script type="text/javascript">
        !function ( w, d ) {
            var scriptsPath="/localization/";
            if(w.location.pathname.match(/title\.htm$/)){scriptsPath="./js/"}d.writeln("\x3Cscript type='text/javascript' src='"+scriptsPath+d.documentElement.lang+".js'>\x3C/script>");
        }( window, document );
    </script>	
    <script type="text/javascript" src="toc.js"></script>
    
    <script type="text/javascript" src="aiconverter_result.js"></script>
    <link rel="stylesheet" type='text/css' href="typography.css"/>
    <link rel="stylesheet" type='text/css' href="styles.css"/>
    <link rel="shortcut icon" href="favicon.ico"/>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
    <link rel="icon" href="favicon.png" type="image/png"/>

            <!--[if lte IE 9]>
                <link rel="stylesheet" type="text/css" href="bootstrap.css">
            <![endif]-->
            <!--[if lte IE 8]>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.js"></script>
            <![endif]-->
            </head>

<body id="who-content" class="no-js"><div class='cont all-in-one-toc'><h1 class='heading1 js_all_in_one_header'>Contents</h1><ul class='contents contents_all-in-one'><li class="contents__item"><a href='226466.htm'>Kaspersky Scan Engine  Help</a></li><li class="contents__item"><a href='192968.htm'>About Kaspersky Scan Engine</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='209374.htm'>What's new</a></li><li class="contents__item"><a href='184797.htm'>Key functions of Kaspersky Scan Engine</a></li><li class="contents__item"><a href='192970.htm'>Kaspersky Scan Engine detection technologies</a></li><li class="contents__item"><a href='184796.htm'>Kaspersky Scan Engine architecture</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='192971.htm'>HTTP mode</a></li><li class="contents__item"><a href='192972.htm'>ICAP mode</a></li><li class="contents__item"><a href='211897.htm'>Instances and clusters</a></li></ul></li><li class="contents__item"><a href='179824.htm'>Kaspersky Scan Engine usage scenarios</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='180130.htm'>Threat Protection</a></li><li class="contents__item"><a href='180131.htm'>Web Protection from malicious and phishing websites</a></li><li class="contents__item"><a href='180133.htm'>File and URL reputation checking in KSN</a></li></ul></li><li class="contents__item"><a href='184795.htm'>Hardware and software requirements</a></li><li class="contents__item"><a href='184793.htm'>Distribution kit contents (Linux)</a></li><li class="contents__item"><a href='192973.htm'>Distribution kit contents (Windows)</a></li></ul></li><li class="contents__item"><a href='180558.htm'>Getting started with Kaspersky Scan Engine</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='179865.htm'>Getting started with Kaspersky Scan Engine in HTTP mode</a></li><li class="contents__item"><a href='179890.htm'>Getting started with Kaspersky Scan Engine in ICAP mode</a></li></ul></li><li class="contents__item"><a href='192974.htm'>Installing Kaspersky Scan Engine</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='184775.htm'>Preparing to install Kaspersky Scan Engine GUI</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='192975.htm'>Installing and configuring PostgreSQL (Linux)</a></li><li class="contents__item"><a href='192976.htm'>Installing and configuring PostgreSQL (Windows)</a></li></ul></li><li class="contents__item"><a href='199729.htm'>Installing Kaspersky Scan Engine on Linux</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='192977.htm'>Automatic installation (Linux)</a></li><li class="contents__item"><a href='180652.htm'>Manual installation (Linux)</a></li></ul></li><li class="contents__item"><a href='199730.htm'>Installing Kaspersky Scan Engine on Windows</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='192978.htm'>Automatic installation (Windows)</a></li><li class="contents__item"><a href='184719.htm'>Manual installation (Windows)</a></li></ul></li></ul></li><li class="contents__item"><a href='221907.htm'>Upgrading Kaspersky Scan Engine on Linux</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='221941.htm'>Automatic upgrade (Linux)</a></li><li class="contents__item"><a href='209771.htm'>Manual upgrade (Linux)</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='225714.htm'>Manually upgrading Kaspersky Scan Engine 2.0 and later</a></li><li class="contents__item"><a href='225715.htm'>Manually upgrading Kaspersky Scan Engine 1.0</a></li></ul></li></ul></li><li class="contents__item"><a href='96464.htm'>Updating the anti-malware database and updatable modules</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='218188.htm'>About updating</a></li><li class="contents__item"><a href='218259.htm'>Database backup and recovery</a></li><li class="contents__item"><a href='218262.htm'>Reduced anti-malware databases kit usage</a></li><li class="contents__item"><a href='218298.htm'>Best practices for database updates</a></li><li class="contents__item"><a href='218349.htm'>Updating from an HTTPS server</a></li></ul></li><li class="contents__item"><a href='192979.htm'>Using Kaspersky Scan Engine in HTTP mode</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='184921.htm'>Kaspersky Scan Engine and HTTP mode</a></li><li class="contents__item"><a href='210245.htm'>HTTPS connections</a></li><li class="contents__item"><a href='225526.htm'>Recommended settings for HTTP mode</a></li><li class="contents__item"><a href='192980.htm'>Configuring Kaspersky Scan Engine in HTTP mode</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='184799.htm'>HTTP mode configuration file</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='201021.htm'>ServerSettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='201026.htm'>ConnectionString</a></li><li class="contents__item"><a href='201027.htm'>MaxIncomingConnectionsNum</a></li><li class="contents__item"><a href='201028.htm'>MaxHTTPSessionsNum</a></li><li class="contents__item"><a href='201029.htm'>MaxTCPFileSize</a></li><li class="contents__item"><a href='201030.htm'>SessionTimeout</a></li><li class="contents__item"><a href='201031.htm'>Flags</a></li><li class="contents__item"><a href='200613.htm'>TlsCertificateKeyFile</a></li><li class="contents__item"><a href='200614.htm'>TlsCertificateFile</a></li><li class="contents__item"><a href='201900.htm'>CORS</a></li><li class="contents__item"><a href='207348.htm'>KeepAliveSettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='207346.htm'>Enabled</a></li><li class="contents__item"><a href='207350.htm'>TimeoutMs</a></li><li class="contents__item"><a href='207352.htm'>MaxRequests</a></li></ul></li><li class="contents__item"><a href='222092.htm'>AuthSettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='222099.htm'>UseAccessToken</a></li><li class="contents__item"><a href='222116.htm'>AuthRequestField</a></li><li class="contents__item"><a href='222121.htm'>UseBearerAuthScheme</a></li><li class="contents__item"><a href='224176.htm'>AccessTokens</a></li><li class="contents__item"><a href='224177.htm'>Token</a></li></ul></li></ul></li><li class="contents__item"><a href='201022.htm'>KSNSettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='200623.htm'>UrlCheckTimeoutMs</a></li><li class="contents__item"><a href='200624.htm'>ObjectCheckOnDemandTimeoutMs</a></li><li class="contents__item"><a href='201036.htm'>CacheSizeKb</a></li></ul></li><li class="contents__item"><a href='201023.htm'>KAVScanningSettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='201037.htm'>ScannersCount</a></li><li class="contents__item"><a href='201038.htm'>ThreadsCount</a></li><li class="contents__item"><a href='200631.htm'>QueueLen</a></li><li class="contents__item"><a href='201040.htm'>Flags</a></li><li class="contents__item"><a href='201041.htm'>Mode</a></li><li class="contents__item"><a href='207145.htm'>MaxArchivesScanningDepth</a></li></ul></li><li class="contents__item"><a href='201024.htm'>DirectorySettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='201042.htm'>BasesPath</a></li><li class="contents__item"><a href='200640.htm'>TempPath</a></li><li class="contents__item"><a href='201044.htm'>LicensePath</a></li><li class="contents__item"><a href='201045.htm'>LicensingMode</a></li><li class="contents__item"><a href='201076.htm'>ScanningPaths</a></li></ul></li><li class="contents__item"><a href='200598.htm'>UseHTTPProxy</a></li><li class="contents__item"><a href='201047.htm'>HTTPProxy</a></li><li class="contents__item"><a href='201025.htm'>UpdateSettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='200649.htm'>DisableBackup</a></li><li class="contents__item"><a href='200650.htm'>UpdatePeriodMinutes</a></li><li class="contents__item"><a href='200651.htm'>UseOnlyCustomSources</a></li><li class="contents__item"><a href='201051.htm'>UpdateSources</a></li><li class="contents__item"><a href='200653.htm'>UpdatesCertFile</a></li><li class="contents__item"><a href='200654.htm'>CertificateConfirmationAction</a></li><li class="contents__item"><a href='200655.htm'>UseReducedBases</a></li></ul></li><li class="contents__item"><a href='201055.htm'>FormatRecognizerSettings</a></li></ul></li><li class="contents__item"><a href='179868.htm'>Configuring Format Recognizer for use in HTTP mode</a></li><li class="contents__item"><a href='179869.htm'>Setting up the connection queue in HTTP mode</a></li><li class="contents__item"><a href='179870.htm'>Setting the session timeout</a></li><li class="contents__item"><a href='179872.htm'>Changing variables in the HTTP mode unit file</a></li><li class="contents__item"><a href='179873.htm'>Configuring updating in HTTP mode</a></li></ul></li><li class="contents__item"><a href='192981.htm'>Running Kaspersky Scan Engine in HTTP mode</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='179876.htm'>Running Kaspersky Scan Engine in HTTP mode manually</a></li><li class="contents__item"><a href='184956.htm'>Running Kaspersky Scan Engine in HTTP mode with systemd unit file (Linux)</a></li><li class="contents__item"><a href='192984.htm'>Running Kaspersky Scan Engine in HTTP mode as service (Windows)</a></li><li class="contents__item"><a href='186032.htm'>Running Kaspersky Scan Engine in HTTP mode with a BAT script (Windows)</a></li><li class="contents__item"><a href='179880.htm'>Monitoring Kaspersky Scan Engine in HTTP mode</a></li></ul></li><li class="contents__item"><a href='192985.htm'>Making requests in HTTP mode</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='181167.htm'>About KAV protocol</a></li><li class="contents__item"><a href='179875.htm'>Making requests in HTTP mode via KAV protocol version 3</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='181169.htm'>Supported API methods in KAV protocol version 3</a></li><li class="contents__item"><a href='193000.htm'>Format of a scan POST request</a></li><li class="contents__item"><a href='193001.htm'>Format of a response to a scan POST request</a></li><li class="contents__item"><a href='181065.htm'>Increasing the detection rate</a></li><li class="contents__item"><a href='224308.htm'>Example of an HTTP request containing an API token for authorization</a></li><li class="contents__item"><a href='193002.htm'>Example of an HTTP request to scan a local file</a></li><li class="contents__item"><a href='193003.htm'>Example of an HTTP request to scan a block of memory</a></li><li class="contents__item"><a href='193004.htm'>Example of an HTTP request to check a URL</a></li><li class="contents__item"><a href='193005.htm'>Example of an HTTP request to get the release date of the anti-virus database</a></li><li class="contents__item"><a href='193007.htm'>Example of an HTTP request to get the current KAV SDK version</a></li><li class="contents__item"><a href='193008.htm'>Example of an HTTP request to get licensing information</a></li><li class="contents__item"><a href='193009.htm'>Example of an HTTP request to get accumulated statistics</a></li><li class="contents__item"><a href='193010.htm'>Example of an HTTP request to clear accumulated statistics</a></li><li class="contents__item"><a href='193011.htm'>Example of an HTTP request to update the anti-virus database</a></li><li class="contents__item"><a href='193012.htm'>Example of an HTTP request to get the database update status</a></li><li class="contents__item"><a href='193338.htm'>Example of an HTTP request to get the KSN information</a></li></ul></li><li class="contents__item"><a href='181038.htm'>Making requests in HTTP mode via KAV protocol versions 1 and 2</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='181170.htm'>Supported API methods in KAV protocol versions 1 and 2</a></li><li class="contents__item"><a href='181073.htm'>Request headers</a></li><li class="contents__item"><a href='224307.htm'>Example of an HTTP request containing an API token for authorization</a></li><li class="contents__item"><a href='181074.htm'>Example of an HTTP request to scan a local file</a></li><li class="contents__item"><a href='181076.htm'>Example of an HTTP request to scan a block of memory</a></li><li class="contents__item"><a href='181078.htm'>Example of a multipart HTTP request to scan a block of memory</a></li><li class="contents__item"><a href='181080.htm'>Example of an HTTP request to check a URL</a></li><li class="contents__item"><a href='181082.htm'>Example of an HTTP request to get the release date of the anti-virus database</a></li><li class="contents__item"><a href='181084.htm'>Example of an HTTP request to get the current KAV SDK version</a></li><li class="contents__item"><a href='181086.htm'>Example of an HTTP request to get licensing information</a></li><li class="contents__item"><a href='181088.htm'>Example of an HTTP request to get accumulated statistics</a></li><li class="contents__item"><a href='181090.htm'>Example of an HTTP request to clear accumulated statistics</a></li></ul></li><li class="contents__item"><a href='201538.htm'>Getting the list of HTTP methods supported in the service</a></li></ul></li><li class="contents__item"><a href='179883.htm'>Using the sample HTTP client</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='179884.htm'>Syntax and options for the HTTP client</a></li><li class="contents__item"><a href='182976.htm'>Scanning files over TCP socket in scanfile mode</a></li><li class="contents__item"><a href='179885.htm'>Syntax examples</a></li><li class="contents__item"><a href='179886.htm'>Scan results for the HTTP client</a></li><li class="contents__item"><a href='179887.htm'>HTTP client connection error messages</a></li></ul></li><li class="contents__item"><a href='179881.htm'>Using a proxy server</a></li><li class="contents__item"><a href='179882.htm'>Updating the anti-virus database in HTTP mode</a></li><li class="contents__item"><a href='186768.htm'>Logging in HTTP mode</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='179879.htm'>Configuring logging in HTTP mode</a></li><li class="contents__item"><a href='186767.htm'>Format of CEF logs in HTTP mode</a></li><li class="contents__item"><a href='186769.htm'>Format of RAW logs in HTTP mode</a></li></ul></li><li class="contents__item"><a href='179888.htm'>Building executable files for the HTTP service and the HTTP client</a></li></ul></li><li class="contents__item"><a href='184798.htm'>Using Kaspersky Scan Engine in ICAP mode</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='192987.htm'>Kaspersky Scan Engine and ICAP mode</a></li><li class="contents__item"><a href='206407.htm'>Recommendations on secure integration</a></li><li class="contents__item"><a href='225528.htm'>Recommended settings for ICAP mode</a></li><li class="contents__item"><a href='192988.htm'>Configuring Kaspersky Scan Engine in ICAP mode</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='192989.htm'>ICAP mode configuration file</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='201103.htm'>SDKSettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='200690.htm'>ScannersCount</a></li><li class="contents__item"><a href='200691.htm'>ThreadsCount</a></li><li class="contents__item"><a href='200692.htm'>QueueLen</a></li><li class="contents__item"><a href='200693.htm'>ScanTimeout</a></li><li class="contents__item"><a href='201118.htm'>LicensePath</a></li><li class="contents__item"><a href='201120.htm'>BasesPath</a></li><li class="contents__item"><a href='200697.htm'>TempPath</a></li><li class="contents__item"><a href='201123.htm'>ScanningMode</a></li><li class="contents__item"><a href='201124.htm'>LicensingMode</a></li><li class="contents__item"><a href='207146.htm'>MaxArchivesScanningDepth</a></li></ul></li><li class="contents__item"><a href='200603.htm'>KSNSettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='200698.htm'>UseKSN</a></li><li class="contents__item"><a href='200702.htm'>ObjectCheckOnDemandTimeoutMs</a></li><li class="contents__item"><a href='200703.htm'>CacheSizeKb</a></li></ul></li><li class="contents__item"><a href='200604.htm'>ProxySettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='200704.htm'>UseProxy</a></li><li class="contents__item"><a href='200705.htm'>Host</a></li><li class="contents__item"><a href='200706.htm'>Port</a></li><li class="contents__item"><a href='200707.htm'>User</a></li><li class="contents__item"><a href='200708.htm'>Pass</a></li></ul></li><li class="contents__item"><a href='200605.htm'>UpdateSettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='200709.htm'>DisableBackup</a></li><li class="contents__item"><a href='200710.htm'>UpdatePeriodMinutes</a></li><li class="contents__item"><a href='200711.htm'>UseOnlyCustomSources</a></li><li class="contents__item"><a href='200712.htm'>UpdateSources</a></li><li class="contents__item"><a href='200713.htm'>UpdatesCertFile</a></li><li class="contents__item"><a href='200714.htm'>CertificateConfirmationAction</a></li><li class="contents__item"><a href='200715.htm'>UseReducedBases</a></li></ul></li><li class="contents__item"><a href='201129.htm'>ICAPSettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='200716.htm'>Port</a></li><li class="contents__item"><a href='207194.htm'>ReqModeAddress</a></li><li class="contents__item"><a href='207240.htm'>RespModeAddress</a></li><li class="contents__item"><a href='200717.htm'>MaxIcapSessionsCount</a></li><li class="contents__item"><a href='201149.htm'>RAMUsageLimit</a></li><li class="contents__item"><a href='200719.htm'>ScanMaxFileSize</a></li><li class="contents__item"><a href='200720.htm'>Allow204</a></li><li class="contents__item"><a href='207291.htm'>KeepAliveSettings</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='207292.htm'>Enabled</a></li><li class="contents__item"><a href='207298.htm'>TimeoutMs</a></li><li class="contents__item"><a href='207303.htm'>MaxRequests</a></li><li class="contents__item"><a href='221376.htm'>UseAlways</a></li></ul></li><li class="contents__item"><a href='225221.htm'>RequestingICAPHeaders</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='225222.htm'>ICAPHeader</a></li></ul></li><li class="contents__item"><a href='200726.htm'>HTTPClientIpICAPHeader</a></li><li class="contents__item"><a href='200727.htm'>HTTPUserNameICAPHeader</a></li><li class="contents__item"><a href='201214.htm'>VirusNameICAPHeader</a></li><li class="contents__item"><a href='225156.htm'>DatabaseVersionICAPHeader</a></li><li class="contents__item"><a href='221147.htm'>SendInfectionFoundICAPHeader</a></li><li class="contents__item"><a href='221160.htm'>SendResponseDescICAPHeader</a></li><li class="contents__item"><a href='221161.htm'>SendResponseInfoICAPHeader</a></li><li class="contents__item"><a href='221162.htm'>SendViolationsFoundICAPHeader</a></li><li class="contents__item"><a href='200721.htm'>ScanInReqMode</a></li><li class="contents__item"><a href='200722.htm'>ScanInRespMode</a></li><li class="contents__item"><a href='201153.htm'>RulesFilePath</a></li><li class="contents__item"><a href='201154.htm'>CmdPath</a></li><li class="contents__item"><a href='201155.htm'>ResponsesPath</a></li><li class="contents__item"><a href='201208.htm'>TransferBeforeScanEnding</a></li><li class="contents__item"><a href='200729.htm'>Exclusions</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='200813.htm'>ContentSize</a></li><li class="contents__item"><a href='200814.htm'>ContentType</a></li><li class="contents__item"><a href='200815.htm'>RequestURL</a></li></ul></li><li class="contents__item"><a href='201163.htm'>USR1SignalAction</a></li><li class="contents__item"><a href='201164.htm'>USR2SignalAction</a></li><li class="contents__item"><a href='200730.htm'>LoggingConfigFilePath</a></li></ul></li><li class="contents__item"><a href='206616.htm'>FormatRecognizerSettings</a></li></ul></li><li class="contents__item"><a href='206590.htm'>Configuring Format Recognizer for use in ICAP mode</a></li><li class="contents__item"><a href='179893.htm'>Configuring service rules</a></li><li class="contents__item"><a href='192475.htm'>Changing variables in the ICAP mode unit file</a></li><li class="contents__item"><a href='179895.htm'>Working with response templates and scripts</a></li><li class="contents__item"><a href='179897.htm'>Specifying paths to plug-ins and libraries</a></li></ul></li><li class="contents__item"><a href='192990.htm'>Running Kaspersky Scan Engine in ICAP mode</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='192397.htm'>Running Kaspersky Scan Engine in ICAP mode with the systemd unit file</a></li><li class="contents__item"><a href='179900.htm'>Running Kaspersky Scan Engine in ICAP mode manually</a></li><li class="contents__item"><a href='179901.htm'>Running Kaspersky Scan Engine in ICAP mode with kavicapd shell script</a></li></ul></li><li class="contents__item"><a href='221159.htm'>Response headers</a></li><li class="contents__item"><a href='179902.htm'>Updating the anti-virus database in ICAP mode</a></li><li class="contents__item"><a href='182615.htm'>Getting accumulated statistics in ICAP mode</a></li><li class="contents__item"><a href='186630.htm'>Logging in ICAP mode</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='179896.htm'>Configuring logging in ICAP mode</a></li><li class="contents__item"><a href='186631.htm'>Format of CEF logs in ICAP mode</a></li><li class="contents__item"><a href='186652.htm'>Format of RAW logs in ICAP mode</a></li></ul></li><li class="contents__item"><a href='219958.htm'>Integrating Kaspersky Scan Engine with other solutions</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='179904.htm'>Using Kaspersky Scan Engine in ICAP mode with Squid</a></li><li class="contents__item"><a href='212974.htm'>Using Kaspersky Scan Engine in ICAP mode with Oracle Solaris Vscan</a></li><li class="contents__item"><a href='219959.htm'>Using Kaspersky Scan Engine in ICAP mode with Dell EMC Isilon</a></li><li class="contents__item"><a href='221109.htm'>Using Kaspersky Scan Engine with F5 BIG-IP Application Security Manager</a></li><li class="contents__item"><a href='221715.htm'>Using Kaspersky Scan Engine in ICAP mode with GoAnywhere MFT</a></li></ul></li><li class="contents__item"><a href='179905.htm'>Building executable files for Kaspersky Scan Engine used in ICAP mode</a></li></ul></li><li class="contents__item"><a href='179683.htm'>Using Kaspersky Scan Engine GUI</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='219850.htm'>User roles</a></li><li class="contents__item"><a href='179694.htm'>Signing in to Kaspersky Scan Engine</a></li><li class="contents__item"><a href='179706.htm'>Using the footer bar</a></li><li class="contents__item"><a href='179695.htm'>Kaspersky Scan Engine dashboard</a></li><li class="contents__item"><a href='179696.htm'>Kaspersky Scan Engine scan results page</a></li><li class="contents__item"><a href='201264.htm'>Managing Kaspersky Scan Engine cluster instances</a></li><li class="contents__item"><a href='179697.htm'>Kaspersky Scan Engine settings pages</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='179698.htm'>Service settings</a></li><li class="contents__item"><a href='179699.htm'>Scanning settings</a></li><li class="contents__item"><a href='224195.htm'>Authorization settings</a></li><li class="contents__item"><a href='180283.htm'>ICAP rules</a></li><li class="contents__item"><a href='179701.htm'>Update settings</a></li><li class="contents__item"><a href='179702.htm'>License settings</a></li><li class="contents__item"><a href='179703.htm'>Logging settings</a></li><li class="contents__item"><a href='179704.htm'>Proxy settings</a></li><li class="contents__item"><a href='219610.htm'>Users settings</a></li><li class="contents__item"><a href='221467.htm'>Exporting the settings</a></li></ul></li><li class="contents__item"><a href='179705.htm'>Changing password</a></li><li class="contents__item"><a href='185278.htm'>Working with the klScanEngineUI binary file</a></li><li class="contents__item"><a href='192471.htm'>Running the klScanEngineUI service with systemd unit file (Linux)</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='192481.htm'>Changing variables in the klScanEngineUI unit file (Linux)</a></li></ul></li></ul></li><li class="contents__item"><a href='206592.htm'>Kaspersky Scan Engine configuration</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='179825.htm'>Manually editing Kaspersky Scan Engine configuration file</a></li><li class="contents__item"><a href='180222.htm'>Recognizable file formats</a></li></ul></li><li class="contents__item"><a href='179826.htm'>Verifying virus detection capabilities</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='180178.htm'>About EICAR Standard Anti-Virus Test File</a></li><li class="contents__item"><a href='180193.htm'>Verifying detection capabilities in HTTP mode</a></li><li class="contents__item"><a href='179903.htm'>Verifying detection capabilities in ICAP mode</a></li></ul></li><li class="contents__item"><a href='221141.htm'>System audit</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='221146.htm'>Identification of the event initiator</a></li><li class="contents__item"><a href='221150.htm'>Getting detailed information about events on the dashboard</a></li><li class="contents__item"><a href='221189.htm'>Getting detailed information about events from the syslog</a></li></ul></li><li class="contents__item"><a href='179684.htm'>Logging</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='179928.htm'>Manually enabling logging</a></li><li class="contents__item"><a href='179926.htm'>Logging configuration file</a></li><li class="contents__item"><a href='179925.htm'>Logged user data</a></li></ul></li><li class="contents__item"><a href='220775.htm'>Integration with SIEM solutions</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='220777.htm'>Integration with Splunk</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='220780.htm'>Configuring Splunk</a></li><li class="contents__item"><a href='220782.htm'>Searching for Kaspersky Scan Engine events in Splunk</a></li></ul></li><li class="contents__item"><a href='220779.htm'>Integration with ArcSight ESM</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='220896.htm'>Configuring ArcSight ESM</a></li><li class="contents__item"><a href='220898.htm'>Searching for Kaspersky Scan Engine events in ArcSight ESM</a></li></ul></li><li class="contents__item"><a href='220778.htm'>Integration with KUMA</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='220785.htm'>Configuring KUMA</a></li><li class="contents__item"><a href='220787.htm'>Searching for Kaspersky Scan Engine events in KUMA</a></li></ul></li><li class="contents__item"><a href='220786.htm'>Configuring Kaspersky Scan Engine to interact with a SIEM</a></li></ul></li><li class="contents__item"><a href='235568.htm'>Integration with Docker and Kubernetes</a></li><li class="contents__item"><a href='179827.htm'>Boosting performance of Kaspersky Scan Engine</a></li><li class="contents__item"><a href='192993.htm'>Uninstalling Kaspersky Scan Engine</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='192994.htm'>Uninstallation using the uninstaller (Linux and Windows)</a></li><li class="contents__item"><a href='199825.htm'>Uninstalling Kaspersky Scan Engine on Linux</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='180699.htm'>Manual uninstallation (Linux)</a></li></ul></li><li class="contents__item"><a href='199826.htm'>Uninstalling Kaspersky Scan Engine on Windows</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='184741.htm'>Manual uninstallation (Windows)</a></li></ul></li></ul></li><li class="contents__item"><a href='179831.htm'>Using the password utility</a></li><li class="contents__item"><a href='181814.htm'>Using the encrypting utility</a></li><li class="contents__item"><a href='209025.htm'>Using the integrity check tool</a></li><li class="contents__item"><a href='179686.htm'>Licensing</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='179852.htm'>Activating Kaspersky Scan Engine in offline licensing mode</a></li><li class="contents__item"><a href='179855.htm'>Activating Kaspersky Scan Engine in online licensing mode</a></li><li class="contents__item"><a href='179860.htm'>Licensing limitations</a></li></ul></li><li class="contents__item"><a href='182982.htm'>Kaspersky Scan Engine GUI and SSL certificates</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='182983.htm'>Generating SSL certificates for Kaspersky Scan Engine GUI</a></li><li class="contents__item"><a href='182984.htm'>Adding the self-signed certificate as trusted to a browser (Linux)</a></li><li class="contents__item"><a href='186925.htm'>Adding the self-signed certificate as trusted to a browser (Windows)</a></li></ul></li><li class="contents__item"><a href='182962.htm'>Troubleshooting</a></li><li class="contents__item"><a href='192996.htm'>Data transferred to Kaspersky</a><ul class='contents contents_all-in-one'><li class="contents__item"><a href='180001.htm'>Data transferred to Kaspersky during an update</a></li><li class="contents__item"><a href='180002.htm'>Data transferred to Kaspersky in online licensing mode</a></li><li class="contents__item"><a href='192997.htm'>Data transferred to Kaspersky during File and URL Reputation Checking</a></li><li class="contents__item"><a href='180772.htm'>Statistics submitted to KSN</a></li><li class="contents__item"><a href='185034.htm'>About data provisioning</a></li></ul></li><li class="contents__item"><a href='234774.htm'>Contacting Technical Support</a></li><li class="contents__item"><a href='192998.htm'>Information about third-party code</a></li><li class="contents__item"><a href='192999.htm'>Trademark notices</a></li><li class="contents__item"><a href='55937.htm'>Copyright</a></li></ul></div><div class="cont" id="226466"><p><a name=226466 style="display: none;">[Topic 226466]</a></p>
	<h1 id="t234418" class="heading1">Kaspersky Scan Engine  Help</h1>
<h5 class="heading5"><img id="f226817" src="kse_logo.png" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0"> About Kaspersky Scan Engine</h5>
<ul class="listbullet1"><li class="listbullet1"><a id="h222091" class="englishcrossreferencetemplate" href="#209374" target="_self">What's new</a></li><li class="listbullet1"><a id="h193110" class="englishcrossreferencetemplate" href="#184797" target="_self">Key functions</a></li><li class="listbullet1"><a id="h181527" class="englishcrossreferencetemplate" href="#192970" target="_self">Detection technologies</a></li><li class="listbullet1"><a id="h226821" class="englishcrossreferencetemplate" href="#184796" target="_self">Architecture</a></li><li class="listbullet1"><a id="h226822" class="englishcrossreferencetemplate" href="#179824" target="_self">Usage scenarios</a></li><li class="listbullet1"><a id="h193112" class="englishcrossreferencetemplate" href="#184795" target="_self">Hardware and software requirements</a></li></ul><h5 class="heading5"><img id="f226818" src="pc_06.svg" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0"> HTTP mode</h5>
<p class="bodytextindent"><a id="h193051" class="englishcrossreferencetemplate" href="#193002" target="_self">Example of an HTTP request to scan a local file</a></p>
<h5 class="heading5"><img id="f226819" src="cosole_07.svg" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0"> ICAP mode</h5>
<p class="bodytextindent"><a id="h193044" class="englishcrossreferencetemplate" href="#192990" target="_self">Running Kaspersky Scan Engine in ICAP mode</a></p>
<h5 class="heading5"><img id="f226820" src="browser_03.svg" class="linkedpngfiletemplateforlandingpage" alt="" vspace="0" hspace="0" align="bottom" border="0"> Web interface</h5>
<p class="bodytextindent"><a id="h180139" class="englishcrossreferencetemplate" href="#179683" target="_self">Using the Kaspersky Scan Engine GUI</a></p>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192968"><p><a name=192968 style="display: none;">[Topic 192968]</a></p>
	<h1 id="t234268" class="heading1">About Kaspersky Scan Engine</h1>
<p class="bodytext">Kaspersky Scan Engine is a server-side security solution that provides anti-virus protection, HTTP traffic scanning, and file and URL reputation checking for third party client-side solutions.</p>
<p class="bodytext">Kaspersky Scan Engine delivers comprehensive protection for a wide range of devices from malware, trojans, worms, rootkits, spyware, and adware. It can be used with various products and services including desktop applications, server solutions, proxy servers, and mail gateways.</p>
<p class="bodytext">Based on Kaspersky Anti-Virus Software Development Kit 8 Level 3 (KAV SDK) and the award-winning Kaspersky Anti-Virus Engine, Kaspersky Scan Engine employs the newest methods of detection and removing various types of malware.</p>
<p class="attentionbody">You can request the KAV SDK documentation or purchase KAV SDK together with the documentation from your Technical Account Manager (TAM).</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#209374" target="_self">What's new</a></p><p class="relateditem"><a href="#184797" target="_self">Key functions of Kaspersky Scan Engine</a></p><p class="relateditem"><a href="#192970" target="_self">Kaspersky Scan Engine detection technologies</a></p><p class="relateditem"><a href="#184796" target="_self">Kaspersky Scan Engine architecture</a></p><p class="relateditem"><a href="#179824" target="_self">Kaspersky Scan Engine usage scenarios</a></p><p class="relateditem"><a href="#184795" target="_self">Hardware and software requirements</a></p><p class="relateditem"><a href="#184793" target="_self">Distribution kit contents (Linux)</a></p><p class="relateditem"><a href="#192973" target="_self">Distribution kit contents (Windows)</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="209374"><p><a name=209374 style="display: none;">[Topic 209374]</a></p>
	<h2 id="t234595" class="heading2">What's new</h2>
<p class="bodytext">This section describes new features and enhancements in the latest version of Kaspersky Scan Engine.</p>
<p class="introheading">What's new in version 2.1</p>
<ul class="listbullet1"><li class="listbullet1">Multi-user mode for Kaspersky Scan Engine GUI is supported; <em class="emphasischaracter">Administrator</em> and <em class="emphasischaracter">Operator</em> <a id="h219851" class="englishcrossreferencetemplate" href="#219850" target="_self">user roles</a> are available for Kaspersky Scan Engine GUI users.</li><li class="listbullet1"><a id="h221151" class="englishcrossreferencetemplate" href="#221141" target="_self">System audit functionality</a>. With the system audit, it is much easier to monitor how Kaspersky Scan Engine functions and to analyze security incidents when they happen.</li><li class="listbullet1"><a id="h221943" class="englishcrossreferencetemplate" href="#221941" target="_self">Automatic upgrade</a> to a newer version of Kaspersky Scan Engine by using the <code class="programcharacter">install</code> utility.</li><li class="listbullet1">Different modes for Kaspersky Scan Engine instances in a <a id="h212028" class="englishcrossreferencetemplate" href="#211897" target="_self">cluster</a>. Kaspersky Scan Engine instances now can work in different modes at the same time: when some instances work in ICAP mode, others work in HTTP mode.</li><li class="listbullet1"><a id="h201478" class="englishcrossreferencetemplate" href="#201264" target="_self">Automatic removal of inactive cluster instances</a>. If this function is enabled, Kaspersky Scan Engine automatically removes from the cluster those instances that are inactive for a specified period of time.</li><li class="listbullet1"><a id="h224351" class="englishcrossreferencetemplate" href="#184921" target="_self">API token authentication</a>. If this function is enabled, Kaspersky Scan Engine provides access to its functions only to those HTTP clients that have successfully authenticated by using the API token.</li><li class="listbullet1">Separate KAV SDK objects. Starting from Kaspersky Scan Engine version 2.1, KAV SDK objects are delivered as a separate package.</li><li class="listbullet1"><code class="programcharacter">X-</code> response <a id="h221163" class="englishcrossreferencetemplate" href="#221159" target="_self">header fields</a>:<ul class="listbullet2"><li class="listbullet2">X-Infection-Found</li><li class="listbullet2">X-Response-Desc</li><li class="listbullet2">X-Response-Info</li><li class="listbullet2">X-Violations-Found</li><li class="listbullet2">X-Include</li></ul></li><li class="listbullet1">Custom response header field that contains information about the anti-virus database version used by Kaspersky Scan Engine to scan objects. The name of the field is specified in <a id="h225157" class="englishcrossreferencetemplate" href="#225156" target="_self">DatabaseVersionICAPHeader</a>.</li><li class="listbullet1">Value limits have changed for the following parameters:<ul class="listbullet2"><li class="listbullet2"><a id="h207354" class="englishcrossreferencetemplate" href="#207350" target="_self">KeepAliveSettings &gt; TimeoutMs (HTTP mode)</a></li><li class="listbullet2"><a id="h207355" class="englishcrossreferencetemplate" href="#207352" target="_self">KeepAliveSettings &gt; MaxRequests (HTTP mode)</a></li><li class="listbullet2"><a id="h207304" class="englishcrossreferencetemplate" href="#207298" target="_self">KeepAliveSettings &gt; TimeoutMs (ICAP mode)</a></li><li class="listbullet2"><a id="h207305" class="englishcrossreferencetemplate" href="#207303" target="_self">KeepAliveSettings &gt; MaxRequests (ICAP mode)</a></li></ul></li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="184797"><p><a name=184797 style="display: none;">[Topic 184797]</a></p>
	<h2 id="t234417" class="heading2">Key functions of Kaspersky Scan Engine</h2>
<p class="bodytext">Kaspersky Scan Engine can work in one of two modes:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h193041" class="englishcrossreferencetemplate" href="#192979" target="_self">HTTP mode</a><p class="listcontinue1">In this mode, Kaspersky Scan Engine works as a REST-like service that receives HTTP requests from client applications, scans the objects passed in these requests, and sends back HTTP responses with the scan results.</p>
</li><li class="listbullet1"><a id="h180141" class="englishcrossreferencetemplate" href="#184798" target="_self">ICAP mode</a><p class="attentioncontinue1">This mode is available only for Linux operating systems.</p>
<p class="listcontinue1">In this mode, Kaspersky Scan Engine works as an ICAP server that scans the HTTP traffic that passes through a proxy server and the URLs that are requested by users, and filters out web pages that contain malicious content.</p>
</li></ul><p class="bodytext">Kaspersky Scan Engine also includes a graphical user interface that allows you to easily configure the behavior of Kaspersky Scan Engine, review its service events, and scan results.</p>
<p class="introheading">Usage scenarios:</p>
<p class="introheading"><a id="h180134" class="englishcrossreferencetemplate" href="#180130" target="_self">Threat Protection</a></p>
<p class="bodytext">Kaspersky Scan Engine can scan files and blocks of random access memory (RAM) by using the Kaspersky anti-virus database and the advanced heuristics module. Scanning of compressed executables, archives, Microsoft Office macros, email messages, and email databases is supported.</p>
<p class="introheading"><a id="h180135" class="englishcrossreferencetemplate" href="#180131" target="_self">Web Filtering</a></p>
<p class="bodytext">Kaspersky Scan Engine can scan specific URLs (in HTTP mode) or URLs that users request from a proxy server (in ICAP mode). In ICAP mode, Kaspersky Scan Engine can return a user-specified HTML page instead of malicious web pages.</p>
<p class="introheading"><a id="h180137" class="englishcrossreferencetemplate" href="#180133" target="_self">File and URL Reputation Checking</a></p>
<p class="bodytext">Kaspersky Scan Engine can receive information about the reputation of the scanned files and URLs from Kaspersky Security Network (KSN).</p>
<p class="introheading"><a id="h180139" class="englishcrossreferencetemplate" href="#179683" target="_self">Graphical User Interface</a></p>
<p class="bodytext">The graphical user interface (GUI) allows you to configure Kaspersky Scan Engine, check the status of a Kaspersky Scan Engine key file or activation code, review service events, and scan results. </p>
<p class="introheading">Key functionality: </p>
<ul class="listbullet1"><li class="listbullet1">Award-wining Kaspersky anti-malware technology provides the best-in-class malware detection rates and can instantaneously react to emerging threats.</li><li class="listbullet1">Kaspersky Security Network provides information about the reputation of files and Internet resources, ensures that Kaspersky applications react to threats faster without waiting for an application database update, and reduces the likelihood of false positives.</li><li class="listbullet1">Filters out malicious, phishing, and adware URLs.</li><li class="listbullet1">Detection of multi-packed objects and objects packed using &quot;grey&quot; compression utilities (frequently used for hiding malicious programs from anti-virus software).</li><li class="listbullet1">Advanced heuristics analyzer and machine learning-based detection technologies.</li><li class="listbullet1">Disinfection of infected files, archives, and encoded objects.</li><li class="listbullet1">Updatable Anti-Virus engine: detection technologies and processing logic can be upgraded or modified through regular updates of the anti-virus database.</li><li class="listbullet1">Kaspersky Scan Engine natively supports multithreading and can process several tasks simultaneously. You can adjust the number of scanning processes and threads to increase performance of Kaspersky Scan Engine.</li><li class="listbullet1">An additional filtering layer is made possible by the Format Recognizer component. You can use this component to recognize and skip certain file formats during the scanning process. Dozens of formats are supported, including executable, document files, media files, and archives.</li><li class="listbullet1">Graphical user interface (GUI) for management and monitoring:<ul class="listbullet2"><li class="listbullet2">Lets you configure application settings and manage the application.</li><li class="listbullet2">Lets you monitor the application operating status, status of the used key file or activation code, and the number of scanned and detected objects. </li><li class="listbullet2">Provides a dashboard with information about all scanned objects. Scan results can be exported in CSV format. </li></ul></li><li class="listbullet1">Ease of installation and configuration, and no development is needed with this out-of-the box installation. The solution will be running within minutes. </li><li class="listbullet1">Reporting features:<ul class="listbullet2"><li class="listbullet2">Important application events are sent to Syslog in the CEF format. </li><li class="listbullet2">All service events are visible on the GUI dashboard.</li></ul></li><li class="listbullet1">Maintenance features: <ul class="listbullet2"><li class="listbullet2">Anti-virus database updates are automatic. Kaspersky Scan Engine automatically restores corrupted databases. </li><li class="listbullet2">Easy collection of product traces by using the GUI.</li><li class="listbullet2">Option to use online activation. With online activation, licensing information for Kaspersky Scan Engine is updated automatically.</li></ul></li><li class="listbullet1">Fault-tolerant and resilient architecture.</li><li class="listbullet1">Source code for HTTP client and ICAP service are provided in the distribution kit for customization. </li><li class="listbullet1">Comprehensive documentation and cross-platform API support. Similar APIs for Linux/UNIX and Windows versions.</li><li class="listbullet1">Option to minimize external traffic by creating local mirror server for the anti-virus database (additional tool needed).</li><li class="listbullet1">Kaspersky Scan Engine supports cluster architecture. This feature allows you to do the following:<ul class="listbullet2"><li class="listbullet2">Centralized instance management: you can apply unified settings to multiple instances in a cluster</li><li class="listbullet2">View service events from each clustered instance</li><li class="listbullet2">View scan results with statistics for each clustered instance</li><li class="listbullet2">View information about the status of Kaspersky Scan Engine for each clustered instance (current status of Kaspersky Scan Engine, version, information about the anti-virus database, etc.)</li></ul></li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192970"><p><a name=192970 style="display: none;">[Topic 192970]</a></p>
	<h2 id="t234409" class="heading2">Kaspersky Scan Engine detection technologies</h2>
<p class="bodytext">This section describes detection technologies that are implemented in Kaspersky Scan Engine.</p>
<p class="introheading">Signature analysis</p>
<p class="bodytext">This detection method is based on searching for a predefined string in scanned files. Signature analysis also includes detection based on the hash of the entire malicious file. Traditional signatures allow for the detection of specific objects with high precision. Other signature-based technologies, such as structure heuristics signatures and SmartHash, can detect unknown and polymorphic malware. </p>
<p class="bodytext">Signature analysis can detect specific attacks with high precision and few false positives. However, this detection method is ineffective against polymorphic malware and different versions of the same malware. Effective signature analysis also requires frequent signature updates.</p>
<p class="bodytext">The frequently updated and comprehensive anti-virus database of Kaspersky Scan Engine ensures the highest level of protection from known malware, trojans, worms, rootkits, spyware, and adware.</p>
<p class="introheading">Advanced heuristics</p>
<p class="bodytext">When scanning a script or an executable file, Kaspersky Anti-Virus Engine emulates its execution in a secure artificial environment. If a suspicious activity is discovered during analysis of the behavior of the emulated object, it is considered malicious. This method helps detect new and unknown malware.</p>
<p class="bodytext">The emulator component of Kaspersky Scan Engine emulates a functional execution environment for the object, including functions and different subsystems of the target operation system. No real functions or subsystems are used during emulation. </p>
<p class="introheading">Machine learning technologies</p>
<p class="bodytext">SmartHash is a Kaspersky patented algorithm for building intelligent, locality-sensitive hashes. Locality-sensitive hashes are static file features that can be extracted and quantized. SmartHashes can be calculated for each file and different files can have the same SmartHash when they are functionally similar. Because of this, a single SmartHash allows for the identification of clusters of similar files and the effective detection of unknown malware from known malware families.The SmartHash technology utilizes several precision levels, a feature that allows for the detection of even highly polymorphic malware. Simultaneously, with a very high level of confidence, it minimizes the risk of false positive detection.</p>
<p class="bodytext">SmartHash benefits:</p>
<ul class="listbullet1"><li class="listbullet1">Strength against new, evasive, and polymorphic malware.</li><li class="listbullet1">Detection within minutes. </li><li class="listbullet1">Works offline and online.</li><li class="listbullet1">Flexible model with several similarity levels that allows for detection of uninfected and malicious files.</li><li class="listbullet1">Resilient technology: mathematical model is updated by machine learning techniques and is constantly revised by experts. Using SmartHash results in minimal false positives and yields a high detection rate.</li></ul><p class="bodytext">SmartHash online also helps to minimize false positive detections. SmartHash calculated on the client side can be compared against billions of known good files in the Kaspersky database through global Kaspersky Security Network.</p>
<p class="bodytext">Kaspersky uses machine learning to boost the detection rate of existing scanning technologies. It deploys machine learning for automated analysis of internal sandbox execution logs. Both known malicious files and unknown files are executed in internal behavioral sandbox systems. Some of these sandboxes mimic user systemsrunning standard products. The most powerful sandboxes make use of granular logging capabilities, allowing for extremely fine-tuned detection. </p>
<p class="bodytext">Robots process the sandbox logs line by line. The execution logs of new malicious samples are studied by using Machine Learning, to find new detection indicators. These new indicators enrich mathematical models of non-signature-based detection methods as well as heuristic behavioral records created by Kaspersky experts.</p>
<p class="introheading">Processing of Compressed Executables And Archives</p>
<p class="bodytext">Kaspersky Scan Engine includes technology that allows for detection of viruses and other objects inside compressed executables and archives. With this technology, infected archives and compressed executables can be safely disinfected or deleted. </p>
<p class="bodytext">Kaspersky Scan Engine supports approximately 4000 different formats of compressed executables and archives.</p>
<p class="introheading">Disinfection of Archives</p>
<p class="bodytext">This technology is designed to disinfect archived files. With this technology, infected objects inside archives are successfully disinfected or deleted, depending on user-defined settings. You do not have to use any other archiving utilities.</p>
<p class="bodytext">Kaspersky Anti-Virus Engine is currently capable of removing viruses from ARJ, CAB, RAR, and ZIP archives.</p>
<p class="introheading">Kaspersky Security Network</p>
<p class="bodytext">Kaspersky Security Network (KSN) is an infrastructure of cloud services that provides access to the online Knowledge Base of Kaspersky which contains information about the reputation of files, web resources, and software. The use of data from Kaspersky Security Network ensures faster responses to threats, improves the performance of some protection components, and reduces the likelihood of false positives.</p>
<p class="bodytext">Kaspersky hosts KSN servers in data centers all around the world providing minimal latency for cloud checks. KSN database contains terabytes of information that is constantly updated by security analysts and automatic methods.</p>
<p class="bodytext">When using KSN, you provide Kaspersky with information about the installed copy of Kaspersky Scan Engine and detected objects. This information does not contain any personal or confidential information of the user. The information obtained is protected by Kaspersky in accordance with statutory requirements. See also the full list of data that is <a id="h193034" class="englishcrossreferencetemplate" href="#192997" target="_self">transferred to Kaspersky during file and URL reputation checking</a>.</p>
<p class="bodytext">Kaspersky Scan Engine is compliant with the General Data Protection Regulation (GDPR).</p>
<p class="introheading">Malicious and phishing URL detection</p>
<p class="bodytext">Kaspersky Scan Engine includes an offline database of malicious and phishing URLs. In addition, you can check the reputation of the scanned URLs in Kaspersky Security Network.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="184796"><p><a name=184796 style="display: none;">[Topic 184796]</a></p>
	<h2 id="t234406" class="heading2">Kaspersky Scan Engine architecture</h2>
<p class="bodytext">Kaspersky Scan Engine is an implementation of Kaspersky HTTP Daemon and Kaspersky ICAP Plug-in, which are parts of Kaspersky Anti-Virus SDK. </p>
<p class="bodytext">When Kaspersky Scan Engine is running as Kaspersky HTTP Daemon, it is working in <em class="emphasischaracter">HTTP mode</em>. When Kaspersky Scan Engine is running as Kaspersky ICAP Plug-in, it is working in <em class="emphasischaracter">ICAP mode.</em></p>
<p class="listheading">Following are descriptions of the modes:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h193041" class="englishcrossreferencetemplate" href="#192979" target="_self">HTTP mode</a><p class="listcontinue1">In this mode, Kaspersky Scan Engine works as a REST-like service that receives HTTP requests from client applications, scans files and URLs passed in these requests, and sends back HTTP responses with scan results.</p>
</li><li class="listbullet1"><a id="h212033" class="englishcrossreferencetemplate" href="#192972" target="_self">ICAP mode</a><p class="attentioncontinue1">This mode is available only for Linux operating systems.</p>
<p class="listcontinue1">In this mode, Kaspersky Scan Engine works as an ICAP server that scans HTTP traffic that passes through a proxy server, scans URLs that are requested by users, and filters out web pages that contain malicious content.</p>
</li></ul><p class="listheading">Kaspersky Scan Engine consists of the following components:</p>
<ul class="listbullet1"><li class="listbullet1">The service that processes client requests. The services are different in HTTP and ICAP modes. </li><li class="listbullet1">Kaspersky Scan Engine GUI<p class="listcontinue1">The user interface that the user can access over a browser. Its functionality is implemented in the klScanEngineUI executable file.</p>
</li><li class="listbullet1">Kaspersky Anti-Virus Engine<p class="listcontinue1">The executable file that scans objects passed to it.</p>
</li></ul><p class="bodytext">Several instances of Kaspersky Scan Engine can be added into <a id="h212028" class="englishcrossreferencetemplate" href="#211897" target="_self">clusters</a><em class="emphasischaracter">.</em> This simplifies configuration and further management of the instances.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#192971" target="_self">HTTP mode</a></p><p class="relateditem"><a href="#192972" target="_self">ICAP mode</a></p><p class="relateditem"><a href="#211897" target="_self">Instances and clusters</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192971"><p><a name=192971 style="display: none;">[Topic 192971]</a></p>
	<h3 id="t234378" class="heading3">HTTP mode</h3>
<p class="bodytext">In HTTP mode, Kaspersky Scan Engine consists of an HTTP service called kavhttpd, Kaspersky Anti-Virus Engine, and Kaspersky Scan Engine GUI.</p>
<p class="listheading">When you use Kaspersky Scan Engine in HTTP mode, the interaction between the components occurs in the following order:</p>
<ol class="listnumber1"><li class="listnumber1">Files and URLs for scanning are sent to kavhttpd in HTTP requests.<p class="listcontinue1">You can send objects to kavhttpd in two ways:</p>
<ul class="listbullet2"><li class="listbullet2">By using an HTTP client, such as the <a id="h179932" class="englishcrossreferencetemplate" href="#179883" target="_self">sample HTTP client</a> from the distribution kit</li><li class="listbullet2">By <a id="h193035" class="englishcrossreferencetemplate" href="#192985" target="_self">making HTTP requests manually</a></li></ul></li><li class="listnumber1">The kavhttpd service sends objects to Kaspersky Anti-Virus Engine.</li><li class="listnumber1">Kaspersky Anti-Virus Engine scans the objects. <p class="listcontinue1">If you are using File and URL Reputation Checking, the objects are also sent to KSN for reputation checking. </p>
</li><li class="listnumber1">After scanning, Kaspersky Anti-Virus Engine returns the results to the kavhttpd service.</li><li class="listnumber1">The kavhttpd service sends scan results to the HTTP client or another application that sent objects for scanning.<p class="listcontinue1">If you are using Kaspersky Scan Engine GUI, the scan results are displayed on the <span class="guicharacter"><a id="h180597" class="englishcrossreferencetemplate" href="#179696" target="_self">Scan results</a></span> page.</p>
</li></ol><p class="bodytext">The diagram below shows the interaction between the components of Kaspersky Scan Engine. </p>
<p class="bodytext"></p>
<p class="picture"><img id="f180591" src="http.png" class="linkedpngfiletemplate" alt="Diagram that shows how an HTTP client or Custom application interacts with Kaspersky Scan Engine via a REST-like interface." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Kaspersky Scan Engine in HTTP mode</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192972"><p><a name=192972 style="display: none;">[Topic 192972]</a></p>
	<h3 id="t234384" class="heading3">ICAP mode</h3>
<p class="bodytext">In ICAP mode, Kaspersky Scan Engine consists of an ICAP service called kavicapd, Kaspersky Anti-Virus Engine, and Kaspersky Scan Engine GUI.</p>
<p class="bodytext">When you use Kaspersky Scan Engine in ICAP mode, the interaction between the components occurs in the following order:</p>
<ol class="listnumber1"><li class="listnumber1">An ICAP client (for example, a proxy server) sends ICAP requests to kavicapd. </li><li class="listnumber1">The kavicapd service sends files to Kaspersky Anti-Virus Engine for scanning.</li><li class="listnumber1">Kaspersky Anti-Virus Engine scans the contents of HTTP messages and URLs that are encapsulated in these ICAP requests. <p class="listcontinue1">If you are using File and URL Reputation Checking, the contents of HTTP messages and URLs are also sent to KSN for reputation checking.</p>
</li><li class="listnumber1">After scanning, Kaspersky Anti-Virus Engine returns the results to the kavicapd service.</li><li class="listnumber1">The kavicapd service sends ICAP responses with scan results to the ICAP client. <p class="listcontinue1">If you are using Kaspersky Scan Engine GUI, the scanning results are displayed on the <span class="guicharacter"><a id="h180597" class="englishcrossreferencetemplate" href="#179696" target="_self">Scan results</a></span> page.</p>
</li></ol><p class="bodytext">Kaspersky Scan Engine can work with several ICAP clients at once.</p>
<p class="bodytext">The following example shows the interaction between a proxy server and Kaspersky Scan Engine working in ICAP mode.</p>
<p class="picture"><img id="f180646" src="icap.png" class="linkedpngfiletemplate" alt="Diagram that shows how a proxy server interacts with Kaspersky Scan Engine via the ICAP protocol." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Kaspersky Scan Engine in ICAP mode</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="211897"><p><a name=211897 style="display: none;">[Topic 211897]</a></p>
	<h3 id="t234398" class="heading3">Instances and clusters</h3>
<p class="bodytext">You can install more than one instance of Kaspersky Scan Engine in your infrastructure, in HTTP mode, ICAP mode, or both. If you need more than one instance, you may choose to group them into clusters. A cluster is a set of Kaspersky Scan Engine instances that use the same <code class="programcharacter">kavebase</code> database. This allows users to access Kaspersky Scan Engine GUI of any of the installed instances and do the following:</p>
<ul class="listbullet1"><li class="listbullet1">Observe service events from all installed instances of Kaspersky Scan Engine</li><li class="listbullet1">Observe scan results from all installed instances of Kaspersky Scan Engine</li><li class="listbullet1">Check the information about each installed instance of Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">Status of the instance (enabled or disabled)</li><li class="listbullet2">Anti-virus database version</li></ul></li><li class="listbullet1">Manage settings of each installed instance of Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">Enable or disable logging</li><li class="listbullet2">Update the anti-virus database</li></ul></li></ul><p class="bodytext">You can configure several instances of Kaspersky Scan Engine simultaneously by using <em class="emphasischaracter">settings profiles.</em> A settings profile is a set of Kaspersky Scan Engine settings that can be applied to one or more instances. Settings profiles are created by using <a id="h201478" class="englishcrossreferencetemplate" href="#201264" target="_self">Kaspersky Scan Engine GUI</a>.</p>
<p class="attentionbody">The current version of Kaspersky Scan Engine does not include the balancer for distributing scan requests between different instances of Kaspersky Scan Engine. If you want to distribute scan requests, you need to use a third-party balancer.</p>
<p class="picture"><img id="f212065" src="cluster_diagram.png" class="linkedpngfiletemplate" alt="Cluster diagram. Several instances of Kaspersky Scan Engine connected to the kavebase database." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Using several instances of Kaspersky Scan Engine</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">See also:</p><p class="relateditem"><a href="#201264" target="_self">Managing Kaspersky Scan Engine cluster instances</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179824"><p><a name=179824 style="display: none;">[Topic 179824]</a></p>
	<h2 id="t234413" class="heading2">Kaspersky Scan Engine usage scenarios</h2>
<p class="bodytext">This section describes common usage scenarios of Kaspersky Scan Engine.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#180130" target="_self">Threat Protection</a></p><p class="relateditem"><a href="#180131" target="_self">Web Protection from malicious and phishing websites</a></p><p class="relateditem"><a href="#180133" target="_self">File and URL reputation checking in KSN</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180130"><p><a name=180130 style="display: none;">[Topic 180130]</a></p>
	<h3 id="t234531" class="heading3">Threat Protection</h3>
<p class="bodytext">Kaspersky Scan Engine helps you protect your network and data by detecting malware and legitimate software that can be used by intruders.</p>
<p class="bodytext">Before you start using Kaspersky Scan Engine, decide on your use case, in the following order:</p>
<ol class="listnumber1"><li class="listnumber1">Decide what data you want to scan:<ul class="listbullet2"><li class="listbullet2">Data uploaded to your network by your users.</li><li class="listbullet2">Data created inside your organization, such as documents.</li><li class="listbullet2">Data uploaded from sources outside your network. This can prevent supply chain attacks.</li></ul><p class="listcontinue1">You can also use Kaspersky Scan Engine to add scanning functionality to your own applications and security services. Kaspersky Scan Engine scans objects of any format, including packed objects.</p>
</li><li class="listnumber1">Decide whether HTTP or ICAP mode is better for your environment.</li><li class="listnumber1">Decide where you want to deploy Kaspersky Scan Engine. </li><li class="listnumber1">Decide how you will gain access to scan results:<ul class="listbullet2"><li class="listbullet2">In Kaspersky Scan Engine GUI </li><li class="listbullet2">In a client application</li></ul></li><li class="listnumber1">Decide which features of Kaspersky Scan Engine you will use:<ul class="listbullet2"><li class="listbullet2">Decide whether you want to use <a id="h180137" class="englishcrossreferencetemplate" href="#180133" target="_self">Kaspersky Security Network (KSN) for checking the reputation of files and URLs</a></li><li class="listbullet2">Decide what level of heuristics you want to use</li><li class="listbullet2">Decide what actions Kaspersky Scan Engine must perform after detecting malware or legitimate software that can be used by intruders</li><li class="listbullet2">Decide whether you want to scan packed executables</li><li class="listbullet2">Decide whether you want to scan archives</li><li class="listbullet2">Decide whether you want to scan email</li><li class="listbullet2">Decide whether you want to scan email databases</li></ul></li></ol><p class="bodytext">After determining your use case for Kaspersky Scan Engine, proceed to <a id="h180690" class="englishcrossreferencetemplate" href="#180558" target="_self">getting started with Kaspersky Scan Engine</a>.</p>
<p class="bodytext">Below, you can find instructions for typical tasks that Kaspersky Scan Engine performs in HTTP mode and in ICAP mode.</p>
<p class="introheading">Scanning files with the sample HTTP client (HTTP mode)</p>
<p class="bodytext">This instruction assumes that you have already <a id="h193042" class="englishcrossreferencetemplate" href="#192974" target="_self">installed</a> and configured Kaspersky Scan Engine, by using the <a id="h193111" class="englishcrossreferencetemplate" href="#192980" target="_self">configuration file</a> or the <a id="h180271" class="englishcrossreferencetemplate" href="#179697" target="_self">GUI</a>.</p>
<p class="procedureheading">To scan files with Kaspersky Scan Engine:</p>
<ol class="listnumber1"><li class="listnumber1"><a id="h193043" class="englishcrossreferencetemplate" href="#192981" target="_self">Start the kavhttpd service</a>.</li><li class="listnumber1">Start the sample HTTP client. The client is located in the <code class="programcharacter">/bin/kavhttp_client</code> directory of the <a id="h180273" class="englishcrossreferencetemplate" href="#184793" target="_self">distribution kit</a>.</li><li class="listnumber1">Pass the files that you want to scan to the sample HTTP client:<ul class="listbullet2"><li class="listbullet2">Scan files that are larger than 4 megabytes (MB) in <a id="h180274" class="englishcrossreferencetemplate" href="#179884" target="_self">scanfile mode</a>. Use the <code class="programcharacter">-f</code> option and pass the local paths to the files to the sample HTTP client.<p class="listcontinue2">The example below shows how to scan two files in scanfile mode:</p>
</li></ul><table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">./kavhttp_client -f /usr/dir1/example1.zip /usr/dir2/example2.iso</p>
</td>
</tr>

</table>
<ul class="listbullet2"><li class="listbullet2">Scan files that are smaller than 4 MB in <a id="h180274_2" class="englishcrossreferencetemplate" href="#179884" target="_self">scanmemory mode</a>. Pass the paths (network or local) to the sample HTTP client. To do this, use the <code class="programcharacter">-s</code> option.<p class="listcontinue2">The example below shows how to scan a file in scanmemory mode:</p>
</li></ul><table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">./kavhttp_client -s 192.0.2.0:888 /usr/dir/example.txt</p>
</td>
</tr>

</table>
</li><li class="listnumber1"><a id="h180276" class="englishcrossreferencetemplate" href="#179886" target="_self">Review the scan results</a>.</li></ol><p class="introheading">Scanning traffic that passes through a proxy server (ICAP mode)</p>
<p class="bodytext">This instruction assumes that you have already <a id="h193042_2" class="englishcrossreferencetemplate" href="#192974" target="_self">installed</a> and configured Kaspersky Scan Engine, by using the <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">configuration file</a> or the <a id="h180271_2" class="englishcrossreferencetemplate" href="#179697" target="_self">Kaspersky Scan Engine GUI</a>.</p>
<p class="procedureheading">To scan traffic that passes through a proxy server:</p>
<ol class="listnumber1"><li class="listnumber1">Configure your proxy server to work with Kaspersky Scan Engine (see the example of <a id="h180279" class="englishcrossreferencetemplate" href="#179904" target="_self">using Kaspersky Scan Engine in ICAP mode with Squid</a>).</li><li class="listnumber1">Create a <a id="h180188" class="englishcrossreferencetemplate" href="#179895" target="_self">response template that you want to display or script</a> to execute when malware or legitimate software that can be used by intruders is detected.</li><li class="listnumber1">Configure ICAP service rules for a situation when Kaspersky Scan Engine detects malware or legitimate software that can be used by intruders. You can do it either <a id="h180152" class="englishcrossreferencetemplate" href="#179893" target="_self">manually</a> or by <a id="h180831" class="englishcrossreferencetemplate" href="#180283" target="_self">using the GUI</a>.</li><li class="listnumber1"><a id="h193044" class="englishcrossreferencetemplate" href="#192990" target="_self">Start the kavicapd service</a>.</li></ol><p class="bodytext">Kaspersky Scan Engine will automatically detect malware or legitimate software that can be used by intruders, and then process it according to the ICAP service rules.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180131"><p><a name=180131 style="display: none;">[Topic 180131]</a></p>
	<h3 id="t234594" class="heading3">Web Protection from malicious and phishing websites</h3>
<p class="bodytext">This section describes common scenarios where you can use Kaspersky Scan Engine to check websites.</p>
<p class="bodytext">The instructions provided in this section assume that you have already <a id="h193042" class="englishcrossreferencetemplate" href="#192974" target="_self">installed</a> Kaspersky Scan Engine.</p>
<p class="introheading">Scanning URLs (HTTP mode)</p>
<p class="procedureheading">To scan a URL with Kaspersky Scan Engine:</p>
<ol class="listnumber1"><li class="listnumber1">In the <code class="programcharacter">ServerSettings &gt; Flags</code> element of the kavhttpd.xml <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">configuration file</a>, specify the settings you want:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">KAV_SHT_ENGINE_KSN</code>&#8212;For checking the reputation of websites by KSN.</li><li class="listbullet2"><code class="programcharacter">KAV_SHT_ENGINE_WMUF</code>&#8212;For detecting malicious websites.</li><li class="listbullet2"><code class="programcharacter">KAV_SHT_ENGINE_APUF</code>&#8212;For detecting phishing websites.</li></ul><p class="listcontinue1">You can also specify settings by means of the <a id="h180271" class="englishcrossreferencetemplate" href="#179697" target="_self">Kaspersky Scan Engine GUI</a>.</p>
</li><li class="listnumber1"><a id="h193043" class="englishcrossreferencetemplate" href="#192981" target="_self">Start the kavhttpd service</a>.</li><li class="listnumber1">Send the URL that you want to check to the kavhttpd service.<p class="listcontinue1">For example, you can use the sample HTTP client <code class="programcharacter">%service_dir%/bin/kavhttp_client</code> for this purpose, as follows:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">./kavhttp_client -u http://example.com</p>
</td>
</tr>

</table>
<p class="listcontinue1">Also you can send an <a id="h179981" class="englishcrossreferencetemplate" href="#179875" target="_self">HTTP POST request</a> to the kavhttpd service.</p>
</li><li class="listnumber1"><a id="h180276" class="englishcrossreferencetemplate" href="#179886" target="_self">Review the scan results</a>.<p class="listcontinue1">You can block URLs for which the <code class="programcharacter">DETECT</code> result is returned.</p>
</li></ol><p class="introheading">Checking URLs that users request through proxy server (ICAP mode)</p>
<p class="procedureheading">To check URLs that pass through a proxy server:</p>
<ol class="listnumber1"><li class="listnumber1">In the kavicapd.xml configuration file, specify the settings you want:<ul class="listbullet2"><li class="listbullet2">In the <code class="programcharacter">SDKSettings &gt; ScanningMode</code> element, specify <code class="programcharacter">KAV_O_M_PHISHING</code> for detecting phishing websites.</li><li class="listbullet2">In the <code class="programcharacter">KSNSettings &gt; UseKSN</code> element, specify <code class="programcharacter">1</code> for checking the reputation of websites by KSN.</li></ul><p class="listcontinue1">You can also specify settings by means of the <a id="h180271_2" class="englishcrossreferencetemplate" href="#179697" target="_self">Kaspersky Scan Engine GUI</a>.</p>
</li><li class="listnumber1">Configure your proxy server to work with Kaspersky Scan Engine (see the example of <a id="h180279" class="englishcrossreferencetemplate" href="#179904" target="_self">using Kaspersky Scan Engine in ICAP mode with Squid</a>).</li><li class="listnumber1">Create a <a id="h180188" class="englishcrossreferencetemplate" href="#179895" target="_self">response template</a> if you want to display it instead of phishing web pages.</li><li class="listnumber1">Create ICAP service rules for cases when Kaspersky Scan Engine returns <code class="programcharacter">PHISHING</code> and <code class="programcharacter">DETECT</code> scan results.<p class="listcontinue1">You can do it either <a id="h180152" class="englishcrossreferencetemplate" href="#179893" target="_self">manually</a> or by <a id="h180831" class="englishcrossreferencetemplate" href="#180283" target="_self">using the Kaspersky Scan Engine GUI</a>.</p>
</li><li class="listnumber1"><a id="h193043_2" class="englishcrossreferencetemplate" href="#192981" target="_self">Start the kavicapd service</a>.</li></ol><p class="bodytext">Kaspersky Scan Engine will automatically check URLs and process them according to the ICAP service rules.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180133"><p><a name=180133 style="display: none;">[Topic 180133]</a></p>
	<h3 id="t234356" class="heading3">File and URL reputation checking in KSN</h3>
<p class="bodytext">This section describes common scenarios where you can use Kaspersky Scan Engine together with <a id="h181527" class="englishcrossreferencetemplate" href="#192970" target="_self">Kaspersky Security Network (KSN)</a> to check files and websites.</p>
<p class="bodytext">The instructions provided in this section assume that you have already <a id="h193042" class="englishcrossreferencetemplate" href="#192974" target="_self">installed</a> Kaspersky Scan Engine.</p>
<p class="introheading">Checking files and websites with reputation checking (HTTP mode)</p>
<p class="procedureheading">To check files and websites by means of reputation checking:</p>
<ol class="listnumber1"><li class="listnumber1">In the <code class="programcharacter">ServerSettings &gt; Flags</code> element of the kavhttpd.xml <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">configuration file</a>, specify the <code class="programcharacter">KAV_SHT_ENGINE_KSN</code> setting.<p class="listcontinue1">You can also use the <a id="h180271" class="englishcrossreferencetemplate" href="#179697" target="_self">Kaspersky Scan Engine GUI</a> to turn on reputation checking.</p>
</li><li class="listnumber1"><a id="h193043" class="englishcrossreferencetemplate" href="#192981" target="_self">Start the kavhttpd service</a>.</li><li class="listnumber1">Send URLs and files that you want to check to the kavhttpd service.<p class="listcontinue1">For example, you can use the <a id="h180274" class="englishcrossreferencetemplate" href="#179884" target="_self">sample HTTP client</a> <code class="programcharacter">%service_dir%/bin/kavhttp_client</code>.</p>
<p class="listcontinue1">Also, you can send <a id="h179981" class="englishcrossreferencetemplate" href="#179875" target="_self">HTTP POST requests</a> to the kavhttpd service.</p>
</li><li class="listnumber1"><a id="h180276" class="englishcrossreferencetemplate" href="#179886" target="_self">Review the scan results</a>.<p class="listcontinue1">The scan results will depend on the reputation of the URLs and files.</p>
</li></ol><p class="introheading">Checking URLs that users request through proxy server (ICAP mode)</p>
<p class="procedureheading">To check URLs that pass through a proxy server:</p>
<ol class="listnumber1"><li class="listnumber1">In the <code class="programcharacter">KSNSettings &gt; UseKSN</code> element of the kavicapd.xml <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">configuration file</a>, specify <code class="programcharacter">1</code> for checking the reputation of files and websites by KSN.<p class="listcontinue1">You can also turn on reputation checking by using the <a id="h180271_2" class="englishcrossreferencetemplate" href="#179697" target="_self">Kaspersky Scan Engine GUI</a>.</p>
</li><li class="listnumber1">Configure your proxy server to work with Kaspersky Scan Engine (see the example of <a id="h180279" class="englishcrossreferencetemplate" href="#179904" target="_self">using Kaspersky Scan Engine in ICAP mode with Squid</a>).</li><li class="listnumber1">Create ICAP service rules for scan results returned by Kaspersky Scan Engine.<p class="listcontinue1">You can create the rules either <a id="h180152" class="englishcrossreferencetemplate" href="#179893" target="_self">manually</a> or by <a id="h180831" class="englishcrossreferencetemplate" href="#180283" target="_self">using the Kaspersky Scan Engine GUI</a>.</p>
</li><li class="listnumber1"><a id="h193043_2" class="englishcrossreferencetemplate" href="#192981" target="_self">Start the kavicapd service</a>.</li></ol><p class="bodytext">Kaspersky Scan Engine will return the results of checking files and URLs on the basis of their reputation in KSN and will respond according to the ICAP service rules you have specified.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="184795"><p><a name=184795 style="display: none;">[Topic 184795]</a></p>
	<h2 id="t234375" class="heading2">Hardware and software requirements</h2>
<p class="bodytext">This section describes the Kaspersky Scan Engine system requirements.</p>
<p class="introheading">Supported operating systems</p>
<p class="bodytext">Kaspersky Scan Engine runs on 64-bit Linux&reg; and 64-bit Microsoft&reg; Windows&reg; operating systems.</p>
<p class="introheading">Software requirements</p>
<p class="bodytext">Kaspersky Scan Engine GUI can be used with the following web browsers:</p>
<ul class="listbullet1"><li class="listbullet1">Google Chrome&#8482; 60 or later</li><li class="listbullet1">Microsoft Internet Explorer 11 or later</li><li class="listbullet1">Mozilla&#8482; Firefox&#8482; 55 or later</li><li class="listbullet1">Microsoft Edge 38 or later</li></ul><p class="bodytext">Kaspersky Scan Engine GUI requires <a id="h181518" class="englishcrossreferencetemplate" href="#184775" target="_self">PostgreSQL 10.7 or later to be installed</a>.</p>
<p class="bodytext">The Kaspersky Scan Engine distribution kit does not contain the Boost and OpenSSL sources. If you want to customize the HTTP service or ICAP service by editing and recompiling their sources shipped in the Kaspersky Scan Engine distribution kit, download the Boost and OpenSSL sources from the official websites and use them in your system. If you make changes in the sources of the HTTP or ICAP service and want to use Kaspersky Scan Engine GUI, get approval for the changes from your technical account manager (TAM) so that the HTTP or ICAP service can still work with Kaspersky Scan Engine GUI.</p>
<p class="bodytext">For compiling the HTTPD and ICAP services, use the following software:</p>
<ul class="listbullet1"><li class="listbullet1">Boost 1.72.0 or later</li><li class="listbullet1">OpenSSL (latest version)</li><li class="listbullet1">GCC 7.3 or later</li><li class="listbullet1">Brotli (for ICAP only)</li><li class="listbullet1">PostgreSQL libraries from 6.4.4 to 7 (non-inclusive)<p class="listcontinue1">We recommend that you install the <code class="programcharacter">libpqxx-devel</code> package.</p>
</li></ul><p class="introheading">Hardware requirements</p>
<p class="bodytext">Kaspersky Scan Engine requires 1 gigabyte (GB) of available hard disk space. If you use Kaspersky Scan Engine GUI, you also must allocate space for the PostgreSQL database that stores service events. You can keep the PostgreSQL database on the same computer as Kaspersky Scan Engine or on a different computer. The size of the database depends on the number of the events and can reach several gigabytes. The database stores events that occurred in the last six months.</p>
<p class="bodytext">The table below lists minimum processors and the RAM requirements for Kaspersky Scan Engine depending on the operating system that you use.</p>
<table class="tableintopic" width="750" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="375"><p class="tableheading">Operating System</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="375"><p class="tableheading">RAM and processor requirements</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="375"><p class="tablebodytext">64-bit Linux</p>
</td>
<td style="border:1px solid #010101;" width="375"><p class="tablebodytext">1 GB of RAM</p>
<p class="tablebodytext">1&nbsp;GHz 64-bit (x64) or faster processor</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="375"><p class="tablebodytext">64-bit Windows 7 and later</p>
<p class="tablebodytext">64-bit Windows Server 2008 R2 and later</p>
</td>
<td style="border:1px solid #010101;" width="375"><p class="tablebodytext">1 GB of RAM</p>
<p class="tablebodytext">1 GHz 64-bit (x64) or faster processor</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="184793"><p><a name=184793 style="display: none;">[Topic 184793]</a></p>
	<h2 id="t234323" class="heading2">Distribution kit contents (Linux)</h2>
<p class="tablebodytext">This section describes the contents of the Kaspersky Scan Engine distribution kit for Linux systems.</p>
<p class="introheading">Distribution kit types</p>
<p class="tablebodytext">Kaspersky Scan Engine is distributed in the following types of distribution kits:</p>
<ul class="listbullet1"><li class="listbullet1">As an RPM package and a set of additional files</li><li class="listbullet1">As a DEB package and a set of additional files</li><li class="listbullet1">As a .tar.gz archive<p class="listcontinue1">This type of distribution kit can be used instead of the RPM or DEB package.</p>
</li></ul><p class="introheading">RPM and DEB distribution kits</p>
<p class="bodytext">This type of distribution kit contains the following files and directories.</p>
<p class="tablename">Distribution kit contents (RPM and DEB package)</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="690" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<td bgcolor="#C0C0C0" style="border:1px solid #010101;" width="408"><p class="tableheading">Item</p>
</td>
<td bgcolor="#C0C0C0" style="border:1px solid #010101;" width="282"><p class="tableheading">Description</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext"><code class="programcharacter">Doc_data/*</code></p>
</td>
<td style="border:1px solid #010101;" width="282"><p class="tablebodytext">Documentation files.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext"><code class="programcharacter">Kaspersky_Scan_Engine.htm</code></p>
</td>
<td style="border:1px solid #010101;" width="282"><p class="tablebodytext">Offline version of documentation.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext"><code class="programcharacter">Kaspersky_ScanEngine-Linux-x86_64-%RELEASE_VERSION%-Release.rpm </code></p>
<p class="tablebodytext">(RPM package)</p>
<p class="tablebodytext"><code class="programcharacter">Kaspersky_ScanEngine-Linux-x86_64-%RELEASE_VERSION%-Release.deb</code></p>
<p class="tablebodytext"><code class="programcharacter">(DEB package)</code></p>
</td>
<td style="border:1px solid #010101;" width="282"><p class="tablebodytext">Installation packages.</p>
<p class="tablebodytext">For a list of files inside this package, see  subsection &quot;Files contained in the .tgz archive&quot; below.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext"><code class="programcharacter">setup.sh</code></p>
</td>
<td style="border:1px solid #010101;" width="282"><p class="tablebodytext">Installation script.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext"><code class="programcharacter">ReleaseNotes.pdf</code></p>
</td>
<td style="border:1px solid #010101;" width="282"><p class="tablebodytext">Release notes.</p>
</td>
</tr>

</table>
<p class="introheading">Files contained in the .tar.gz archive</p>
<p class="bodytext">The Kaspersky Scan Engine distribution kit for Linux contains the following files and directories.</p>
<p class="tablename">Distribution kit contents (.tar.gz archive)</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="690" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<td bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Item</p>
</td>
<td bgcolor="#C0C0C0" style="border:1px solid #010101;" width="354"><p class="tableheading">Description</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/bin/appinfo.kli</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Application information file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/bin/httpdkavlog.ini</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Configuration file that contains logging settings for the kavhttpd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/bin/icapdkavlog.conf</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Configuration file that contains logging settings for the kavicapd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/bin/kavhttpd</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Executable file of the kavhttpd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/bin/kavhttp_client</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Executable file of the client application for the kavhttpd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/bin/kavhttpd.sh</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Script for starting the kavhttpd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/bin/kavicapd</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Executable file of the kavicapd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/bin/kavicapd.sh</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Script for starting the kavicapd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/bin/klScanEngineUI</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Kaspersky Scan Engine GUI binary file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/bin/libssp.so.0</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Auxiliary library.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/doc/Doc_data/</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Directory that contains the Kaspersky Scan Engine documentation files.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/doc/Kaspersky_Scan_Engine.htm</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Main page of the Kaspersky Scan Engine documentation.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/doc/ksn_license.txt</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">End User License Agreement (EULA) for Kaspersky Security Network (KSN).</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/doc/legal_notices.txt</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Legal notices.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/doc/license.txt</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">End User License Agreement (EULA) for Kaspersky Scan Engine.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/etc/kavhttpd.service</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">The systemd unit file for the kavhttpd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/etc/kavhttpd.xml</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Sample configuration file for the kavhttpd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/etc/kavicapd.service</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">The systemd unit file for the kavicapd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/etc/kavicapd.xml</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Sample configuration file for the kavicapd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/etc/klScanEngineUI.service</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">The systemd unit file for the klScanEngineUI service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/etc/klScanEngineUI.xml</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Kaspersky Scan Engine GUI configuration file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/httpsrv/templates/</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Directory with templates for the Kaspersky Scan Engine GUI.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/icap_data/kavicapd_gui_rules.conf</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Configuration file with service rules for the kavicapd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/icap_data/templates/detect_req</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Response template used in request modification (REQMOD) mode.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/icap_data/templates/detect_resp</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Response template used in response modification (RESPMOD) mode.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/icap_data/templates/macro_req</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Response template used in request modification (REQMOD) mode to notify that a macro is detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/icap_data/templates/macro_resp</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Response template used in response modification (RESPMOD) mode to notify that a macro is detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/icap_data/scripts/send_syslog</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Sample script that displays messages with information about scanned objects and redirects them to the logger utility.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/install</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Installation script.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/integrity_check.xml</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Manifest file with a list of application files for the integrity check tool.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/integrity_checker</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Utility for checking the integrity of application components.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/gcc-version</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">A text file with the GCC version.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/platform</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">A text file with the version of the GLIBC library.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/ReleaseNotes.pdf</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Release notes.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/samples/common/</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Libraries used by the kavhttpd and kavicapd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/samples/kavhttp/</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Directory with sources of the kavhttpd service and its client application.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/samples/kavicap/</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Directory with sources of the kavicapd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/samples/migrate.sql</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">File used to upgrade the <code class="programcharacter">kavebase</code> database to a newer version.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/samples/tables.sql</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">File with SQL queries to be performed after manual installation of Kaspersky Scan Engine.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/tools/kav_encrypt</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Utility for encrypting logins and passwords for proxy servers and Kaspersky Scan Engine database.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/tools/kl_access_util</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Utility for editing user credentials.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/tools/libssp.so.0</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Auxiliary library.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/tools/openssl</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">OpenSSL utility.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/tools/openssl.cnf</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">OpenSSL configuration file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/uninstall</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Uninstallation script.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">/version</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">A text file with the product version.</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192973"><p><a name=192973 style="display: none;">[Topic 192973]</a></p>
	<h2 id="t234324" class="heading2">Distribution kit contents (Windows)</h2>
<p class="bodytext">The Kaspersky Scan Engine distribution kit for Windows contains the following files and directories.</p>
<p class="tablename">Distribution kit contents (Windows)</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="690" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<td bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Item</p>
</td>
<td bgcolor="#C0C0C0" style="border:1px solid #010101;" width="354"><p class="tableheading">Description</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\appinfo.kli</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Application information file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\kavehost.exe</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Executable file of the kavehost service (Kaspersky Anti-Virus Engine).</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\kavhttp_client.exe</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Executable file of the client application for the kavhttpd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\klScanEngineUI.exe</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Kaspersky Scan Engine GUI binary file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\klScanEngineUI.xml</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Kaspersky Scan Engine GUI configuration file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\kavhttpd.exe</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Executable file of the kavhttpd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\kavhttpd.xml</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Sample configuration file for the kavhttpd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\httpdkavlog.ini</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Configuration file that contains logging settings for the kavhttpd service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\bases\</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Folder that contains anti-virus database files.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\ossl\</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">OpenSSL library.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\x86\</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">32-bit images of libraries used by emulator component.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\*.dll</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Dynamic libraries used by Kaspersky Scan Engine.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\bin\*.ppl</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Binary modules used of by Kaspersky Scan Engine.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\doc\Doc_data\</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Folder that contains the Kaspersky Scan Engine documentation files.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\doc\About data provision.txt</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">File describing information that is provided to Kaspersky when Kaspersky Scan Engine is used with cloud services.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\doc\About data provision extended.txt</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">File describing information that is provided to Kaspersky when you enable submission of statistics to Kaspersky Security Network (KSN).</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\doc\About data provision - online activation.txt</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">File describing information that is provided to Kaspersky when Kaspersky Scan Engine is used in online licensing mode.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\doc\Kaspersky_Scan_Engine.html</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Main page of the Kaspersky Scan Engine documentation.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\doc\legal_notices.txt</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Legal notices.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\doc\license.txt</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">End User License Agreement (EULA) for Kaspersky Scan Engine.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\doc\ksn_license.txt</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">End User License Agreement (EULA) for Kaspersky Security Network (KSN).</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\httpsrv\etc\kavaccess</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">File with encrypted credentials for Kaspersky Scan Engine GUI.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\httpsrv\templates\</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Folder with templates for Kaspersky Scan Engine GUI.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\include\</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Folder with header files for developing custom applications on the basis of Kaspersky Anti-Virus SDK.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\runtime\</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Universal C Runtime (UCRT) and C++ Runtime dynamic libraries.</p>
<p class="tablebodytext">These files can be used if the target system does not have these libraries installed.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\samples\kavhttp\</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Folder with sources of the <code class="programcharacter">kavhttpd</code> service and its client application.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\samples\tables.sql</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">File with SQL queries to be performed after manual installation of Kaspersky Scan Engine.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\tools\kav_encrypt.exe</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Utility for encrypting user names and passwords for proxy servers and Kaspersky Scan Engine database.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\tools\kavsigner.exe</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Utility for signing custom applications.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\tools\kl_access_util.exe</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Utility for editing user credentials.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\tools\openssl.exe</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">OpenSSL utility.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\tools\openssl.cnf</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">OpenSSL configuration file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\tools\msvcp80.dll</code></p>
<p class="tablebodytext"><code class="programcharacter">\tools\msvcr80.dll</code></p>
<p class="tablebodytext"><code class="programcharacter">\tools\Microsoft.VC80.CRT</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Microsoft Visual C++ Redistributable components.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\install.exe</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Installer.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\kl_control.bat </code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Script for managing the kavhttpd service and the klScanEngineUI service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\uninstall.exe</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Uninstaller.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\ReleaseNotes.pdf</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">Release notes.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext"><code class="programcharacter">\version</code></p>
</td>
<td style="border:1px solid #010101;" width="354"><p class="tablebodytext">A text file with the product version.</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180558"><p><a name=180558 style="display: none;">[Topic 180558]</a></p>
	<h1 id="t234371" class="heading1">Getting started with Kaspersky Scan Engine</h1>
<p class="bodytext">This section explains how to start using Kaspersky Scan Engine quickly and easily.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#179865" target="_self">Getting started with Kaspersky Scan Engine in HTTP mode</a></p><p class="relateditem"><a href="#179890" target="_self">Getting started with Kaspersky Scan Engine in ICAP mode</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179865"><p><a name=179865 style="display: none;">[Topic 179865]</a></p>
	<h2 id="t234372" class="heading2">Getting started with Kaspersky Scan Engine in HTTP mode</h2>
<p class="bodytext">This section explains how to start using Kaspersky Scan Engine in HTTP mode.</p>
<p class="attentionbody">Before you start using Kaspersky Scan Engine, we strongly recommend that you restrict access to Kaspersky Scan Engine files, including logs, with built-in tools provided by your operating system. This measure will help make your information more secure.</p>
<p class="procedureheading">To start using Kaspersky Scan Engine in HTTP mode:</p>
<ol class="listnumber1"><li class="listnumber1"><a id="h193042" class="englishcrossreferencetemplate" href="#192974" target="_self">Install Kaspersky Scan Engine</a>.<p class="listcontinue1">Kaspersky Scan Engine starts automatically after installation is complete.</p>
</li><li class="listnumber1">Optionally, <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">configure Kaspersky Scan Engine for use in HTTP mode</a>.<p class="listcontinue1">For example, you can configure <a id="h180155" class="englishcrossreferencetemplate" href="#179868" target="_self">Format Recognizer</a> to increase the processing speed of Kaspersky Scan Engine in HTTP mode.</p>
</li><li class="listnumber1">Optionally, configure the <a id="h179931" class="englishcrossreferencetemplate" href="#179872" target="_self">systemd unit file</a> to manage Kaspersky Scan Engine in HTTP mode.</li><li class="listnumber1">Optionally, <a id="h180157" class="englishcrossreferencetemplate" href="#179879" target="_self">configure logging</a>. <p class="listcontinue1">Notice that logging decreases performance of Kaspersky Scan Engine. Usually you need to enable logging only during the integration or for debugging.</p>
</li><li class="listnumber1"><a id="h179933" class="englishcrossreferencetemplate" href="#179882" target="_self">Update the anti-virus database or configure the update frequency</a>.<p class="listcontinue1">To keep track of the update process and make sure that you get the latest updates, send an HTTP request to the <code class="programcharacter">/api/v3.0/update/status</code> address.</p>
</li><li class="listnumber1"><a id="h180562" class="englishcrossreferencetemplate" href="#180193" target="_self">Verify the detection capabilities of Kaspersky Scan Engine</a>.</li><li class="listnumber1">Make requests to Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">Run the <a id="h179932" class="englishcrossreferencetemplate" href="#179883" target="_self">sample HTTP client</a> from the command line to scan files.</li><li class="listbullet2">Use a REST-like protocol for making <a id="h193035" class="englishcrossreferencetemplate" href="#192985" target="_self">HTTP requests</a>.</li><li class="listbullet2">Use the source code of the sample HTTP client as an example for creating your own client.</li></ul></li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179890"><p><a name=179890 style="display: none;">[Topic 179890]</a></p>
	<h2 id="t234373" class="heading2">Getting started with Kaspersky Scan Engine in ICAP mode</h2>
<p class="bodytext">This section explains how to start using Kaspersky Scan Engine in ICAP mode.</p>
<p class="attentionbody">Before you start using Kaspersky Scan Engine, we strongly recommend that you restrict access to Kaspersky Scan Engine files, including logs, with built-in tools provided by your operating system. This step will help make your information more secure.</p>
<p class="procedureheading">To start using Kaspersky Scan Engine in ICAP mode:</p>
<ol class="listnumber1"><li class="listnumber1"><a id="h193042" class="englishcrossreferencetemplate" href="#192974" target="_self">Install Kaspersky Scan Engine</a>.<p class="listcontinue1">Kaspersky Scan Engine starts automatically after installation is complete.</p>
</li><li class="listnumber1">Optionally, <a id="h193107" class="englishcrossreferencetemplate" href="#192988" target="_self">configure Kaspersky Scan Engine for use in ICAP mode</a>.</li><li class="listnumber1">If you configure ICAP mode manually (without using the installer), and you are using offline licensing mode, you have to put the license file in the directory that is specified in the <code class="programcharacter">LicensePath</code> element of the configuration file. If you are using online licensing mode, you have to specify the activation code. See also the detailed information about <a id="h180819" class="englishcrossreferencetemplate" href="#179855" target="_self">online</a> and <a id="h180864" class="englishcrossreferencetemplate" href="#179852" target="_self">offline</a> licensing modes.</li><li class="listnumber1">Optionally, <a id="h180152" class="englishcrossreferencetemplate" href="#179893" target="_self">configure service rules</a>.</li><li class="listnumber1">Optionally, <a id="h190568" class="englishcrossreferencetemplate" href="#179896" target="_self">configure logging</a>.<p class="listcontinue1">Notice that logging decreases performance of Kaspersky Scan Engine. Usually you need to enable logging only during the integration or for debugging.</p>
</li><li class="listnumber1">Optionally, <a id="h180129" class="englishcrossreferencetemplate" href="#179897" target="_self">configure environment variables</a>.</li><li class="listnumber1"><a id="h180564" class="englishcrossreferencetemplate" href="#179902" target="_self">Update the anti-virus database or configure the update frequency</a>.</li><li class="listnumber1"><a id="h180563" class="englishcrossreferencetemplate" href="#179903" target="_self">Verify the detection capabilities of Kaspersky Scan Engine</a>.</li><li class="listnumber1"><a id="h193044" class="englishcrossreferencetemplate" href="#192990" target="_self">Run Kaspersky Scan Engine in ICAP mode</a>.</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192974"><p><a name=192974 style="display: none;">[Topic 192974]</a></p>
	<h1 id="t234395" class="heading1">Installing Kaspersky Scan Engine</h1>
<p class="bodytext">This section explains how to install Kaspersky Scan Engine.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#184775" target="_self">Preparing to install Kaspersky Scan Engine GUI</a></p><p class="relateditem"><a href="#199729" target="_self">Installing Kaspersky Scan Engine on Linux</a></p><p class="relateditem"><a href="#199730" target="_self">Installing Kaspersky Scan Engine on Windows</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="184775"><p><a name=184775 style="display: none;">[Topic 184775]</a></p>
	<h2 id="t234465" class="heading2">Preparing to install Kaspersky Scan Engine GUI</h2>
<p class="bodytext">Kaspersky Scan Engine GUI uses the PostgreSQL object-relational database management system to store scan statistics, scan results, service events, and service status. For this reason, if you want to use Kaspersky Scan Engine GUI, you must install PostgreSQL first. </p>
<p class="bodytext">You can use one of two integration schemes: </p>
<ul class="listbullet1"><li class="listbullet1">Install Kaspersky Scan Engine on the same computer as PostgreSQL.</li><li class="listbullet1">Install Kaspersky Scan Engine on a different computer that has access to the computer with PostgreSQL.</li></ul><table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#192975" target="_self">Installing and configuring PostgreSQL (Linux)</a></p><p class="relateditem"><a href="#192976" target="_self">Installing and configuring PostgreSQL (Windows)</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192975"><p><a name=192975 style="display: none;">[Topic 192975]</a></p>
	<h3 id="t234393" class="heading3">Installing and configuring PostgreSQL (Linux)</h3>
<p class="bodytext">Kaspersky Scan Engine GUI requires PostgreSQL 10.7 or later. The following procedure covers installation and configuration of PostgreSQL 10.7. The procedure for a later version may vary.</p>
<p class="procedureheading">To install and configure PostgreSQL:</p>
<ol class="listnumber1"><li class="listnumber1">Download and install PostgreSQL.<p class="listcontinue1">You can install PostgreSQL in one of the following ways:</p>
<ul class="listbullet2"><li class="listbullet2">Install the package downloaded from the PostgreSQL website.<p class="listcontinue2">Visit <a class="hyperlinktemplate" href="https://www.postgresql.org/download/" target="_blank">https://www.postgresql.org/download/</a> to see a list of supported operating systems and installation instructions for each of them.</p>
</li><li class="listbullet2">Install PostgreSQL from source code.<p class="listcontinue2">Visit <a class="hyperlinktemplate" href="https://www.postgresql.org/docs/10/installation.html" target="_blank">https://www.postgresql.org/docs/10/installation.html</a> for installation instructions.</p>
</li></ul></li><li class="listnumber1">Open the <code class="programcharacter">postgresql.conf</code> configuration file. The location of this file varies depending on your operating system:<ul class="listbullet2"><li class="listbullet2">In Debian-based Linux distributions <code class="programcharacter">postgresql.conf</code> is located at <code class="programcharacter">/etc/postgresql/10/main/</code>.</li><li class="listbullet2">In RedHat-based Linux distributions <code class="programcharacter">postgresql.conf</code> is located at <code class="programcharacter">/var/lib/pgsql/data/</code>.</li></ul><p class="listcontinue1">If you use another operating system, the location of <code class="programcharacter">postgresql.conf</code> may be different.</p>
</li><li class="listnumber1">Specify the IP address that Kaspersky Scan Engine must use to connect to PostgreSQL in the <code class="programcharacter">listen_addresses</code> setting of <code class="programcharacter">postgresql.conf</code>.</li><li class="listnumber1">Specify the port on which the PostgreSQL is to listen for connections from Kaspersky Scan Engine in the <code class="programcharacter">port</code> setting of <code class="programcharacter">postgresql.conf</code>.</li><li class="listnumber1">Save and close <code class="programcharacter">postgresql.conf</code>.</li><li class="listnumber1">Open the <code class="programcharacter">pg_hba.conf</code> configuration file. This file is located in the same directory as <code class="programcharacter">postgresql.conf</code>.</li><li class="listnumber1">Specify that PostgreSQL must require an MD5-encrypted password for authentication from all of its clients:<ol class="listalpha2"><li class="listalpha2">Find the following line in <code class="programcharacter">pg_hba.conf</code>:<p class="listcontinue2"><code class="programcharacter">host       all  all  127.0.0.1/32  peer</code></p>
</li><li class="listalpha2">Change this line to:<p class="listcontinue2"><code class="programcharacter">host       all  all  127.0.0.1/32  md5</code></p>
</li></ol><p class="attentioncontinue1">If the <code class="programcharacter">pg_hba.conf</code> configuration file does not contain the <code class="programcharacter">host       all  all  127.0.0.1/32  peer </code>line, you have to change the<code class="programcharacter"> host       all  all  127.0.0.1/32  ident </code>line.</p>
</li><li class="listnumber1">If PostgreSQL and Kaspersky Scan Engine are installed on different computers, add the following line to <code class="programcharacter">pg_hba.conf</code>:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">host       all  all  %IP%/32  md5</p>
</td>
</tr>

</table>
<p class="listcontinue1">Here <code class="programcharacter">%IP%</code> is the IP address of the computer on which Kaspersky Scan Engine is installed.</p>
</li><li class="listnumber1">Save and close <code class="programcharacter">pg_hba.conf</code>.</li><li class="listnumber1">Restart PostgreSQL by running the following command from the command line:<p class="listcontinue1"><code class="programcharacter">service postgresql restart</code></p>
</li><li class="listnumber1">Set the password for the default PostgreSQL user.<p class="listcontinue1">During installation PostgreSQL creates a superuser called <code class="programcharacter">postgres</code>. By default, this user does not a have a password. </p>
<p class="listcontinue1">To set the password for the <code class="programcharacter">postgres</code> user:</p>
<ol class="listalpha2"><li class="listalpha2">From the command line, change the correct user to the <code class="programcharacter">postgres</code> user:<p class="listcontinue2"><code class="programcharacter">su postgres</code></p>
</li><li class="listalpha2">Under the <code class="programcharacter">postgres</code> user account, start the psql utility by running the following command in the command line:<p class="listcontinue2"><code class="programcharacter">psql</code></p>
</li><li class="listalpha2">In psql, change the password of the <code class="programcharacter">postgres</code> user by running the following command:<p class="listcontinue2"><code class="programcharacter">alter user postgres with password '%PASSWORD%';</code></p>
<p class="listcontinue2">Here <code class="programcharacter">%PASSWORD%</code> is the new password for the <code class="programcharacter">postgres</code> user.</p>
</li><li class="listalpha2">Quit the psql utility by running the following command in psql:<p class="listcontinue2"><code class="programcharacter">\q</code></p>
</li></ol></li></ol><p class="bodytext">You can now install Kaspersky Scan Engine GUI.</p>
<p class="bodytext">To install Kaspersky Scan Engine GUI, you need a PostgreSQL user that has permissions for creating new databases and users. You can use the postgres user for that, or create a new user.</p>
<p class="bodytext">After installing PostgreSQL and setting the password for the <code class="programcharacter">postgres</code> user, you can proceed to section &quot;<a id="h193036" class="englishcrossreferencetemplate" href="#192977" target="_self">Automatic installation (Linux)</a>&quot; or &quot;<a id="h181517" class="englishcrossreferencetemplate" href="#180652" target="_self">Manual installation (Linux)</a>&quot;.</p>
<p class="attentionbody">All data is stored in a single database called kavebase. Kaspersky Scan Engine does not use any other databases.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192976"><p><a name=192976 style="display: none;">[Topic 192976]</a></p>
	<h3 id="t234394" class="heading3">Installing and configuring PostgreSQL (Windows)</h3>
<p class="procedureheading">To install and configure PostgreSQL:</p>
<ol class="listnumber1"><li class="listnumber1">Download and install PostgreSQL.<p class="listcontinue1">Visit <a class="hyperlinktemplate" href="https://www.postgresql.org/download/" target="_blank">https://www.enterprisedb.com/downloads/postgres-postgresql-downloads</a> to see a list of supported operating systems and download the installer.</p>
</li><li class="listnumber1">Open the <code class="programcharacter">postgresql.conf</code> configuration file. This file is located at <code class="programcharacter">%postgresql_dir%\data</code>. Here <code class="programcharacter">%postgresql_dir%</code> (for example, <code class="programcharacter">C:\Program Files\PostgreSQL\11</code>) is the folder that PostgreSQL was installed in.</li><li class="listnumber1">Specify the IP address that Kaspersky Scan Engine must use to connect to PostgreSQL in the <code class="programcharacter">listen_addresses</code> setting of <code class="programcharacter">postgresql.conf</code>.</li><li class="listnumber1">Specify the port on which the PostgreSQL is to listen for connections from Kaspersky Scan Engine in the <code class="programcharacter">port</code> setting of <code class="programcharacter">postgresql.conf</code>.</li><li class="listnumber1">For PostgreSQL Version 13 or later, find the following line in <code class="programcharacter">postgresql.conf</code>:<p class="listcontinue1"><code class="programcharacter">password_encryption = md5            # md5 or scram-sha-256</code></p>
<p class="listcontinue1">If the password encryption method specified on this line is other than <code class="programcharacter">md5</code>, change it to <code class="programcharacter">md5</code>.</p>
</li><li class="listnumber1">Save and close <code class="programcharacter">postgresql.conf</code>.</li><li class="listnumber1">Open the <code class="programcharacter">pg_hba.conf</code> configuration file. This file is located in the same folder as <code class="programcharacter">postgresql.conf</code>.</li><li class="listnumber1">Make sure that PostgreSQL requires an MD5-encrypted password for authentication from all of its clients. Find the following line in <code class="programcharacter">pg_hba.conf</code>:<p class="listcontinue1"><code class="programcharacter">host       all  all  127.0.0.1/32  md5</code></p>
<p class="listcontinue1">If the authentication method specified on this line is other than <code class="programcharacter">md5</code>, change it to <code class="programcharacter">md5</code>.</p>
</li><li class="listnumber1">If PostgreSQL and Kaspersky Scan Engine are installed on different computers, add the following line to <code class="programcharacter">pg_hba.conf</code>:<p class="listcontinue1"><code class="programcharacter">host       all  all  %IP%/32  md5</code></p>
<p class="listcontinue1">Here <code class="programcharacter">%IP%</code> is the IP address of the computer on which Kaspersky Scan Engine is installed.</p>
</li><li class="listnumber1">Save and close <code class="programcharacter">pg_hba.conf</code>.</li><li class="listnumber1">Restart PostgreSQL by running the following commands from the command line:<p class="listcontinue1"><code class="programcharacter">sc stop postgresql-x64-11</code></p>
<p class="listcontinue1"><code class="programcharacter">sc start postgresql-x64-11</code></p>
</li><li class="listnumber1">If step 5 was performed, you have to update the password for the superuser on the computer that has PostgreSQL installed. The default user is <code class="programcharacter">postgres</code>. You can use either the psql utility or pgAdmin to perform this action. If you use the psql utility, specify a space character and a user name after the -U parameter, as follows: <code class="programcharacter">psql -U postgres</code><p class="listcontinue1">Update the password for the superuser:</p>
<p class="listcontinue1"><code class="programcharacter">ALTER ROLE username WITH PASSWORD 'your password';</code></p>
</li></ol><p class="bodytext"> You can now install Kaspersky Scan Engine GUI.</p>
<p class="bodytext">To install Kaspersky Scan Engine GUI, you need a PostgreSQL user that has permissions for creating new databases and users. You can use the postgres user for that, or create a new user.</p>
<p class="bodytext">After installing PostgreSQL, you can proceed to section &quot;<a id="h184734" class="englishcrossreferencetemplate" href="#192978" target="_self">Installation using installer (Windows)</a>&quot; or &quot;<a id="h184731" class="englishcrossreferencetemplate" href="#184719" target="_self">Manual installation (Windows)</a>&quot;.</p>
<p class="attentionbody">All data is stored in a single database called kavebase. Kaspersky Scan Engine does not use any other databases.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="199729"><p><a name=199729 style="display: none;">[Topic 199729]</a></p>
	<h2 id="t234396" class="heading2">Installing Kaspersky Scan Engine on Linux</h2>
<p class="bodytext">This section explains how to install Kaspersky Scan Engine on Linux operating systems.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#192977" target="_self">Automatic installation (Linux)</a></p><p class="relateditem"><a href="#180652" target="_self">Manual installation (Linux)</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192977"><p><a name=192977 style="display: none;">[Topic 192977]</a></p>
	<h3 id="t234280" class="heading3">Automatic installation (Linux)</h3>
<p class="bodytext">This section explains how to install Kaspersky Scan Engine by using the installer. You can use the installer if Kaspersky Scan Engine is not installed on your computer (there is no <code class="programcharacter">/opt/kaspersky/ScanEngine</code> directory).</p>
<p class="attentionbody">If you want to use Kaspersky Scan Engine together with the Kaspersky Scan Engine GUI, you must have PostgreSQL installed on a computer that is accessible from the computer on which you install Kaspersky Scan Engine. The Kaspersky Scan Engine GUI does not work without PostgreSQL. </p>
<p class="bodytext">Before installing and configuring Kaspersky Scan Engine, you need to specify the locale of the computer on which Kaspersky Scan Engine is installed. Use the following commands:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">LC_ALL=en_US.utf8</p>
<p class="program">export LC_ALL</p>
</td>
</tr>

</table>
<p class="introheading">Installing Kaspersky Scan Engine by using the installer</p>
<p class="bodytext">The procedure below describes the actions that must be performed if you want to install Kaspersky Scan Engine by using the installer.</p>
<p class="procedureheading">To install Kaspersky Scan Engine automatically:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure you have root (administrator) privileges.</li><li class="listnumber1">Run <code class="programcharacter">install</code>.</li><li class="listnumber1">Read the End User License Agreement (EULA) for Kaspersky Scan Engine.<p class="listcontinue1">If you agree with the terms of the EULA, accept it. If you decline to accept the terms of the EULA, the installation will be canceled.</p>
</li><li class="listnumber1">Choose whether to use the Kaspersky Scan Engine GUI.</li><li class="listnumber1">If you choose to use the Kaspersky Scan Engine GUI, do the following:<ol class="listalpha2"><li class="listalpha2">Make sure you have <a id="h198591" class="englishcrossreferencetemplate" href="#192975" target="_self">installed and configured PostgreSQL</a>.</li><li class="listalpha2">Specify the IP and port for connecting to PostgreSQL.</li><li class="listalpha2">Choose whether to add the product instance to an existing cluster or to connect to an existing database. <p class="listcontinue2">If you chose to add the product instance to an existing cluster, see the next step. Otherwise, go to step f.</p>
</li><li class="listalpha2">Enter the username and password of the PostgreSQL user account.<p class="listcontinue2">Under these credentials, Kaspersky Scan Engine will work with the database.</p>
</li><li class="listalpha2">Continue the procedure from the step 6.</li><li class="listalpha2">Provide credentials for a user that has permissions for creating new databases and users. The credentials are not recorded anywhere. <p class="listcontinue2">With these credentials, Kaspersky Scan Engine will create a new database called kavebase in which Kaspersky Scan Engine will store its data and a new PostgreSQL user. From this moment on, Kaspersky Scan Engine will use this user to make changes to the database.</p>
</li><li class="listalpha2">Set the username and password for a new PostgreSQL user account.<p class="listcontinue2">The installer will create the account under which Kaspersky Scan Engine will work with the database. This account will have access only to the kavebase database.</p>
<p class="attentioncontinue2">These credentials will be stored as encrypted and available only for the root user. That is why if you run the service as a user without root privileges, an error message will be displayed. To solve this problem, after the installation is complete, configure access to the <code class="programcharacter">kl_scanengine_db.key</code> encryption key file stored in the <code class="programcharacter">httpsrv</code> directory so that the user account under which you want Kaspersky Scan Engine to work with the database can have the read permission.</p>
</li></ol></li><li class="listnumber1">Choose the mode for Kaspersky Scan Engine.<p class="listcontinue1">The following modes are available:</p>
<ul class="listbullet2"><li class="listbullet2">HTTP</li><li class="listbullet2">ICAP</li></ul></li><li class="listnumber1">For the HTTP mode, specify the IP address and port or the UNIX socket that Kaspersky Scan Engine will listen on for incoming requests to scan objects.<p class="listcontinue1">For the ICAP mode, specify the port whose traffic Kaspersky Scan Engine will scan.</p>
</li><li class="listnumber1">Specify whether Kaspersky Scan Engine must use Kaspersky Security Network (KSN).</li><li class="listnumber1">If you choose to use KSN, read the EULA for KSN and the Privacy Policy.<p class="listcontinue1">If you agree with the terms of the EULA and the Privacy Policy, accept it. If you decline the terms of the EULA for KSN or the Privacy Policy, you will not be able to use KSN, but the installation will continue. You can enable KSN later by using <a id="h182505" class="englishcrossreferencetemplate" href="#179699" target="_self">Kaspersky Scan Engine GUI</a> or the Kaspersky Scan Engine configuration file (<a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">HTTP</a> or <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">ICAP</a>).</p>
</li><li class="listnumber1">If you choose to use the Kaspersky Scan Engine GUI, specify the port on which the Kaspersky Scan Engine GUI will be available, if necessary.</li><li class="listnumber1">Specify whether to use a proxy server.</li><li class="listnumber1">If you choose to use a proxy server, specify the proxy settings.</li><li class="listnumber1">Specify the directory for storing temporary files.<p class="listcontinue1">If you press <kbd class="keycharacter">Enter</kbd>, the <code class="programcharacter">/tmp</code> directory will be used for storing temporary files.</p>
<p class="listcontinue1">The installer will create the <code class="programcharacter">scanengine</code> subdirectory in the directory that you specified. Kaspersky Scan Engine will use this subdirectory for storing temporary files.</p>
</li><li class="listnumber1">Starting from Kaspersky Scan Engine version 2.1, the KAV SDK objects are delivered as a separate package. Specify the absolute path to the directory that contains the KAV SDK package. Alternatively, you can press <kbd class="keycharacter">Enter</kbd>. In this case, the Kaspersky Scan Engine installer will search for the KAV SDK files in the directory one level higher than the directory where the installer is located.</li><li class="listnumber1">Specify the licensing mode to be used in Kaspersky Scan Engine.<ul class="listbullet2"><li class="listbullet2">For simplified licensing mode, specify the key file.</li><li class="listbullet2">For online licensing mode, specify the activation code.</li></ul></li><li class="listnumber1">At the prompt, check the settings you have specified and modify them if necessary.</li></ol><p class="bodytext">After you specify the necessary data, Kaspersky Scan Engine is installed, and then started. Finally, the installer prints the summary information about the installation to the console.</p>
<p class="bodytext">After you install Kaspersky Scan Engine, you can check the integrity of its components at any time by <a id="h209330" class="englishcrossreferencetemplate" href="#209025" target="_self">using the integrity check tool</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180652"><p><a name=180652 style="display: none;">[Topic 180652]</a></p>
	<h3 id="t234441" class="heading3">Manual installation (Linux)</h3>
<p class="bodytext">This section describes how to manually install Kaspersky Scan Engine on Linux systems. </p>
<p class="bodytext">Before installing and configuring Kaspersky Scan Engine, you need to specify the locale of the computer on which Kaspersky Scan Engine is installed. Use the following commands:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">LC_ALL=en_US.utf8</p>
<p class="program">export LC_ALL</p>
</td>
</tr>

</table>
<p class="procedureheading">To install Kaspersky Scan Engine manually: </p>
<ol class="listnumber1"><li class="listnumber1">Make sure that you have root (administrator) privileges.</li><li class="listnumber1">Create the <code class="programcharacter">/opt/kaspersky/ScanEngine</code> directory. This directory is called <code class="programcharacter">%service_dir%</code> in this Help document.</li><li class="listnumber1">Unpack the distribution kit contents to the <code class="programcharacter">%service_dir%</code> directory on your system.</li><li class="listnumber1">Unpack the objects from the KAV SDK distribution kit (hereinafter <code class="programcharacter">%SDK_kit%</code>) as follows:<ul class="listbullet2"><li class="listbullet2">Objects from <code class="programcharacter">%SDK_kit%/bin/bases</code> to <code class="programcharacter">%service_dir%/bin/bases</code></li><li class="listbullet2">Objects from <code class="programcharacter">%SDK_kit%/include</code> to <code class="programcharacter">%service_dir%/include</code></li><li class="listbullet2">Objects from <code class="programcharacter">%SDK_kit%/lib</code> to <code class="programcharacter">%service_dir%/lib</code></li><li class="listbullet2">Objects from <code class="programcharacter">%SDK_kit%/ppl</code> to <code class="programcharacter">%service_dir%/ppl</code></li><li class="listbullet2">The <code class="programcharacter">%SDK_kit%/tools/kavsigner</code> file to <code class="programcharacter">%service_dir%/tools</code></li><li class="listbullet2">The <code class="programcharacter">%SDK_kit%/tools/integrity_check_sdk.xml</code> file to <code class="programcharacter">%service_dir%</code></li></ul><p class="attentioncontinue1">Only users with administrator rights must have access to the objects from <code class="programcharacter">%SDK_kit%</code>. <br>For compatibility with Kaspersky Scan Engine, use the KAV SDK version 8.9.2.595 or later.</p>
</li><li class="listnumber1">Read the End User License Agreement (EULA) for Kaspersky Scan Engine. The EULA is located at <code class="programcharacter">%service_dir%/doc/license.txt</code>.<p class="listcontinue1">If you agree to the terms of the EULA, proceed to the next step. If you decline the terms of the EULA, cancel the installation.</p>
</li><li class="listnumber1">Open file <code class="programcharacter">%service_dir%/etc/klScanEngineUI.xml</code>.</li><li class="listnumber1">Accept the EULA. Change <code class="programcharacter">&lt;Common&gt;rejected&lt;/Common&gt;</code> to <code class="programcharacter">&lt;Common&gt;accepted&lt;/Common&gt;</code> in the <code class="programcharacter">klScanEngineUI.xml</code> file.</li><li class="listnumber1">If you want to use Kaspersky Security Network (KSN), read the EULA for KSN and the Privacy Policy. This EULA is also located at <code class="programcharacter">%service_dir%/doc/ksn_license.txt</code> and contains the link to the Privacy Policy.<p class="listcontinue1">If you agree to the terms of the EULA for KSN and the Privacy Policy, proceed to the next step. If you decline the terms of the EULA for KSN or the Privacy Policy, proceed to step 10.</p>
</li><li class="listnumber1">Accept the EULA for KSN. Change <code class="programcharacter">&lt;KSN&gt;rejected&lt;/KSN&gt;</code> to <code class="programcharacter">&lt;KSN&gt;accepted&lt;/KSN&gt;</code> in <code class="programcharacter">klScanEngineUI.xml</code>.</li><li class="listnumber1">Save and close <code class="programcharacter">%service_dir%/etc/klScanEngineUI.xml</code>.</li><li class="listnumber1">Create a symbolic link to <code class="programcharacter">%service_dir%/etc/klScanEngineUI.xml</code> from the <code class="programcharacter">/etc/</code> directory:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">ln -s <code class="programcharacter">%service_dir%/etc/klScanEngineUI.xml /etc/klScanEngineUI.xml</code></p>
</td>
</tr>

</table>
</li><li class="listnumber1">If you want to use Kaspersky Scan Engine GUI, read subsection &quot;Enabling Kaspersky Scan Engine GUI&quot; below.</li><li class="listnumber1">Make a symbolic link to the proper Kaspersky Scan Engine configuration file from the <code class="programcharacter">/etc/</code> directory:<ul class="listbullet2"><li class="listbullet2">For HTTP mode, copy the <code class="programcharacter">%service_dir%/etc/kavhttpd.xml</code> file to the <code class="programcharacter">/etc/</code> directory.</li><li class="listbullet2">For ICAP mode, copy the <code class="programcharacter">%service_dir%/etc/kavicapd.xml</code> file to the <code class="programcharacter">/etc/</code> directory.</li></ul><p class="listcontinue1">For example, in HTTP mode you have to run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">ln -s <code class="programcharacter">%service_dir%/etc/kavhttpd.xml /etc/kavhttpd.xml</code></p>
</td>
</tr>

</table>
</li><li class="listnumber1">If you do not use the Kaspersky Scan Engine GUI and a connection through proxy server is needed, you have to specify an encrypted user name and password for the proxy server. To encrypt the user name and password:<ol class="listalpha2"><li class="listalpha2">Generate an encryption key as follows:<p class="listcontinue2"><code class="programcharacter">openssl rand -out %service_dir%/httpsrv/kl_scanengine_db.key 512</code></p>
</li><li class="listalpha2">Provide read permission to the owner only by running the following command:<p class="listcontinue2"><code class="programcharacter">chmod 400 %service_dir%/httpsrv/kl_scanengine_db.key</code></p>
</li><li class="listalpha2">To encrypt the credentials, use the <code class="programcharacter">kav_encrypt</code> utility. This utility also automatically writes the encrypted user name and password to the configuration file <code class="programcharacter">kavhttpd.xml</code> (for HTTP mode) or <code class="programcharacter">kavicapd.xml</code> (for ICAP mode). The utility is located in the <code class="programcharacter">%service_dir%/tools/</code> directory.<p class="listcontinue2">Run the <code class="programcharacter">kav_encrypt</code> utility with the following options:</p>
<p class="listcontinue2"><code class="programcharacter">-m &lt;httpd | icap&gt; -p &lt;user_name:password&gt;</code></p>
</li></ol></li><li class="listnumber1">In <code class="programcharacter">/etc/systemd/system/multi-user.target.wants/</code>, make symbolic links to the following files:<ul class="listbullet2"><li class="listbullet2">For ICAP mode, make a symbolic link to <code class="programcharacter">/opt/kaspersky/ScanEngine/etc/kavicapd.service</code> by using the following command:</li></ul><table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">ln -s /opt/kaspersky/ScanEngine/etc/kavicapd.service /etc/systemd/system/kavicapd.service</p>
</td>
</tr>

</table>
<ul class="listbullet2"><li class="listbullet2">For HTTP mode, make a symbolic link to <code class="programcharacter">/opt/kaspersky/ScanEngine/etc/kavhttpd.service</code> by using the following command:</li></ul><table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">ln -s /opt/kaspersky/ScanEngine/etc/kavhttpd.service /etc/systemd/system/kavhttpd.service </p>
</td>
</tr>

</table>
</li><li class="listnumber1">Register Kaspersky Scan Engine in the system by using the following commands:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program"><code class="programcharacter">systemctl daemon-reload</code></p>
<p class="program"><code class="programcharacter">systemctl enable kavhttpd</code></p>
<p class="program"><code class="programcharacter">systemctl enable kavicapd</code></p>
</td>
</tr>

</table>
</li><li class="listnumber1">Run registered Kaspersky Scan Engine services:<ul class="listbullet2"><li class="listbullet2">For ICAP mode, run:</li></ul><table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program"> service kavicapd start</p>
</td>
</tr>

</table>
<ul class="listbullet2"><li class="listbullet2">For HTTP mode, run:</li></ul><table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program"> service kavhttpd start</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Go to the next steps as described in Getting started for <a id="h180269" class="englishcrossreferencetemplate" href="#179865" target="_self">HTTP mode</a> or <a id="h180693" class="englishcrossreferencetemplate" href="#179890" target="_self">ICAP mode</a>.</li><li class="listnumber1">Activate Kaspersky Scan Engine either in <a id="h180864" class="englishcrossreferencetemplate" href="#179852" target="_self">offline licensing mode</a> or <a id="h180819" class="englishcrossreferencetemplate" href="#179855" target="_self">online licensing mode</a>. </li></ol><p class="bodytext">After you install Kaspersky Scan Engine, you can check the integrity of its components at any time by <a id="h209330" class="englishcrossreferencetemplate" href="#209025" target="_self">using the integrity check tool</a>.</p>
<p class="introheading">Enabling Kaspersky Scan Engine GUI</p>
<p class="procedureheading">To enable Kaspersky Scan Engine GUI:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure that you have root (administrator) privileges.</li><li class="listnumber1">Do one of the following:<ul class="listbullet2"><li class="listbullet2">If you have never installed an instance of Kaspersky Scan Engine with GUI before or you do not want to <a id="h212028" class="englishcrossreferencetemplate" href="#211897" target="_self">add the new instance to an existing cluster</a>, perform the actions described in section &quot;<a id="h181518" class="englishcrossreferencetemplate" href="#184775" target="_self">Preparing to install Kaspersky Scan Engine GUI</a>&quot;.</li><li class="listbullet2">If you already have an instance of Kaspersky Scan Engine with GUI and you want to <a id="h212028_2" class="englishcrossreferencetemplate" href="#211897" target="_self">add the new instance to the same cluster</a>, go to the step 4.</li></ul></li><li class="listnumber1">On the computer that has PostgreSQL installed, perform the actions listed below under a user that can create new users and databases. To perform these actions, you can use either the psql utility or pgAdmin.<p class="listcontinue1">Make sure that the user running the database queries has access to the directory containing <code class="programcharacter">tables.sql</code> and also has read access to <code class="programcharacter">tables.sql</code> itself.</p>
<ol class="listalpha2"><li class="listalpha2">Create a new PostgreSQL user called <code class="programcharacter">scanengine</code>:<p class="listcontinue2"><code class="programcharacter">CREATE USER scanengine;</code></p>
</li><li class="listalpha2">Set the password for the <code class="programcharacter">scanengine</code> user:<p class="listcontinue2"><code class="programcharacter">ALTER USER scanengine WITH PASSWORD '%PASSWORD%';</code></p>
</li><li class="listalpha2">Using PostgreSQL, create a database called <code class="programcharacter">kavebase</code>:<p class="listcontinue2"><code class="programcharacter">CREATE DATABASE kavebase OWNER scanengine;</code></p>
</li><li class="listalpha2">In the <code class="programcharacter">kavebase</code> database run the queries described in <code class="programcharacter">%service_dir%/samples/tables.sql</code>.<p class="listcontinue2"><code class="programcharacter">psql -d kavebase -a -f tables.sql</code></p>
</li></ol></li><li class="listnumber1">Open <code class="programcharacter">/etc/klScanEngineUI.xml</code>.</li><li class="listnumber1">In the <code class="programcharacter">&lt;Mode&gt;</code> element, specify the mode that Kaspersky Scan Engine will work in:<p class="listcontinue1">For HTTP mode:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Mode&gt;httpd&lt;/Mode&gt;</p>
</td>
</tr>

</table>
<p class="listcontinue1">For ICAP mode:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Mode&gt;icap&lt;/Mode&gt;</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Change <code class="programcharacter">&lt;EnableUI&gt;false&lt;/EnableUI&gt;</code> to <code class="programcharacter">&lt;EnableUI&gt;true&lt;/EnableUI&gt;</code>.</li><li class="listnumber1">In the <code class="programcharacter">&lt;ConnectionString&gt;</code> element, specify the address of the Kaspersky Scan Engine GUI web service in %IP%:%port% format.<p class="listcontinue1">For example:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ConnectionString&gt;198.51.100.0:443&lt;/ConnectionString&gt;</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Specify the SSL certificate to install in the Kaspersky Scan Engine GUI web service.<ul class="listbullet2"><li class="listbullet2">If you already have an SSL certificate that you want to install in the Kaspersky Scan Engine GUI web service, specify the paths to your certificate and your private key:<ol class="listalpha3"><li class="listalpha3">In the <code class="programcharacter">&lt;SSLCertificatePath&gt;</code> element, specify the path to your SSL certificate.</li><li class="listalpha3">In the <code class="programcharacter">&lt;SSLPrivateKeyPath&gt;</code> element, specify the path to your private key.</li></ol></li><li class="listbullet2">If you do not have an SSL certificate that you want to install in the Kaspersky Scan Engine GUI web service, generate a new one. Run the <code class="programcharacter">%service_dir%/tools/openssl</code> utility as follows:</li></ul><table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">/opt/kaspersky/ScanEngine/tools/openssl req -x509 -nodes -days 1825 -subj /C=RU/CN=&quot;%ConnectionString%&quot; -newkey rsa:<code class="programcharacter">4096</code> -extensions EXT -config &quot;/opt/kaspersky/ScanEngine/tools/openssl.cnf&quot; -keyout &quot;/opt/kaspersky/ScanEngine/httpsrv/kl_scanengine_private.pem&quot; -out &quot;/opt/kaspersky/ScanEngine/httpsrv/kl_scanengine_cert.pem&quot;</p>
</td>
</tr>

</table>
<p class="listcontinue2">Here <code class="programcharacter">%ConnectionString%</code> is the value that is specified in the <code class="programcharacter">&lt;ConnectionString&gt;</code> element. It is recommended to use the values <code class="programcharacter">rsa:4096</code> or <code class="programcharacter">rsa:3072</code> with the <code class="programcharacter">-newkey</code> parameter. The minimum supported value is <code class="programcharacter">rsa:2048</code>. </p>
<p class="attentioncontinue2">You must configure access to the private key file for ScanEngine GUI so that only the root user and the user account under which the service is running can have the read permission.</p>
</li><li class="listnumber1">Generate an encryption key as follows:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">openssl rand -out %service_dir%/httpsrv/kl_scanengine_db.key 512</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Provide read permission to the owner only by running the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">chmod 400 %service_dir%/httpsrv/kl_scanengine_db.key</p>
</td>
</tr>

</table>
</li><li class="listnumber1">In the <code class="programcharacter">DatabaseSettings &gt; ConnectionString </code>element, specify the address of a new or existing kavebase database that you want to connect to by using the format %IP%:%port%.</li><li class="listnumber1">Save and close <code class="programcharacter">/etc/klScanEngineUI.xml</code>.</li><li class="listnumber1">Encrypt the user name and password of the user that will be used to access to the kavebase database:<ul class="listbullet2"><li class="listbullet2">If you have never installed an instance of Kaspersky Scan Engine with GUI before or you do not want to add the new instance to an existing cluster, encrypt the user name and password of the user that you specified in step 3.  </li><li class="listbullet2">If you already have an instance of Kaspersky Scan Engine with GUI and you want to add the new instance to the same cluster, encrypt the user name and password of the user that is used to access the kavebase database of the cluster.</li></ul><p class="listcontinue1">To encrypt the credentials, <a id="h209335" class="englishcrossreferencetemplate" href="#181814" target="_self">use the kav_encrypt utility</a>. This utility also automatically writes the encrypted user name and password to <code class="programcharacter">/etc/klScanEngineUI.xml</code>. The utility is located in the <code class="programcharacter">%service_dir%/tools/</code> directory.</p>
<p class="listcontinue1">Run the kav_encrypt utility with the following options:</p>
<p class="listcontinue1"><code class="programcharacter">-d '%username%:%password%'</code></p>
</li><li class="listnumber1">In <code class="programcharacter">/etc/systemd/system/multi-user.target.wants/</code>, make a symbolic link to <code class="programcharacter">/opt/kaspersky/ScanEngine/etc/klScanEngineUI.service</code> by using the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">ln -s /opt/kaspersky/ScanEngine/etc/klScanEngineUI.service /etc/systemd/system/klScanEngineUI.service </p>
</td>
</tr>

</table>
</li><li class="listnumber1">Register Kaspersky Scan Engine in the system by using the following commands:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program"><code class="programcharacter">systemctl daemon-reload</code></p>
<p class="program"><code class="programcharacter">systemctl enable klScanEngineUI</code></p>
</td>
</tr>

</table>
</li><li class="listnumber1">Run the registered Kaspersky Scan Engine service:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program"><code class="programcharacter">service klScanEngineUI start</code></p>
</td>
</tr>

</table>
<p class="spacer"></p>
</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="199730"><p><a name=199730 style="display: none;">[Topic 199730]</a></p>
	<h2 id="t234397" class="heading2">Installing Kaspersky Scan Engine on Windows</h2>
<p class="bodytext">This section explains how to install Kaspersky Scan Engine on Windows operating systems.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#192978" target="_self">Automatic installation (Windows)</a></p><p class="relateditem"><a href="#184719" target="_self">Manual installation (Windows)</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192978"><p><a name=192978 style="display: none;">[Topic 192978]</a></p>
	<h3 id="t234281" class="heading3">Automatic installation (Windows)</h3>
<p class="bodytext">This section explains how to install Kaspersky Scan Engine using the installer. You can use the installer if Kaspersky Scan Engine is not installed on your computer.</p>
<p class="attentionbody">If you want to use Kaspersky Scan Engine together with Kaspersky Scan Engine GUI, you must have PostgreSQL installed on a computer that is accessible from the computer on which you install Kaspersky Scan Engine. Kaspersky Scan Engine GUI does not work without PostgreSQL.</p>
<p class="procedureheading">To install Kaspersky Scan Engine using the installer:</p>
<ol class="listnumber1"><li class="listnumber1">Unpack the distribution kit contents to an empty folder on your system.</li><li class="listnumber1">Make sure you have administrator privileges.</li><li class="listnumber1">Run <code class="programcharacter">install.exe</code>.</li><li class="listnumber1">Read the End User License Agreement (EULA) for Kaspersky Scan Engine.<p class="listcontinue1">If you agree with the terms of the EULA, accept it. If you decline to accept the terms of the EULA, the installation will be canceled.</p>
</li><li class="listnumber1">Choose whether to use Kaspersky Scan Engine GUI.</li><li class="listnumber1">If you choose to use Kaspersky Scan Engine GUI, do the following:<ol class="listalpha2"><li class="listalpha2">Make sure you have <a id="h193039" class="englishcrossreferencetemplate" href="#192976" target="_self">installed and configured PostgreSQL</a>.</li><li class="listalpha2">Specify the IP and port for connecting to PostgreSQL.</li><li class="listalpha2">Provide credentials for a user that has permissions for creating new databases and users. The credentials are not recorded anywhere. <p class="listcontinue2">With these credentials, Kaspersky Scan Engine will create a new database called kavebase in which Kaspersky Scan Engine will store its data, and a new PostgreSQL user called scanengine. From this moment on, Kaspersky Scan Engine will use the scanengine user to make changes to the database.</p>
</li></ol></li><li class="listnumber1">Specify the IP address and port that Kaspersky Scan Engine will listen on for incoming requests to scan objects.</li><li class="listnumber1">Specify whether Kaspersky Scan Engine must use Kaspersky Security Network (KSN).</li><li class="listnumber1">If you choose to use KSN, read the EULA for KSN and the Privacy Policy.<p class="listcontinue1">If you agree with the terms of the EULA and the Privacy Policy, accept it. If you decline the terms of the EULA for KSN or the Privacy Policy, you will not be able to use KSN, but the installation will continue. You can enable KSN later by using <a id="h182505" class="englishcrossreferencetemplate" href="#179699" target="_self">Kaspersky Scan Engine GUI</a> or the Kaspersky Scan Engine <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">configuration file</a>.</p>
</li><li class="listnumber1">If you choose to use Kaspersky Scan Engine GUI, specify the port on which Kaspersky Scan Engine GUI will be available, if necessary.</li><li class="listnumber1">Specify whether to use a proxy server.</li><li class="listnumber1">If you choose to use a proxy server, specify the proxy settings.</li><li class="listnumber1">Specify the directory for storing temporary files.<p class="listcontinue1">The installer will create the <code class="programcharacter">scanengine</code> subdirectory in this directory; Kaspersky Scan Engine will use this subdirectory for storing temporary files.</p>
</li><li class="listnumber1">Specify the licensing mode to be used in Kaspersky Scan Engine.<ul class="listbullet2"><li class="listbullet2">For simplified licensing mode, specify the key file.</li><li class="listbullet2">For online licensing mode, specify the activation code.</li></ul></li><li class="listnumber1">At the prompt, check the settings you have specified and modify them if necessary.</li></ol><p class="bodytext">After you specify necessary data, <code class="programcharacter">install</code> installs Kaspersky Scan Engine and then starts it. Kaspersky Scan Engine is installed to the <code class="programcharacter">C:\Program Files\Kaspersky Lab\ScanEngine</code> folder.</p>
<p class="bodytext">Finally, the installer prints the summary information about the installation to the console.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="184719"><p><a name=184719 style="display: none;">[Topic 184719]</a></p>
	<h3 id="t234442" class="heading3">Manual installation (Windows)</h3>
<p class="bodytext">This section describes how to manually install Kaspersky Scan Engine on Windows systems. </p>
<p class="procedureheading">To install Kaspersky Scan Engine manually: </p>
<ol class="listnumber1"><li class="listnumber1">Make sure that you have administrator privileges.</li><li class="listnumber1">Create the <code class="programcharacter">C:\Program Files\Kaspersky Lab\ScanEngine</code> folder. This folder is called <code class="programcharacter">%service_dir%</code> in this Help document. </li><li class="listnumber1">Unpack the distribution kit contents to the <code class="programcharacter">%service_dir%</code> folder on your system.</li><li class="listnumber1">Read the End User License Agreement (EULA) for Kaspersky Scan Engine. The EULA is located at <code class="programcharacter">%service_dir%\doc\license.txt</code>.<p class="listcontinue1">If you agree to the terms of the EULA, proceed to the next step. If you decline the terms of the EULA, cancel the installation.</p>
</li><li class="listnumber1">Open file <code class="programcharacter">%service_dir%\bin\klScanEngineUI.xml</code>.</li><li class="listnumber1">Accept the EULA. Change <code class="programcharacter">&lt;Common&gt;rejected&lt;/Common&gt;</code> to <code class="programcharacter">&lt;Common&gt;accepted&lt;/Common&gt;</code> in the klScanEngineUI.xml file.</li><li class="listnumber1">If you want to use Kaspersky Security Network (KSN), read the EULA for KSN and the Privacy Policy. This EULA is also located at %service_dir%\doc\ksn_license.txt and contains the link to the Privacy Policy.<p class="listcontinue1">If you agree to the terms of the EULA for KSN and the Privacy Policy, proceed to the next step. If you decline the terms of the EULA for KSN or the Privacy Policy, proceed to step 9.</p>
</li><li class="listnumber1">Accept the EULA for KSN. Change <code class="programcharacter">&lt;KSN&gt;rejected&lt;/KSN&gt; </code>to <code class="programcharacter">&lt;KSN&gt;accepted&lt;/KSN&gt;</code> in klScanEngineUI.xml.</li><li class="listnumber1">Save and close <code class="programcharacter">%service_dir%\bin\klScanEngineUI.xml</code>.</li><li class="listnumber1">Open file <code class="programcharacter">%service_dir%\bin\kavhttpd.xml</code>. </li><li class="listnumber1">At the <code class="programcharacter">BasesPath</code> and the <code class="programcharacter">TempPath</code> element specify the full path to the <code class="programcharacter">%service_dir%\bin\bases</code> directory and to the directory that contains temporary files used by Kaspersky Scan Engine, respectively. Save and close the file.</li><li class="listnumber1">If you want Kaspersky Scan Engine to start automatically on system bootup, do the following:<ol class="listalpha2"><li class="listalpha2">In Windows, open a Command Prompt window as Administrator.</li><li class="listalpha2">Run the following command:<p class="listcontinue2"><code class="programcharacter">sc create &quot;Kaspersky ScanEngine&quot; binpath= &quot;%service_dir%\bin\kavhttpd.exe -c  %service_dir%\bin\kavhttpd.xml&quot; start= auto DisplayName= &quot;Kaspersky ScanEngine&quot;</code></p>
</li></ol><p class="attentioncontinue1">Note that if the full path to the configuration file contains a space character, you have to add a quote mark (<code class="programcharacter">&quot;</code>) after the slash (<code class="programcharacter">\</code>) mark. Example: <code class="programcharacter">C:\Program Files\Kaspersky Lab\ScanEngine\bin&gt;sc create &quot;Kaspersky ScanEngine&quot; binpath= &quot;C:\Program Files\Kaspersky Lab\ScanEngine\bin\kavhttpd.exe -c \&quot;C:\Program Files\Kaspersky Lab\ScanEngine\bin\kavhttpd.xml\&quot;&quot; </code></p>
</li><li class="listnumber1">Proceed to <a id="h180269" class="englishcrossreferencetemplate" href="#179865" target="_self">getting started with Kaspersky Scan Engine in HTTP mode</a>.</li></ol><p class="introheading">Enabling Kaspersky Scan Engine GUI</p>
<p class="procedureheading">To enable Kaspersky Scan Engine GUI:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure that you have administrator privileges.</li><li class="listnumber1"><a id="h193039" class="englishcrossreferencetemplate" href="#192976" target="_self">Install and configure PostgreSQL</a>.</li><li class="listnumber1">On the computer that has PostgreSQL installed, perform the actions listed below under a user that can create new users and databases. To perform these actions, you can use either the psql utility, or pgAdmin. If you use the psql utility, specify a space character and a user name after the <code class="programcharacter">-U</code> parameter. <ol class="listalpha2"><li class="listalpha2">Create a new PostgreSQL user called <code class="programcharacter">scanengine</code>:<p class="listcontinue2"><code class="programcharacter">CREATE USER scanengine;</code></p>
</li><li class="listalpha2">Set the password for the <code class="programcharacter">scanengine</code> user:<p class="listcontinue2"><code class="programcharacter">ALTER USER scanengine WITH PASSWORD '%PASSWORD%';</code></p>
</li><li class="listalpha2">Using PostgreSQL, create a database called <code class="programcharacter">kavebase</code>:<p class="listcontinue2"><code class="programcharacter">CREATE DATABASE kavebase OWNER scanengine;</code></p>
</li><li class="listalpha2">In the <code class="programcharacter">kavebase</code> database run the queries described in <code class="programcharacter">%service_dir%\samples\tables.sql</code>.<p class="listcontinue2"><code class="programcharacter">psql -d kavebase -a -f tables.sql</code></p>
</li></ol></li><li class="listnumber1">Open <code class="programcharacter">%service_dir%\bin\klScanEngineUI.xml</code>.</li><li class="listnumber1">Change <code class="programcharacter">&lt;EnableUI&gt;false&lt;/EnableUI&gt;</code> to <code class="programcharacter">&lt;EnableUI&gt;true&lt;/EnableUI&gt;</code>.</li><li class="listnumber1">In the <code class="programcharacter">&lt;ConnectionString&gt;</code> element, specify the address of the Kaspersky Scan Engine GUI web service in <code class="programcharacter">%IP%:%port%</code> format.<p class="listcontinue1">For example:</p>
<p class="listcontinue1"><code class="programcharacter">&lt;ConnectionString&gt;198.51.100.0:443&lt;/ConnectionString&gt;</code></p>
</li><li class="listnumber1">Specify the SSL certificate to install in the Kaspersky Scan Engine GUI web service.<ul class="listbullet2"><li class="listbullet2">If you already have an SSL certificate that you want to install in the Kaspersky Scan Engine GUI web service, specify the paths to your certificate and your private key:<ol class="listalpha3"><li class="listalpha3">In the <code class="programcharacter">&lt;SSLCertificatePath&gt;</code> element, specify the path to your SSL certificate.</li><li class="listalpha3">In the <code class="programcharacter">&lt;SSLPrivateKeyPath&gt;</code> element, specify the path to your private key.</li></ol></li><li class="listbullet2">If you do not have an SSL certificate that you want to install in the Kaspersky Scan Engine GUI web service, generate a new one. Run the <code class="programcharacter">%service_dir%\tools\openssl</code> utility as follows:<p class="listcontinue2"><code class="programcharacter">%service_dir%\tools\openssl.exe req -x509 -nodes -days 1825 -subj /C=RU/CN=&quot;%ConnectionString%&quot; -newkey rsa:4096 -extensions EXT -config &quot;%service_dir%\tools\openssl.cnf&quot; -keyout &quot;%service_dir%\httpsrv\kl_scanengine_private.pem&quot; -out &quot;%service_dir%\httpsrv\kl_scanengine_cert.pem&quot;</code></p>
<p class="listcontinue2">Here <code class="programcharacter">%ConnectionString%</code> is the value that is specified in the <code class="programcharacter">&lt;ConnectionString&gt;</code> element. It is recommended to use the values <code class="programcharacter">rsa:4096</code> or <code class="programcharacter">rsa:3072</code> with the <code class="programcharacter">-newkey</code> parameter. The minimum supported value is <code class="programcharacter">rsa:2048</code>. </p>
</li></ul></li><li class="listnumber1">Encrypt the user name and password of the user that you specified in step 3. Kaspersky Scan Engine will use this user name and password to connect to the kavebase database.<p class="listcontinue1">To encrypt the credentials, <a id="h209335" class="englishcrossreferencetemplate" href="#181814" target="_self">use the kav_encrypt utility</a>. This utility also automatically writes the encrypted user name and password to <code class="programcharacter">klScanEngineUI.xml</code>. The utility is located in the <code class="programcharacter">%service_dir%\tools\</code> folder.</p>
<p class="listcontinue1">Run the kav_encrypt utility with the following options:</p>
<p class="listcontinue1"><code class="programcharacter">-d %username%:%password%</code></p>
</li><li class="listnumber1">In the <code class="programcharacter">DatabaseSettings &gt; ConnectionString </code>element, specify the address of the kavebase database in format <code class="programcharacter">%IP%:%port%</code>.</li><li class="listnumber1">Save and close <code class="programcharacter">%service_dir%\bin\klScanEngineUI.xml</code>.</li><li class="listnumber1">If you want Kaspersky Scan Engine GUI to start automatically on system bootup, do the following:<ol class="listalpha2"><li class="listalpha2">Open a Command Prompt window as Administrator.</li><li class="listalpha2">Run the following command:<p class="listcontinue2"><code class="programcharacter">sc create &quot;Kaspersky ScanEngine UI&quot; binpath= &quot;%service_dir%\bin\klScanEngineUI.exe --svc&quot; start= auto DisplayName= &quot;Kaspersky ScanEngine UI&quot;</code></p>
</li></ol></li><li class="listnumber1">Start Kaspersky Scan Engine GUI:<p class="listcontinue1"><code class="programcharacter">sc start &quot;Kaspersky ScanEngine UI&quot;</code></p>
</li></ol><p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221907"><p><a name=221907 style="display: none;">[Topic 221907]</a></p>
	<h1 id="t234557" class="heading1">Upgrading Kaspersky Scan Engine on Linux</h1>
<p class="bodytext">This section describes how to upgrade Kaspersky Scan Engine&nbsp;from a previous version on Linux systems.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#221941" target="_self">Automatic upgrade (Linux)</a></p><p class="relateditem"><a href="#209771" target="_self">Manual upgrade (Linux)</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221941"><p><a name=221941 style="display: none;">[Topic 221941]</a></p>
	<h2 id="t234282" class="heading2">Automatic upgrade (Linux)</h2>
<p class="bodytext">Starting with Kaspersky Scan Engine version 2.0, you can automatically upgrade Kaspersky Scan Engine to a newer version.</p>
<p class="introheading">Using the install utility to upgrade</p>
<p class="bodytext">You can upgrade Kaspersky Scan Engine with the same utility that is used to install Kaspersky Scan Engine: the <code class="programcharacter">install</code> utility. You can find the utility in the <a id="h180273" class="englishcrossreferencetemplate" href="#184793" target="_self">distribution kit</a>.</p>
<p class="bodytext">The <code class="programcharacter">install</code> utility upgrades Kaspersky Scan Engine when the program meets the following requirements:</p>
<ul class="listbullet1"><li class="listbullet1">Kaspersky Scan Engine is already installed on the computer (that is, the <code class="programcharacter">/opt/kaspersky/ScanEngine</code> directory exists).<p class="listcontinue1">If Kaspersky Scan Engine is not installed on the computer, the <code class="programcharacter">install</code> utility performs <a id="h193036" class="englishcrossreferencetemplate" href="#192977" target="_self">automatic installation</a>.</p>
</li><li class="listbullet1">The version of Kaspersky Scan Engine that is already installed is 2.0 or later, and this version is earlier than the version being installed during the upgrade.<p class="listcontinue1">If Kaspersky Scan Engine version does not meet this requirement, the <code class="programcharacter">install</code> utility displays an error message, and then exits.</p>
</li></ul><p class="bodytext">When upgrading Kaspersky Scan Engine, the <code class="programcharacter">install</code> utility backs up important objects such as configuration files, TLS certificates, and the license. Successful upgrade means that all of these objects are already integrated into the new version of Kaspersky Scan Engine. If the upgrade fails for some reason, the <code class="programcharacter">install</code> utility restores the previous version of Kaspersky Scan Engine, including objects that were backed up.</p>
<p class="introheading">Stopping instances of Kaspersky Scan Engine</p>
<p class="bodytext">If the Kaspersky Scan Engine instance being upgraded is a part of a cluster, you need to stop all instances in the cluster before the upgrade.</p>
<p class="bodytext">It is important to stop all instances because the <code class="programcharacter">install</code> utility modifies the <code class="programcharacter">kavebase</code> database when upgrading Kaspersky Scan Engine.</p>
<p class="procedureheading">To stop the Kaspersky Scan Engine instance:</p>
<ul class="listbullet1"><li class="listbullet1">If an instance works in ICAP mode, run <code class="programcharacter">service kavicapd stop.</code></li><li class="listbullet1">If an instance works in HTTP mode, run <code class="programcharacter">service kavhttpd stop.</code></li><li class="listbullet1">If an instance uses the Kaspersky Scan Engine GUI, run <code class="programcharacter">service klScanEngineUI stop.</code></li></ul><p class="introheading">Upgrading Kaspersky Scan Engine</p>
<p class="procedureheading">To upgrade Kaspersky Scan Engine automatically:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure that you have root (administrator) privileges.</li><li class="listnumber1">Run <code class="programcharacter">install</code>.</li><li class="listnumber1">Read the End User License Agreement (EULA) for Kaspersky Scan Engine.<p class="listcontinue1">If you agree with the terms of the EULA, accept it. If you decline to accept the terms of the EULA, the upgrade will be canceled.</p>
</li><li class="listnumber1">If you agreed to use Kaspersky Security Network (KSN) earlier, the install utility displays the current terms of the EULA for KSN and the Privacy Policy. Read the new EULA for KSN and the Privacy Policy.<p class="listcontinue1">If you agree with the terms of the EULA and the Privacy Policy, accept them. If you decline the terms of the EULA for KSN or the Privacy Policy, you will not be able to use KSN, but the upgrade will continue. You can enable KSN later by using <a id="h182505" class="englishcrossreferencetemplate" href="#179699" target="_self">Kaspersky Scan Engine GUI</a> or the Kaspersky Scan Engine configuration file (<a id="h201090" class="englishcrossreferencetemplate" href="#201022" target="_self">HTTP</a> or <a id="h201224" class="englishcrossreferencetemplate" href="#200603" target="_self">ICAP</a>).</p>
</li><li class="listnumber1">Specify the absolute path to the directory that contains the KAV SDK package.<p class="listcontinue1">The KAV SDK package is located in a separate directory, starting with Kaspersky Scan Engine version 2.1.</p>
</li></ol><p class="bodytext">After you specify the necessary data, Kaspersky Scan Engine is upgraded, and then started.</p>
<p class="bodytext">After you upgrade Kaspersky Scan Engine, you can check the integrity of its components at any time by <a id="h209330" class="englishcrossreferencetemplate" href="#209025" target="_self">using the integrity check tool</a>.</p>
<p class="introheading">Migration from the init script to the systemd unit file</p>
<p class="bodytext">Starting from Kaspersky Scan Engine version 2.1, the <code class="programcharacter">init</code> script is no longer supported. Instead of this script, you can use the <code class="programcharacter">systemd</code> unit file.</p>
<p class="bodytext">If you used the <code class="programcharacter">init</code> script to manage Kaspersky Scan Engine in previous versions, the <code class="programcharacter">install</code> utility automatically performs the migration from the <code class="programcharacter">init</code> script to <code class="programcharacter">systemd</code> during the upgrade.</p>
<p class="bodytext">Learn more about using <code class="programcharacter">systemd</code> in <a id="h209554" class="englishcrossreferencetemplate" href="#184956" target="_self">HTTP mode</a> and <a id="h209555" class="englishcrossreferencetemplate" href="#192397" target="_self">ICAP mode</a>.</p>
<p class="introheading">Adding new elements to the configuration files</p>
<p class="bodytext">There are new elements added in the new version of Kaspersky Scan Engine.  The <code class="programcharacter">install</code> utility does not add these elements to the configuration files during the upgrade. You can add the new elements by using the <a id="h180139" class="englishcrossreferencetemplate" href="#179683" target="_self">Kaspersky Scan Engine GUI</a>, or directly to the <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">kavhttpd.xml</a> and <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">kavicapd.xml</a> configuration files. See also the detailed information about <a id="h222091" class="englishcrossreferencetemplate" href="#209374" target="_self">the new elements in the configuration file</a>.</p>
<p class="introheading">Clearing browser cache</p>
<p class="bodytext">If you are using the Kaspersky Scan Engine GUI, clear your browser cache after the upgrade.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="209771"><p><a name=209771 style="display: none;">[Topic 209771]</a></p>
	<h2 id="t234445" class="heading2">Manual upgrade (Linux)</h2>
<p class="bodytext">This section describes how to upgrade Kaspersky Scan Engine manually.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#225714" target="_self">Manually upgrading Kaspersky Scan Engine 2.0 and later</a></p><p class="relateditem"><a href="#225715" target="_self">Manually upgrading Kaspersky Scan Engine 1.0</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="225714"><p><a name=225714 style="display: none;">[Topic 225714]</a></p>
	<h3 id="t234449" class="heading3">Manually upgrading Kaspersky Scan Engine 2.0 and later</h3>
<p class="procedureheading">To upgrade Kaspersky Scan Engine 2.0 and later manually:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure you have root (administrator) privileges.</li><li class="listnumber1"><em class="emphasischaracter">For Kaspersky Scan Engine 2.0. </em>Stop Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">If you use Kaspersky Scan Engine in ICAP mode, run this command:<p class="listcontinue2"><code class="programcharacter">/etc/init.d/kavicapd stop</code></p>
</li><li class="listbullet2">If you use Kaspersky Scan Engine in HTTP mode, run this command:<p class="listcontinue2"><code class="programcharacter">/etc/init.d/kavhttpd stop</code></p>
</li><li class="listbullet2">If you use Kaspersky Scan Engine GUI, run this command:<p class="listcontinue2"> <code class="programcharacter">/etc/init.d/klScanEngineUI stop</code></p>
</li></ul></li><li class="listnumber1"><em class="emphasischaracter">For Kaspersky Scan Engine 2.1 and later. </em>Stop Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">If you used Kaspersky Scan Engine in ICAP mode, run this command:<p class="listcontinue2"><code class="programcharacter">service kavicapd stop</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine in HTTP mode, run this command:<p class="listcontinue2"><code class="programcharacter">service kavhttpd stop</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine GUI, run this command:<p class="listcontinue2">s<code class="programcharacter">ervice klScanEngineUI stop</code></p>
</li></ul></li><li class="listnumber1">Create backup copies of the following data:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">/opt/kaspersky/ScanEngine/etc/klScanEngineUI.xml</code></li><li class="listbullet2">If Kaspersky Scan Engine worked in ICAP mode:<ul class="listbullet3"><li class="listbullet3"><code class="programcharacter">/opt/kaspersky/ScanEngine/etc/kavicapd.xml</code></li><li class="listbullet3"><code class="programcharacter">/opt/kaspersky/ScanEngine/icap_data</code>, if you configured ICAP rules in <code class="programcharacter">kavicapd_gui_rules.conf</code></li></ul></li><li class="listbullet2">If Kaspersky Scan Engine worked in HTTP mode: <ul class="listbullet3"><li class="listbullet3"><code class="programcharacter">/opt/kaspersky/ScanEngine/etc/kavhttpd.xml</code></li><li class="listbullet3">If Kaspersky Scan Engine used TLS, you need to copy the private key and certificate generated for use in TLS connections. The location of these files is specified in the <code class="programcharacter">TlsCertificateKeyFile</code> and <code class="programcharacter">TlsCertificateFile</code> elements of the <code class="programcharacter">kavhttpd.xml</code> configuration file.</li></ul></li><li class="listbullet2">If you generated a certificate and a private key to use with the Kaspersky Scan Engine GUI, copy the certificate and the private key.<p class="listcontinue2">You can find information on the location of the certificate and private key in the <code class="programcharacter">SSLCertificatePath</code> and <code class="programcharacter">SSLPrivateKeyPath</code> elements of the <code class="programcharacter">klScanEngineUI.xml</code> file.</p>
</li><li class="listbullet2">The key file (if Kaspersky Scan Engine was activated in <a id="h180864" class="englishcrossreferencetemplate" href="#179852" target="_self">offline licensing mode</a>) or the activation code (if Kaspersky Scan Engine was activated in <a id="h180819" class="englishcrossreferencetemplate" href="#179855" target="_self">online licensing mode</a>).<p class="listcontinue2">You can find information on the location of the key file or activation code in the <code class="programcharacter">LicensePath</code> element of the <code class="programcharacter">kavhttpd.xml</code> configuration file (if Kaspersky Scan Engine worked in HTTP mode) or <code class="programcharacter">kavicapd.xml</code> configuration file (if Kaspersky Scan Engine worked in ICAP mode).</p>
</li></ul></li><li class="listnumber1">In the <code class="programcharacter">/opt/kaspersky/ScanEngine</code> directory, uninstall Kaspersky Scan Engine with <code class="programcharacter">uninstall.</code><p class="listcontinue1">If you used the Kaspersky Scan Engine GUI and you want to continue using the <code class="programcharacter">kavebase</code> database created earlier in PostgreSQL, you do not need to submit the deletion of data from this database. However, you need to upgrade the database with the following command:</p>
<p class="listcontinue1"><code class="programcharacter">psql -d kavebase -a -f %tempdir%/samples/migrate.sql</code></p>
<p class="listcontinue1">The above command imports the contents of <code class="programcharacter">%tempdir%/samples/migrate.sql</code>.</p>
<p class="listcontinue1"><code class="programcharacter">%tempdir%</code> in this command is the directory that contains the unpacked Kaspersky Scan Engine distribution kit contents.</p>
<p class="listcontinue1">Make sure that the user running the database queries has access to the directory containing <code class="programcharacter">migrate.sql</code> and also has read access to <code class="programcharacter">migrate.sql</code> itself.</p>
<p class="warningcontinue1">Do not use migrate.sql to upgrade the database used by Kaspersky Scan Engine version below 2.0.</p>
<p class="listcontinue1">You also need to specify the same username and password as used to connect to the previous version of the database. You can specify the username and password later, during the installation of Kaspersky Scan Engine.</p>
<p class="listcontinue1">If you forgot the username or password, <a id="h226775" class="expandingblocktemplate" href="javascript:toggleBlock('226775')" target="_self">use the psql utility</a>.</p>
<div id="d226775" class="expandingblock" ><p class="bodytext">If you forgot the username or password used to connect to the database, use the psql utility to get the username or to change the password.</p>
<p class="bodytext">To see the database <span class="boldcharacter">username</span>, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">postgres=# \l kavebase</p>
</td>
</tr>

</table>
<p class="bodytext">The psql utility displays information about the database name and its owner (username):</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">List of databases</p>
<p class="program">-[ RECORD 1 ]-----+--------------------------</p>
<p class="program">Name              | kavebase</p>
<p class="program">Owner             | scanengine </p>
</td>
</tr>

</table>
<p class="bodytext">If you forgot the <span class="boldcharacter">password</span>, you need to change it with the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">alter user %USERNAME% with password '%PASSWORD%'; </p>
</td>
</tr>

</table>
<p class="bodytext">Here, <code class="programcharacter">%PASSWORD%</code> is the new password for the <code class="programcharacter">%USERNAME%</code> user.</p>
</div></li><li class="listnumber1">Remove files form the directory <code class="programcharacter">/opt/kaspersky/ScanEngine/</code> or delete this directory.</li><li class="listnumber1">Install the new version of Kaspersky Scan Engine with the <a id="h193036" class="englishcrossreferencetemplate" href="#192977" target="_self">installer</a>.</li><li class="listnumber1">Stop Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">If you used Kaspersky Scan Engine in ICAP mode, run this command:<p class="listcontinue2"><code class="programcharacter">service kavicapd stop</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine in HTTP mode, run this command:<p class="listcontinue2"><code class="programcharacter">service kavhttpd stop</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine GUI, run this command:<p class="listcontinue2">s<code class="programcharacter">ervice klScanEngineUI stop</code></p>
</li></ul></li><li class="listnumber1">Copy data that you backed up earlier:<ul class="listbullet2"><li class="listbullet2">Copy<code class="programcharacter"> klScanEngineUI.xml</code> to <code class="programcharacter">/opt/kaspersky/ScanEngine/etc/</code></li><li class="listbullet2">If the previous version of Kaspersky Scan Engine worked in ICAP mode:<ul class="listbullet3"><li class="listbullet3">Copy <code class="programcharacter">kavicapd.xml</code> to <code class="programcharacter">/opt/kaspersky/ScanEngine/etc/</code></li><li class="listbullet3">Copy data from <code class="programcharacter">icap_data</code> to <code class="programcharacter">/opt/kaspersky/ScanEngine/icap_data</code>, if you configured ICAP rules in <code class="programcharacter">kavicapd_gui_rules.conf </code></li></ul></li><li class="listbullet2">If the previous version of Kaspersky Scan Engine worked in HTTP mode, copy <code class="programcharacter">kavhttpd.xml</code> to <code class="programcharacter">/opt/kaspersky/ScanEngine/etc/</code></li><li class="listbullet2">If you made copies of the private key and certificate to connect via TLS in HTTP mode, copy the private key and certificate to the directories, specified in the <code class="programcharacter">TlsCertificateKeyFile</code> and <code class="programcharacter">TlsCertificateFile</code> elements of the <code class="programcharacter">kavhttpd.xml</code> configuration file.<p class="listcontinue2">Make sure that only users with administrator rights have read access to the certificate and the private key.</p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine GUI and you made copies of the certificate and the private key, place them in the locations that are specified in the <code class="programcharacter">SSLCertificatePath</code> and <code class="programcharacter">SSLPrivateKeyPath</code> elements of the <code class="programcharacter">klScanEngineUI.xml</code> file, respectively.<p class="listcontinue2">Make sure that only users with administrator rights have read access to the certificate and the private key.</p>
</li><li class="listbullet2">Make sure that the key file (if the previous version of Kaspersky Scan Engine was activated in <a id="h180864_2" class="englishcrossreferencetemplate" href="#179852" target="_self">offline licensing mode</a>) or the activation code (if the previous version of Kaspersky Scan Engine was activated in <a id="h180819_2" class="englishcrossreferencetemplate" href="#179855" target="_self">online licensing mode</a>) is located in the correct directory. <p class="listcontinue2">You can find information on the location of the key file or activation code in the <code class="programcharacter">LicensePath</code> element of the <code class="programcharacter">kavhttpd.xml</code> configuration file (if Kaspersky Scan Engine worked in HTTP mode) or <code class="programcharacter">kavicapd.xml</code> configuration file (if Kaspersky Scan Engine worked in ICAP mode).</p>
</li></ul></li><li class="listnumber1">Run Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">To use Kaspersky Scan Engine in ICAP mode, run <code class="programcharacter">service kavicapd start</code></li><li class="listbullet2">To use Kaspersky Scan Engine in HTTP mode, run <code class="programcharacter">service kavhttpd start</code></li><li class="listbullet2">To use the Kaspersky Scan Engine GUI, run <code class="programcharacter">service klScanEngineUI start</code></li></ul></li><li class="listnumber1">If you are using the Kaspersky Scan Engine GUI, clear your browser cache after the upgrade.</li></ol><p class="attentionbody">If you decided to use the same <code class="programcharacter">kavebase</code> database when installing the new version of Kaspersky Scan Engine, the password you specified in the previous version for Kaspersky Scan Engine GUI administrator remains valid, it is not reset to the default password.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="225715"><p><a name=225715 style="display: none;">[Topic 225715]</a></p>
	<h3 id="t234448" class="heading3">Manually upgrading Kaspersky Scan Engine 1.0</h3>
<p class="procedureheading">To manually upgrade Kaspersky Scan Engine 1.0:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure you have root (administrator) privileges.</li><li class="listnumber1">Stop Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">If you use Kaspersky Scan Engine in ICAP mode, run this command:<p class="listcontinue2"><code class="programcharacter">/etc/init.d/kavicapd stop</code></p>
</li><li class="listbullet2">If you use Kaspersky Scan Engine in HTTP mode, run this command:<p class="listcontinue2"><code class="programcharacter">/etc/init.d/kavhttpd stop</code></p>
</li><li class="listbullet2">If you use Kaspersky Scan Engine GUI, run this command:<p class="listcontinue2"> <code class="programcharacter">/etc/init.d/klScanEngineUI stop</code></p>
</li></ul></li><li class="listnumber1">Create backup copies of the following data:<ul class="listbullet2"><li class="listbullet2">If Kaspersky Scan Engine worked in ICAP mode and you configured ICAP rules in <code class="programcharacter">kavicapd_gui_rules.conf</code>, you need to copy <code class="programcharacter">/opt/kaspersky/ScanEngine/icap_data</code>.</li><li class="listbullet2">If you generated a certificate and a private key to use with the Kaspersky Scan Engine GUI, copy the certificate and the private key.<p class="listcontinue2">You can find information on the location of the certificate and private key in the <code class="programcharacter">SSLCertificatePath</code> and <code class="programcharacter">SSLPrivateKeyPath</code> elements of the <code class="programcharacter">klScanEngineUI.xml</code> file.</p>
</li><li class="listbullet2">The key file (if Kaspersky Scan Engine was activated in <a id="h180864" class="englishcrossreferencetemplate" href="#179852" target="_self">offline licensing mode</a>) or the activation code (if Kaspersky Scan Engine was activated in <a id="h180819" class="englishcrossreferencetemplate" href="#179855" target="_self">online licensing mode</a>).<p class="listcontinue2">You can find information on the location of the key file or activation code in the <code class="programcharacter">LicensePath</code> element of the <code class="programcharacter">kavhttpd.xml</code> configuration file (if Kaspersky Scan Engine worked in HTTP mode) or <code class="programcharacter">kavicapd.xml</code> configuration file (if Kaspersky Scan Engine worked in ICAP mode).</p>
</li></ul></li><li class="listnumber1">In the <code class="programcharacter">/opt/kaspersky/ScanEngine</code> directory, uninstall Kaspersky Scan Engine with <code class="programcharacter">uninstall.</code><p class="listcontinue1">If you used the Kaspersky Scan Engine GUI, you also need to confirm deletion of data from the <code class="programcharacter">kavebase</code> database. The structure of database in Kaspersky Scan Engine 1.0 differs significantly from the new version, so you cannot use the old database with the new version of Kaspersky Scan Engine.</p>
</li><li class="listnumber1">Remove files form the directory <code class="programcharacter">/opt/kaspersky/ScanEngine/</code> or delete this directory.</li><li class="listnumber1">Install the new version of Kaspersky Scan Engine with the <a id="h193036" class="englishcrossreferencetemplate" href="#192977" target="_self">installer</a>.</li><li class="listnumber1">Stop Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">If you used Kaspersky Scan Engine in ICAP mode, run this command:<p class="listcontinue2"><code class="programcharacter">service kavicapd stop</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine in HTTP mode, run this command:<p class="listcontinue2"><code class="programcharacter">service kavhttpd stop</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine GUI, run this command:<p class="listcontinue2">s<code class="programcharacter">ervice klScanEngineUI stop</code></p>
</li></ul></li><li class="listnumber1">Copy data that you backed up earlier:<ul class="listbullet2"><li class="listbullet2">Copy <code class="programcharacter">klScanEngineUI.xml</code> to <code class="programcharacter">/opt/kaspersky/ScanEngine/etc/</code> </li><li class="listbullet2">To be able to use Kaspersky Scan Engine GUI:<ol class="listalpha3"><li class="listalpha3">Go to <code class="programcharacter">/opt/kaspersky/ScanEngine/tools/</code></li><li class="listalpha3">Run the following command:<p class="listcontinue3"><code class="programcharacter">./kav_encrypt -d '%USERNAME%:%PASSWORD%'</code></p>
<p class="listcontinue3">Here, <code class="programcharacter">%USERNAME%</code> and <code class="programcharacter">%PASSWORD%</code> are the username and password used to connect to the <code class="programcharacter">kavebase</code> database.</p>
<p class="listcontinue3">If you forgot the username or password, <a id="h226775" class="expandingblocktemplate" href="javascript:toggleBlock('226775')" target="_self">use the psql utility</a>.</p>
<div id="d226775" class="expandingblock" ><p class="bodytext">If you forgot the username or password used to connect to the database, use the psql utility to get the username or to change the password.</p>
<p class="bodytext">To see the database <span class="boldcharacter">username</span>, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">postgres=# \l kavebase</p>
</td>
</tr>

</table>
<p class="bodytext">The psql utility displays information about the database name and its owner (username):</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">List of databases</p>
<p class="program">-[ RECORD 1 ]-----+--------------------------</p>
<p class="program">Name              | kavebase</p>
<p class="program">Owner             | scanengine </p>
</td>
</tr>

</table>
<p class="bodytext">If you forgot the <span class="boldcharacter">password</span>, you need to change it with the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">alter user %USERNAME% with password '%PASSWORD%'; </p>
</td>
</tr>

</table>
<p class="bodytext">Here, <code class="programcharacter">%PASSWORD%</code> is the new password for the <code class="programcharacter">%USERNAME%</code> user.</p>
</div></li></ol></li><li class="listbullet2">If the previous version of Kaspersky Scan Engine worked in ICAP mode and you configured ICAP rules in <code class="programcharacter">kavicapd_gui_rules.conf</code>, copy data from <code class="programcharacter">/opt/kaspersky/ScanEngine/icap_data</code>.</li><li class="listbullet2">If you used Kaspersky Scan Engine GUI and you made copies of the certificate and the private key, place them in the locations that are specified in the <code class="programcharacter">SSLCertificatePath</code> and <code class="programcharacter">SSLPrivateKeyPath</code> elements of the <code class="programcharacter">klScanEngineUI.xml</code> file, respectively.<p class="listcontinue2">Make sure that only users with administrator rights have read access to the certificate and the private key.</p>
</li><li class="listbullet2">Make sure that the key file (if the previous version of Kaspersky Scan Engine was activated in <a id="h180864_2" class="englishcrossreferencetemplate" href="#179852" target="_self">offline licensing mode</a>) or the activation code (if the previous version of Kaspersky Scan Engine was activated in <a id="h180819_2" class="englishcrossreferencetemplate" href="#179855" target="_self">online licensing mode</a>) is located in the correct directory. <p class="listcontinue2">You can find information on the location of the key file or activation code in the <code class="programcharacter">LicensePath</code> element of the <code class="programcharacter">kavhttpd.xml</code> configuration file (if Kaspersky Scan Engine worked in HTTP mode) or <code class="programcharacter">kavicapd.xml</code> configuration file (if Kaspersky Scan Engine worked in ICAP mode).</p>
</li></ul></li><li class="listnumber1">Run Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">To use Kaspersky Scan Engine in ICAP mode, run <code class="programcharacter">service kavicapd start</code></li><li class="listbullet2">To use Kaspersky Scan Engine in HTTP mode, run <code class="programcharacter">service kavhttpd start</code></li><li class="listbullet2">To use the Kaspersky Scan Engine GUI, run <code class="programcharacter">service klScanEngineUI start</code></li></ul></li><li class="listnumber1">If you are using the Kaspersky Scan Engine GUI, clear your browser cache after the upgrade.</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="96464"><p><a name=96464 style="display: none;">[Topic 96464]</a></p>
	<h1 id="t234554" class="heading1">Updating the anti-malware database and updatable modules</h1>
<p class="bodytext">Kaspersky Scan Engine uses updatable modules and the anti-malware database that allow you to extend detection functionality. </p>
<p class="bodytext">This section explains how to update the anti-malware database and updatable modules of Kaspersky Scan Engine, and describes the best practices for updating.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#218188" target="_self">About updating</a></p><p class="relateditem"><a href="#218259" target="_self">Database backup and recovery</a></p><p class="relateditem"><a href="#218262" target="_self">Reduced anti-malware databases kit usage</a></p><p class="relateditem"><a href="#218298" target="_self">Best practices for database updates</a></p><p class="relateditem"><a href="#218349" target="_self">Updating from an HTTPS server</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="218188"><p><a name=218188 style="display: none;">[Topic 218188]</a></p>
	<h2 id="t234270" class="heading2">About updating</h2>
<p class="bodytext">Updating the anti-malware database and updatable modules on a regular basis ensures that Kaspersky Scan Engine provides a consistent level of security. See also <a id="h218299" class="englishcrossreferencetemplate" href="#218298" target="_self">best practices for database updates</a>.</p>
<p class="bodytext">To update the database and modules, you must have a valid KEY file or an activation code for Kaspersky Scan Engine.</p>
<p class="warningbody">When the anti-malware database and modules are updated, the encrypted <code class="programcharacter">User-Agent</code> string of Kaspersky Scan Engine is transferred to Kaspersky. See also the full list of data that is <a id="h180101" class="englishcrossreferencetemplate" href="#180001" target="_self">transferred to Kaspersky during an update</a>.</p>
<p class="bodytext">Kaspersky Scan Engine supports the following methods of updating:</p>
<ul class="listbullet1"><li class="listbullet1">Regular updating by using the built-in functionality of Kaspersky Scan Engine<p class="listcontinue1">This method does not require any additional software to be installed.</p>
<p class="listcontinue1">This is the recommended method of updating.</p>
</li><li class="listbullet1">Updating by using Updater SDK<p class="listcontinue1">You can use Updater SDK to download updates and to create mirror servers for updates.</p>
<p class="listcontinue1">Updater SDK, including the documentation on Updater SDK API, is delivered as a separate package.</p>
</li><li class="listbullet1">Manual updating<p class="listcontinue1">This method is not recommended.</p>
</li></ul><p class="introheading">Updating by using the built-in functionality of Kaspersky Scan Engine</p>
<p class="listheading">To configure regular updates by using the built-in functionality of Kaspersky Scan Engine:</p>
<ul class="listbullet1"><li class="listbullet1">If you are using Kaspersky Scan Engine in HTTP mode, <a id="h180054" class="englishcrossreferencetemplate" href="#179873" target="_self">configure updating for HTTP mode</a>.</li><li class="listbullet1">If you are using Kaspersky Scan Engine in ICAP mode, <a id="h180564" class="englishcrossreferencetemplate" href="#179902" target="_self">configure updating for ICAP mode</a>.</li><li class="listbullet1">You can also <a id="h201469" class="englishcrossreferencetemplate" href="#179701" target="_self">configure updating in Kaspersky Scan Engine GUI</a>.</li></ul><p class="introheading">Updating by using Updater SDK</p>
<p class="bodytext">Updater SDK allows you to update Kaspersky Scan Engine and to create mirrors that keep your own copies of updates for updatable modules and the anti-malware database downloaded from the Kaspersky update servers. These mirrors can be deployed within the boundaries of a local enterprise network, allowing you to retrieve updates once, and then redistribute the updates to multiple endpoints within the local network and without having to contact the Kaspersky update servers each time. You can also use Updater SDK to download the updated anti-malware database to computers with Kaspersky Scan Engine installed.</p>
<p class="bodytext">For more information about updating with Updater SDK, see the Updater SDK documentation. You can get the Updater SDK documentation from the person at Kaspersky who provided you with the Kaspersky Scan Engine distribution kit.</p>
<p class="introheading">Manual updating</p>
<p class="attentionbody">Manual updating is not recommended.</p>
<p class="bodytext">You can run an update manually in the following ways:</p>
<ul class="listbullet1"><li class="listbullet1">Update the anti-virus database on demand <a id="h179933" class="englishcrossreferencetemplate" href="#179882" target="_self">in HTTP mode</a>.</li><li class="listbullet1">Update the anti-virus database by sending a <code class="programcharacter">SIGUSR2</code> signal <a id="h180564_2" class="englishcrossreferencetemplate" href="#179902" target="_self">in ICAP mode</a>.</li><li class="listbullet1">On the <a id="h180278" class="englishcrossreferencetemplate" href="#179695" target="_self">Kaspersky Scan Engine dashboard</a>, by clicking the <span class="guicharacter">Update</span> button.</li></ul><p class="introheading">About the update procedure</p>
<p class="bodytext">Updates are available through the Kaspersky update servers, which are dedicated servers on the Internet operated by Kaspersky that have the most recent versions of files provided by Kaspersky. Kaspersky Scan Engine can also download updates from mirror servers created with Updater SDK.</p>
<p class="attentionbody">When the update is performed from the Kaspersky infrastructure, data is transmitted over a secure channel. The HTTPS (TLS) protocol can be used. The protocol to use is selected by the Kaspersky infrastructure.</p>
<p class="bodytext">The following data is downloaded during the update procedure of Kaspersky Scan Engine:</p>
<ul class="listbullet1"><li class="listbullet1">Malware definition files<p class="listcontinue1">Malware definitions store malware signature data. Scanning components of Kaspersky Scan Engine use these definitions for detection.</p>
</li><li class="listbullet1">Updates for updatable modules<p class="listcontinue1">Updatable modules implement enhanced detection methods in Kaspersky Scan Engine.</p>
</li></ul><p class="bodytext">Updates are performed by using a differential updating technique. This technique allows Kaspersky Scan Engine to update files by downloading only the part of the file that has changed since the last update.</p>
<p class="introheading">Getting information about the current anti-malware database</p>
<p class="bodytext">You can get information about the current anti-malware database in the following ways:</p>
<ul class="listbullet1"><li class="listbullet1">On the <a id="h180278_2" class="englishcrossreferencetemplate" href="#179695" target="_self">Kaspersky Scan Engine dashboard</a>.</li><li class="listbullet1">Sending <a id="h193115" class="englishcrossreferencetemplate" href="#193005" target="_self">an HTTP request</a> (in HTTP mode).</li><li class="listbullet1">Getting the status of the <code class="programcharacter">kavicapd</code> service by using the <code class="programcharacter"><a id="h209555" class="englishcrossreferencetemplate" href="#192397" target="_self">status</a></code> command (in ICAP mode).</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="218259"><p><a name=218259 style="display: none;">[Topic 218259]</a></p>
	<h2 id="t234318" class="heading2">Database backup and recovery</h2>
<p class="bodytext">The anti-malware database can be damaged if connectivity issues occur while Kaspersky Scan Engine is downloading updates. For this reason, Kaspersky Scan Engine has a mechanism of automatic database recovery.</p>
<p class="bodytext">You can configure backup in the following ways:</p>
<ul class="listbullet1"><li class="listbullet1">Use the <span class="guicharacter">Back up the anti-virus database</span> toggle switch in <a id="h201469" class="englishcrossreferencetemplate" href="#179701" target="_self">Kaspersky Scan Engine GUI</a>. To enable backup, turn on this toggle switch.</li><li class="listbullet1">Specify the <a id="h201079" class="englishcrossreferencetemplate" href="#200649" target="_self">DisableBackup</a> parameter in the kavhttpd.xml configuration file (<a id="h193041" class="englishcrossreferencetemplate" href="#192979" target="_self">HTTP mode</a>). To enable backup, set this parameter to <code class="programcharacter">0</code>.</li><li class="listbullet1">Specify the <a id="h201186" class="englishcrossreferencetemplate" href="#200709" target="_self">DisableBackup</a> parameter in the kavicapd.xml configuration file (<a id="h180141" class="englishcrossreferencetemplate" href="#184798" target="_self">ICAP mode</a>). To enable backup, set this parameter to <code class="programcharacter">0</code>.</li></ul><p class="attentionbody">Make sure that your hard disk has enough free space for a full copy of the database. </p>
<p class="bodytext">If KAV Engine cannot start with a newly updated database, Kaspersky Scan Engine automatically restores the previous version of the database from the backup copy during the next initialization. </p>
<p class="bodytext">After the database recovery is completed, Kaspersky Scan Engine deletes the backup copy. If no backup copy is found, Kaspersky Scan Engine tries to initialize with the current database.</p>
<p class="bodytext">When connectivity issues are resolved, try to update again.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="218262"><p><a name=218262 style="display: none;">[Topic 218262]</a></p>
	<h2 id="t234475" class="heading2">Reduced anti-malware databases kit usage</h2>
<p class="bodytext">You can use the reduced databases kit instead of the full databases kit. The reduced databases kit is smaller in size than the full kit and takes up less RAM when used. To ensure the same detection rate as when using the full databases kit, you must use the reduced kit together with KSN.</p>
<p class="introheading">Reduced anti-malware databases kit and KSN</p>
<p class="bodytext">It is not recommended to use the reduced databases kit without KSN, because the detection rate will be lower than when using the full database kit. If there is no connection to the KSN servers (for example, when access to the Internet becomes unavailable), it is recommended to switch to the full databases kit.</p>
<p class="bodytext">If you download databases to mirror servers, always update both the reduced and full databases kits, so that the full kit will be up-to-date when Kaspersky Scan Engine switches to it.</p>
<p class="introheading">Switching to the reduced databases kit by using the built-in functionality of Kaspersky Scan Engine</p>
<p class="bodytext">The instruction below shows the scenario of switching to the reduced databases kit by using the built-in functionality of Kaspersky Scan Engine.</p>
<p class="procedureheading">To switch to the reduced databases kit:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure that the current license supports KSN usage.</li><li class="listnumber1">Enable KSN by using one of the following methods:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">KAV_SHT_ENGINE_KSN</code> flag in HTTP mode.</li><li class="listbullet2"><code class="programcharacter">UseKSN</code> parameter of the <code class="programcharacter">KSNSetting</code> section of the <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">ICAP mode configuration file</a> in ICAP mode.<p class="listcontinue2">Make sure that you have read and accepted the End User License Agreement (EULA). You can find the text of the EULA in <code class="programcharacter">/doc/ksn_license.txt</code>. To accept the EULA, the parameter <code class="programcharacter">Settings &gt; EULA &gt; KSN</code> in the <code class="programcharacter">klScanEngineUI.xml</code> configuration file must be set to <code class="programcharacter">accepted</code>.</p>
</li><li class="listbullet2"><span class="guicharacter">Enable reputation checking</span> toggle switch in the <a id="h182505" class="englishcrossreferencetemplate" href="#179699" target="_self">scanning settings</a> of Kaspersky Scan Engine GUI.</li></ul></li><li class="listnumber1">To start using the reduced databases kit, in HTTP and ICAP modes, specify <code class="programcharacter">1</code> for the <code class="programcharacter">UseReducedBases</code> parameter of the <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">kavhttpd.xml</a> and <a id="h180154_2" class="englishcrossreferencetemplate" href="#192989" target="_self">kavicapd.xml</a> configuration files. By default, the value is <code class="programcharacter">0</code>.</li><li class="listnumber1">Restart <code class="programcharacter">kavhttpd</code> (in HTTP mode) or <code class="programcharacter">kavicapd</code> (in ICAP mode).</li></ol><p class="attentionbody">Notice that the full databases kit is not removed and remains on the hard drive.</p>
<p class="introheading">Switching to the full databases kit by using the built-in functionality of Kaspersky Scan Engine</p>
<p class="bodytext">The scenario below demonstrates how to switch to the full databases kit by using the built-in functionality of Kaspersky Scan Engine.</p>
<p class="procedureheading">To switch to the full databases kit:</p>
<ol class="listnumber1"><li class="listnumber1">Set the <code class="programcharacter">UseReducedBases</code> parameter to <code class="programcharacter">0</code> (see <code class="programcharacter">UseReducedBases</code> for <a id="h200662" class="englishcrossreferencetemplate" href="#200655" target="_self">HTTP</a> or <a id="h200792" class="englishcrossreferencetemplate" href="#200715" target="_self">ICAP</a> mode).</li><li class="listnumber1">Restart <code class="programcharacter">kavhttpd</code> (in HTTP mode) or <code class="programcharacter">kavicapd</code> (in ICAP mode).</li></ol><p class="attentionbody">Notice that the reduced databases kit is not removed and remains on the hard drive.</p>
<p class="introheading">Switching from the full databases kit to the reduced kit and removing the full databases kit</p>
<p class="procedureheading">To switch from the full databases kit to the reduced kit, and then remove the full databases kit:</p>
<ol class="listnumber1"><li class="listnumber1">Perform steps 1 to 4 from subsection &quot;Switching to the reduced databases kit by using the built-in functionality of Kaspersky Scan Engine&quot; (see above).</li><li class="listnumber1">Click <span class="guicharacter">Update from scratch</span> on the <a id="h180278" class="englishcrossreferencetemplate" href="#179695" target="_self">Kaspersky Scan Engine dashboard</a>.</li></ol><p class="bodytext">After this, the reduced databases kit is downloaded.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="218298"><p><a name=218298 style="display: none;">[Topic 218298]</a></p>
	<h2 id="t234285" class="heading2">Best practices for database updates</h2>
<p class="bodytext">The best practices listed here help you maintain a consistent level of security in Kaspersky Scan Engine.</p>
<p class="warningbody">Avoid using an out-of-date or extremely out-of-date database. If Kaspersky Scan Engine is not up to date, maximum protection cannot be guaranteed.</p>
<p class="introheading">Do not download updates to an empty directory on regular basis</p>
<p class="warningbody">In some cases, Kaspersky public update servers do not contain some of the components to update. Therefore, we recommend that you do not regularly update databases from scratch (download the anti-virus database from an update server to an empty directory). If you do, Kaspersky Scan Engine may not start or may work incorrectly. Make sure that the target directory to which the updates are downloaded contains an existing anti-virus database. If you have problems with updating an existing anti-virus database, you can try using the anti-virus database from the distribution kit instead.</p>
<p class="introheading">Schedule a daily update</p>
<p class="bodytext">You must run the update procedure and obtain new malware definitions and updates for modules at least once an hour.</p>
<p class="bodytext">This measure reduces the risk of a scenario where KSN becomes unavailable due to an expired KSN encryption key file.</p>
<p class="bodytext">The KSN encryption key file is used to secure the communication between Kaspersky Scan Engine and KSN servers. This file is updated during the regular anti-malware database update procedure. By default, Kaspersky Scan Engine checksthe status of the KSN encryption key file during every update and if the current KSN encryption key file is expired, a new key is downloaded during the update.</p>
<p class="bodytext">The following classification must be used when considering updates.</p>
<p class="tablename">Database up-to-dateness classification</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="437" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="219"><p class="tableheading">Anti-malware database is considered</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="219"><p class="tableheading">If the update was last run</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Up to date</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Less than one day ago.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Out of date</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Less than three days ago.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Extremely out of date</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">More than a week ago.</p>
</td>
</tr>

</table>
<p class="introheading">Use the reduced anti-malware databases kit</p>
<p class="bodytext">You can use the reduced anti-malware databases kit if you want to <a id="h218348" class="englishcrossreferencetemplate" href="#218262" target="_self">reduce the hard disk space that Kaspersky Scan Engine uses</a>.</p>
<p class="introheading">Use the anti-malware databases backup</p>
<p class="bodytext">We recommend that you turn on the anti-malware databases backup. If Kaspersky Scan Engine cannot initialize after some update, it can <a id="h218441" class="englishcrossreferencetemplate" href="#218259" target="_self">restore the anti-malware databases from backup</a>.</p>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="218349"><p><a name=218349 style="display: none;">[Topic 218349]</a></p>
	<h2 id="t234553" class="heading2">Updating from an HTTPS server</h2>
<p class="attentionbody">This functionality is available starting with Kaspersky Scan Engine 2.0.</p>
<p class="bodytext">You can configure your environment for getting updates from an HTTPS server.</p>
<p class="procedureheading">To configure updating from an HTTPS server:</p>
<ol class="listnumber1"><li class="listnumber1">Create an HTTPS server as a mirror for storing the anti-virus database files.</li><li class="listnumber1">On the HTTPS server, configure Updater SDK (or the keep-up-to-date tool) to perform updating and distribution of the anti-virus database files.<p class="attentioncontinue1">You must use Updater SDK or the keep-up-to-date tool on the HTTPS server. It is not possible to create or configure the mirror server by using Kaspersky Scan Engine. You can get the Updater SDK from the person at Kaspersky who provided you with the Kaspersky Scan Engine distribution kit.</p>
</li><li class="listnumber1">On the computers that will use the HTTPS server, configure Kaspersky Scan Engine to download updates from the HTTPS server.<p class="listcontinue1">For the <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">kavhttpd</a> or <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">kavicapd</a> service, do the following:</p>
<ul class="listbullet2"><li class="listbullet2">In the <code class="programcharacter">UpdateSettings &gt; UpdatesCertFile</code> element of the <a id="h201083" class="englishcrossreferencetemplate" href="#200653" target="_self">kavhttpd</a> or <a id="h201190" class="englishcrossreferencetemplate" href="#200713" target="_self">kavicapd</a> configuration file, specify the local path to the root certificate of the key with which the TLS certificate of your HTTPS server is signed.<p class="listcontinue2">You can leave the value of this element empty.</p>
</li><li class="listbullet2">In the <code class="programcharacter">UpdateSettings &gt; UpdateSources</code> element of the <a id="h201082" class="englishcrossreferencetemplate" href="#201051" target="_self">kavhttpd</a> or <a id="h201189" class="englishcrossreferencetemplate" href="#200712" target="_self">kavicapd</a> configuration file, specify the address of the HTTPS server.</li><li class="listbullet2">In the <code class="programcharacter">UpdateSettings &gt; UseOnlyCustomSources</code> element of the <a id="h201081" class="englishcrossreferencetemplate" href="#200651" target="_self">kavhttpd</a> or <a id="h201188" class="englishcrossreferencetemplate" href="#200711" target="_self">kavicapd</a> configuration file, specify <code class="programcharacter">1</code>.</li><li class="listbullet2">In the <code class="programcharacter">UpdateSettings &gt; CertificateConfirmationAction</code> element of the <a id="h201084" class="englishcrossreferencetemplate" href="#200654" target="_self">kavhttpd </a>or <a id="h201191" class="englishcrossreferencetemplate" href="#200714" target="_self">kavicapd</a> configuration file, specify the value according to the desired action to undertake if the update server uses an untrusted certificate.</li></ul></li><li class="listnumber1">Restart Kaspersky Scan Engine.</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192979"><p><a name=192979 style="display: none;">[Topic 192979]</a></p>
	<h1 id="t234577" class="heading1">Using Kaspersky Scan Engine in HTTP mode</h1>
<p class="bodytext">This chapter contains information about using Kaspersky Scan Engine in HTTP mode.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#184921" target="_self">Kaspersky Scan Engine and HTTP mode</a></p><p class="relateditem"><a href="#210245" target="_self">HTTPS connections</a></p><p class="relateditem"><a href="#225526" target="_self">Recommended settings for HTTP mode</a></p><p class="relateditem"><a href="#192980" target="_self">Configuring Kaspersky Scan Engine in HTTP mode</a></p><p class="relateditem"><a href="#192981" target="_self">Running Kaspersky Scan Engine in HTTP mode</a></p><p class="relateditem"><a href="#192985" target="_self">Making requests in HTTP mode</a></p><p class="relateditem"><a href="#179883" target="_self">Using the sample HTTP client</a></p><p class="relateditem"><a href="#179881" target="_self">Using a proxy server</a></p><p class="relateditem"><a href="#179882" target="_self">Updating the anti-virus database in HTTP mode</a></p><p class="relateditem"><a href="#186768" target="_self">Logging in HTTP mode</a></p><p class="relateditem"><a href="#179888" target="_self">Building executable files for the HTTP service and the HTTP client</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="184921"><p><a name=184921 style="display: none;">[Topic 184921]</a></p>
	<h2 id="t234404" class="heading2">Kaspersky Scan Engine and HTTP mode</h2>
<p class="bodytext">Hypertext Transfer Protocol (HTTP) is the standard communication protocol in the client-server computer model. In HTTP mode, Kaspersky Scan Engine operates as a REST-like service that receives HTTP requests in JSON or plain text format from client applications. The service scans objects passed in these requests, and sends back HTTP responses with scan results in JSON or plain text format.</p>
<p class="bodytext">In addition, a <a id="h179932" class="englishcrossreferencetemplate" href="#179883" target="_self">sample HTTP client</a> source code is shipped in the distribution package. This sample HTTP client demonstrates how to make requests to Kaspersky Scan Engine in HTTP mode. You can also use the compiled sample to <a id="h180274" class="englishcrossreferencetemplate" href="#179884" target="_self">scan files from the command line</a>.</p>
<p class="introheading">Connection types</p>
<p class="listheading">Kaspersky Scan Engine supports two connection types:</p>
<ul class="listbullet1"><li class="listbullet1">TCP connection</li><li class="listbullet1">UNIX socket connection<p class="attentioncontinue1">For Linux systems only.</p>
</li></ul><p class="introheading">Scanning capabilities</p>
<p class="listheading">Kaspersky Scan Engine supports the following scan modes:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">scanfile</code><p class="listcontinue1">In this mode, the sample HTTP client passes file paths to Kaspersky Scan Engine, which reads the files and scans them.</p>
</li><li class="listbullet1"><code class="programcharacter">scanmemory</code><p class="listcontinue1">In this mode, the sample HTTP client passes file contents to Kaspersky Scan Engine, which scans the contents. The maximum size of an object sent for scanning in scanmemory mode is limited by the system memory of the computer.</p>
</li><li class="listbullet1"><code class="programcharacter">checkurl</code><p class="listcontinue1">In this mode, the sample HTTP client passes URLs to Kaspersky Scan Engine, which checks them for malicious and phishing addresses.</p>
</li></ul><p class="bodytext">You can scan files and URLs by making HTTP requests via <a id="h179981" class="englishcrossreferencetemplate" href="#179875" target="_self">KAV protocols version 3</a> or <a id="h180281" class="englishcrossreferencetemplate" href="#181038" target="_self">KAV protocol versions 1 and 2</a>.</p>
<p class="introheading">API token authorization</p>
<p class="bodytext">Kaspersky Scan Engine supports API token authorization.</p>
<p class="bodytext">If API token authorization is enabled, HTTP clients must specify an API token in the request header when sending requests to Kaspersky Scan Engine. This request header field used for sending an API token has a custom name. The Kaspersky Scan Engine administrator can specify this name in the <span class="guicharacter"><a id="h224242" class="englishcrossreferencetemplate" href="#224195" target="_self">Authorization</a></span> section of the Kaspersky Scan Engine GUI. The default name is <code class="programcharacter">Authorization</code>.</p>
<p class="attentionbody">If you have enabled API token authorization and the kavhttpd service is not running, starting klScanEngineUI will also initiate the start of the kavhttpd service.</p>
<p class="listheading">The usual procedure for creating and using an API token is as follows:</p>
<ol class="listnumber1"><li class="listnumber1">The Kaspersky Scan Engine administrator creates a token in the <span class="guicharacter"><a id="h224242_2" class="englishcrossreferencetemplate" href="#224195" target="_self">Authorization</a></span> section of the Kaspersky Scan Engine GUI.</li><li class="listnumber1">The Kaspersky Scan Engine administrator provides the token to the users who can use it to get access to the <code class="programcharacter">kavhttpd</code> service.</li><li class="listnumber1">When making HTTP requests, the HTTP client sends the token as the value of the authorization field in the request header. The name of the authorization field in the request header must be the same as specified in the Kaspersky Scan Engine settings (see the description of the <span class="guicharacter">Authorization header field</span> element of the <span class="guicharacter"><a id="h224242_3" class="englishcrossreferencetemplate" href="#224195" target="_self">Authorization</a></span> section).</li><li class="listnumber1">If authorization is successful, Kaspersky Scan Engine provides access to its functions.</li></ol><p class="bodytext">To try API token authorization and understand how it works, you can use the <a id="h179932_2" class="englishcrossreferencetemplate" href="#179883" target="_self">HTTP client</a> provided with Kaspersky Scan Engine: configure Kaspersky Scan Engine to authorize requests, create an API token, and then use the HTTP client to send a request containing the token. You can find the examples of such requests sent over the KAV protocol <a id="h224455" class="englishcrossreferencetemplate" href="#224307" target="_self">version 1 or 2</a> and <a id="h224456" class="englishcrossreferencetemplate" href="#224308" target="_self">version 3</a>.</p>
<p class="attentionbody">For security reasons, an <a id="h211898" class="englishcrossreferencetemplate" href="#210245" target="_self">HTTPS connection</a> is required to send requests that need authorization.</p>
<p class="introheading">Keep-Alive connections</p>
<p class="bodytext">By default, Kaspersky Scan Engine supports <a id="h207358" class="englishcrossreferencetemplate" href="#207348" target="_self">Keep-Alive connections</a>, so it can process multiple objects one after another, by using the same connection.</p>
<p class="bodytext">To open a Keep-Alive connection, an HTTP client has to add the following header to the request:</p>
<table class="tableintopic" width="162" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="162"><p class="program">Connection: Keep-Alive</p>
</td>
</tr>

</table>
<p class="bodytext">To close the connection, an HTTP client has to add the following header to the request:</p>
<table class="tableintopic" width="126" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="126"><p class="program">Connection: close</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="210245"><p><a name=210245 style="display: none;">[Topic 210245]</a></p>
	<h2 id="t234382" class="heading2">HTTPS connections</h2>
<p class="bodytext">Kaspersky Scan Engine in HTTP mode supports HTTPS to establish a secure connection. </p>
<p class="attentionbody">Kaspersky Scan Engine does not check the HTTP client certificate.</p>
<p class="bodytext">Kaspersky Scan Engine supports the following secure protocols and cipher suites:</p>
<ul class="listbullet1"><li class="listbullet1">TLS 1.3 protocol and the following cipher suites:<ul class="listbullet2"><li class="listbullet2">TLS_AES_256_GCM_SHA384</li><li class="listbullet2">TLS_CHACHA20_POLY1305_SHA256</li><li class="listbullet2">TLS_AES_128_GCM_SHA256</li></ul></li><li class="listbullet1">TLS 1.2 protocol and the following cipher suites:<ul class="listbullet2"><li class="listbullet2">TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</li><li class="listbullet2">TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384</li><li class="listbullet2">TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</li><li class="listbullet2">TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256</li><li class="listbullet2">TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</li><li class="listbullet2">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384</li><li class="listbullet2">TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</li><li class="listbullet2">TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256</li><li class="listbullet2">TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</li><li class="listbullet2">TLS_DHE_RSA_WITH_AES_256_GCM_SHA384</li><li class="listbullet2">TLS_DHE_RSA_WITH_AES_256_CBC_SHA256</li><li class="listbullet2">TLS_DHE_RSA_WITH_AES_128_CBC_SHA256</li><li class="listbullet2">TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256</li></ul></li></ul><p class="bodytext">To configure an HTTPS connection, you need to specify the following parameters in the HTTP mode configuration file:</p>
<ul class="listbullet1"><li class="listbullet1">A path to the private key file (the <code class="programcharacter"><a id="h201062" class="englishcrossreferencetemplate" href="#200613" target="_self">ServerSettings &gt; TlsCertificateKeyFile</a></code> element)</li><li class="listbullet1">A path to the certificate file (the <code class="programcharacter"><a id="h201063" class="englishcrossreferencetemplate" href="#200614" target="_self">ServerSettings &gt; TlsCertificateFile</a></code> element)</li><li class="listbullet1">The <code class="programcharacter">https</code> protocol (the <code class="programcharacter"><a id="h201056" class="englishcrossreferencetemplate" href="#201026" target="_self">ServerSettings &gt; ConnectionString</a></code> element)</li></ul><p class="bodytext">In addition, you can configure an HTTPS connection by using <a id="h201467" class="englishcrossreferencetemplate" href="#179698" target="_self">Kaspersky Scan Engine GUI</a>.</p>
<p class="bodytext">Below is an example of how to generate private key and certificate files.</p>
<p class="procedureheading">To generate a private key and a certificate (Linux):</p>
<ol class="listnumber1"><li class="listnumber1">Go to <code class="programcharacter">/opt/kaspersky/ScanEngine/tools</code>.</li><li class="listnumber1">Run the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">./openssl req -new -x509 -config openssl.cnf -newkey ec -pkeyopt ec_paramgen_curve:secp384r1 -nodes -days 3650 -subj &quot;/C=RU/CN=localhost&quot; -keyout kavhttpd.key -out kavhttpd.cert</p>
</td>
</tr>

</table>
<p class="listcontinue1">In <code class="programcharacter">/opt/kaspersky/ScanEngine/tools</code>, two files are created:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">kavhttpd.key&#8212;</code>the private key</li><li class="listbullet2"><code class="programcharacter">kavhttpd.cert&#8212;</code>the certificate</li></ul></li></ol><p class="procedureheading">To generate a private key and a certificate (Windows):</p>
<ol class="listnumber1"><li class="listnumber1">Go to <code class="programcharacter">%service_dir%\tools</code>.</li><li class="listnumber1">Run the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">openssl.exe req -new -x509 -config openssl.cnf -newkey ec -pkeyopt ec_paramgen_curve:secp384r1 -nodes -days 3650 -subj &quot;/C=RU/CN=localhost&quot; -keyout kavhttpd.key -out kavhttpd.cert</p>
</td>
</tr>

</table>
<p class="listcontinue1">In <code class="programcharacter">%service_dir%\tools</code>, two files are created:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">kavhttpd.key&#8212;</code>the private key</li><li class="listbullet2"><code class="programcharacter">kavhttpd.cert&#8212;</code>the certificate</li></ul></li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="225526"><p><a name=225526 style="display: none;">[Topic 225526]</a></p>
	<h2 id="t240944" class="heading2">Recommended settings for HTTP mode</h2>
<p class="bodytext">This section describes the recommended settings for Kaspersky Scan Engine in HTTP mode.</p>
<p class="bodytext">If you use the Kaspersky Scan Engine GUI, specify the recommended parameters as described in the table below.</p>
<p class="tablename">Recommended settings for HTTP mode in the Kaspersky Scan Engine GUI</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="521" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="193"><p class="tableheading">Settings in the Kaspersky Scan Engine GUI</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="328"><p class="tableheading">Recommended settings</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Service &gt; Keep-alive connection</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">See the description of <code class="programcharacter">KeepAliveSettings</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Service &gt; Connection timeout</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">See the description of <code class="programcharacter">TimeoutMs</code> in <code class="programcharacter">KeepAliveSettings</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Service &gt; Sessions</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">See the description of <code class="programcharacter">MaxHTTPSessionsNum </code>below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Service &gt; Connections</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">See the description of <code class="programcharacter">MaxIncomingConnectionsNum</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Service &gt; Threads</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">Twice the value of <code class="programcharacter">ScannersCount</code></p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Service &gt; Processes</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">Equal to the number of processor cores</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Enable reputation checking</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">Turn on the toggle switch</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Enable Phishing Protection</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">Turn on the toggle switch</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="bodytext">Scanning &gt; Object scan timeout</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">10000 (10 seconds)</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Heuristic analysis level</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="bodytext">Low</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Actions on detected objects</p>
</td>
<td valign="middle" style="border:1px solid #010101;" width="328"><p class="tablebodytext">See the description of <code class="programcharacter">Mode</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Size limit for the received file</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="bodytext">10343 KB (10.1 MB)</p>
<p class="attentionbody">Get an updated value from your TAM at least once a year</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Maximum depth</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">5</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="193"><p class="tablebodytext">Scanning &gt; Types of files to scan</p>
</td>
<td style="border:1px solid #010101;" width="328"><p class="tablebodytext">Select the checkbox:</p>
<ul class="tablelistbullet"><li class="tablelistbullet">Packed objects</li><li class="tablelistbullet">Archives</li><li class="tablelistbullet">Emails databases</li><li class="tablelistbullet">Emails</li></ul></td>
</tr>

</table>
<p class="bodytext">If you do not use the Kaspersky Scan Engine GUI, specify the recommended parameters in the kavhttpd.xml configuration file as described in the table below.</p>
<p class="tablename">Recommended settings for HTTP mode in the configuration file</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="512" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="180"><p class="tableheading">Parameter in kavhttpd.xml</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="332"><p class="tableheading">Recommended settings</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">ScannersCount</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="bodytext">Equal to the number of processor cores</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">ThreadsCount</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="bodytext">Twice the value of <code class="programcharacter">ScannersCount</code></p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">MaxIncomingConnectionsNum</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">See the description of <code class="programcharacter">MaxIncomingConnectionsNum</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">MaxHTTPSessionsNum</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">See the description of <code class="programcharacter">MaxHTTPSessionsNum</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">QueueLen</p>
</td>
<td style="border:1px solid #010101;" width="332"><ul class="tablelistbullet"><li class="tablelistbullet">Greater than or equal to the value of <code class="programcharacter">MaxHTTPSessionsNum</code></li><li class="tablelistbullet">Greater than the <code class="programcharacter">ThreadsCount</code> value</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">MaxTCPFileSize</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">10591440 bytes (10.1 MB)</p>
<p class="attentionbody">Get an updated value from your TAM at least once a year</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">Flags</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">Specify the flags:</p>
<ul class="tablelistbullet"><li class="tablelistbullet">KAV_O_M_PACKED</li><li class="tablelistbullet">KAV_O_M_ARCHIVED</li><li class="tablelistbullet">KAV_O_M_MAILPLAIN</li><li class="tablelistbullet">KAV_O_M_MAILBASES</li><li class="tablelistbullet">KAV_O_M_HEURISTIC_LEVEL_SHALLOW</li><li class="tablelistbullet">KAV_SHT_ENGINE_KSN</li><li class="tablelistbullet">KAV_SHT_ENGINE_APUF</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">Mode</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">See the description of <code class="programcharacter">Mode</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">MaxArchivesScanningDepth</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">5</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">SessionTimeout</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">10000 (10 seconds)</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="180"><p class="tablebodytext">KeepAliveSettings</p>
</td>
<td style="border:1px solid #010101;" width="332"><p class="tablebodytext">See the description of <code class="programcharacter">KeepAliveSettings</code> below</p>
</td>
</tr>

</table>
<p class="bodytext"><a id="h201067" class="englishcrossreferencetemplate" href="#201037" target="_self">ScannersCount</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Processes</span>.</p>
<p class="bodytext">The recommended number of scanning processes is equal to the number of processor cores. For example, if Kaspersky Scan Engine is running on a computer with a 4-core processor, set <code class="programcharacter">ScannersCount</code> to <code class="programcharacter">4</code>.</p>
<p class="bodytext">See also subsection &quot;Example of Kaspersky Scan Engine work in HTTP mode depending on the ScannersCount, ThreadsCount, QueueLen, MaxIncomingConnectionsNum, and MaxHTTPSessionsNum settings.&quot;</p>
<p class="bodytext"><a id="h201068" class="englishcrossreferencetemplate" href="#201038" target="_self">ThreadsCount</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Threads</span>.</p>
<p class="bodytext">The recommended number of scanning threads depends on the number of scanning processes specified in <code class="programcharacter">ScannersCount</code>: the value of <code class="programcharacter">ThreadsCount</code> is twice the value of <code class="programcharacter">ScannersCount</code>. For example, if Kaspersky Scan Engine is running on a computer with a 4-core processor and <code class="programcharacter">ScannersCount</code> is set to <code class="programcharacter">4</code>, set <code class="programcharacter">ThreadsCount</code> to <code class="programcharacter">8</code>.</p>
<p class="bodytext">See also the subsection &quot;Example of Kaspersky Scan Engine work in HTTP mode depending on the ScannersCount, ThreadsCount, QueueLen, MaxIncomingConnectionsNum, and MaxHTTPSessionsNum settings.&quot;</p>
<p class="bodytext"><a id="h201057" class="englishcrossreferencetemplate" href="#201027" target="_self">MaxIncomingConnectionsNum</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Connections</span>.</p>
<p class="bodytext">You can configure this parameter to set the queue length of the incoming TCP connections waiting for connection with HTTPD. See section &quot;<a id="h180043" class="englishcrossreferencetemplate" href="#179869" target="_self">Setting up the connection queue in HTTP mode</a>&quot; for connection queue setup details. </p>
<p class="bodytext">For example, you expect, on average, ten simultaneous connections with clients. If <code class="programcharacter">MaxHTTPSessionsNum</code> value is set to 10, all 10 connections simultaneously occurred will be accepted by HTTPD for processing. The 11th incoming TCP connection will wait for connection with HTTPD. At least 11 additional connections can wait for HTTPD acceptance, the 12th additional  connection will cause an error message. So, when setting the value for <code class="programcharacter">MaxIncomingConnectionsNum</code>, consider the value for <code class="programcharacter">MaxHTTPSessionNum</code>: the value specified in <code class="programcharacter">MaxIncomingConnectionsNum</code> should be multiple times bigger than the value specified in <code class="programcharacter">MaxHTTPSessionNum</code>.</p>
<p class="bodytext"><a id="h201058" class="englishcrossreferencetemplate" href="#201028" target="_self">MaxHTTPSessionsNum</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings </span>&gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Sessions</span>.</p>
<p class="bodytext">When specifying the value for this parameter, consider the following:</p>
<ul class="listbullet1"><li class="listbullet1">the maximum number of scanning threads (<code class="programcharacter">ThreadsCount</code>).</li><li class="listbullet1">the maximum length of the queue for scan tasks (<code class="programcharacter">QueueLen</code>).</li><li class="listbullet1">the maximum length of the scan waiting queue (<code class="programcharacter">MaxIncomingConnectionsNum</code>).</li><li class="listbullet1">specifics of the PD: in general, HTTPD runs one scanning process for one scan task.</li></ul><p class="listheading">The recommended value is:</p>
<ul class="listbullet1"><li class="listbullet1">greater than or equal to:<ol class="listalpha2"><li class="listalpha2">5*ThreadsCount/4 (when scanning files and URL).</li><li class="listalpha2">3*ThreadsCount/2 (when scanning system memory).</li></ol></li><li class="listbullet1">corresponds to the expected number of HTTP clients that make requests to HTTPD.</li></ul><p class="bodytext">See also the subsection &quot;Example of Kaspersky Scan Engine work in HTTP mode depending on the ScannersCount, ThreadsCount, QueueLen, MaxIncomingConnectionsNum, and MaxHTTPSessionsNum settings.&quot;</p>
<p class="bodytext"><a id="h201069" class="englishcrossreferencetemplate" href="#200631" target="_self">QueueLen</a></p>
<p class="bodytext">Since the scan tasks are enqueued from all simultaneously open sessions, consider the <code class="programcharacter">MaxHTTPSessionsNum</code> settings. The queue length should not be less than the <code class="programcharacter">MaxHTTPSessionsNum</code> value. Otherwise, some clients will get an error when opening sessions.</p>
<p class="bodytext">Since the scan tasks are processed by the threads from the queue, the queue length should not be less than the number of threads in <code class="programcharacter">ThreadsCount</code>. Otherwise, some threads will be not in use.</p>
<p class="bodytext">The recommended <code class="programcharacter">QueueLen</code> value is:</p>
<ul class="listbullet1"><li class="listbullet1">greater than the <code class="programcharacter">ThreadsCount</code> value.</li><li class="listbullet1">greater than or equal to <code class="programcharacter">MaxHTTPSessionsNum</code> value.</li></ul><p class="bodytext">See also the subsection &quot;Example of Kaspersky Scan Engine work in HTTP mode depending on the ScannersCount, ThreadsCount, QueueLen, MaxIncomingConnectionsNum, and MaxHTTPSessionsNum settings.&quot;</p>
<p class="bodytext"><a id="h201059" class="englishcrossreferencetemplate" href="#201029" target="_self">MaxTCPFileSize</a></p>
<p class="bodytext">During scanning, HTTPD loads the files into the system memory. The greater the file size and the number of active sessions, the more system memory is consumed. The value specified should be less than the RAM size.</p>
<p class="bodytext">To  increase performance, you can specify the maximum size of HTTP messages sent to HTTPD and set the value to 10591440 bytes (10.1 MB). This value provides detecting most of the malware.</p>
<p class="attentionbody">If you have followed the recommendation above, we also recommend consulting with your Technical Account Manager (TAM) once a year to get an updated recommended value, as the average malware size changes from year to year.</p>
<p class="bodytext"><a id="h201061" class="englishcrossreferencetemplate" href="#201031" target="_self">Flags</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Types of files to scan</span>, <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Heuristic analysis level </span>and<span class="guicharacter"> Settings</span> &gt; <span class="guicharacter">Scanning </span>&gt;<span class="guicharacter"> Enable reputation checking</span>.</p>
<p class="bodytext">The recommended value for <code class="programcharacter">Flags</code> is the following:</p>
<p class="bodytext"><code class="programcharacter">KAV_O_M_PACKED | KAV_O_M_ARCHIVED | KAV_O_M_MAILPLAIN | KAV_O_M_MAILBASES | KAV_O_M_HEURISTIC_LEVEL_SHALLOW | KAV_SHT_ENGINE_KSN</code></p>
<p class="bodytext">If the<code class="programcharacter"> KAV_SHT_ENGINE_KSN flag </code>is used,<code class="programcharacter"> </code>it is also recommended to enable<code class="programcharacter"> </code>Phishing Protection by using one of the following ways:</p>
<ul class="listbullet1"><li class="listbullet1">In the Flags element of the kavhttpd.xml configuration file, add the <code class="programcharacter">KAV_SHT_ENGINE_APUF</code> flag.</li><li class="listbullet1">On the <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> page of the Kaspersky Scan Engine GUI, turn on the <span class="guicharacter">Enable Phishing Protection</span> toggle switch.</li></ul><p class="bodytext">Phishing Protection is useful when Kaspersky Scan Engine checks URLs.<code class="programcharacter"> </code></p>
<p class="bodytext"><a id="h201071" class="englishcrossreferencetemplate" href="#201041" target="_self">Mode</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Actions on detected objects</span>.</p>
<p class="bodytext">If it is expected to specify the object local path (request <code class="programcharacter">scanfile</code> to scan a local file), specify the following:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">KAV_DELETE </code>(if the object is to be deleted without a disinfection attempt).</li><li class="listbullet1"><code class="programcharacter">KAV_CLEAN_DELETE </code>(if the object is to be disinfected or to be deleted, if disinfection is impossible).</li></ul><p class="bodytext">Specify <code class="programcharacter">KAV_SKIP</code> in all other cases.</p>
<p class="bodytext"><a id="h206217" class="englishcrossreferencetemplate" href="#207145" target="_self">MaxArchivesScanningDepth</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Maximum depth</span>.</p>
<p class="bodytext">We recommend that you limit the maximum depth of nested archives to be unpacked during scanning. The recommended value for <code class="programcharacter">MaxArchivesScanningDepth</code> is <code class="programcharacter">5</code>.</p>
<p class="bodytext"><a id="h201060" class="englishcrossreferencetemplate" href="#201030" target="_self">SessionTimeout</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Object scan timeout</span>.</p>
<p class="bodytext">You can set a timeout for all operations in a session: connection with a client, data receipt, and object checking.  Timeout configuring can be used with the <code class="programcharacter">X-KAV-Timeout</code> header (see <a id="h179922" class="englishcrossreferencetemplate" href="#179870" target="_self">Setting the session timeout</a>). </p>
<p class="bodytext">Setting the timeout allows the following:</p>
<ul class="listbullet1"><li class="listbullet1">immediate releasing the scanning thread, if the session time has expired.</li><li class="listbullet1">faster managing the queue of the incoming TCP connections (the queue length is set in <code class="programcharacter">MaxIncomingConnectionsNum</code>).</li></ul><p class="bodytext">Initially, HTTPD receives the data, and then loads the files into the system memory during scanning. The greater the file size and the number of active sessions, the more system memory is consumed. To  increase performance, you can specify the maximum size of HTTP messages sent to HTTPD (see <code class="programcharacter">MaxTCPFileSize</code> above) and limit the session time in <code class="programcharacter">SessionTimeout</code>. This will allow you to skip the large objects or objects requiring a long time for scanning.</p>
<p class="bodytext">Before setting a value to <code class="programcharacter">SessionTimeout</code>, we recommend that you estimate the expected number of HTTP clients requesting the HTTPD, as well as probable length of the incoming TCP connections queue.</p>
<p class="bodytext">Generally, the default value for <code class="programcharacter">SessionTimeout</code> is <code class="programcharacter">10000</code> (10 seconds).</p>
<p class="bodytext"><a id="h207358" class="englishcrossreferencetemplate" href="#207348" target="_self">KeepAliveSettings</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Keep-alive connection</span>.</p>
<p class="bodytext">We recommend enabling Keep-Alive. When Keep-Alive is enabled, Kaspersky Scan Engine maintains a persistent connection even after the request has been processed and the session timed out. This gives the following advantages:</p>
<ul class="listbullet1"><li class="listbullet1">reduce network traffic.</li><li class="listbullet1">reduce the use of server resources.</li><li class="listbullet1">reduce latency in processing requests.</li></ul><p class="bodytext">Keep-Alive is especially useful for HTTPS connections that require more CPU time and more client-server interactions.</p>
<p class="bodytext">To enable Keep-Alive, set the <a id="h228936" class="englishcrossreferencetemplate" href="#207346" target="_self">Enabled</a> element in <code class="programcharacter">KeepAliveSettings</code> to <code class="programcharacter">1</code>.</p>
<p class="bodytext">To determine the values for <code class="programcharacter"><a id="h228937" class="englishcrossreferencetemplate" href="#207350" target="_self">TimeoutMs</a></code> and <code class="programcharacter"><a id="h228938" class="englishcrossreferencetemplate" href="#207352" target="_self">MaxRequests</a></code>, estimate the number of clients and the number of requests from clients.</p>
<p class="bodytext">For example, you have estimated that the maximum number of clients is 10, so you set <code class="programcharacter">MaxHTTPSessionsNum</code> to 10. If <code class="programcharacter">TimeoutMs</code> and <code class="programcharacter">MaxRequests</code> are unlimited, and all 10 clients send requests continuously, Kaspersky Scan Engine maintains connections with these 10 clients without limits. As a result, new connections cannot be accepted by HTTPD for processing.</p>
<p class="bodytext">Another example. You have estimated that the maximum number of clients is 10, so you set <code class="programcharacter">MaxHTTPSessionsNum</code> to 10. You have also estimated that the maximum number of requests from one client is 15, so you set <code class="programcharacter">MaxRequests</code> to <code class="programcharacter">15</code>. If you did not set the limit for <code class="programcharacter">TimeoutMs</code>, and clients do not send 15 requests, Kaspersky Scan Engine maintains connections with these 10 clients without limits, so new connections cannot be accepted by HTTPD for processing.</p>
<p class="introheading">Example of Kaspersky Scan Engine work in HTTP mode depending on the ScannersCount, ThreadsCount, QueueLen, MaxIncomingConnectionsNum, and MaxHTTPSessionsNum settings</p>
<p class="bodytext">Let's say Kaspersky Scan Engine is installed on a computer with four CPU cores, there are 15 simultaneous connections to this computer, and Kaspersky Scan Engine is configured as follows:</p>
<ul class="listbullet1"><li class="listbullet1">ScannersCount = 4</li><li class="listbullet1">ThreadsCount = 8</li><li class="listbullet1">QueueLen = 20</li><li class="listbullet1">MaxHTTPSessionsNum = 10</li><li class="listbullet1">MaxIncomingConnectionsNum = 20</li></ul><p class="bodytext">In this case:</p>
<ol class="listnumber1"><li class="listnumber1">Five out of fifteen clients will be enqueued for connection.</li><li class="listnumber1">Ten sessions will open for ten clients.</li><li class="listnumber1">Ten open sessions will form a queue of scan tasks. If the number of scan tasks surpass the value of <code class="programcharacter">QueueLen</code>, the client will receive the error <code class="programcharacter">503 </code>-<code class="programcharacter"> Service overloaded.</code></li><li class="listnumber1">Kaspersky Scan Engine runs four scanning processes.</li><li class="listnumber1">Four scanning processes create eight threads for simultaneous processing of eight scan tasks from the queue (one thread for one scan task).</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192980"><p><a name=192980 style="display: none;">[Topic 192980]</a></p>
	<h2 id="t234301" class="heading2">Configuring Kaspersky Scan Engine in HTTP mode</h2>
<p class="bodytext">This section explains how to manually configure Kaspersky Scan Engine for use in HTTP mode without using Kaspersky Scan Engine GUI.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#184799" target="_self">HTTP mode configuration file</a></p><p class="relateditem"><a href="#179868" target="_self">Configuring Format Recognizer for use in HTTP mode</a></p><p class="relateditem"><a href="#179869" target="_self">Setting up the connection queue in HTTP mode</a></p><p class="relateditem"><a href="#179870" target="_self">Setting the session timeout</a></p><p class="relateditem"><a href="#179872" target="_self">Changing variables in the HTTP mode unit file</a></p><p class="relateditem"><a href="#179873" target="_self">Configuring updating in HTTP mode</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="184799"><p><a name=184799 style="display: none;">[Topic 184799]</a></p>
	<h3 id="t234379" class="heading3">HTTP mode configuration file</h3>
<p class="bodytext">The HTTP mode configuration file (hereinafter, also configuration file) is an XML file that specifies general settings for Kaspersky Scan Engine.</p>
<p class="introheading">HTTP mode configuration file (Linux)</p>
<p class="bodytext">The Kaspersky Scan Engine distribution kit for Linux contains a <code class="programcharacter">%distr_kit%/etc/kavhttpd.xml</code> configuration file. </p>
<p class="bodytext">After <a id="h193042" class="englishcrossreferencetemplate" href="#192974" target="_self">installing Kaspersky Scan Engine</a>, you can copy <code class="programcharacter">kavhttpd.xml</code> to your preferred location:</p>
<ul class="listbullet1"><li class="listbullet1">If you copy <code class="programcharacter">kavhttpd.xml</code> to the <code class="programcharacter">/etc/</code> directory, Kaspersky Scan Engine automatically finds and parses this file.</li><li class="listbullet1">If you copy <code class="programcharacter">kavhttpd.xml</code> to a different location, you must set the path to this location when you start Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">by using the <a id="h179931" class="englishcrossreferencetemplate" href="#179872" target="_self">systemd unit file</a></li><li class="listbullet2">by running Kaspersky Scan Engine from the command line <a id="h179959" class="englishcrossreferencetemplate" href="#179876" target="_self">manually</a></li></ul></li></ul><p class="introheading">HTTP mode configuration file (Windows)</p>
<p class="bodytext">The Kaspersky Scan Engine distribution kit for Windows contains a <code class="programcharacter">%distr_kit%\bin\kavhttpd.xml</code> configuration file.</p>
<p class="bodytext">We recommend specifying full paths to files in <code class="programcharacter">kavhttpd.xml</code>. In particular, it is strongly recommended to specify the full paths to the certificate (the <code class="programcharacter">TlsCertificateFile</code> element) and the key file (the <code class="programcharacter">TlsCertificateKeyFile</code> element).</p>
<p class="introheading">Parameters of the HTTP mode configuration file</p>
<p class="bodytext">Most elements of the configuration file have default values that are used when the element is absent. Elements that are present in the configuration file must not be empty, unless stated otherwise.</p>
<p class="bodytext">KAV HTTPD configuration file contains the following parent elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h201089" class="englishcrossreferencetemplate" href="#201021" target="_self">ServerSettings</a></li><li class="listbullet1"><a id="h201090" class="englishcrossreferencetemplate" href="#201022" target="_self">KSNSettings</a></li><li class="listbullet1"><a id="h201091" class="englishcrossreferencetemplate" href="#201023" target="_self">KAVScanningSettings</a></li><li class="listbullet1"><a id="h201092" class="englishcrossreferencetemplate" href="#201024" target="_self">DirectorySettings</a></li><li class="listbullet1"><a id="h201093" class="englishcrossreferencetemplate" href="#200598" target="_self">UseHTTPProxy</a></li><li class="listbullet1"><a id="h201094" class="englishcrossreferencetemplate" href="#201047" target="_self">HTTPProxy</a></li><li class="listbullet1"><a id="h201095" class="englishcrossreferencetemplate" href="#201025" target="_self">UpdateSettings</a></li><li class="listbullet1"><a id="h201096" class="englishcrossreferencetemplate" href="#201055" target="_self">FormatRecognizerSettings</a></li></ul><p class="introheading">Structure of the configuration file</p>
<p class="bodytext">Following is an example of the HTTP mode configuration file.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Configuration&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;ServerSettings&gt;</p>
<p class="program3">&lt;ConnectionString&gt;/tmp/.kavhttpd&lt;/ConnectionString&gt;</p>
<p class="program3">&lt;MaxIncomingConnectionsNum&gt;100&lt;/MaxIncomingConnectionsNum&gt;</p>
<p class="program3">&lt;MaxHTTPSessionsNum&gt;50&lt;/MaxHTTPSessionsNum&gt;</p>
<p class="program3">&lt;MaxTCPFileSize&gt;100&lt;/MaxTCPFileSize&gt;</p>
<p class="program3">&lt;SessionTimeout&gt;1000&lt;/SessionTimeout&gt;</p>
<p class="program3">&lt;Flags&gt;<code class="programcharacter">KAV_SHT_ENGINE_KSN</code> | <code class="programcharacter">KAV_SHT_ENGINE_APUF</code>&lt;/Flags&gt;</p>
<p class="program3">&lt;<code class="programcharacter">TlsCertificateKeyFile</code>&gt;opt/kaspersky/http_data/https_key.pem&lt;/<code class="programcharacter">TlsCertificateKeyFile</code>&gt;</p>
<p class="program3">&lt;<code class="programcharacter">TlsCertificateFile</code>&gt;opt/kaspersky/http_data/https_cert.crt&lt;/<code class="programcharacter">TlsCertificateFile</code>&gt;</p>
<p class="program3">&lt;CORS&gt;</p>
<p class="program4">&lt;AccessControlAllowOrigin&gt;https://example.com&lt;/AccessControlAllowOrigin&gt;</p>
<p class="program4">&lt;AccessControlAllowOrigin&gt;https://kaspersky.ru&lt;/AccessControlAllowOrigin&gt;</p>
<p class="program3">&lt;/CORS&gt;</p>
<p class="program3">&lt;KeepAliveSettings&gt;			</p>
<p class="program4">&lt;Enabled&gt;1&lt;/Enabled&gt;</p>
<p class="program4">&lt;TimeoutMs&gt;5000&lt;/TimeoutMs&gt;</p>
<p class="program4">&lt;MaxRequests&gt;1000&lt;/MaxRequests&gt;</p>
<p class="program3">&lt;/KeepAliveSettings&gt;</p>
<p class="program3">&lt;AuthSettings&gt;</p>
<p class="program4">&lt;UseAccessToken&gt;0&lt;/UseAccessToken&gt; &lt;!--Enable or disable API-token authentication --&gt;</p>
<p class="program4">&lt;AuthRequestField&gt;Authorization&lt;/AuthRequestField&gt;</p>
<p class="program4">&lt;UseBearerAuthScheme&gt;1&lt;/UseBearerAuthScheme&gt;</p>
<p class="program4">&lt;AccessTokens&gt;</p>
<p class="program5">&lt;Token&gt;</p>
<p class="program5">    &lt;Name&gt;Unlimited key&lt;/Name&gt;</p>
<p class="program5">    &lt;Value&gt;JWXA529CU2q7Udv7r3ji6BEMsha-5yu0KqU3yvKtf-6I+TU2AEQACKAABIgpEIIM&lt;/Value&gt;</p>
<p class="program5">    &lt;Description&gt;Kaspersky Scan Engine Clients. Full access scope&lt;/Description&gt;</p>
<p class="program5">    &lt;Enabled&gt;1&lt;/Enabled&gt;</p>
<p class="program5">&lt;/Token&gt;</p>
<p class="program5">&lt;Token&gt;</p>
<p class="program5">    &lt;Name&gt;Key for URL-scanning&lt;/Name&gt;</p>
<p class="program5">    &lt;Value&gt;MIIEpgIBAAKCAQEA2UT+I6-ftKvy3UqK0uy5-ahsMEB6ij3r7vdU7q2UC925AXWJ&lt;/Value&gt;</p>
<p class="program5">    &lt;Description&gt;Server access key. Only URL-scanning&lt;/Description&gt;</p>
<p class="program5">    &lt;Enabled&gt;0&lt;/Enabled&gt;</p>
<p class="program5">&lt;/Token&gt;</p>
<p class="program4">&lt;/AccessTokens&gt;</p>
<p class="program3">&lt;/AuthSettings&gt;</p>
<p class="program2">&lt;/ServerSettings&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;KSNSettings&gt;</p>
<p class="program3">&lt;UrlCheckTimeoutMs&gt;20000&lt;/UrlCheckTimeoutMs&gt;</p>
<p class="program3">&lt;ObjectCheckOnDemandTimeoutMs&gt;10000&lt;/ObjectCheckOnDemandTimeoutMs&gt;</p>
<p class="program3">&lt;CacheSizeKb&gt;30720&lt;/CacheSizeKb&gt;</p>
<p class="program2">&lt;/KSNSettings&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;KAVScanningSettings&gt;</p>
<p class="program3">&lt;ScannersCount&gt;4&lt;/ScannersCount&gt;</p>
<p class="program3">&lt;ThreadsCount&gt;8&lt;/ThreadsCount&gt;</p>
<p class="program3">&lt;QueueLen&gt;1024&lt;/QueueLen&gt;</p>
<p class="program3">&lt;Flags&gt;KAV_O_M_PACKED | KAV_O_M_ARCHIVED | KAV_O_M_MAILBASES | KAV_O_M_MAILPLAIN | KAV_O_M_HEURISTIC_LEVEL_DETAIL&lt;/Flags&gt;</p>
<p class="program3">&lt;Mode&gt;KAV_SKIP&lt;/Mode&gt;</p>
<p class="program3">&lt;MaxArchivesScanningDepth&gt;0&lt;/MaxArchivesScanningDepth&gt;</p>
<p class="program2">&lt;/KAVScanningSettings&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;DirectorySettings&gt;</p>
<p class="program3">&lt;BasesPath&gt;/home/bases&lt;/BasesPath&gt;</p>
<p class="program3">&lt;TempPath&gt;/home/temp&lt;/TempPath&gt;</p>
<p class="program3">&lt;LicensePath&gt;/home/license&lt;/LicensePath&gt;</p>
<p class="program3">&lt;LicensingMode&gt;1&lt;/LicensingMode&gt;</p>
<p class="program3">&lt;ScanningPaths&gt;</p>
<p class="program4">&lt;ScanningPath&gt;&lt;/ScanningPath&gt;</p>
<p class="program3">&lt;/ScanningPaths&gt;</p>
<p class="program2">&lt;/DirectorySettings&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;UseHTTPProxy&gt;1&lt;/UseHTTPProxy&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;HTTPProxy&gt;</p>
<p class="program3">&lt;url&gt;myproxy.mycompany.com&lt;/url&gt;</p>
<p class="program3">&lt;port&gt;3128&lt;/port&gt;</p>
<p class="program3">&lt;user&gt;doOTrypDTxpVJxUHYeKQTw==&lt;/user&gt;</p>
<p class="program3">&lt;pass&gt;8mSHXFix3uL+RP9oNeKDZQ==&lt;/pass&gt;</p>
<p class="program2">&lt;/HTTPProxy&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;UpdateSettings&gt;</p>
<p class="program3">&lt;DisableBackup&gt;0&lt;/DisableBackup&gt;</p>
<p class="program3">&lt;UpdatePeriodMinutes&gt;0&lt;/UpdatePeriodMinutes&gt;</p>
<p class="program3">&lt;UseOnlyCustomSources&gt;0&lt;/UseOnlyCustomSources&gt;</p>
<p class="program3">&lt;UpdateSources&gt;</p>
<p class="program4">&lt;Source&gt;[update source]&lt;/Source&gt;</p>
<p class="program3">&lt;/UpdateSources&gt;</p>
<p class="program3">&lt;UpdatesCertFile&gt;&lt;/UpdatesCertFile&gt;</p>
<p class="program3">&lt;CertificateConfirmationAction&gt;0&lt;/CertificateConfirmationAction&gt;</p>
<p class="program3">&lt;UseReducedBases&gt;0&lt;/UseReducedBases&gt;</p>
<p class="program2">&lt;/UpdateSettings&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;FormatRecognizerSettings&gt;</p>
<p class="program3">&lt;FormatsToSkipScanning&gt;</p>
<p class="program4">&lt;KAV_FF_GENERAL_TXT/&gt;</p>
<p class="program4">&lt;KAV_FF_GENERAL_CSV/&gt;</p>
<p class="program4">&lt;KAV_FF_AUDIO_WMA/&gt;</p>
<p class="program3">&lt;/FormatsToSkipScanning&gt;</p>
<p class="program2">&lt;/FormatRecognizerSettings&gt; </p>
<p class="program">&nbsp;</p>
<p class="program">&lt;/Configuration&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201021"><p><a name=201021 style="display: none;">[Topic 201021]</a></p>
	<h4 id="t234514" class="heading4">ServerSettings</h4>
<p class="bodytext">Specifies server settings for KAV HTTPD. </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h201056" class="englishcrossreferencetemplate" href="#201026" target="_self">ConnectionString</a></li><li class="listbullet1"><a id="h201057" class="englishcrossreferencetemplate" href="#201027" target="_self">MaxIncomingConnectionsNum</a></li><li class="listbullet1"><a id="h201058" class="englishcrossreferencetemplate" href="#201028" target="_self">MaxHTTPSessionsNum</a></li><li class="listbullet1"><a id="h201059" class="englishcrossreferencetemplate" href="#201029" target="_self">MaxTCPFileSize</a></li><li class="listbullet1"><a id="h201060" class="englishcrossreferencetemplate" href="#201030" target="_self">SessionTimeout</a></li><li class="listbullet1"><a id="h201061" class="englishcrossreferencetemplate" href="#201031" target="_self">Flags</a></li><li class="listbullet1"><a id="h201062" class="englishcrossreferencetemplate" href="#200613" target="_self">TlsCertificateKeyFile</a></li><li class="listbullet1"><a id="h201063" class="englishcrossreferencetemplate" href="#200614" target="_self">TlsCertificateFile</a></li><li class="listbullet1"><a id="h201539" class="englishcrossreferencetemplate" href="#201900" target="_self">CORS</a></li><li class="listbullet1"><a id="h207358" class="englishcrossreferencetemplate" href="#207348" target="_self">KeepAliveSettings</a></li><li class="listbullet1"><a id="h224310" class="englishcrossreferencetemplate" href="#222092" target="_self">AuthSettings</a></li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of a <em class="emphasischaracter">ServerSettings</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ServerSettings&gt;</p>
<p class="program2">&lt;ConnectionString&gt;/tmp/.kavhttpd&lt;/ConnectionString&gt;</p>
<p class="program2">&lt;MaxIncomingConnectionsNum&gt;100&lt;/MaxIncomingConnectionsNum&gt;</p>
<p class="program2">&lt;MaxHTTPSessionsNum&gt;50&lt;/MaxHTTPSessionsNum&gt;</p>
<p class="program2">&lt;MaxTCPFileSize&gt;100&lt;/MaxTCPFileSize&gt;</p>
<p class="program2">&lt;SessionTimeout&gt;1000&lt;/SessionTimeout&gt;</p>
<p class="program2">&lt;Flags&gt;<code class="programcharacter">KAV_SHT_ENGINE_KSN</code> | <code class="programcharacter">KAV_SHT_ENGINE_APUF</code>&lt;/Flags&gt;</p>
<p class="program2">&lt;<code class="programcharacter">TlsCertificateKeyFile</code>&gt;opt/kaspersky/http_data/https_key.pem&lt;/<code class="programcharacter">TlsCertificateKeyFile</code>&gt;</p>
<p class="program2">&lt;<code class="programcharacter">TlsCertificateFile</code>&gt;opt/kaspersky/http_data/https_cert.crt&lt;/<code class="programcharacter">TlsCertificateFile</code>&gt;</p>
<p class="program2">&lt;CORS&gt;</p>
<p class="program3">&lt;AccessControlAllowOrigin&gt;http://example.com&lt;/AccessControlAllowOrigin&gt;</p>
<p class="program3">&lt;AccessControlAllowOrigin&gt;https://www.kaspersky.com&lt;/AccessControlAllowOrigin&gt;</p>
<p class="program2">&lt;/CORS&gt;</p>
<p class="program2">&lt;KeepAliveSettings&gt;</p>
<p class="program3">&lt;Enabled&gt;1&lt;/Enabled&gt;</p>
<p class="program3">&lt;TimeoutMs&gt;5000&lt;/TimeoutMs&gt;</p>
<p class="program3">&lt;MaxRequests&gt;1000&lt;/MaxRequests&gt;</p>
<p class="program2">&lt;/KeepAliveSettings&gt;</p>
<p class="program2">&lt;AuthSettings&gt;</p>
<p class="program3">&lt;UseAccessToken&gt;0&lt;/UseAccessToken&gt; &lt;!--Enable or disable API-token authentication --&gt;</p>
<p class="program3">&lt;AuthRequestField&gt;Authorization&lt;/AuthRequestField&gt;</p>
<p class="program3">&lt;UseBearerAuthScheme&gt;1&lt;/UseBearerAuthScheme&gt;</p>
<p class="program3">&lt;AccessTokens&gt;</p>
<p class="program4">&lt;Token&gt;</p>
<p class="program5">&lt;Name&gt;Unlimited key&lt;/Name&gt;</p>
<p class="program5">&lt;Value&gt;SldYQTUyOUNVMnE3VWR2N3Izamk2QkVNc2hhLTV5dTBLcVUzeXZLdGYtNkkrVFUyQUVRQUNLQUFCSWdwRUlJTQ==&lt;/Value&gt;</p>
<p class="program5">&lt;Description&gt;Kaspersky Scan Engine Clients. Full access scope&lt;/Description&gt;</p>
<p class="program5">&lt;Enabled&gt;1&lt;/Enabled&gt;</p>
<p class="program4">&lt;/Token&gt;</p>
<p class="program4">&lt;Token&gt;</p>
<p class="program5">&lt;Name&gt;Key for URL-scanning&lt;/Name&gt;</p>
<p class="program5">&lt;Value&gt;XUmCkYURUdWQldFGIT3TlEQUQQwkBy2LLNaNMVtrkSQUR2kSNUZV=NT2zLRzQJycVW5VNhUVOdLVcUd3YeVFnT=h&lt;/Value&gt;</p>
<p class="program5">&lt;Description&gt;Server access key. Only URL-scanning&lt;/Description&gt;</p>
<p class="program5">&lt;Enabled&gt;0&lt;/Enabled&gt;</p>
<p class="program4">&lt;/Token&gt;</p>
<p class="program3">&lt;/AccessTokens&gt;</p>
<p class="program2">&lt;/AuthSettings&gt;</p>
<p class="program">&lt;/ServerSettings&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201026"><p><a name=201026 style="display: none;">[Topic 201026]</a></p>
	<h5 id="t234310" class="heading5">ConnectionString</h5>
<p class="bodytext">Specifies the IP address and the port for Kaspersky Scan Engine with a protocol (<code class="programcharacter">http://</code> or <code class="programcharacter">https://</code>), or a path to the UNIX socket used by Kaspersky Scan Engine. This is a string value.</p>
<p class="attentionbody">If you want to use the HTTPS protocol, the elements <a id="h201062" class="englishcrossreferencetemplate" href="#200613" target="_self">TlsCertificateKeyFile</a> and <a id="h201063" class="englishcrossreferencetemplate" href="#200614" target="_self">TlsCertificateFile</a> are mandatory.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; ConnectionString</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">Mandatory parameter. The default value is <code class="programcharacter">/tmp/.kavhttpd</code> in Linux and <code class="programcharacter">127.0.0.1:9999</code> in Windows. You can specify an IP address and a port for a TCP connection in the following format: <code class="programcharacter">protocol://ip_addr:port</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ConnectionString&gt;/tmp/.kavhttpd&lt;/ConnectionString&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201027"><p><a name=201027 style="display: none;">[Topic 201027]</a></p>
	<h5 id="t234454" class="heading5">MaxIncomingConnectionsNum</h5>
<p class="bodytext">Specifies the maximum number of pending TCP connections to Kaspersky Scan Engine in HTTP mode. Extra connections may be dropped.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; MaxIncomingConnectionsNum</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer and cannot be <code class="programcharacter">0</code>. The default value is <code class="programcharacter">100</code>. </p>
<p class="bodytext">See also the examples of <a id="h180043" class="englishcrossreferencetemplate" href="#179869" target="_self">setting up the connection queue in HTTP mode</a>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;MaxIncomingConnectionsNum&gt;100&lt;/MaxIncomingConnectionsNum&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201028"><p><a name=201028 style="display: none;">[Topic 201028]</a></p>
	<h5 id="t234452" class="heading5">MaxHTTPSessionsNum</h5>
<p class="bodytext">Specifies the maximum number of active TCP connections that Kaspersky Scan Engine can maintain simultaneously.</p>
<p class="attentionbody">It is not recommended to specify a value greater than the number of TCP connections that your HTTP client can simultaneously maintain with Kaspersky Scan Engine.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; MaxHTTPSessionsNum</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer. The default value is <code class="programcharacter">10</code>. If you set <code class="programcharacter">MaxHTTPSessionsNum</code> to <code class="programcharacter">0</code>, the default value is used. </p>
<p class="bodytext">See also the examples of <a id="h180043" class="englishcrossreferencetemplate" href="#179869" target="_self">setting up the connection queue in HTTP mode</a>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;MaxHTTPSessionsNum&gt;50&lt;/MaxHTTPSessionsNum&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201029"><p><a name=201029 style="display: none;">[Topic 201029]</a></p>
	<h5 id="t234457" class="heading5">MaxTCPFileSize</h5>
<p class="bodytext">Specifies the maximum allowed size (in bytes) of the headers and bodies of the HTTP messages that are passed to Kaspersky Scan Engine.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; MaxTCPFileSize</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer. It is recommended to specify at least 100 KB for the headers.</p>
<p class="bodytext">The default value is <code class="programcharacter">104857600</code> (100 MB). If you set <code class="programcharacter">MaxTCPFileSize</code> to <code class="programcharacter">0</code>, the default value is used.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;MaxTCPFileSize&gt;100&lt;/MaxTCPFileSize&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201030"><p><a name=201030 style="display: none;">[Topic 201030]</a></p>
	<h5 id="t234516" class="heading5">SessionTimeout</h5>
<p class="bodytext">Specifies the timeout for processing the request and sending the response, in milliseconds (ms). </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; SessionTimeout</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer. The default value is <code class="programcharacter">1000</code>. If you set <code class="programcharacter">SessionTimeout</code> to <code class="programcharacter">0</code>, the timeout for processing the request and sending the response is not limited. See also the detailed information about <a id="h179922" class="englishcrossreferencetemplate" href="#179870" target="_self">setting the session timeout</a>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;SessionTimeout&gt;1000&lt;/SessionTimeout&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201031"><p><a name=201031 style="display: none;">[Topic 201031]</a></p>
	<h5 id="t234357" class="heading5">Flags</h5>
<p class="bodytext">Specifies the initialization options for Kaspersky Scan Engine. Initialization options are defined by a combination of flags separated by pipes (<code class="programcharacter">|</code>).</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; Flags</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This is a string value.</p>
<p class="bodytext">Possible values:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">KAV_SHT_ENGINE_KLAV</code><p class="listcontinue1">Enable KLAV anti-virus engine.</p>
<p class="attentioncontinue1">If you set this flag, you do not have to specify the <code class="programcharacter">KAV_SHT_ENGINE_KLAVEMU</code> flag. Enabling KLAV Engine automatically turns on the KLAV emulator.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_SHT_ENGINE_KLAVEMU</code><p class="listcontinue1">Enable the advanced heuristic anti-virus engine (KLAV emulator). Add this flag if you want to use heuristics.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_SHT_ENGINE_WMUF</code><p class="listcontinue1">Enable detection of malicious websites.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_SHT_ENGINE_APUF</code><p class="listcontinue1">Use phishing protection.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_SHT_ENGINE_KSN</code><p class="listcontinue1">Use KSN to check the reputation of files and URLs.</p>
<p class="attentioncontinue1">Before specifying the <code class="programcharacter">KAV_SHT_ENGINE_KSN</code> flag, make sure that your key file allows you to use this functionality and that you accepted the terms of the EULA for KSN.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_SHT_ENGINE_STATISTIC_MAIL</code><p class="listcontinue1">Submit statistical information to KSN in Linux.</p>
<p class="attentioncontinue1">Before specifying the <code class="programcharacter">KAV_SHT_ENGINE_STATISTIC_MAIL</code> flag, make sure that your key file allows you to use this functionality.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_SHT_ENGINE_STATISTIC</code><p class="listcontinue1">Submit statistical information to KSN in Windows.</p>
<p class="attentioncontinue1">Before specifying the <code class="programcharacter">KAV_SHT_ENGINE_STATISTIC</code> flag, make sure that your key file allows you to use this functionality.</p>
</li></ul><p class="warningbody">Notice that by enabling the <code class="programcharacter">KAV_SHT_ENGINE_KSN</code>, <code class="programcharacter">KAV_SHT_ENGINE_STATISTIC_MAIL</code>, or <code class="programcharacter">KAV_SHT_ENGINE_STATISTIC</code> flags, you agree to transfer data to Kaspersky, as described in the corresponding About data provision*.txt file. See also the detailed information <a id="h180046" class="englishcrossreferencetemplate" href="#185034" target="_self">about data provisioning</a> and <a id="h180773" class="englishcrossreferencetemplate" href="#180772" target="_self">statistics submitted to KSN</a>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Flags&gt;<code class="programcharacter">KAV_SHT_ENGINE_KSN</code> | <code class="programcharacter">KAV_SHT_ENGINE_APUF</code>&lt;/Flags&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200613"><p><a name=200613 style="display: none;">[Topic 200613]</a></p>
	<h5 id="t234535" class="heading5">TlsCertificateKeyFile</h5>
<p class="bodytext">Specifies a path to the private key file.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; TlsCertificateKeyFile</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This can be either absolute or a relative path. A relative path is calculated relative to the kavhttpd binary file.</p>
<p class="bodytext">This element is mandatory if the <code class="programcharacter">ConnectionString</code> element contains the <code class="programcharacter">https://</code> protocol.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;<code class="programcharacter">TlsCertificateKeyFile</code>&gt;opt/kaspersky/http_data/https_key.pem&lt;/<code class="programcharacter">TlsCertificateKeyFile</code>&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200614"><p><a name=200614 style="display: none;">[Topic 200614]</a></p>
	<h5 id="t234534" class="heading5">TlsCertificateFile</h5>
<p class="bodytext">Specifies a path to the certificate file.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; TlsCertificateFile</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This can be either absolute or a relative path. A relative path is calculated relative to the kavhttpd binary file.</p>
<p class="bodytext">This element is mandatory if the <code class="programcharacter">ConnectionString</code> element contains the <code class="programcharacter">https://</code> protocol.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;<code class="programcharacter">TlsCertificateFile</code>&gt;opt/kaspersky/http_data/https_cert.crt&lt;/<code class="programcharacter">TlsCertificateFile</code>&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201900"><p><a name=201900 style="display: none;">[Topic 201900]</a></p>
	<h5 id="t234313" class="heading5">CORS</h5>
<p class="bodytext">Contains the cross-origin resource sharing mechanism settings.</p>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; CORS</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><em class="emphasischaracter">AccessControlAllowOrigin</em><p class="listcontinue1">Specifies the list of origins (IP addresses or host names with a protocol) to which an access to the kavhttpd service must be provided. </p>
<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2">IP address or a host name of an origin, including the protocol (http:// or https://), that initiates requests to the kavhttpd service</li><li class="listbullet2"><code class="programcharacter">*</code><p class="listcontinue2">This value allows any origin to access the kavhttpd service.</p>
</li><li class="listbullet2">Empty value</li></ul></li></ul><p class="bodytext">Kaspersky Scan Engine in HTTP mode may receive an HTTP request with the <code class="programcharacter">Origin</code> header field which contains the IP address or host name that initiates the request. If the HTTP mode configuration file contains one or more <code class="programcharacter">AccessControlAllowOrigin</code> elements, the value of the <code class="programcharacter">Origin</code> header field is mapped to the values defined in these elements. The following results are possible:  </p>
<ul class="listbullet1"><li class="listbullet1">The value of the <code class="programcharacter">Origin</code> header field matches at least one of the <code class="programcharacter">AccessControlAllowOrigin</code> element values<p class="listcontinue1">In this case, the value of the <code class="programcharacter">Origin</code> header field will be specified in the <code class="programcharacter">Access-Control-Allow-Origin</code> field of the response header. </p>
</li><li class="listbullet1">No matches <p class="listcontinue1">In this case, <code class="programcharacter">Access-Control-Allow-Origin</code> will contain the <code class="programcharacter">https://scanengine.kaspersky.com</code> value.</p>
</li><li class="listbullet1">At least one of the <code class="programcharacter">AccessControlAllowOrigin</code> element contains the <code class="programcharacter">*</code> value<p class="listcontinue1">In this case, the <code class="programcharacter">Access-Control-Allow-Origin</code> field of the response header will contain the <code class="programcharacter">*</code> value regardless of the <code class="programcharacter">Origin</code> header field value.</p>
</li></ul><p class="bodytext">If the request does not contain the <code class="programcharacter">Origin</code> header field, the kavhttpd service processes it in the standard way.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;CORS&gt;</p>
<p class="program2">&lt;AccessControlAllowOrigin&gt;http://example.com&lt;/AccessControlAllowOrigin&gt;</p>
<p class="program2">&lt;AccessControlAllowOrigin&gt;https://www.kaspersky.com&lt;/AccessControlAllowOrigin&gt;</p>
<p class="program">&lt;/CORS&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="207348"><p><a name=207348 style="display: none;">[Topic 207348]</a></p>
	<h5 id="t234415" class="heading5">KeepAliveSettings</h5>
<p class="bodytext">By default, Kaspersky Scan Engine supports Keep-Alive (persistent connections), so an HTTP client can use the same connection to send multiple requests. With <code class="programcharacter">KeepAliveSettings</code>, you can configure Keep-Alive support or even disable it.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings</code> &gt; <code class="programcharacter">KeepAliveSettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h207353" class="englishcrossreferencetemplate" href="#207346" target="_self">Enabled</a>.</li><li class="listbullet1"><a id="h207354" class="englishcrossreferencetemplate" href="#207350" target="_self">TimeoutMs</a>.</li><li class="listbullet1"><a id="h207355" class="englishcrossreferencetemplate" href="#207352" target="_self">MaxRequests</a>.</li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;KeepAliveSettings&gt;</p>
<p class="program2">&lt;Enabled&gt;1&lt;/Enabled&gt;</p>
<p class="program2">&lt;TimeoutMs&gt;5000&lt;/TimeoutMs&gt;</p>
<p class="program2">&lt;MaxRequests&gt;1000&lt;/MaxRequests&gt;</p>
<p class="program">&lt;/KeepAliveSettings&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="207346"><p><a name=207346 style="display: none;">[Topic 207346]</a></p>
	<h6 id="t234339" class="heading6">Enabled</h6>
<p class="bodytext">Specifies if Keep-Alive support is enabled or disabled.</p>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; KeepAliveSettings &gt; Enabled</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">Valid values:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">0</code> - Keep-Alive support is disabled.</li><li class="listbullet1"><code class="programcharacter">1</code> - Keep-Alive support is enabled.</li></ul><p class="bodytext">The default value is <code class="programcharacter">1</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Enabled&gt;1&lt;/Enabled&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="207350"><p><a name=207350 style="display: none;">[Topic 207350]</a></p>
	<h6 id="t234532" class="heading6">TimeoutMs</h6>
<p class="bodytext">The amount of time an idle connection has to be kept open (in milliseconds), waiting for a new request from an HTTP client.</p>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; KeepAliveSettings &gt; TimeoutMs</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The valid value is an integer from <code class="programcharacter">0</code> to <code class="programcharacter">18000</code> <code class="programcharacter">(</code>milliseconds).</p>
<p class="bodytext">If <code class="programcharacter">TimeoutMs</code> is set to <code class="programcharacter">0</code>, there is no time limit for the connection.</p>
<p class="bodytext">The default value is <code class="programcharacter">5000</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;TimeoutMs&gt;5000&lt;/TimeoutMs&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="207352"><p><a name=207352 style="display: none;">[Topic 207352]</a></p>
	<h6 id="t234455" class="heading6">MaxRequests</h6>
<p class="bodytext">The maximum number of requests for one connection before the connection is closed.</p>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; KeepAliveSettings &gt; MaxRequests</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The valid value is an integer from <code class="programcharacter">0</code> to <code class="programcharacter">1000</code>.</p>
<p class="bodytext">If <code class="programcharacter">MaxRequests</code> is set to <code class="programcharacter">0</code>, the number of requests for one connection is not limited.</p>
<p class="bodytext">The default value is <code class="programcharacter">1000</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;MaxRequests&gt;1000&lt;/MaxRequests&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="222092"><p><a name=222092 style="display: none;">[Topic 222092]</a></p>
	<h5 id="t234279" class="heading5">AuthSettings</h5>
<p class="bodytext">Settings for API token authentication.</p>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings</code> &gt; <code class="programcharacter">AuthSettings</code></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h224179" class="englishcrossreferencetemplate" href="#222099" target="_self">UseAccessToken</a></li><li class="listbullet1"><a id="h222122" class="englishcrossreferencetemplate" href="#222116" target="_self">AuthRequestField</a></li><li class="listbullet1"><a id="h224180" class="englishcrossreferencetemplate" href="#222121" target="_self">UseBearerAuthScheme</a></li><li class="listbullet1"><a id="h224181" class="englishcrossreferencetemplate" href="#224176" target="_self">AccessTokens</a></li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;AuthSettings&gt;</p>
<p class="program2">&lt;UseAccessToken&gt;0&lt;/UseAccessToken&gt; &lt;!--Enable or disable API-token authentication --&gt;</p>
<p class="program2">&lt;AuthRequestField&gt;Authorization&lt;/AuthRequestField&gt;</p>
<p class="program2">&lt;UseBearerAuthScheme&gt;1&lt;/UseBearerAuthScheme&gt;</p>
<p class="program2">&lt;AccessTokens&gt;</p>
<p class="program3">&lt;Token&gt;</p>
<p class="program4">&lt;Name&gt;Unlimited key&lt;/Name&gt;</p>
<p class="program4">&lt;Value&gt;SldYQTUyOUNVMnE3VWR2N3Izamk2QkVNc2hhLTV5dTBLcVUzeXZLdGYtNkkrVFUyQUVRQUNLQUFCSWdwRUlJTQ==&lt;/Value&gt;</p>
<p class="program4">&lt;Description&gt;ScanEngine Clients. Full access scope&lt;/Description&gt;</p>
<p class="program4">&lt;Enabled&gt;1&lt;/Enabled&gt;</p>
<p class="program3">&lt;/Token&gt;</p>
<p class="program3">&lt;Token&gt;</p>
<p class="program4">&lt;Name&gt;Key for URL-scanning&lt;/Name&gt;</p>
<p class="program4">&lt;Value&gt;XUmCkYURUdWQldFGIT3TlEQUQQwkBy2LLNaNMVtrkSQUR2kSNUZV=NT2zLRzQJycVW5VNhUVOdLVcUd3YeVFnT=h&lt;/Value&gt;</p>
<p class="program4">&lt;Description&gt;Server access key. Only URL-scanning&lt;/Description&gt;</p>
<p class="program4">&lt;Enabled&gt;0&lt;/Enabled&gt;</p>
<p class="program3">&lt;/Token&gt;</p>
<p class="program2">&lt;/AccessTokens&gt;</p>
<p class="program">&lt;/AuthSettings&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="222099"><p><a name=222099 style="display: none;">[Topic 222099]</a></p>
	<h6 id="t234559" class="heading6">UseAccessToken</h6>
<p class="bodytext">Specifies if API token authorization is enabled or disabled.</p>
<p class="attentionbody">If you have enabled API token authorization and the kavhttpd service is not running, starting klScanEngineUI will also initiate the start of the kavhttpd service.</p>
<p class="bodytext">The <code class="programcharacter">UseAccessToken</code> element cannot be empty. The element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; AuthSettings &gt; UseAccessToken</code></p>
<p class="introheading">Value</p>
<p class="bodytext">Valid values:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">0&#8212;</code>API token authorization is disabled.</li><li class="listbullet1"><code class="programcharacter">1&#8212;</code>API token authorization is enabled.</li></ul><p class="bodytext">The default value is <code class="programcharacter">0</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UseAccessToken&gt;0&lt;/UseAccessToken&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="222116"><p><a name=222116 style="display: none;">[Topic 222116]</a></p>
	<h6 id="t234278" class="heading6">AuthRequestField</h6>
<p class="bodytext">Specifies the name of the request header field that contains the API token.</p>
<p class="bodytext">If the element <code class="programcharacter">UseAccessToken</code> is set to <code class="programcharacter">1</code>, the <code class="programcharacter">AuthRequestField</code> element is mandatory.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; AuthSettings &gt; AuthRequestField</code></p>
<p class="introheading">Value</p>
<p class="bodytext">The value must meet the following requirements:</p>
<ul class="listbullet1"><li class="listbullet1">3 to 40 characters long.</li><li class="listbullet1">Consists of characters allowed for header field names according to <a class="hyperlinktemplate" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" target="_blank">RFC 7230</a>.</li></ul><p class="bodytext">The default value is <code class="programcharacter">Authorization</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;AuthRequestField&gt;Authorization&lt;/AuthRequestField&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="222121"><p><a name=222121 style="display: none;">[Topic 222121]</a></p>
	<h6 id="t234561" class="heading6">UseBearerAuthScheme</h6>
<p class="bodytext">Specifies if Kaspersky Scan Engine supports the Bearer authentication scheme. When support for the Bearer authentication scheme is enabled, Kaspersky Scan Engine expects that the request header field, named as specified in <a id="h222122" class="englishcrossreferencetemplate" href="#222116" target="_self">AuthRequestField</a>, starts with the <code class="programcharacter">Bearer</code> prefix.</p>
<p class="bodytext">If the element <code class="programcharacter">UseAccessToken</code> is set to <code class="programcharacter">1</code>, the <code class="programcharacter">UseBearerAuthScheme</code> element is mandatory.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings &gt; AuthSettings &gt; UseBearerAuthScheme</code></p>
<p class="introheading">Value</p>
<p class="bodytext">Valid values:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">0&#8212;</code>Support for the Bearer authentication scheme is disabled.</li><li class="listbullet1"><code class="programcharacter">1&#8212;</code>Support for the Bearer authentication scheme is enabled.</li></ul><p class="bodytext">The default value is <code class="programcharacter">1</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UseBearerAuthScheme&gt;1&lt;/UseBearerAuthScheme&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="224176"><p><a name=224176 style="display: none;">[Topic 224176]</a></p>
	<h6 id="t234271" class="heading6">AccessTokens</h6>
<p class="bodytext">This element is a container for <a id="h224178" class="englishcrossreferencetemplate" href="#224177" target="_self">Token</a> elements. If authentication of HTTP clients is enabled, Kaspersky Scan Engine provides access to its functions only to those HTTP clients that have successfully authenticated by using the API token.</p>
<p class="bodytext">If the element <code class="programcharacter">UseAccessToken</code> is set to <code class="programcharacter">1</code>, the <code class="programcharacter">AccessTokens</code> element is mandatory.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings</code> &gt; <code class="programcharacter">AuthSettings &gt; AccessTokens</code></p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;AccessTokens&gt;</p>
<p class="program2">&lt;Token&gt;</p>
<p class="program3">&lt;Name&gt;Unlimited key&lt;/Name&gt;</p>
<p class="program3">&lt;Value&gt;SldYQTUyOUNVMnE3VWR2N3Izamk2QkVNc2hhLTV5dTBLcVUzeXZLdGYtNkkrVFUyQUVRQUNLQUFCSWdwRUlJTQ==&lt;/Value&gt;</p>
<p class="program3">&lt;Description&gt;ScanEngine Clients. Full access scope&lt;/Description&gt;</p>
<p class="program3">&lt;Enabled&gt;1&lt;/Enabled&gt;</p>
<p class="program2">&lt;/Token&gt;</p>
<p class="program2">&lt;Token&gt;</p>
<p class="program3">&lt;Name&gt;Key for URL-scanning&lt;/Name&gt;</p>
<p class="program3">&lt;Value&gt;XUmCkYURUdWQldFGIT3TlEQUQQwkBy2LLNaNMVtrkSQUR2kSNUZV=NT2zLRzQJycVW5VNhUVOdLVcUd3YeVFnT=h&lt;/Value&gt;</p>
<p class="program3">&lt;Description&gt;Server access key. Only URL-scanning&lt;/Description&gt;</p>
<p class="program3">&lt;Enabled&gt;0&lt;/Enabled&gt;</p>
<p class="program2">&lt;/Token&gt;</p>
<p class="program">&lt;/AccessTokens&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="224177"><p><a name=224177 style="display: none;">[Topic 224177]</a></p>
	<h6 id="t234536" class="heading6">Token</h6>
<p class="bodytext">Specifies parameters of an API token, such as its name and value. In the <code class="programcharacter">AccessTokens</code> element, there can be several <code class="programcharacter">Token</code> elements.</p>
<p class="bodytext">If the element <code class="programcharacter">UseAccessToken</code> is set to <code class="programcharacter">1</code>, there must be at least one <code class="programcharacter">Token</code> element and it cannot be empty. </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ServerSettings</code> &gt; <code class="programcharacter">AuthSettings &gt; AccessTokens &gt; Token</code></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1">Name;</li><li class="listbullet1">Value;</li><li class="listbullet1">Description;</li><li class="listbullet1">Enabled.</li></ul><p class="bodytext">See the description of these elements below.</p>
<p class="introheading">Token &gt; Name</p>
<p class="bodytext">The unique name of the token. Each token in the <code class="programcharacter">AccessTokens</code> element must have a unique name. </p>
<p class="bodytext">The name must contain from 1 to 40 Unicode characters.</p>
<p class="bodytext">If the element <code class="programcharacter">UseAccessToken</code> is set to <code class="programcharacter">1</code>, there must be at least one <code class="programcharacter">Name</code> element and it cannot be empty. </p>
<p class="introheading">Token &gt; Value</p>
<p class="bodytext">An element containing the encrypted value of the API token, 88 ASCII characters long.</p>
<p class="bodytext">Do not specify this value directly in the configuration file; use the <a id="h224242" class="englishcrossreferencetemplate" href="#224195" target="_self">Kaspersky Scan Engine GUI</a> or <a id="h180277" class="englishcrossreferencetemplate" href="#179831" target="_self">kl_access_util</a> instead. When the token is added via Kaspersky Scan Engine GUI or kl_access_util, its value is being encrypted. Do not put the original token in the <code class="programcharacter">Value</code> element.</p>
<p class="bodytext">If the element <code class="programcharacter">UseAccessToken</code> is set to <code class="programcharacter">1</code>, there must be at least one <code class="programcharacter">Value</code> element and it cannot be empty.</p>
<p class="introheading">Token &gt; Description</p>
<p class="bodytext">The description contains additional information about the token. For example, the name of the client that uses the token, or the date and time the token was created.</p>
<p class="bodytext">The description can contain up to 1000 Unicode characters.</p>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Token &gt; Enabled</p>
<p class="bodytext">Indicates whether Kaspersky Scan Engine should authorize clients that specified the token in the request header.</p>
<p class="bodytext">Possible values:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">0&#8212;</code>The token is disabled. Kaspersky Scan Engine does not authorize clients that specified the token in the request header.</li><li class="listbullet1"><code class="programcharacter">1&#8212;</code>The token is enabled. Kaspersky Scan Engine can authorize clients that specified the token in the request header.</li></ul><p class="bodytext">If the element <code class="programcharacter">UseAccessToken</code> is set to <code class="programcharacter">1</code>, there must be at least one <code class="programcharacter">Enabled</code> element and it cannot be empty.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of the <code class="programcharacter">Token</code> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Token&gt;</p>
<p class="program2">&lt;Name&gt;Unlimited key&lt;/Name&gt;</p>
<p class="program2">&lt;Value&gt;SldYQTUyOUNVMnE3VWR2N3Izamk2QkVNc2hhLTV5dTBLcVUzeXZLdGYtNkkrVFUyQUVRQUNLQUFCSWdwRUlJTQ==&lt;/Value&gt;</p>
<p class="program2">&lt;Description&gt;Kaspersky Scan Engine Clients. Full access scope&lt;/Description&gt;</p>
<p class="program2">&lt;Enabled&gt;1&lt;/Enabled&gt;</p>
<p class="program">&lt;/Token&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201022"><p><a name=201022 style="display: none;">[Topic 201022]</a></p>
	<h4 id="t234419" class="heading4">KSNSettings</h4>
<p class="bodytext">Specifies KSN settings. </p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h200626" class="englishcrossreferencetemplate" href="#200623" target="_self">UrlCheckTimeoutMs</a></li><li class="listbullet1"><a id="h200627" class="englishcrossreferencetemplate" href="#200624" target="_self">ObjectCheckOnDemandTimeoutMs</a></li><li class="listbullet1"><a id="h201066" class="englishcrossreferencetemplate" href="#201036" target="_self">CacheSizeKb</a></li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of a <em class="emphasischaracter">KSNSettings</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;KSNSettings&gt;</p>
<p class="program2">&lt;UrlCheckTimeoutMs&gt;20000&lt;/UrlCheckTimeoutMs&gt;</p>
<p class="program2">&lt;ObjectCheckOnDemandTimeoutMs&gt;10000&lt;/ObjectCheckOnDemandTimeoutMs&gt;</p>
<p class="program2">&lt;CacheSizeKb&gt;30720&lt;/CacheSizeKb&gt;</p>
<p class="program">&lt;/KSNSettings&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200623"><p><a name=200623 style="display: none;">[Topic 200623]</a></p>
	<h5 id="t234558" class="heading5">UrlCheckTimeoutMs</h5>
<p class="bodytext">Specifies the maximum time that Kaspersky Scan Engine waits for a response from KSN when running reputation checks for URLs (in milliseconds). </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KSNSettings &gt; UrlCheckTimeoutMs</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer and cannot be <code class="programcharacter">0</code>. The default value is <code class="programcharacter">20000</code>.</p>
<p class="attentionbody">Notice that this parameter only sets the timeout for reputation checks in KSN. This timeout does not include the time needed for sending a scan request and receiving a reputation status from KSN.<br>This timeout can be exceeded if KSN finds that the reputation status of the scanned file is <em class="emphasischaracter">Danger</em>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UrlCheckTimeoutMs&gt;20000&lt;/UrlCheckTimeoutMs&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200624"><p><a name=200624 style="display: none;">[Topic 200624]</a></p>
	<h5 id="t234460" class="heading5">ObjectCheckOnDemandTimeoutMs</h5>
<p class="bodytext">Specifies the timeout for response from KSN when running reputation checks for files (in milliseconds). </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KSNSettings &gt; ObjectCheckOnDemandTimeoutMs</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer and cannot be <code class="programcharacter">0</code>. The default value is <code class="programcharacter">10000</code>.</p>
<p class="attentionbody">Notice that this parameter only sets the timeout for reputation checks in KSN. This timeout does not include the time needed for sending a scan request and receiving a reputation status from KSN.<br>This timeout can be exceeded if KSN finds that the reputation status of the scanned file is <em class="emphasischaracter">Danger</em>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ObjectCheckOnDemandTimeoutMs&gt;10000&lt;/ObjectCheckOnDemandTimeoutMs&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201036"><p><a name=201036 style="display: none;">[Topic 201036]</a></p>
	<h5 id="t234289" class="heading5">CacheSizeKb</h5>
<p class="bodytext">Specifies the maximum size of the KSN status cache (in kilobytes). This cache is used by Kaspersky Scan Engine to store scan results obtained from KSN.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KSNSettings &gt; CacheSizeKb</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer. If the value of this parameter is <code class="programcharacter">0</code>, the KSN status cache is not used. The maximum value is <code class="programcharacter">262143</code>.</p>
<p class="bodytext">The default value is <code class="programcharacter">30720</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;CacheSizeKb&gt;30720&lt;/CacheSizeKb&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201023"><p><a name=201023 style="display: none;">[Topic 201023]</a></p>
	<h4 id="t234414" class="heading4">KAVScanningSettings</h4>
<p class="bodytext">Specifies scanning settings for the KAV SDK, which is a part of Kaspersky Scan Engine.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KAVScanningSettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h201067" class="englishcrossreferencetemplate" href="#201037" target="_self">ScannersCount</a></li><li class="listbullet1"><a id="h201068" class="englishcrossreferencetemplate" href="#201038" target="_self">ThreadsCount</a></li><li class="listbullet1"><a id="h201069" class="englishcrossreferencetemplate" href="#200631" target="_self">QueueLen</a></li><li class="listbullet1"><a id="h201070" class="englishcrossreferencetemplate" href="#201040" target="_self">Flags</a></li><li class="listbullet1"><a id="h201071" class="englishcrossreferencetemplate" href="#201041" target="_self">Mode</a></li><li class="listbullet1"><a id="h206217" class="englishcrossreferencetemplate" href="#207145" target="_self">MaxArchivesScanningDepth</a></li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of a <em class="emphasischaracter">KAVScanningSettings</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;KAVScanningSettings&gt;</p>
<p class="program2">&lt;ScannersCount&gt;4&lt;/ScannersCount&gt;</p>
<p class="program2">&lt;ThreadsCount&gt;8&lt;/ThreadsCount&gt;</p>
<p class="program2">&lt;QueueLen&gt;1024&lt;/QueueLen&gt;</p>
<p class="program2">&lt;Flags&gt;KAV_O_M_PACKED | KAV_O_M_ARCHIVED | KAV_O_M_MAILBASES | KAV_O_M_MAILPLAIN | KAV_O_M_HEURISTIC_LEVEL_DETAIL&lt;/Flags&gt;</p>
<p class="program2">&lt;Mode&gt;KAV_SKIP&lt;/Mode&gt;</p>
<p class="program2">&lt;MaxArchivesScanningDepth&gt;0&lt;/MaxArchivesScanningDepth&gt;</p>
<p class="program"><code class="programcharacter">&lt;/KAVScanningSe</code>tti<code class="programcharacter">ngs&gt;</code></p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201037"><p><a name=201037 style="display: none;">[Topic 201037]</a></p>
	<h5 id="t234497" class="heading5">ScannersCount</h5>
<p class="bodytext">Specifies the number of scanning processes. You can have up to 256 scanning processes.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KAVScanningSettings &gt; ScannersCount</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer and cannot be <code class="programcharacter">0</code>. The default value is <code class="programcharacter">4</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ScannersCount&gt;4&lt;/ScannersCount&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201038"><p><a name=201038 style="display: none;">[Topic 201038]</a></p>
	<h5 id="t234529" class="heading5">ThreadsCount</h5>
<p class="bodytext">Specifies the number of simultaneously running scanning threads. You can have up to 256 scanning threads.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KAVScanningSettings &gt; ThreadsCount</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer and cannot be <code class="programcharacter">0</code>. The default value is <code class="programcharacter">8</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ThreadsCount&gt;8&lt;/ThreadsCount&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200631"><p><a name=200631 style="display: none;">[Topic 200631]</a></p>
	<h5 id="t234468" class="heading5">QueueLen</h5>
<p class="bodytext">Specifies the maximum length of the queue for scan tasks.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KAVScanningSettings &gt; QueueLen</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer and cannot be <code class="programcharacter">0</code>. The default value is <code class="programcharacter">1024</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;QueueLen&gt;1024&lt;/QueueLen&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201040"><p><a name=201040 style="display: none;">[Topic 201040]</a></p>
	<h5 id="t234358" class="heading5">Flags</h5>
<p class="bodytext">Specifies a scanning mode.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KAVScanningSettings &gt; Flags</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">Scanning modes are defined by a combination of flags separated by vertical bars (<code class="programcharacter">|</code>). This is a string value. </p>
<p class="bodytext">Possible values: </p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">KAV_O_M_PACKED</code><p class="listcontinue1">Scan compressed executable files.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_O_M_ARCHIVED</code><p class="listcontinue1">Scan archived files.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_O_M_MAILBASES</code><p class="listcontinue1">Scan email database files.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_O_M_MAILPLAIN</code><p class="listcontinue1">Scan email messages.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_O_M_HEURISTIC_LEVEL_SHALLOW</code><p class="listcontinue1">Set the scanning level of the advanced heuristic code analyzer to <code class="programcharacter">shallow</code> (the Low level in the graphical user interface).</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_O_M_HEURISTIC_LEVEL_MEDIUM</code><p class="listcontinue1">Set the scanning level of the advanced heuristic code analyzer to <code class="programcharacter">medium</code> (the Medium level in the graphical user interface).</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_O_M_HEURISTIC_LEVEL_DETAIL</code><p class="listcontinue1">Set the scanning level of the advanced heuristic code analyzer to <code class="programcharacter">detailed</code> (the High level in the graphical user interface).</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_O_M_MSOFFICE_MACRO</code><p class="listcontinue1">Notify the user if a Microsoft Office document file contains a macro.</p>
</li></ul><p class="bodytext">This element can be empty. In this case, the value of <code class="programcharacter">0</code> is used.</p>
<p class="bodytext">The default value is <code class="programcharacter">KAV_O_M_PACKED | KAV_O_M_ARCHIVED | KAV_O_M_MAILBASES | KAV_O_M_MAILPLAIN | KAV_O_M_HEURISTIC_LEVEL_DETAIL</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Flags&gt;KAV_O_M_PACKED | KAV_O_M_ARCHIVED | KAV_O_M_MAILBASES | KAV_O_M_MAILPLAIN | KAV_O_M_HEURISTIC_LEVEL_DETAIL&lt;/Flags&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201041"><p><a name=201041 style="display: none;">[Topic 201041]</a></p>
	<h5 id="t234458" class="heading5">Mode</h5>
<p class="bodytext">Specifies a cleaning mode</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KAVScanningSettings &gt; Mode</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This is a string value. This is a mandatory parameter.</p>
<p class="bodytext">Possible values:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">KAV_SKIP</code><p class="listcontinue1">If malware is detected while scanning an object, Kaspersky Scan Engine will not try to disinfect or delete the object. The infected object will be skipped.</p>
<p class="listcontinue1">Specify this value if you want to use scanmemory mode.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_DELETE</code><p class="listcontinue1">If malware is detected while scanning an object, Kaspersky Scan Engine will try to delete the object. If deletion is not possible, the infected object will be skipped.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_CLEAN_DELETE</code><p class="listcontinue1">If malware is detected while scanning an object, Kaspersky Scan Engine will try to disinfect the object. If the disinfection attempt fails, or disinfection is not possible for specific malware, the object will be deleted. If deletion is not possible, the infected object will be skipped.</p>
<p class="attentioncontinue1">The above actions will be performed only if Kaspersky Anti-Virus Engine detects a threat while processing a <code class="programcharacter">scanfile</code> request. In all other cases, Kaspersky Scan Engine will only send a notification if the specified actions can be applied to the detected object.</p>
</li><li class="listbullet1"><code class="programcharacter">KAV_CLEAN_SKIP</code><p class="listcontinue1">If malware is detected while scanning an object, Kaspersky Scan Engine will try to disinfect the object. If the disinfection attempt fails, the infected object will be skipped.</p>
</li></ul><p class="bodytext">The default value is <code class="programcharacter">KAV_SKIP</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Mode&gt;KAV_SKIP&lt;/Mode&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="207145"><p><a name=207145 style="display: none;">[Topic 207145]</a></p>
	<h5 id="t234450" class="heading5">MaxArchivesScanningDepth</h5>
<p class="bodytext">Specifies the maximum depth of nested archives to be unpacked during scanning. This parameter is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KAVScanningSettings &gt; MaxArchivesScanningDepth</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The value must be an unsigned integer. </p>
<p class="bodytext">The default value is <code class="programcharacter">0</code>.</p>
<p class="bodytext">The recommended value is <code class="programcharacter">5</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;MaxArchivesScanningDepth&gt;0&lt;/MaxArchivesScanningDepth&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201024"><p><a name=201024 style="display: none;">[Topic 201024]</a></p>
	<h4 id="t234320" class="heading4">DirectorySettings</h4>
<p class="bodytext">Specifies directory settings for KAV SDK, which is a part of Kaspersky Scan Engine. </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">DirectorySettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h201072" class="englishcrossreferencetemplate" href="#201042" target="_self">BasesPath</a> </li><li class="listbullet1"><a id="h201073" class="englishcrossreferencetemplate" href="#200640" target="_self">TempPath</a></li><li class="listbullet1"><a id="h201074" class="englishcrossreferencetemplate" href="#201044" target="_self">LicensePath</a></li><li class="listbullet1"><a id="h201075" class="englishcrossreferencetemplate" href="#201045" target="_self">LicensingMode</a></li><li class="listbullet1"><a id="h201077" class="englishcrossreferencetemplate" href="#201076" target="_self">ScanningPaths</a></li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of a <em class="emphasischaracter">DirectorySettings</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;DirectorySettings&gt;</p>
<p class="program2">&lt;BasesPath&gt;/home/bases&lt;/BasesPath&gt;</p>
<p class="program2">&lt;TempPath&gt;/home/temp&lt;/TempPath&gt;</p>
<p class="program2">&lt;LicensePath&gt;/home/license&lt;/LicensePath&gt;</p>
<p class="program2">&lt;LicensingMode&gt;1&lt;/LicensingMode&gt;</p>
<p class="program2">&lt;ScanningPaths&gt;</p>
<p class="program3">&lt;ScanningPath&gt;&lt;/ScanningPath&gt;</p>
<p class="program2">&lt;/ScanningPaths&gt;</p>
<p class="program">&lt;/DirectorySettings&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201042"><p><a name=201042 style="display: none;">[Topic 201042]</a></p>
	<h5 id="t234283" class="heading5">BasesPath</h5>
<p class="bodytext">Specifies a directory where the database is located. </p>
<p class="bodytext">This element is mandatory.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">DirectorySettings &gt; BasesPath</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This is a string value. </p>
<p class="attentionbody">Notice that in Windows systems you have to specify a full path to the directory where the database is located.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;BasesPath&gt;/home/bases&lt;/BasesPath&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200640"><p><a name=200640 style="display: none;">[Topic 200640]</a></p>
	<h5 id="t234527" class="heading5">TempPath</h5>
<p class="bodytext">Specifies a directory where the files created at runtime are stored. </p>
<p class="bodytext">This element is mandatory.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">DirectorySettings &gt; TempPath</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This is a string value. The path must be absolute.</p>
<p class="warningbody">Do not delete any files from this directory.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;TempPath&gt;/home/temp&lt;/TempPath&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201044"><p><a name=201044 style="display: none;">[Topic 201044]</a></p>
	<h5 id="t234424" class="heading5">LicensePath</h5>
<p class="bodytext">Specifies a directory where the application ID file, the licensing file, and the key file are stored.</p>
<p class="bodytext">This element is mandatory.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">DirectorySettings &gt; LicensePath</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This is a string value. Kaspersky Scan Engine looks for these files in the following directories:</p>
<ul class="listbullet1"><li class="listbullet1">The directory that is specified in <code class="programcharacter">LicensePath.</code></li><li class="listbullet1">The directory that contains the <code class="programcharacter">kavhttpd</code> executable file.</li><li class="listbullet1">The <code class="programcharacter">%service_dir%/ppl</code> directory. For Linux systems only.</li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;LicensePath&gt;/home/license&lt;/LicensePath&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201045"><p><a name=201045 style="display: none;">[Topic 201045]</a></p>
	<h5 id="t234428" class="heading5">LicensingMode</h5>
<p class="bodytext">Specifies the licensing mode used in Kaspersky Scan Engine.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">DirectorySettings &gt; LicensingMode</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">Possible values:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">1&#8212;</code><a id="h180864" class="englishcrossreferencetemplate" href="#179852" target="_self">Offline licensing mode</a></li><li class="listbullet1"><code class="programcharacter">2&#8212;</code><a id="h180819" class="englishcrossreferencetemplate" href="#179855" target="_self">Online licensing mode</a></li></ul><p class="bodytext">The default value is <code class="programcharacter">1</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;LicensingMode&gt;1&lt;/LicensingMode&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201076"><p><a name=201076 style="display: none;">[Topic 201076]</a></p>
	<h5 id="t234502" class="heading5">ScanningPaths</h5>
<p class="bodytext">Contains paths to the locations where scanning is allowed when an HTTP client sends scan requests over a TCP socket from a remote computer. Scanning in other locations is prohibited. These paths are located in the file system of the computer with the Kaspersky Scan Engine server. Restricting the scan area prevents scanning the whole file system of the Kaspersky Scan Engine server by a command from the outside.</p>
<p class="bodytext">By default, Kaspersky Scan Engine scans objects in <a id="h201071" class="englishcrossreferencetemplate" href="#201041" target="_self">KAV_SKIP mode</a>, which means that Kaspersky Scan Engine does not add or remove objects in the directories specified in <code class="programcharacter">ScanningPath</code>. The HTTP client has to send objects to scan, then remove them after scanning.</p>
<p class="attentionbody">If Kaspersky Scan Engine scans objects in KAV_DELETE, KAV_CLEAN_DELETE, or KAV_CLEAN_SKIP mode, sometimes the directory specified in <code class="programcharacter">ScanningPaths</code> must have write access as root.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">DirectorySettings &gt; ScanningPaths</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><em class="emphasischaracter">ScanningPath</em><p class="listcontinue1">Specifies a location where scanning over a TCP socket in scanfile mode is allowed.</p>
<p class="attentioncontinue1">It is not recommended to use links as paths due to security reasons. Use absolute paths instead.</p>
<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2">Absolute paths to a directory<p class="listcontinue2">Allows scanning files that are located inside this directory and all its subdirectories.</p>
<p class="listcontinue2">The directory must be located on the same computer as Kaspersky Scan Engine or on a remote hard disk mounted on that computer.</p>
<p class="listcontinue2">The path must start from the root directory of the computer that Kaspersky Scan Engine is installed on.</p>
<p class="listcontinue2">The kavhttpd service must have permissions to read files in the directory and its subdirectories.</p>
</li><li class="listbullet2">Absolute path to a file<p class="listcontinue2">Allows scanning of the specified file.</p>
<p class="listcontinue2">The file must be located on the same computer as Kaspersky Scan Engine or on a remote hard disk mounted on that computer.</p>
<p class="listcontinue2">The path must start from the root directory of the computer that Kaspersky Scan Engine is installed on.</p>
<p class="listcontinue2">The kavhttpd service must have permissions to read the file.</p>
</li><li class="listbullet2"><code class="programcharacter">/</code> (forward slash)<p class="listcontinue2">Allows scanning of all files.</p>
<p class="attentioncontinue2">For Linux systems only.</p>
</li></ul><p class="listcontinue1">Each path is specified inside its own <code class="programcharacter">&lt;ScanningPath&gt;</code> element.</p>
</li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ScanningPaths&gt;</p>
<p class="program2">&lt;ScanningPath&gt;&lt;/ScanningPath&gt;</p>
<p class="program">&lt;/ScanningPaths&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200598"><p><a name=200598 style="display: none;">[Topic 200598]</a></p>
	<h4 id="t234562" class="heading4">UseHTTPProxy</h4>
<p class="bodytext">Specifies whether Kaspersky Scan Engine uses proxy when connecting to the Internet.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UseHTTPProxy</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">UseHTTPProxy element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Proxy is not used.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Proxy is used.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of a <em class="emphasischaracter">UseHTTPProxy</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UseHTTPProxy&gt;1&lt;/UseHTTPProxy&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201047"><p><a name=201047 style="display: none;">[Topic 201047]</a></p>
	<h4 id="t234381" class="heading4">HTTPProxy</h4>
<p class="bodytext">Specifies proxy settings.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">HTTPProxy</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">url</code> is the address of the proxy. This is a string value.<p class="listcontinue1">The value of this parameter can be an IPv4 address, an IPv6 address, or a domain name. Do not specify a protocol (<code class="programcharacter">http://</code> or <code class="programcharacter">https://</code>) in this parameter.</p>
<p class="listcontinue1">If <code class="programcharacter">UseHTTPProxy</code> is set to 1, this parameter is mandatory.</p>
</li><li class="listbullet1"><code class="programcharacter">port</code> is the port of the proxy. This value must be an unsigned integer and cannot be <code class="programcharacter">0</code>.<p class="listcontinue1">The default value is <code class="programcharacter">3128</code>.</p>
</li><li class="listbullet1"><code class="programcharacter">user</code> is the encrypted user name used to authenticate on a proxy server. The user name is encrypted by the <code class="programcharacter">kav_encrypt</code> utility.  This is a string value.<p class="listcontinue1">If <code class="programcharacter">UseHTTPProxy</code> is set to <code class="programcharacter">1</code>, this parameter is mandatory.</p>
</li><li class="listbullet1"><code class="programcharacter">pass</code> is the encrypted password used to authenticate on a proxy server. The password is encrypted by the <code class="programcharacter">kav_encrypt</code> utility. This is a string value.<p class="listcontinue1">If <code class="programcharacter">UseHTTPProxy</code> is set to <code class="programcharacter">1</code>, this parameter is mandatory.</p>
<p class="spacer"></p>
</li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of an <em class="emphasischaracter">HTTPProxy</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;HTTPProxy&gt;</p>
<p class="program2">&lt;url&gt;myproxy.mycompany.com&lt;/url&gt;</p>
<p class="program2">&lt;port&gt;3128&lt;/port&gt;</p>
<p class="program2">&lt;user&gt;doOTrypDTxpVJxUHYeKQTw==&lt;/user&gt;</p>
<p class="program2">&lt;pass&gt;8mSHXFix3uL+RP9oNeKDZQ==&lt;/pass&gt;</p>
<p class="program">&lt;/HTTPProxy&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201025"><p><a name=201025 style="display: none;">[Topic 201025]</a></p>
	<h4 id="t234549" class="heading4">UpdateSettings</h4>
<p class="bodytext">The following parameters specify <a id="h180054" class="englishcrossreferencetemplate" href="#179873" target="_self">update settings for Kaspersky Scan Engine</a>.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h201079" class="englishcrossreferencetemplate" href="#200649" target="_self">DisableBackup</a></li><li class="listbullet1"><a id="h201080" class="englishcrossreferencetemplate" href="#200650" target="_self">UpdatePeriodMinutes</a></li><li class="listbullet1"><a id="h201081" class="englishcrossreferencetemplate" href="#200651" target="_self">UseOnlyCustomSources</a></li><li class="listbullet1"><a id="h201082" class="englishcrossreferencetemplate" href="#201051" target="_self">UpdateSources</a></li><li class="listbullet1"><a id="h201083" class="englishcrossreferencetemplate" href="#200653" target="_self">UpdatesCertFile</a></li><li class="listbullet1"><a id="h201084" class="englishcrossreferencetemplate" href="#200654" target="_self">CertificateConfirmationAction</a></li><li class="listbullet1"><a id="h200662" class="englishcrossreferencetemplate" href="#200655" target="_self">UseReducedBases</a></li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of an <em class="emphasischaracter">UpdateSettings</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UpdateSettings&gt;</p>
<p class="program2">&lt;DisableBackup&gt;0&lt;/DisableBackup&gt;</p>
<p class="program2">&lt;UpdatePeriodMinutes&gt;0&lt;/UpdatePeriodMinutes&gt;</p>
<p class="program2">&lt;UseOnlyCustomSources&gt;0&lt;/UseOnlyCustomSources&gt;</p>
<p class="program2">&lt;UpdateSources&gt;</p>
<p class="program3">&lt;Source&gt;[update source]&lt;/Source&gt;</p>
<p class="program2">&lt;/UpdateSources&gt;</p>
<p class="program2">&lt;UpdatesCertFile&gt;&lt;/UpdatesCertFile&gt;</p>
<p class="program2">&lt;CertificateConfirmationAction&gt;0&lt;/CertificateConfirmationAction&gt;</p>
<p class="program2">&lt;UseReducedBases&gt;0&lt;/UseReducedBases&gt;</p>
<p class="program">&lt;/UpdateSettings&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200649"><p><a name=200649 style="display: none;">[Topic 200649]</a></p>
	<h5 id="t234321" class="heading5">DisableBackup</h5>
<p class="bodytext">Defines whether the database backup is disabled. </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; DisableBackup</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">DisableBackup element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="234"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="276"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Anti-virus database backup is enabled.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Anti-virus database backup is disabled.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;DisableBackup&gt;0&lt;/DisableBackup&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200650"><p><a name=200650 style="display: none;">[Topic 200650]</a></p>
	<h5 id="t234545" class="heading5">UpdatePeriodMinutes</h5>
<p class="bodytext">Specifies automatic update interval (in minutes). </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; UpdatePeriodMinutes</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer. The maximum value is <code class="programcharacter">44640</code>.</p>
<p class="bodytext">If this parameter is <code class="programcharacter">0</code>, Kaspersky Scan Engine does not perform automatic updates.</p>
<p class="bodytext">The preset value in the configuration file is <code class="programcharacter">0</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UpdatePeriodMinutes&gt;0&lt;/UpdatePeriodMinutes&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200651"><p><a name=200651 style="display: none;">[Topic 200651]</a></p>
	<h5 id="t234564" class="heading5">UseOnlyCustomSources</h5>
<p class="bodytext">Specifies whether the default update sources are used. </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; UseOnlyCustomSources</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">UseOnlyCustomSources element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Kaspersky update servers are used along with custom update sources.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Only the custom update sources are used.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UseOnlyCustomSources&gt;0&lt;/UseOnlyCustomSources&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201051"><p><a name=201051 style="display: none;">[Topic 201051]</a></p>
	<h5 id="t234551" class="heading5">UpdateSources</h5>
<p class="bodytext">Contains custom update sources.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; UpdateSources</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><em class="emphasischaracter">Source</em><p class="listcontinue1">Specifies a custom update source. This is a string value.</p>
<p class="listcontinue1">Each update source is specified inside its own <code class="programcharacter">&lt;Source&gt;</code> element. See an example of <a id="h180054" class="englishcrossreferencetemplate" href="#179873" target="_self">specifying custom database update sources</a>.</p>
<p class="listcontinue1">If Kaspersky Scan Engine must use TLS when connecting to a custom update source, you must specify the <code class="programcharacter">https://</code> protocol in the address of this custom update source.</p>
</li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UpdateSources&gt;</p>
<p class="program2">&lt;Source&gt;[update source]&lt;/Source&gt;</p>
<p class="program">&lt;/UpdateSources&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200653"><p><a name=200653 style="display: none;">[Topic 200653]</a></p>
	<h5 id="t234547" class="heading5">UpdatesCertFile</h5>
<p class="bodytext">Path to the PEM-formatted root certificate to be used for downloading updates from custom HTTPS update servers. </p>
<p class="bodytext">The parameter is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; UpdatesCertFile</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">You can specify either an absolute or relative path. A relative path is relative to the location of the <code class="programcharacter">kavhttpd</code> executable file.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UpdatesCertFile&gt;&lt;/UpdatesCertFile&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200654"><p><a name=200654 style="display: none;">[Topic 200654]</a></p>
	<h5 id="t234291" class="heading5">CertificateConfirmationAction</h5>
<p class="bodytext">Specifies action to undertake if the update server uses an untrusted certificate.</p>
<p class="bodytext">The parameter is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; CertificateConfirmationAction</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">CertificateConfirmationAction element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">The update server must not be used.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">The update server must be still used.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;CertificateConfirmationAction&gt;0&lt;/CertificateConfirmationAction&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200655"><p><a name=200655 style="display: none;">[Topic 200655]</a></p>
	<h5 id="t234569" class="heading5">UseReducedBases</h5>
<p class="bodytext">Specifies a parameter that  is one of the terms that defines whether a reduced databases kit is updated or not.</p>
<p class="bodytext">The parameter is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; UseReducedBases</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">UseReducedBases element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="bodytext">The full databases kit is always updated.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="bodytext">The built-in functionality of KAV SDK updates the reduced kit, if all terms of updating to a reduced databases kit are observed. If at least one of the acceptance terms is not observed, the full databases kit is updated.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UseReducedBases&gt;0&lt;/UseReducedBases&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201055"><p><a name=201055 style="display: none;">[Topic 201055]</a></p>
	<h4 id="t234365" class="heading4">FormatRecognizerSettings</h4>
<p class="bodytext">Specifies Format Recognizer settings. </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">FormatRecognizerSettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><em class="emphasischaracter">FormatsToSkipScanning</em><p class="listcontinue1">Specifies which <a id="h180224" class="englishcrossreferencetemplate" href="#180222" target="_self">file formats</a> must not be scanned by Kaspersky Scan Engine in HTTP mode.</p>
<p class="listcontinue1">To disable the format skipping functionality, remove the <code class="programcharacter">FormatRecognizerSettings</code> section from the configuration file or leave the <code class="programcharacter">FormatsToSkipScanning</code> list empty.</p>
</li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of a <em class="emphasischaracter">FormatRecognizerSettings</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;FormatRecognizerSettings&gt;</p>
<p class="program2">&lt;FormatsToSkipScanning&gt;</p>
<p class="program3">&lt;KAV_FF_GENERAL_TXT/&gt;</p>
<p class="program3">&lt;KAV_FF_GENERAL_CSV/&gt;</p>
<p class="program3">&lt;KAV_FF_AUDIO_WMA/&gt;</p>
<p class="program2">&lt;/FormatsToSkipScanning&gt;</p>
<p class="program">&lt;/FormatRecognizerSettings&gt;  </p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179868"><p><a name=179868 style="display: none;">[Topic 179868]</a></p>
	<h3 id="t234299" class="heading3">Configuring Format Recognizer for use in HTTP mode</h3>
<p class="bodytext">Format Recognizer is a component that can be used in Kaspersky Scan Engine to recognize and skip files of certain formats during the scanning process. Skipping files increases the processing speed of Kaspersky Scan Engine in HTTP mode.</p>
<p class="introheading">Enabling Format Recognizer</p>
<p class="procedureheading">To enable Format Recognizer:</p>
<ol class="listnumber1"><li class="listnumber1">In the <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">HTTP mode configuration file</a>, locate the <code class="programcharacter">FormatRecognizerSettings</code> section.<p class="listcontinue1">If this section is missing, add it manually as follows:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;FormatRecognizerSettings&gt;</p>
<p class="program">...</p>
<p class="program">&lt;/FormatRecognizerSettings&gt;  </p>
</td>
</tr>

</table>
</li><li class="listnumber1">Within this section, in the <code class="programcharacter">FormatsToSkipScanning</code> list, specify which <a id="h180224" class="englishcrossreferencetemplate" href="#180222" target="_self">file formats</a> must not be scanned by Kaspersky Scan Engine, as follows:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;FormatRecognizerSettings&gt;</p>
<p class="program2">&lt;FormatsToSkipScanning&gt;</p>
<p class="program3">&lt;KAV_FF_GENERAL_TXT/&gt;</p>
<p class="program3">...</p>
<p class="program3">&lt;KAV_FF_AUDIO_WMA/&gt;</p>
<p class="program2">&lt;/FormatsToSkipScanning&gt;</p>
<p class="program">&lt;/FormatRecognizerSettings&gt;</p>
</td>
</tr>

</table>
</li><li class="listnumber1">For the changes to take effect, restart the <code class="programcharacter">kavhttpd</code> service with the following command:<p class="listcontinue1"><code class="programcharacter">service kavhttpd restart</code></p>
</li></ol><p class="bodytext">Format Recognizer will start recognizing and skipping files of the formats specified in the <code class="programcharacter">FormatsToSkipScanning</code> list. Kaspersky Scan Engine will not scan the skipped files, which will increase its processing speed.</p>
<p class="introheading">Disabling Format Recognizer</p>
<p class="procedureheading">To disable Format Recognizer:</p>
<ol class="listnumber1"><li class="listnumber1">In the <a id="h179927_2" class="englishcrossreferencetemplate" href="#184799" target="_self">HTTP mode configuration file</a>, remove the <code class="programcharacter">FormatRecognizerSettings</code> section or leave the <code class="programcharacter">FormatsToSkipScanning</code> list empty.</li><li class="listnumber1">For the changes to take effect, restart the <code class="programcharacter">kavhttpd</code> service with the following command:<p class="listcontinue1"><code class="programcharacter">service kavhttpd restart</code></p>
</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179869"><p><a name=179869 style="display: none;">[Topic 179869]</a></p>
	<h3 id="t234518" class="heading3">Setting up the connection queue in HTTP mode</h3>
<p class="bodytext">The connection queue contains pending connections to Kaspersky Scan Engine. By configuring the connection queue, you can influence the performance of Kaspersky Scan Engine in HTTP mode. This section explains how to configure the connection queue.</p>
<p class="bodytext">Three parameters allow you to configure the connection queue: <code class="programcharacter">MaxHTTPSessionsNum</code>, <code class="programcharacter">MaxIncomingConnectionsNum</code>, and <code class="programcharacter">ThreadsCount</code>. These parameters can be set in the <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">HTTP mode configuration file</a>.</p>
<p class="introheading">MaxHTTPSessionsNum</p>
<p class="bodytext">This parameter specifies the maximum number of active TCP connections that Kaspersky Scan Engine can maintain simultaneously. When a TCP connection with a client closes, Kaspersky Scan Engine can accept another connection in its place.</p>
<p class="introheading">MaxIncomingConnectionsNum</p>
<p class="bodytext">This parameter specifies the maximum number of pending TCP connections to Kaspersky Scan Engine. If the number of pending connections reaches <code class="programcharacter">MaxIncomingConnectionsNum</code>, additional connections may be dropped.</p>
<p class="introheading">ThreadsCount</p>
<p class="bodytext">This parameter specifies the maximum number of simultaneously running scan threads. When a scan thread completes a scanning task, it picks up another one from the scan queue.</p>
<p class="introheading">Examples of the connection queue configuration</p>
<p class="bodytext">These examples show how you can use the connection queue to influence the behavior of Kaspersky Scan Engine.</p>
<ul class="listbullet1"><li class="listbullet1">Kaspersky Scan Engine without a connection queue<p class="listcontinue1">Consider the following example: the value of <code class="programcharacter">MaxIncomingConnectionsNum</code> is <code class="programcharacter">16</code>, the value of <code class="programcharacter">ThreadsCount</code> is <code class="programcharacter">16</code>, and the value of <code class="programcharacter">MaxHTTPSessionsNum</code> is <code class="programcharacter">50</code>. In this example, Kaspersky Scan Engine can accept only <code class="programcharacter">16</code> connections at a time, but because <code class="programcharacter">MaxHTTPSessionsNum</code> is <code class="programcharacter">50</code>, their scan tasks are accepted immediately. Additional connections may be dropped. Sixteen scan threads is usually enough to process scan tasks from 16 clients quickly, so the scan queue will be short.</p>
</li><li class="listbullet1">Kaspersky Scan Engine with a connection queue<p class="listcontinue1">Consider the following example: the value of <code class="programcharacter">MaxIncomingConnectionsNum</code> is <code class="programcharacter">100</code>, the value of <code class="programcharacter">ThreadsCount</code> is <code class="programcharacter">16</code>, and the value of <code class="programcharacter">MaxHTTPSessionsNum</code> is <code class="programcharacter">50</code>. In this example, Kaspersky Scan Engine can accept <code class="programcharacter">50</code> connections at a time. Kaspersky Scan Engine starts processing scan tasks from some of these clients in <code class="programcharacter">16</code> scan threads, and the rest of the scan tasks form the scan queue. Other pending connections form the connection queue and wait to be accepted. Additional connections may be dropped.</p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179870"><p><a name=179870 style="display: none;">[Topic 179870]</a></p>
	<h3 id="t234517" class="heading3">Setting the session timeout</h3>
<p class="bodytext">There are parameters that affect the session timeout: the <code class="programcharacter">SessionTimeout</code> and <code class="programcharacter">TimeoutMs</code> parameters of the <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">HTTP mode configuration file</a> and the <code class="programcharacter">X-KAV-Timeout</code> <a id="h179981" class="englishcrossreferencetemplate" href="#179875" target="_self">request header</a>. This section explains how to configure the session timeout for Kaspersky Scan Engine in HTTP mode by using these values.</p>
<p class="introheading">SessionTimeout</p>
<p class="bodytext">This parameter of the configuration file sets the maximum time that Kaspersky Scan Engine can spend on receiving a scan request for an object and on processing this request (scanning operation), in milliseconds. This timeout is valid for all objects sent to Kaspersky Scan Engine.</p>
<p class="bodytext">Consider the following example: the value of <code class="programcharacter">SessionTimeout</code> is set to <code class="programcharacter">4000</code> (four seconds), and the request does not contain the <code class="programcharacter">X-KAV-Timeout</code> header. Kaspersky Scan Engine spends one second on receiving the request. Then Kaspersky Scan Engine spends the remaining three seconds on scanning.</p>
<p class="introheading">X-KAV-Timeout</p>
<p class="bodytext">This header sets the time that Kaspersky Scan Engine can spend on a scanning operation (in milliseconds), regardless of the value of the <code class="programcharacter">SessionTimeout</code> parameter.</p>
<p class="bodytext">The range of values for this parameter is from <code class="programcharacter">0</code> to <code class="programcharacter">4294967295</code> (an unsigned 32-bit integer).</p>
<p class="bodytext">Consider the following example: the value of <code class="programcharacter">SessionTimeout</code> is set to <code class="programcharacter">4000</code> (four seconds), and the value of <code class="programcharacter">X-KAV-Timeout</code> is set to <code class="programcharacter">10000</code> (10 seconds). Kaspersky Scan Engine spends one second on receiving the request. Then Kaspersky Scan Engine spends 10 seconds (which is the value of <code class="programcharacter">X-KAV-Timeout</code>) on scanning.</p>
<p class="bodytext">If <code class="programcharacter">SessionTimeout</code> is exceeded during the reception of the request, the session is closed, regardless of the value of <code class="programcharacter">X-KAV-Timeout</code>.</p>
<p class="bodytext">Consider the following example: the value of <code class="programcharacter">SessionTimeout</code> is set to <code class="programcharacter">4000</code> (four seconds), and the value of <code class="programcharacter">X-KAV-Timeout</code> is set to <code class="programcharacter">10000</code> (10 seconds). Kaspersky Scan Engine spends four seconds on receiving the request, and the session is closed because <code class="programcharacter">SessionTimeout</code> is exceeded.</p>
<p class="bodytext">You can choose the value of <code class="programcharacter">X-KAV-Timeout</code> on the basis of the size of the files that you want to scan. For example, Kaspersky Scan Engine could require 10 seconds to scan a large file, or 0.1 seconds to scan a small one.</p>
<p class="introheading">TimeoutMs</p>
<p class="bodytext">By default, Kaspersky Scan Engine supports <a id="h207358" class="englishcrossreferencetemplate" href="#207348" target="_self">Keep-Alive connections</a>, so it can process multiple objects one after another, by using the same connection.</p>
<p class="bodytext">For each new object, Kaspersky Scan Engine starts the new <code class="programcharacter">SessionTimeout</code>. After Kaspersky Scan Engine sends scan results, it keeps the connection open for as much time as <code class="programcharacter">TimeoutMs</code> specifies, even if the <code class="programcharacter">SessionTimeout</code> time has already expired. If a new object was received before <code class="programcharacter">TimeoutMs</code> expired, the new <code class="programcharacter">SessionTimeout</code> begins while the same connection remains open.</p>
<p class="bodytext">If Keep-Alive connections support is disabled, Kaspersky Scan Engine closes the connection after the <code class="programcharacter">SessionTimeout</code> time is expired.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179872"><p><a name=179872 style="display: none;">[Topic 179872]</a></p>
	<h3 id="t234294" class="heading3">Changing variables in the HTTP mode unit file</h3>
<p class="bodytext">You can configure Kaspersky Scan Engine by changing one or more variables in its unit file, <code class="programcharacter">%distr_kit%/etc/kavhttpd.service</code>.</p>
<p class="introheading">Changing the path to the Kaspersky Scan Engine PID file</p>
<p class="bodytext">You can change this variable if you want to create a PID file of Kaspersky Scan Engine in a directory other than <code class="programcharacter">/var/run/kavhttpd.pid</code>.</p>
<p class="bodytext">The following example shows how this variable is set in the unit file:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">PIDFile=/var/run/kavhttpd.pid</p>
</td>
</tr>

</table>
<p class="introheading">Changing environment variables</p>
<p class="bodytext">You must change these environment variables if Kaspersky Scan Engine is located in a directory other than <code class="programcharacter">/opt/kaspersky/ScanEngine</code>.</p>
<p class="bodytext">The unit file uses the following environment variables:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">SDKPATH</code>&#8212;Specifies the directory where Kaspersky Scan Engine is located. The following example shows how this variable is set in the unit file:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">Environment=SDKPATH=/opt/kaspersky/ScanEngine</p>
</td>
</tr>

</table>
</li><li class="listbullet1"><code class="programcharacter">KL_PLUGINS_PATH</code>&#8212;Specifies the path to the directory containing the PPL plug-in files used by Kaspersky Scan Engine. The following example shows how this variable is set in the unit file:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">Environment=KL_PLUGINS_PATH=/ppl</p>
</td>
</tr>

</table>
</li><li class="listbullet1"><code class="programcharacter">LD_LIBRARY_PATH</code>&#8212;Specifies the path to the directory containing shared libraries used by Kaspersky Scan Engine. The following block shows how this variable is set in the unit file:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">Environment=LD_LIBRARY_PATH=/lib:/ppl</p>
</td>
</tr>

</table>
</li></ul><p class="introheading">Changing paths in the command executed on kavhttpd startup</p>
<p class="bodytext">You must change paths in the command executed on kavhttpd startup if you put the <code class="programcharacter">kavhttpd</code> executable file or the HTTP mode configuration file in directories different from the ones specified in the unit file, or if you want to create a PID file of Kaspersky Scan Engine in a directory other from <code class="programcharacter">/var/run/kavhttpd.pid</code>.</p>
<p class="bodytext">The following example shows how this command is set in the unit file:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">ExecStart=/bin/sh -c 'cd ${SDKPATH}/bin; ./kavhttpd -c /etc/kavhttpd.xml -p /var/run/kavhttpd.pid'</p>
</td>
</tr>

</table>
<p class="introheading">Monitoring enabling and disabling in the command executed on kavhttpd startup</p>
<p class="bodytext">You can enable or disable monitoring by adding or removing the -w option in the command executed on kavhttpd startup.</p>
<p class="bodytext">The following example shows how to enable monitoring in the unit file:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">ExecStart=/bin/sh -c 'cd ${SDKPATH}/bin; ./kavhttpd -c /etc/kavhttpd.xml -p /var/run/kavhttpd.pid -w'</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179873"><p><a name=179873 style="display: none;">[Topic 179873]</a></p>
	<h3 id="t234309" class="heading3">Configuring updating in HTTP mode</h3>
<p class="bodytext">This section explains how to configure updating in Kaspersky Scan Engine.</p>
<p class="introheading">Specifying the update settings</p>
<p class="bodytext">Kaspersky Scan Engine uses update settings stored in the <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">HTTP mode configuration file</a>. Set the necessary update settings in kavhttpd.xml before starting Kaspersky Scan Engine.</p>
<p class="introheading">Specifying custom database update sources</p>
<p class="bodytext">Kaspersky Scan Engine updates the anti-virus database from database update sources. A database update source used by Kaspersky Scan Engine can be either default or custom. The default update sources are Kaspersky update servers.</p>
<p class="bodytext">You can use the default update sources, custom update sources, or both.</p>
<p class="procedureheading">To specify custom update sources:</p>
<ol class="listnumber1"><li class="listnumber1">Specify custom update sources in the <code class="programcharacter">UpdateSources</code> element of the kavhttpd.xml configuration file. Use a separate <code class="programcharacter">Source</code> element for each source.<p class="listcontinue1">To use a local directory, specify an absolute path. To use a network location, specify a URL, including the protocol. The supported protocols are HTTP and FTP.</p>
<p class="listcontinue1">The following example shows two update sources:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UpdateSources&gt;</p>
<p class="program2">&lt;Source&gt;httpd://example.com/update/source1&lt;/Source&gt;</p>
<p class="program2">&lt;Source&gt;httpd://example.com/update/source2&lt;/Source&gt;</p>
<p class="program">&lt;/UpdateSources&gt;</p>
</td>
</tr>

</table>
</li><li class="listnumber1">If you want to use only custom sources, set the <code class="programcharacter">UseOnlyCustomSources</code> parameter of kavhttpd.xml to <code class="programcharacter">1</code>.<p class="listcontinue1">If <code class="programcharacter">UseOnlyCustomSources</code> is <code class="programcharacter">0</code>, Kaspersky Scan Engine uses default sources together with custom sources. In this case, Kaspersky Scan Engine first looks for updates in custom update sources.</p>
</li></ol><p class="bodytext">The settings that you specified will be used after the <code class="programcharacter">kavhttpd</code> service is started or restarted.</p>
<p class="introheading">Configuring database backup</p>
<p class="bodytext">Database backup is a mechanism that protects Kaspersky Scan Engine from possible faults caused by the database update process.</p>
<p class="bodytext">By default, database backup is enabled. Kaspersky Scan Engine creates database backup copies automatically during updates. Make sure that your hard disk has enough free space for a full copy of the database.</p>
<p class="procedureheading">To disable database backup,</p>
<p class="bodytextindent">Set the <code class="programcharacter">DisableBackup</code> parameter in kavhttpd.xml to <code class="programcharacter">1</code>.</p>
<p class="bodytext">The setting that you specified will be used after the <code class="programcharacter">kavhttpd</code> service is started or restarted.</p>
<p class="introheading">Establishing connections to update sources</p>
<p class="bodytext">To connect to update sources, Kaspersky Scan Engine uses the connection settings defined in <a id="h179927_2" class="englishcrossreferencetemplate" href="#184799" target="_self">kavhttpd.xml</a>.</p>
<p class="introheading">Scheduling automatic database updates</p>
<p class="bodytext">If you want to update the database at regular intervals, use automatic updates.</p>
<p class="bodytext">By default, automatic updates are disabled.</p>
<p class="procedureheading">To set up automatic updates:</p>
<ol class="listnumber1"><li class="listnumber1">Set the <code class="programcharacter">UpdatePeriodMinutes</code> parameter in kavhttpd.xml to the required update interval (in minutes).</li><li class="listnumber1">Restart the <code class="programcharacter">kavhttpd</code> service.</li></ol><p class="bodytext">Kaspersky Scan Engine will perform updates automatically.</p>
<p class="bodytext">You can also <a id="h179933" class="englishcrossreferencetemplate" href="#179882" target="_self">update the database manually</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192981"><p><a name=192981 style="display: none;">[Topic 192981]</a></p>
	<h2 id="t234484" class="heading2">Running Kaspersky Scan Engine in HTTP mode</h2>
<p class="bodytext">This section explains how to run Kaspersky Scan Engine in HTTP mode.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#179876" target="_self">Running Kaspersky Scan Engine in HTTP mode manually</a></p><p class="relateditem"><a href="#184956" target="_self">Running Kaspersky Scan Engine in HTTP mode with systemd unit file (Linux)</a></p><p class="relateditem"><a href="#192984" target="_self">Running Kaspersky Scan Engine in HTTP mode as service (Windows)</a></p><p class="relateditem"><a href="#186032" target="_self">Running Kaspersky Scan Engine in HTTP mode with a BAT script (Windows)</a></p><p class="relateditem"><a href="#179880" target="_self">Monitoring Kaspersky Scan Engine in HTTP mode</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179876"><p><a name=179876 style="display: none;">[Topic 179876]</a></p>
	<h3 id="t234486" class="heading3">Running Kaspersky Scan Engine in HTTP mode manually</h3>
<p class="bodytext">You can run the <code class="programcharacter">kavhttpd</code> service by manually executing the kavhttpd binary file.</p>
<p class="bodytext">The following options are available when the <code class="programcharacter">kavhttpd</code> service is run manually:</p>
<p class="tablename">Options for running the kavhttpd binary file</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="804" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="72"><p class="tableheading">Parameter</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="732"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="72"><p class="tablebodytext"><code class="programcharacter">-c &lt;path&gt;</code></p>
</td>
<td style="border:1px solid #010101;" width="732"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Specifies the path to the HTTP mode configuration file.</p>
<p class="tablebodytext">The path can be absolute or relative. Relative path is specified relative to the current working directory.</p>
<p class="tablebodytext">The default path to the configuration file is <code class="programcharacter">./kavhttpd.xml</code>. </p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="72"><p class="tablebodytext"><code class="programcharacter">-p &lt;path&gt;</code></p>
</td>
<td style="border:1px solid #010101;" width="732"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Specifies the path to the PID file. </p>
<p class="tablebodytext">The path can be absolute or relative. Relative path is specified relative to the current working directory.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="72"><p class="tablebodytext"><code class="programcharacter">-w</code></p>
</td>
<td style="border:1px solid #010101;" width="732"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Runs the <code class="programcharacter">kavhttpd</code> service in watchdog mode.</p>
<p class="tablebodytext">In this mode, the <code class="programcharacter">kavhttpd</code> service automatically restarts if it freezes or crashes.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="72"><p class="tablebodytext"><code class="programcharacter">-n</code></p>
</td>
<td style="border:1px solid #010101;" width="732"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Enables nodaemon mode for the <code class="programcharacter">kavhttpd</code> service.</p>
<p class="tablebodytext">Specifying this parameter forces the <code class="programcharacter">kavhttpd</code> service to run in foreground.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="72"><p class="tablebodytext"><code class="programcharacter">-v</code></p>
</td>
<td style="border:1px solid #010101;" width="732"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Shows the Kaspersky Scan Engine version.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="72"><p class="tablebodytext"><code class="programcharacter">-h</code></p>
</td>
<td style="border:1px solid #010101;" width="732"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Shows Help.</p>
</td>
</tr>

</table>
<p class="bodytext"></p>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="184956"><p><a name=184956 style="display: none;">[Topic 184956]</a></p>
	<h3 id="t234488" class="heading3">Running Kaspersky Scan Engine in HTTP mode with systemd unit file (Linux)</h3>
<p class="attentionbody">For Linux systems only.</p>
<p class="bodytext">You can run the Kaspersky Scan Engine in HTTP mode by using the kavhttpd.service unit file for <code class="programcharacter">systemd</code>. The unit file allows you to add the kavhttpd service to the service startup list and to manage the service manually from the command line.</p>
<p class="attentionbody">This section assumes that you want to add the kavhttpd service for all users. For information on how to add and manage a service under a specific user, please see the official documentation for <code class="programcharacter">systemd</code> and <code class="programcharacter">systemctl</code>.</p>
<p class="introheading">Starting Kaspersky Scan Engine automatically</p>
<p class="bodytext">To start Kaspersky Scan Engine automatically, add kavhttpd to the service startup list.</p>
<p class="procedureheading">To add kavhttpd to the service startup list:</p>
<ol class="listnumber1"><li class="listnumber1">Place the kavhttpd.service unit file in the <code class="programcharacter">/etc/systemd/system/</code> directory.</li><li class="listnumber1">If necessary, <a id="h179931" class="englishcrossreferencetemplate" href="#179872" target="_self">edit the unit file</a>.</li><li class="listnumber1">Reload <code class="programcharacter">systemd</code> by running the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl daemon-reload</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Make sure that the kavhttpd.service unit file is installed by running the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl list-unit-files</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Enable kavhttpd to launch when the system starts by running the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl enable kavhttpd.service</p>
</td>
</tr>

</table>
</li></ol><p class="introheading">Remove Kaspersky Scan Engine from the service startup list</p>
<p class="bodytext">To remove kavhttpd from the service startup list, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl disable kavhttpd.service</p>
</td>
</tr>

</table>
<p class="introheading">Managing Kaspersky Scan Engine with systemd from the terminal</p>
<p class="bodytext">To start kavhttpd without rebooting the computer, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl start kavhttpd</p>
</td>
</tr>

</table>
<p class="attentionbody">After this command is executed, the script prints the <code class="programcharacter">[OK]</code> message and immediately returns control to the terminal, but it will take the <code class="programcharacter">kavhttpd</code> service some time to start.</p>
<p class="bodytext">To stop kavhttpd without rebooting the computer, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl stop kavhttpd</p>
</td>
</tr>

</table>
<p class="bodytext">To reload the anti-virus database, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl reload kavhttpd</p>
</td>
</tr>

</table>
<p class="bodytext"></p>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192984"><p><a name=192984 style="display: none;">[Topic 192984]</a></p>
	<h3 id="t234485" class="heading3">Running Kaspersky Scan Engine in HTTP mode as service (Windows)</h3>
<p class="bodytext">If you registered the kavehttpd as a Windows service, you can start it from the command line by using the following commands:</p>
<ul class="listbullet1"><li class="listbullet1">If you installed Kaspersky Scan Engine <a id="h184734" class="englishcrossreferencetemplate" href="#192978" target="_self">by using the installer</a> or <a id="h184731" class="englishcrossreferencetemplate" href="#184719" target="_self">registered kavehttpd as a service manually</a>:<p class="listcontinue1"><code class="programcharacter">net start &quot;Kaspersky ScanEngine&quot;</code></p>
</li><li class="listbullet1">If you registered kavehttpd <a id="h179959" class="englishcrossreferencetemplate" href="#179876" target="_self">by using the kavehttpd binary file</a>:<p class="listcontinue1"><code class="programcharacter">net start kavhttpd</code></p>
</li></ul><p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="186032"><p><a name=186032 style="display: none;">[Topic 186032]</a></p>
	<h3 id="t234487" class="heading3">Running Kaspersky Scan Engine in HTTP mode with a BAT script (Windows)</h3>
<p class="bodytext">Kaspersky Scan Engine distribution kit includes a BAT script that allows you to manage the kavhttpd service and the klScanEngineUI service.</p>
<p class="bodytext">This script will not work if you <a id="h179959" class="englishcrossreferencetemplate" href="#179876" target="_self">manually added the kavhttpd service to the list of Windows services.</a></p>
<p class="bodytext">The script is run from the command line.</p>
<p class="bodytext">Syntax:</p>
<p class="bodytext"><code class="programcharacter">kl_control.bat start | stop | restart | status | help</code></p>
<p class="bodytext">The table below describes the kl_control.bat options. If you specify more than one option, the script will execute the first one and exit.</p>
<p class="tablename">The kl_control.bat options</p>
<table class="tableintopic" width="630" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="150"><p class="tableheading">Option</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="480"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="150"><p class="tablebodytext"><code class="programcharacter">start</code></p>
</td>
<td style="border:1px solid #010101;" width="480"><p class="tablebodytext">Starts the kavhttpd service. If Kaspersky Scan Engine GUI is enabled, also starts the klScanEngineUI service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="150"><p class="tablebodytext"><code class="programcharacter">stop</code></p>
</td>
<td style="border:1px solid #010101;" width="480"><p class="tablebodytext">Stops the kavhttpd service. If Kaspersky Scan Engine GUI is enabled, also stops the klScanEngineUI service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="150"><p class="tablebodytext"><code class="programcharacter">restart</code></p>
</td>
<td style="border:1px solid #010101;" width="480"><p class="tablebodytext">Stops and restarts the kavhttpd service. If Kaspersky Scan Engine GUI is enabled, it also stops and restarts the klScanEngineUI service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="150"><p class="tablebodytext"><code class="programcharacter">status</code></p>
</td>
<td style="border:1px solid #010101;" width="480"><p class="tablebodytext">Checks whether the kavhttpd and klScanEngineUI services are running.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="150"><p class="tablebodytext"><code class="programcharacter">help</code></p>
</td>
<td style="border:1px solid #010101;" width="480"><p class="tablebodytext">Shows Help.</p>
</td>
</tr>

</table>
<p class="bodytext">The kl_control.bat script prints an error message if an error occurred when you tried to stop or start the kavhttpd service. If you receive an error message, you can check the state of the kavhttpd service or the klScanEngineUI service by using Windows Task Manager.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179880"><p><a name=179880 style="display: none;">[Topic 179880]</a></p>
	<h3 id="t234459" class="heading3">Monitoring Kaspersky Scan Engine in HTTP mode</h3>
<p class="bodytext">When monitoring is enabled, the kavhttpd service automatically restarts if it freezes or crashes.</p>
<p class="bodytext">If logging is enabled along with monitoring, the monitoring process writes log messages to a separate file.</p>
<p class="procedureheading">To enable monitoring:</p>
<ol class="listnumber1"><li class="listnumber1">Set the option <code class="programcharacter">-w</code> in the startup command on the systemd unit file for the kavhttpd service.</li><li class="listnumber1">Restart Kaspersky Scan Engine by running the following command: <table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">service kavhttpd restart</p>
</td>
</tr>

</table>
</li></ol><p class="bodytext">See also the information about <a id="h179931" class="englishcrossreferencetemplate" href="#179872" target="_self">editing the unit file</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192985"><p><a name=192985 style="display: none;">[Topic 192985]</a></p>
	<h2 id="t234437" class="heading2">Making requests in HTTP mode</h2>
<p class="bodytext">This section explains how to make requests to Kaspersky Scan Engine when working in HTTP mode.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#181167" target="_self">About KAV protocol</a></p><p class="relateditem"><a href="#179875" target="_self">Making requests in HTTP mode via KAV protocol version 3</a></p><p class="relateditem"><a href="#181038" target="_self">Making requests in HTTP mode via KAV protocol versions 1 and 2</a></p><p class="relateditem"><a href="#201538" target="_self">Getting the list of HTTP methods supported in the service</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181167"><p><a name=181167 style="display: none;">[Topic 181167]</a></p>
	<h3 id="t234269" class="heading3">About KAV protocol</h3>
<p class="bodytext">A client application uses the KAV protocol to interact with Kaspersky Scan Engine by means of HTTP requests. The current KAV protocol version is 3, but versions 1 and 2 are also supported.</p>
<p class="bodytext">Choose the protocol version that works best for your solution:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h179981" class="englishcrossreferencetemplate" href="#179875" target="_self">KAV protocol version 3</a><p class="listcontinue1">In version 3 of the protocol, the bodies of request messages and response messages are in JSON format. Version 3 supports more API methods than versions 1 and 2.</p>
<p class="listcontinue1">This is the recommended version of the protocol.</p>
<p class="attentioncontinue1">Note that on Windows systems, only KAV protocol version 3 is used.</p>
</li><li class="listbullet1"><a id="h180281" class="englishcrossreferencetemplate" href="#181038" target="_self">KAV protocol versions 1 and 2</a><p class="listcontinue1">In versions 1 and 2 of the protocol, the bodies of request messages and response messages are in plain text format.</p>
<p class="listcontinue1">Use these versions of the protocol if plain text format is necessary for your solution.</p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179875"><p><a name=179875 style="display: none;">[Topic 179875]</a></p>
	<h3 id="t234438" class="heading3">Making requests in HTTP mode via KAV protocol version 3</h3>
<p class="bodytext">This section explains how to make HTTP requests to Kaspersky Scan Engine by using KAV protocol version 3.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#181169" target="_self">Supported API methods in KAV protocol version 3</a></p><p class="relateditem"><a href="#193000" target="_self">Format of a scan POST request</a></p><p class="relateditem"><a href="#193001" target="_self">Format of a response to a scan POST request</a></p><p class="relateditem"><a href="#181065" target="_self">Increasing the detection rate</a></p><p class="relateditem"><a href="#224308" target="_self">Example of an HTTP request containing an API token for authorization</a></p><p class="relateditem"><a href="#193002" target="_self">Example of an HTTP request to scan a local file</a></p><p class="relateditem"><a href="#193003" target="_self">Example of an HTTP request to scan a block of memory</a></p><p class="relateditem"><a href="#193004" target="_self">Example of an HTTP request to check a URL</a></p><p class="relateditem"><a href="#193005" target="_self">Example of an HTTP request to get the release date of the anti-virus database</a></p><p class="relateditem"><a href="#193007" target="_self">Example of an HTTP request to get the current KAV SDK version</a></p><p class="relateditem"><a href="#193008" target="_self">Example of an HTTP request to get licensing information</a></p><p class="relateditem"><a href="#193009" target="_self">Example of an HTTP request to get accumulated statistics</a></p><p class="relateditem"><a href="#193010" target="_self">Example of an HTTP request to clear accumulated statistics</a></p><p class="relateditem"><a href="#193011" target="_self">Example of an HTTP request to update the anti-virus database</a></p><p class="relateditem"><a href="#193012" target="_self">Example of an HTTP request to get the database update status</a></p><p class="relateditem"><a href="#193338" target="_self">Example of an HTTP request to get the KSN information</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181169"><p><a name=181169 style="display: none;">[Topic 181169]</a></p>
	<h4 id="t234522" class="heading4">Supported API methods in KAV protocol version 3</h4>
<p class="bodytext">The following table lists the API methods that Kaspersky Scan Engine supports in HTTP mode when using KAV protocol version 3. The format of the requests does not depend on whether the client uses TCP or UNIX sockets for interaction with Kaspersky Scan Engine.</p>
<p class="tablename">API methods supported in HTTP mode in KAV protocol version 3</p>
<table class="tableintopic" width="1044" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="186"><p class="tableheading">API method</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="84"><p class="tableheading">HTTP method</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="84"><p class="tableheading">Format</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="690"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><code class="programcharacter">/api/v3.0/scanfile</code></p>
<p class="tablebodytext"><code class="programcharacter">/api/v3.1/scanfile</code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext">POST</p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext"><a id="h193051" class="englishcrossreferencetemplate" href="#193002" target="_self">Request format</a></p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="tablebodytext">Scans a file.</p>
<p class="tablebodytext">Use the <code class="programcharacter">/api/v3.1/scanfile</code> API method to get <a id="h193050" class="englishcrossreferencetemplate" href="#193001" target="_self">more information</a> about the scanning process.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><code class="programcharacter">/api/v3.0/scanmemory</code></p>
<p class="tablebodytext"><code class="programcharacter">/api/v3.1/scanmemory</code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext">POST</p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="bodytext"><a id="h193113" class="englishcrossreferencetemplate" href="#193003" target="_self">Request format</a></p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="tablebodytext">Scans a block of system memory.</p>
<p class="tablebodytext">Use the <code class="programcharacter">/api/v3.1/scanmemory</code> API method to get <a id="h193050_2" class="englishcrossreferencetemplate" href="#193001" target="_self">more information</a> about the scanning process.</p>
<p class="bodytext">Use only the KAV_SKIP cleaning mode when scanning system memory. Kaspersky Scan Engine cannot disinfect or delete files in this mode.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><code class="programcharacter">/api/v3.0/checkurl</code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext">POST</p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext"><a id="h193114" class="englishcrossreferencetemplate" href="#193004" target="_self">Request format</a></p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="tablebodytext">Checks a URL.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><code class="programcharacter">/api/v3.0/basesdate</code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext">GET</p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext"><a id="h193115" class="englishcrossreferencetemplate" href="#193005" target="_self">Request format</a></p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="tablebodytext">Gets the release date of the anti-virus database. You can use this method to check whether <code class="programcharacter">kavhttpd</code> is running.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><code class="programcharacter">/api/v3.0/version</code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext">GET</p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext"><a id="h193116" class="englishcrossreferencetemplate" href="#193007" target="_self">Request format</a></p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="tablebodytext">Gets the current version of KAV SDK. You can use this method to check whether <code class="programcharacter">kavhttpd</code> is running.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><code class="programcharacter">/api/v3.0/licenseinfo</code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext">GET</p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext"><a id="h193117" class="englishcrossreferencetemplate" href="#193008" target="_self">Request format</a></p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="tablebodytext">Gets information about the current key file or activation code. You can use this method to check whether <code class="programcharacter">kavhttpd</code> is running.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><code class="programcharacter">/api/v3.0/getstatistics</code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext">GET</p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext"><a id="h193118" class="englishcrossreferencetemplate" href="#193009" target="_self">Request format</a></p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="tablebodytext">Gets the accumulated statistics.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><code class="programcharacter">/api/v3.0/clearstatistics</code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext">POST</p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext"><a id="h193119" class="englishcrossreferencetemplate" href="#193010" target="_self">Request format</a></p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="tablebodytext">Clears the accumulated statistics.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><code class="programcharacter">/api/v3.0/update/start</code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext">POST</p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext"><a id="h193120" class="englishcrossreferencetemplate" href="#193011" target="_self">Request format</a></p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="tablebodytext">Updates the anti-virus database.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><code class="programcharacter">/api/v3.0/update/status</code></p>
<p class="tablebodytext"><code class="programcharacter">/api/v3.1/update/status</code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext">GET</p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext"><a id="h193121" class="englishcrossreferencetemplate" href="#193012" target="_self">Request format</a></p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="tablebodytext">Gets the status of the database update process.</p>
<p class="tablebodytext">Use the <code class="programcharacter">/api/v3.1/update/status</code> API method to get <a id="h179933" class="englishcrossreferencetemplate" href="#179882" target="_self">more information</a> about the database update process.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="tablebodytext"><code class="programcharacter">/api/v3.1/ksninfo</code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext">GET</p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="tablebodytext"><a id="h193339" class="englishcrossreferencetemplate" href="#193338" target="_self">Request format</a></p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="tablebodytext">Gets the information about KSN.</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193000"><p><a name=193000 style="display: none;">[Topic 193000]</a></p>
	<h4 id="t234360" class="heading4">Format of a scan POST request</h4>
<p class="bodytext">Scan POST requests have the following format:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">* Request headers *</p>
<p class="program">&nbsp;</p>
<p class="program">* Request body *</p>
<p class="program">{</p>
<p class="program2">&quot;timeout&quot;: &quot;%TIMEOUT%&quot;,</p>
<p class="program2">&quot;omitCleanSubobjectResults&quot;: %TO_OMIT_CLEAN_SUBOBJECT_RESULTS%,</p>
<p class="program2">&quot;url&quot;: &quot;%URL%&quot;,</p>
<p class="program2">&quot;hostIp&quot;: &quot;%HOST_IP%&quot;,</p>
<p class="program2">&quot;requestHeaders&quot;: &quot;%REQUEST_HEADERS%&quot;,</p>
<p class="program2">&quot;responseHeaders&quot;: &quot;%RESPONSE_HEADERS%&quot;,</p>
<p class="program2">&quot;object&quot;: &quot;%OBJECT%&quot;,</p>
<p class="program2">&quot;name&quot;: &quot;%SCAN_OBJECT_NAME%&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">where:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">timeout</code> is the object scan timeout in milliseconds (ms). This field is optional.</li><li class="listbullet1"><code class="programcharacter">omitCleanSubobjectResults</code> is a binary flag that specifies whether the <code class="programcharacter">subObjectsScanResults</code> array returned in the response must contain objects with the <code class="programcharacter">CLEAN</code> scan result. If the value is <code class="programcharacter">true</code>, such objects are omitted; if the value is <code class="programcharacter">false</code>, such objects are retained. The default value is <code class="programcharacter">true</code>. This field is optional.<p class="listcontinue1">See also the detailed information about the <a id="h193050" class="englishcrossreferencetemplate" href="#193001" target="_self">structure of the subObjectsScanResults array</a>.</p>
</li><li class="listbullet1"><code class="programcharacter">url</code> is the URL to use as the scan task context. This field is optional.<p class="listcontinue1">This field can be used for <a id="h181066" class="englishcrossreferencetemplate" href="#181065" target="_self">increasing the detection rate</a>.</p>
</li><li class="listbullet1"><code class="programcharacter">hostIp</code> is the IP of the host that hosts the scanned URL. This field is optional.<p class="listcontinue1">This field can be used for <a id="h181066_2" class="englishcrossreferencetemplate" href="#181065" target="_self">increasing the detection rate</a>. You need to enable KSN to use this field.</p>
</li><li class="listbullet1"><code class="programcharacter">requestHeaders</code> specifies the text of the HTTP request headers extracted from the HTTP transaction message. This field is optional.<p class="listcontinue1">This field can be used for <a id="h181066_3" class="englishcrossreferencetemplate" href="#181065" target="_self">increasing the detection rate</a>.</p>
</li><li class="listbullet1"><code class="programcharacter">responseHeaders</code> specifies the text of the HTTP response headers extracted from the HTTP transaction message. This field is optional.<p class="listcontinue1">This field can be used for <a id="h181066_4" class="englishcrossreferencetemplate" href="#181065" target="_self">increasing the detection rate</a>.</p>
</li><li class="listbullet1"><code class="programcharacter">object</code> is the full path to the file to scan (if a request is made to <code class="programcharacter">/api/v3.0/scanfile</code>) or a Base64-encoded string (if a request is made to <code class="programcharacter">/api/v3.0/scanmemory</code>). Only one object can be specified in this field. This field is mandatory.</li><li class="listbullet1"><code class="programcharacter">name</code> is the name of the object to scan in scanmemory mode (if a request is made to <code class="programcharacter">/api/v3.1/scanmemory</code>). The value can be from 1 to 300 Unicode characters. This field is optional.</li></ul><p class="bodytext">If the request body contains any special characters, they must be escaped in accordance with <a class="directhyperlinktemplate" href="https://www.ecma-international.org/publications/standards/Ecma-404.htm" target="_blank">Standard ECMA-404 (The JSON Interchange Syntax)</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193001"><p><a name=193001 style="display: none;">[Topic 193001]</a></p>
	<h4 id="t234359" class="heading4">Format of a response to a scan POST request</h4>
<p class="bodytext">If a scan POST request is successfully processed, the response body contains a JSON object with the following fields:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">{</p>
<p class="program2">&quot;object&quot;: &quot;%SCAN_OBJECT%&quot;,</p>
<p class="program2">&quot;scanResult&quot;: &quot;%SCAN_RESULT%&quot;,</p>
<p class="program2">&quot;detectionName&quot;: &quot;%DETECTED_OBJECT%&quot;,</p>
<p class="program2">&quot;name&quot;: &quot;%SCAN_OBJECT_NAME%&quot;,</p>
<p class="program2">&quot;containsOfficeMacro&quot;: &quot;%IS_MACRO_CONTAINED%&quot;,</p>
<p class="program2">&quot;subObjectsScanResults&quot;: [</p>
<p class="program2">{</p>
<p class="program3">&quot;object&quot;: &quot;%SCAN_FILE%&quot;,</p>
<p class="program3">&quot;scanResult&quot;: &quot;%SCAN_RESULT%&quot;,</p>
<p class="program3">&quot;detectionName&quot;: &quot;%DETECTED_OBJECT%&quot;,</p>
<p class="program3">&quot;containsOfficeMacro&quot;: &quot;%IS_MACRO_CONTAINED%&quot;</p>
<p class="program2">},</p>
<p class="program2">...</p>
<p class="program2">{</p>
<p class="program3">&quot;object&quot;: &quot;%SCAN_FILE%&quot;,</p>
<p class="program3">&quot;scanResult&quot;: &quot;%SCAN_RESULT%&quot;,</p>
<p class="program3">&quot;detectionName&quot;: &quot;%DETECTED_OBJECT%&quot;,</p>
<p class="program3">&quot;containsOfficeMacro&quot;: &quot;%IS_MACRO_CONTAINED%&quot;</p>
<p class="program2">}</p>
<p class="program2">]</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext"> where:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">object</code> contains the full path to the scanned file (if a request is made to <code class="programcharacter">/api/v3.0/scanfile</code>) or to a <code class="programcharacter">&quot;memory&quot;</code> string (if a request is made to <code class="programcharacter">/api/v3.0/scanmemory</code>).</li><li class="listbullet1"><code class="programcharacter">scanResult</code> is the scan result and can have the following values:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">CLEAN</code></li><li class="listbullet2"><code class="programcharacter">DETECT</code></li><li class="listbullet2"><code class="programcharacter">DISINFECTED</code></li><li class="listbullet2"><code class="programcharacter">DELETED</code></li><li class="listbullet2"><code class="programcharacter">NON_SCANNED</code></li><li class="listbullet2"><code class="programcharacter">SERVER_ERROR</code></li></ul><p class="listcontinue1">If a request is made to <code class="programcharacter">/api/v3.0/scanfile</code> or to <code class="programcharacter">/api/v3.0/scanmemory</code>, the reason that the object is not scanned may be added to the <code class="programcharacter">NON_SCANNED</code> result. For example:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">{</p>
<p class="program2">&quot;object&quot;: &quot;\/home\/user\/Documents\/filestoscan\/test.zip&quot;,</p>
<p class="program2">&quot;scanResult&quot;: &quot;NON_SCANNED (PASSWORD PROTECTED)&quot;,</p>
<p class="program2">&quot;containsOfficeMacro&quot;: &quot;false&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">NON_SCANNED (CANCELED)</code><p class="listcontinue2">Scan canceled.</p>
</li><li class="listbullet2"><code class="programcharacter">NON_SCANNED (CORRUPTED)</code><p class="listcontinue2">The scanned object is corrupted. </p>
</li><li class="listbullet2"><code class="programcharacter">NON_SCANNED (ACCESS DENIED)</code><p class="listcontinue2">Access to the object is denied.</p>
</li><li class="listbullet2"><code class="programcharacter">NON_SCANNED (SKIPPED)</code><p class="listcontinue2">Scan skipped.</p>
</li><li class="listbullet2"><code class="programcharacter">NON_SCANNED (PASSWORD PROTECTED)</code><p class="listcontinue2">The object to scan is password protected.</p>
</li><li class="listbullet2"><code class="programcharacter">NON_SCANNED</code><p class="listcontinue2">The reason that the object is not scanned is not identified.</p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">detectionName</code> is the name of the detected malicious object in the Kaspersky classification system.</li><li class="listbullet1"><code class="programcharacter">name</code> is the name of the object specified in the <code class="programcharacter">name</code> field of the request body (if a request is made to <code class="programcharacter">/api/v3.1/scanmemory</code>). If the scanned object has nested sub-objects, the <code class="programcharacter">name</code> element is specified only in the parent object.</li><li class="listbullet1"><code class="programcharacter">containsOfficeMacro</code> is the binary flag that has a value of <code class="programcharacter">true</code> if a macro was detected in the object and <code class="programcharacter">false</code> otherwise.</li><li class="listbullet1"><code class="programcharacter">subObjectsScanResults</code> is an array of scan results for each sub-object nested in the object that was scanned. This field with all of its sub-fields is only included in the response body if the scanned object contains nested sub-objects.<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">subObjectsScanResults/object</code> is the path to the nested sub-object. Note that the path to the sub-object is separated from the path to its parent object by a double slash (<code class="programcharacter">//</code>), for example:<p class="listcontinue2"><code class="programcharacter">/home/user/archive.tar//folder/subobject</code></p>
</li><li class="listbullet2"><code class="programcharacter">subObjectsScanResults/scanResult</code> is the scan result for the nested sub-object.</li><li class="listbullet2"><code class="programcharacter">subObjectsScanResults/detectionName</code> is the name of the detected malicious object in the Kaspersky classification system.</li><li class="listbullet2"><code class="programcharacter">subObjectsScanResults/containsOfficeMacro</code> is the binary flag that has a value of <code class="programcharacter">true</code> if a macro was detected in the nested sub-object and <code class="programcharacter">false</code> otherwise.</li></ul></li></ul><p class="bodytext">If a POST scan request is processed with an error, the response body contains a JSON object with a single <code class="programcharacter">error</code> field:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">{</p>
<p class="program2">&quot;error&quot;: &quot;%ERROR_MESSAGE%&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext"> where <code class="programcharacter">error</code> contains the description of the error that occurred during the request processing.</p>
<p class="introheading">Additional fields in KAV protocol version 3.1</p>
<p class="bodytext">The <code class="programcharacter">reason</code> field appears only if you use KAV protocol version 3.1. This field specifies the reason why the object is not scanned. This field appears if a request is made to <code class="programcharacter">/api/v3.1/scanfile</code> or to <code class="programcharacter">/api/v3.1/scanmemory</code>, and if the value of the <code class="programcharacter">scanResult</code> field is <code class="programcharacter">NON_SCANNED</code>.</p>
<p class="bodytext">Possible values:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">Canceled</code><p class="listcontinue1">Scan canceled.</p>
</li><li class="listbullet1"><code class="programcharacter">Corrupted</code><p class="listcontinue1">The scanned object is corrupted. </p>
</li><li class="listbullet1"><code class="programcharacter">Access denied</code><p class="listcontinue1">Access to the object is denied.</p>
</li><li class="listbullet1"><code class="programcharacter">Skipped</code><p class="listcontinue1">Scan skipped.	</p>
</li><li class="listbullet1"><code class="programcharacter">Password protected</code><p class="listcontinue1">The object to scan is password protected.</p>
</li><li class="listbullet1"><code class="programcharacter">Max depth exceeded</code><p class="listcontinue1">The maximum depth of nested archives to be unpacked during scanning is exceeded.</p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181065"><p><a name=181065 style="display: none;">[Topic 181065]</a></p>
	<h4 id="t234391" class="heading4">Increasing the detection rate</h4>
<p class="bodytext">When an HTTP request is made to scan a file or a block of memory, there are two ways to increase the detection rate by specifying an optional scan task context:</p>
<ul class="listbullet1"><li class="listbullet1">Provide the origin of the object to scan in the <code class="programcharacter">url</code> field of the POST request body:<ul class="listbullet2"><li class="listbullet2">If the object to scan was received from the web, specify the web address of origin, including the protocol, for example:<p class="listcontinue2"><code class="programcharacter">http://example.com</code></p>
<p class="listcontinue2">The supported protocols are HTTP, HTTPS, and FTP.</p>
<p class="listcontinue2">If the URL is unknown, we recommend that you use <code class="programcharacter">http://example.com</code> as the scan task context.</p>
</li><li class="listbullet2">If the object to scan was received by email, specify the sender's email address in the following format: <code class="programcharacter">[from:%sender_address%]</code>, for example:<p class="listcontinue2"><code class="programcharacter">[from:example@example.com]</code></p>
<p class="listcontinue2">If the sender's email address is unknown, we recommend that you use <code class="programcharacter">[from:test@relay.example]</code> as the scan task context.</p>
</li></ul><p class="listcontinue1">Below is an example of an HTTP request to scan a local file received from the web. Note the use of the <code class="programcharacter">url</code> field to specify the web address of origin:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /api/v3.0/scanfile HTTP/1.0</p>
<p class="program">Content-Type: application/octet-stream</p>
<p class="program">Content-Length: 22</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;timeout&quot;: &quot;10000&quot;,</p>
<p class="program2">&quot;object&quot;: &quot;\/home\/user\/eicar&quot;,</p>
<p class="program2">&quot;url&quot;: &quot;http:\/\/example.com&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="listcontinue1">The response is the same as in the <a id="h193051" class="englishcrossreferencetemplate" href="#193002" target="_self">example of an HTTP request to scan a local file</a>.</p>
</li><li class="listbullet1">Provide request and response headers gathered from HTTP traffic related to the object to scan in the <code class="programcharacter">requestHeaders</code> and <code class="programcharacter">responseHeaders</code> fields of the POST request body.<p class="attentioncontinue1">Note that you can combine the two types of scan task context to further boost the detection rate. In the example below, the request and response headers are specified along with the web address of origin.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /api/v3.0/scanfile HTTP/1.0</p>
<p class="program">Content-Type: application/octet-stream</p>
<p class="program">Content-Length: 22</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;object&quot;: &quot;\/home\/user\/eicars.tar&quot;,</p>
<p class="program2">&quot;requestHeaders&quot;: &quot;: authority: example.com\r\n: method: GET\r\n path:\/ \r\n:scheme: https\r\naccept: text\/html,application\/xhtml+xml,application\/xml;q=0.9,image\/webp,image\/apng,*\/*;q=0.8\r\naccept-encoding: gzip, deflate, br\r\naccept-language: ru-RU,ru;q=0.9,en-US;q=0.8,en;q=0.7,mt;q=0.6\r\ncache-control: no-cache\r\npragma: no-cache\r\nupgrade-insecure-requests: 1\r\nuser-agent: Mozilla\/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/71.0.3578.98 Safari\/537.36&quot;,</p>
<p class="program2">&quot;responseHeaders&quot;: &quot;accept-ranges: bytes\r\ncache-control: max-age=604800\r\ncontent-type: text\/html; charset=UTF-8\r\ndate: Thu, 31 Jan 2019 18:51:11 GMT\r\netag: \&quot;1541025663\&quot;\r\nexpires: Thu, 07 Feb 2019 18:51:11 GMT\r\nlast-modified: Fri, 09 Aug 2013 23:54:35 GMT\r\nserver: ECS (dca\/532C)\r\nstatus: 200\r\nvary: Accept-Encoding\r\nx-cache: HIT&quot;,</p>
<p class="program2">&quot;url&quot;: &quot;http:\/\/example.com&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="listcontinue1">The successfully processed request will result in the following response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 Ok</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 15:46:29 GMT</p>
<p class="program">Content-Length: 75</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;object&quot;: \/home\/user\/eicars.tar&quot;,</p>
<p class="program2">&quot;scanResult&quot;: &quot;DETECT&quot;,</p>
<p class="program2">&quot;detectionName&quot;: &quot;multiple&quot;,</p>
<p class="program2">&quot;subObjectsScanResults&quot;: [</p>
<p class="program2">{</p>
<p class="program3">&quot;object&quot;: &quot;\/home\/user\/eicars.tar\/\/eicar1&quot;,</p>
<p class="program3">&quot;scanResult&quot;: &quot;DETECT&quot;,</p>
<p class="program3">&quot;detectionName&quot;: &quot;EICAR-Test-File&quot;</p>
<p class="program2">},</p>
<p class="program2">{</p>
<p class="program3">&quot;object&quot;: &quot;\/home\/user\/eicars.tar\/\/eicar2&quot;,</p>
<p class="program3">&quot;scanResult&quot;: &quot;DETECT&quot;,</p>
<p class="program3">&quot;detectionName&quot;: &quot;EICAR-Test-File&quot;</p>
<p class="program2">}</p>
<p class="program2">]</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="spacer"></p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="224308"><p><a name=224308 style="display: none;">[Topic 224308]</a></p>
	<h4 id="t234265" class="heading4">Example of an HTTP request containing an API token for authorization</h4>
<p class="introheading">Protocol version 3.0</p>
<p class="bodytext">If HTTP clients authorization is enabled in Kaspersky Scan Engine, all HTTP requests must contain an API token.</p>
<p class="bodytext">The following example shows an HTTP request containing an API token in the <code class="programcharacter">Authorization</code> field:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /api/v3.0/scanfile HTTP/1.0</p>
<p class="program">Content-Type: application/octet-stream</p>
<p class="program">Content-Length: 22</p>
<p class="program">Authorization: SldYQTUyOUNVMnE3VWR2N3Izamk2QkVNc2hhLTV5dTBLcVUzeXZLdGYtNkkrVFUyQUVRQUNLQUFCSWdwRUlJTQ==</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;timeout&quot;: &quot;10000&quot;,</p>
<p class="program2">&quot;object&quot;: &quot;\/home\/user\/eicar&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">In this example, <code class="programcharacter">Authorization</code> is the default name of the request header field used for authorization. You can change this name in the <span class="guicharacter"><a id="h224242" class="englishcrossreferencetemplate" href="#224195" target="_self">Authorization</a></span> section of the Kaspersky Scan Engine GUI.</p>
<p class="bodytext">The following block shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 15:46:29 GMT</p>
<p class="program">Content-Length: 75</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;object&quot;: &quot;\/home\/user\/eicar&quot;,</p>
<p class="program2">&quot;scanResult&quot;: &quot;DETECT&quot;,</p>
<p class="program2">&quot;detectionName&quot;: &quot;EICAR-Test-File&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">If the authorization failed and the Bearer prefix was specified, the response is as follows:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.1 401 Unauthorized</p>
<p class="program">WWW-Authenticate: Bearer realm=&quot;API Kaspersky Scan Engine&quot;</p>
</td>
</tr>

</table>
<p class="bodytext">If the authorization failed and the Bearer prefix was not specified, the response is as follows:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.1 401 Unauthorized</p>
<p class="program">WWW-Authenticate: Token realm=&quot;API Kaspersky Scan Engine&quot;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193002"><p><a name=193002 style="display: none;">[Topic 193002]</a></p>
	<h4 id="t234264" class="heading4">Example of an HTTP request to scan a local file</h4>
<p class="introheading">Protocol version 3.0</p>
<p class="bodytext">The following example shows an HTTP request to scan a local file:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /api/v3.0/scanfile HTTP/1.0</p>
<p class="program">Content-Type: application/octet-stream</p>
<p class="program">Content-Length: 22</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;timeout&quot;: &quot;10000&quot;,</p>
<p class="program2">&quot;object&quot;: &quot;\/home\/user\/eicar&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="attentionbody">In the <code class="programcharacter">object</code> field, only one object can be specified.</p>
<p class="bodytext">See also the <a id="h193049" class="englishcrossreferencetemplate" href="#193000" target="_self">description of all possible fields in the request body</a> and <a id="h181066" class="englishcrossreferencetemplate" href="#181065" target="_self">recommendations on how to increase the detection rate</a>.</p>
<p class="bodytext">The following block shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 15:46:29 GMT</p>
<p class="program">Content-Length: 75</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;object&quot;: &quot;\/home\/user\/eicar&quot;,</p>
<p class="program2">&quot;scanResult&quot;: &quot;DETECT&quot;,</p>
<p class="program2">&quot;detectionName&quot;: &quot;EICAR-Test-File&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">See also <a id="h193050" class="englishcrossreferencetemplate" href="#193001" target="_self">the description of all possible fields in the response body</a>.</p>
<p class="introheading">Protocol version 3.1</p>
<p class="bodytext">The format of the request is the same, but the response has <a id="h193050_2" class="englishcrossreferencetemplate" href="#193001" target="_self">additional fields</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193003"><p><a name=193003 style="display: none;">[Topic 193003]</a></p>
	<h4 id="t234263" class="heading4">Example of an HTTP request to scan a block of memory</h4>
<p class="introheading">Protocol version 3.0</p>
<p class="bodytext">The following example shows an HTTP request to scan a block of memory:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /api/v3.0/scanmemory HTTP/1.0</p>
<p class="program">Content-Type: application/octet-stream</p>
<p class="program">Content-Length: 105</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;timeout&quot;: &quot;10000&quot;,</p>
<p class="program2">&quot;object&quot;: &quot;WDVPIVAlQEFQWzRcUFpYNTQoUF4pN0NDKTd9JEVJQ0FSLVNUQU5EQVJELUFOVElWSVJVUy1URVNULUZJTEUhJEgrSCo=&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="attentionbody">In the <code class="programcharacter">object</code> field, only one object can be specified.</p>
<p class="bodytext">See also the <a id="h193049" class="englishcrossreferencetemplate" href="#193000" target="_self">description of all possible fields in the request body</a> and <a id="h181066" class="englishcrossreferencetemplate" href="#181065" target="_self">recommendations on how to increase the detection rate</a>.</p>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 16:08:12 GMT</p>
<p class="program">Content-Length: 72</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;object&quot;: &quot;memory&quot;,</p>
<p class="program2">&quot;scanResult&quot;: &quot;DETECT&quot;,</p>
<p class="program2">&quot;detectionName&quot;: &quot;EICAR-Test-File&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">See also <a id="h193050" class="englishcrossreferencetemplate" href="#193001" target="_self">the description of all possible fields in the response body</a>.</p>
<p class="introheading">Protocol version 3.1</p>
<p class="bodytext">The format of the request is the same, but the response has <a id="h193050_2" class="englishcrossreferencetemplate" href="#193001" target="_self">additional fields</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193004"><p><a name=193004 style="display: none;">[Topic 193004]</a></p>
	<h4 id="t234257" class="heading4">Example of an HTTP request to check a URL</h4>
<p class="bodytext">The following example shows an HTTP request to check a URL:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /api/v3.0/checkurl HTTP/1.0</p>
<p class="program">Content-Type: application/octet-stream</p>
<p class="program">Content-Length: 50</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;timeout&quot;: &quot;10000&quot;,</p>
<p class="program2">&quot;url&quot;: &quot;http:\/\/<code class="programcharacter">bug.qainfo.ru</code>\/<code class="programcharacter">TesT</code>\/Aphish_w&quot;,</p>
<p class="program2">&quot;hostIp&quot;: &quot;233.252.0.1&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 16:15:44 GMT</p>
<p class="program">Content-Length: 104</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;url&quot;: &quot;http:\/\/<code class="programcharacter">bug.qainfo.ru</code>\/<code class="programcharacter">TesT</code>\/Aphish_w&quot;,</p>
<p class="program2">&quot;scanResult&quot;: &quot;DETECT&quot;,</p>
<p class="program2">&quot;detectionName&quot;: &quot;PHISHING_URL&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext"> where:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">url</code> is the URL that was checked.</li><li class="listbullet1"><code class="programcharacter">scanResult</code> is the scan result and can have the following values:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">CLEAN</code></li><li class="listbullet2"><code class="programcharacter">DETECT</code></li><li class="listbullet2"><code class="programcharacter">DISINFECTED</code></li><li class="listbullet2"><code class="programcharacter">DELETED</code></li><li class="listbullet2"><code class="programcharacter">NON_SCANNED</code></li><li class="listbullet2"><code class="programcharacter">SERVER_ERROR</code></li></ul></li><li class="listbullet1"><code class="programcharacter">detectionName</code> is the name of the detected malicious object in the Kaspersky classification system. It can have one of the following values:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">PHISHING_URL</code></li><li class="listbullet2"><code class="programcharacter">MALICIOUS_URL</code></li><li class="listbullet2"><code class="programcharacter">ADWARE_URL</code></li><li class="listbullet2"><code class="programcharacter">RISKWARE_URL</code></li></ul></li></ul><p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193005"><p><a name=193005 style="display: none;">[Topic 193005]</a></p>
	<h4 id="t234262" class="heading4">Example of an HTTP request to get the release date of the anti-virus database</h4>
<p class="bodytext">This release date request is usually made after a database update to make sure that the anti-virus database has been updated to the latest version.</p>
<p class="bodytext">The following example shows an HTTP request to get the release date of the anti-virus database:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">GET /api/v3.0/basesdate HTTP/1.0</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 19:03:18 GMT</p>
<p class="program">Content-Length: 50</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;databaseVersion&quot;: &quot;30.01.2019 18:38 GMT&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext"> where <code class="programcharacter">databaseVersion</code> contains the current version of the anti-virus database in the following format: <code class="programcharacter">DD.MM.YYYY hh:mm GMT</code>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193007"><p><a name=193007 style="display: none;">[Topic 193007]</a></p>
	<h4 id="t234261" class="heading4">Example of an HTTP request to get the current KAV SDK version</h4>
<p class="bodytext">The following example shows an HTTP request to get the current KAV SDK version:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">GET /api/v3.0/version HTTP/1.0</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 19:05:51 GMT</p>
<p class="program">Content-Length: 36</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;KAVSDKVersion&quot;: &quot;8.8.2.58&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext"> where <code class="programcharacter">KAVSDKVersion</code> contains the current KAV SDK version in the following format: <code class="programcharacter">MajorVersion.MinorVersion.BuildNumber.Revision</code>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193008"><p><a name=193008 style="display: none;">[Topic 193008]</a></p>
	<h4 id="t234260" class="heading4">Example of an HTTP request to get licensing information</h4>
<p class="bodytext">The following example shows an HTTP request to get licensing information:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">GET /api/v3.0/licenseinfo HTTP/1.0</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response that contains licensing information when <a id="h180864" class="englishcrossreferencetemplate" href="#179852" target="_self">offline licensing mode</a> is used:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 19:04:30 GMT</p>
<p class="program">Content-Length: 81</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;licenseName&quot;: &quot;EXAMPLE.key&quot;,</p>
<p class="program2">&quot;licenseExpirationDate&quot;: &quot;05.12.2020&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">where:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">licenseName</code> is the name of the current key file.</li><li class="listbullet1"><code class="programcharacter">licenseExpirationDate</code> is the expiration date of the key file in the following format: <code class="programcharacter">DD.MM.YYYY</code>.</li></ul><p class="bodytext">The following block shows the corresponding response, which contains licensing information when <a id="h180819" class="englishcrossreferencetemplate" href="#179855" target="_self">online licensing mode</a> is used. In this example, the license ticket has expired:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Date: Mon, 10 February 2014 12:25:21 GMT</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">Content-Length: 185</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;activationCode&quot;: &quot;EXMPL-*****-*****-12345&quot;,</p>
<p class="program2">&quot;licenseExpirationDate&quot;: &quot;05.12.2020&quot;,</p>
<p class="program2">&quot;ticketExpired&quot;: &quot;The license ticket has expired. Computer must be connected to the Internet to update the license ticket.&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">where:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">activationCode</code> is the activation code.</li><li class="listbullet1"><code class="programcharacter">licenseExpirationDate</code> is the expiration date of the activation code in the following format: <code class="programcharacter">DD.MM.YYYY</code>.</li><li class="listbullet1"><code class="programcharacter">ticketExpired</code> contains a message that is included in the response body only if the license ticket has expired.</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193009"><p><a name=193009 style="display: none;">[Topic 193009]</a></p>
	<h4 id="t234259" class="heading4">Example of an HTTP request to get accumulated statistics</h4>
<p class="bodytext">The following example shows an HTTP request to get accumulated statistics:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">GET /api/v3.0/getstatistics HTTP/1.0</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 19:07:54 GMT</p>
<p class="program">Content-Length: 314</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;statistics&quot;: {</p>
<p class="program3">&quot;total_requests&quot;: 3,</p>
<p class="program3">&quot;infected_requests&quot;: 3,</p>
<p class="program3">&quot;protected_requests&quot;: 3,</p>
<p class="program3">&quot;error_requests&quot;: 0,</p>
<p class="program3">&quot;engine_errors&quot;: 0,</p>
<p class="program3">&quot;processed_data&quot;: 204,</p>
<p class="program3">&quot;infected_data&quot;: 204,</p>
<p class="program3">&quot;processed_urls&quot;: 1,</p>
<p class="program3">&quot;infected_urls&quot;: 1</p>
<p class="program2">}</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext"> where <code class="programcharacter">statistics</code> is an object containing the following accumulated statistics:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">total_requests</code> is the total number of requests to scan a file or a block of memory or to check a URL.</li><li class="listbullet1"><code class="programcharacter">infected_requests</code> is the number of requests for which Kaspersky Scan Engine returned a <code class="programcharacter">DETECT</code>, <code class="programcharacter">DISINFECTED</code>, or <code class="programcharacter">DELETED</code> scan result.</li><li class="listbullet1"><code class="programcharacter">protected_requests</code> is the number of requests for which Kaspersky Scan Engine returned a <code class="programcharacter">DISINFECTED</code> or <code class="programcharacter">DELETED</code> scan result.</li><li class="listbullet1"><code class="programcharacter">error_requests</code> is the number of requests for which Kaspersky Scan Engine returned a <code class="programcharacter">NON_SCANNED</code> scan result (due to errors related to the scanned object).</li><li class="listbullet1"><code class="programcharacter">engine_errors</code> is the number of requests for which Kaspersky Scan Engine returned a <code class="programcharacter">SERVER_ERROR</code> scan result (due to errors not related to the scanned object).</li><li class="listbullet1"><code class="programcharacter">processed_data</code> is the total amount of scanned data in bytes.</li><li class="listbullet1"><code class="programcharacter">infected_data</code> is the amount of scanned data, in bytes, passed in requests for which Kaspersky Scan Engine returned a <code class="programcharacter">DETECT</code>, <code class="programcharacter">DISINFECTED</code>, or <code class="programcharacter">DELETED</code> scan result.</li><li class="listbullet1"><code class="programcharacter">processed_urls</code> is the total number of checked URLs.</li><li class="listbullet1"><code class="programcharacter">infected_urls</code> is the number of URLs recognized by Kaspersky Scan Engine as malicious, phishing, adware, or legitimate programs that can be used by intruders to damage computers and data.</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193010"><p><a name=193010 style="display: none;">[Topic 193010]</a></p>
	<h4 id="t234258" class="heading4">Example of an HTTP request to clear accumulated statistics</h4>
<p class="bodytext">The following example shows an HTTP request to clear accumulated statistics:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /api/v3.0/clearstatistics HTTP/1.0</p>
<p class="program">Content-Type: application/octet-stream</p>
<p class="program">Content-Length: 2</p>
<p class="program">&nbsp;</p>
<p class="program">{}</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 19:09:27 GMT</p>
<p class="program">Content-Length: 27</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;error&quot;: &quot;CLEARED&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193011"><p><a name=193011 style="display: none;">[Topic 193011]</a></p>
	<h4 id="t234353" class="heading4">Example of an HTTP request to update the anti-virus database</h4>
<p class="attentionbody">This request can be made only if the client and Kaspersky Scan Engine are installed and running on the same computer. If you send this request from a different computer, Kaspersky Scan Engine will throw a <code class="programcharacter">405 Method Not Allowed</code> error.</p>
<p class="bodytext">The following example shows an HTTP request to update the anti-virus database:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /api/v3.0/update/start HTTP/1.0</p>
<p class="program">Content-Type: application/octet-stream</p>
<p class="program">Content-Length: 2</p>
<p class="program">&nbsp;</p>
<p class="program">{}</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response that is returned if the database update has been successfully initiated:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 18:05:44 GMT</p>
<p class="program">Content-Length: 26</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;status&quot;: &quot;update started&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response that is returned if an update is already in progress:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 18:05:44 GMT</p>
<p class="program">Content-Length: 35</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;status&quot;: &quot;update already launched&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response that is returned if an error occurred when launching the update:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 18:05:44 GMT</p>
<p class="program">Content-Length: 40</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;status&quot;: &quot;error while launching update&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193012"><p><a name=193012 style="display: none;">[Topic 193012]</a></p>
	<h4 id="t234348" class="heading4">Example of an HTTP request to get the database update status</h4>
<p class="attentionbody">This request can be made only if the client and Kaspersky Scan Engine are installed and running on the same computer. If you send this request from a different computer, Kaspersky Scan Engine will throw a <code class="programcharacter">405 Method Not Allowed</code> error.</p>
<p class="introheading">Protocol version 3.0</p>
<p class="bodytext">The following example shows an HTTP request to get the database update status:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">GET /api/v3.0/update/status HTTP/1.0</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 30 Jan 2019 18:05:44 GMT</p>
<p class="program">Content-Length: 116</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;status&quot;: &quot;not started&quot;,</p>
<p class="program2">&quot;last_update_result&quot;: &quot;success&quot;,</p>
<p class="program2">&quot;last_update_time&quot;: &quot;21:03:53 30.01.2019&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">See also <a id="h179933" class="englishcrossreferencetemplate" href="#179882" target="_self">the description of all the fields that can be included in the response body</a>.</p>
<p class="introheading">Protocol version 3.1</p>
<p class="bodytext">The format of the request is the same, but the response has <a id="h179933_2" class="englishcrossreferencetemplate" href="#179882" target="_self">additional fields</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="193338"><p><a name=193338 style="display: none;">[Topic 193338]</a></p>
	<h4 id="t234349" class="heading4">Example of an HTTP request to get the KSN information</h4>
<p class="bodytext">The following block shows an HTTP request:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">GET /api/v3.1/ksninfo</p>
</td>
</tr>

</table>
<p class="bodytext">The following block shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">Server: KAVHTTPD/1.0</p>
<p class="program">X-KAV-ProtocolVersion: 3</p>
<p class="program">Date: Wed, 02 Dec 2019 18:06:50 GMT</p>
<p class="program">Content-Length: 190</p>
<p class="program">&nbsp;</p>
<p class="program">{</p>
<p class="program2">&quot;ksnStatus&quot;: &quot;Connected&quot;,</p>
<p class="program2">&quot;whiteApplications&quot;: %whiteApplications%,</p>
<p class="program2">&quot;malwareApplications&quot;: %malwareApplications%,</p>
<p class="program2">&quot;blockedThreats&quot;: %blockedThreats%,</p>
<p class="program2">&quot;region&quot;: &quot;%ksnRegion%&quot;,</p>
<p class="program2">&quot;responseTimestamp&quot;: &quot;%responseTimestamp%&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">If KSN is turned off, the response body contains a JSON object with a single <code class="programcharacter">ksnStatus</code> field:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">{</p>
<p class="program2">&quot;ksnStatus&quot;: &quot;KSN turned off&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181038"><p><a name=181038 style="display: none;">[Topic 181038]</a></p>
	<h3 id="t234439" class="heading3">Making requests in HTTP mode via KAV protocol versions 1 and 2</h3>
<p class="bodytext">This section explains how to make HTTP requests to Kaspersky Scan Engine by using KAV protocol versions 1 and 2.</p>
<p class="bodytext"></p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#181170" target="_self">Supported API methods in KAV protocol versions 1 and 2</a></p><p class="relateditem"><a href="#181073" target="_self">Request headers</a></p><p class="relateditem"><a href="#224307" target="_self">Example of an HTTP request containing an API token for authorization</a></p><p class="relateditem"><a href="#181074" target="_self">Example of an HTTP request to scan a local file</a></p><p class="relateditem"><a href="#181076" target="_self">Example of an HTTP request to scan a block of memory</a></p><p class="relateditem"><a href="#181078" target="_self">Example of a multipart HTTP request to scan a block of memory</a></p><p class="relateditem"><a href="#181080" target="_self">Example of an HTTP request to check a URL</a></p><p class="relateditem"><a href="#181082" target="_self">Example of an HTTP request to get the release date of the anti-virus database</a></p><p class="relateditem"><a href="#181084" target="_self">Example of an HTTP request to get the current KAV SDK version</a></p><p class="relateditem"><a href="#181086" target="_self">Example of an HTTP request to get licensing information</a></p><p class="relateditem"><a href="#181088" target="_self">Example of an HTTP request to get accumulated statistics</a></p><p class="relateditem"><a href="#181090" target="_self">Example of an HTTP request to clear accumulated statistics</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181170"><p><a name=181170 style="display: none;">[Topic 181170]</a></p>
	<h4 id="t234523" class="heading4">Supported API methods in KAV protocol versions 1 and 2 </h4>
<p class="bodytext">In addition to using <a id="h179981" class="englishcrossreferencetemplate" href="#179875" target="_self">KAV protocol version 3</a>, you can make POST and GET requests to Kaspersky Scan Engine by means of KAV protocol versions 1 and 2.</p>
<p class="bodytext">The following table lists the API methods that Kaspersky Scan Engine supports in HTTP mode in KAV protocol versions 1 and 2.</p>
<p class="tablename">API methods supported in HTTP mode in KAV protocol versions 1 and 2</p>
<table class="tableintopic" width="960" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="186"><p class="tableheading">API method</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="84"><p class="tableheading">HTTP method</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="690"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="bodytext"><code class="programcharacter"><a id="h181075" class="englishcrossreferencetemplate" href="#181074" target="_self">/scanfile</a></code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="bodytext">POST</p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="bodytext">Scans a file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="bodytext"><code class="programcharacter"><a id="h181077" class="englishcrossreferencetemplate" href="#181076" target="_self">/scanmemory</a></code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="bodytext">POST</p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="bodytext">Scans a block of system memory.</p>
<p class="bodytext">Use only the KAV_SKIP cleaning mode when scanning system memory. Kaspersky Scan Engine cannot disinfect or delete files in this mode.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="bodytext"><code class="programcharacter"><a id="h181081" class="englishcrossreferencetemplate" href="#181080" target="_self">/checkurl</a></code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="bodytext">POST</p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="bodytext">Checks a URL. </p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="bodytext"><code class="programcharacter"><a id="h181083" class="englishcrossreferencetemplate" href="#181082" target="_self">/basesdate</a></code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="bodytext">GET</p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="bodytext">Gets the release date of the anti-virus database. You can use this method to check whether <code class="programcharacter">kavhttpd</code> is running.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="bodytext"><code class="programcharacter"><a id="h181085" class="englishcrossreferencetemplate" href="#181084" target="_self">/version</a></code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="bodytext">GET</p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="bodytext">Gets the current version of KAV SDK. You can use this method to check whether <code class="programcharacter">kavhttpd</code> is running.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="bodytext"><code class="programcharacter"><a id="h181087" class="englishcrossreferencetemplate" href="#181086" target="_self">/licenseinfo</a></code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="bodytext">GET</p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="bodytext">Gets information about the current key file or activation code. You can use this method to check whether <code class="programcharacter">kavhttpd</code> is running.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="bodytext"><code class="programcharacter"><a id="h181089" class="englishcrossreferencetemplate" href="#181088" target="_self">/getstatistics</a></code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="bodytext">GET</p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="bodytext">Gets the accumulated statistics.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="186"><p class="bodytext"><code class="programcharacter"><a id="h181091" class="englishcrossreferencetemplate" href="#181090" target="_self">/clearstatistics</a></code></p>
</td>
<td style="border:1px solid #010101;" width="84"><p class="bodytext">POST</p>
</td>
<td style="border:1px solid #010101;" width="690"><p class="bodytext">Clears the accumulated statistics.</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181073"><p><a name=181073 style="display: none;">[Topic 181073]</a></p>
	<h4 id="t234477" class="heading4">Request headers</h4>
<p class="attentionbody">An HTTP request, using the POST method, to Kaspersky Scan Engine must include the <code class="programcharacter">Content-Length</code> header.</p>
<p class="bodytext">When making an HTTP request, there are three request headers specific to Kaspersky Scan Engine that you can set:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">X-KAV-ProtocolVersion</code><p class="listcontinue1">This header specifies the KAV protocol version used. This header is mandatory.</p>
</li><li class="listbullet1"><code class="programcharacter">X-KAV-Timeout</code><p class="listcontinue1">This header specifies a scanning operation timeout in milliseconds (but not a session timeout). This header is optional. </p>
<p class="listcontinue1">This header takes values ranging from <code class="programcharacter">0</code> to <code class="programcharacter">4294967295</code> (unsigned 32-bit integer value). Set the value based on the characteristics of the object to scan (for example, its size or whether it is multipart or not; Kaspersky Scan Engine takes longer to scan a large multipart object).</p>
<p class="listcontinue1">See also the detailed information about a <a id="h179922" class="englishcrossreferencetemplate" href="#179870" target="_self">scanning timeout and a session timeout</a>.</p>
</li><li class="listbullet1"><code class="programcharacter">X-KAV-ObjectURL</code><p class="listcontinue1">This header contains the scan task context that Kaspersky Scan Engine uses to increase the detection rate. This header is optional.</p>
<p class="listcontinue1">The use of this header does not affect scanning performance.</p>
<p class="attentioncontinue1">We recommend that you use the scan task context in gateway integrations.</p>
<p class="listcontinue1">Use the following format for the context:</p>
<ul class="listbullet2"><li class="listbullet2">If the object to scan is received from the web, specify the web address of origin, including the protocol, for example:<p class="listcontinue2"><code class="programcharacter">http://example.com</code></p>
<p class="listcontinue2">The supported protocols are HTTP, HTTPS, and FTP.</p>
<p class="listcontinue2">If the URL is unknown, we recommend to use <code class="programcharacter">http://example.com</code> as the scan task context.</p>
</li><li class="listbullet2">If the object to scan was received by email, specify the sender's email address in the following format: <code class="programcharacter">[from:%sender_address%]</code>, for example:<p class="listcontinue2"><code class="programcharacter">[from:example@example.com]</code></p>
<p class="listcontinue2">If the sender's email address is unknown, we recommend that you use <code class="programcharacter">[from:test@relay.example]</code> as the scan task context.</p>
</li></ul><p class="attentioncontinue1">Scan task context is only applicable to file and memory scanning. If you specify scan task context for a URL, it will be ignored.</p>
</li><li class="listbullet1"><code class="programcharacter">X-KAV-HostIP</code><p class="listcontinue1">This header specifies the IP address of the host that hosts the URL to scan. Adding it to a request increases detection rate.</p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="224307"><p><a name=224307 style="display: none;">[Topic 224307]</a></p>
	<h4 id="t234342" class="heading4">Example of an HTTP request containing an API token for authorization</h4>
<p class="bodytext">If HTTP clients authorization is enabled in Kaspersky Scan Engine, all HTTP requests must contain an <a id="h224351" class="englishcrossreferencetemplate" href="#184921" target="_self">API token</a>.</p>
<p class="bodytext">The following example shows an HTTP request containing an API token in the <code class="programcharacter">Authorization</code> field:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /scanfile HTTP/1.0</p>
<p class="program">Content-Length: 35</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
<p class="program">X-KAV-Timeout: 10</p>
<p class="program">Authorization: SldYQTUyOUNVMnE3VWR2N3Izamk2QkVNc2hhLTV5dTBLcVUzeXZLdGYtNkkrVFUyQUVRQUNLQUFCSWdwRUlJTQ==</p>
<p class="program">&nbsp;</p>
<p class="program">* Full path to the EICAR test file * </p>
</td>
</tr>

</table>
<p class="bodytext">In this example, <code class="programcharacter">Authorization</code> is the default name of the request header field used for authorization. You can change this name in the <span class="guicharacter"><a id="h224242" class="englishcrossreferencetemplate" href="#224195" target="_self">Authorization</a></span> section of the Kaspersky Scan Engine GUI.</p>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Date: Mon, 10 February 2014 12:25:21 GMT</p>
<p class="program">Server: KAVHTTPD</p>
<p class="program">Content-Length: 32</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
<p class="program">&nbsp;</p>
<p class="program">DETECT EICAR-Test-File</p>
</td>
</tr>

</table>
<p class="bodytext">If the authorization failed and the Bearer prefix was specified, the response is as follows:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.1 401 Unauthorized</p>
<p class="program">WWW-Authenticate: Bearer realm=&quot;API Kaspersky Scan Engine&quot;</p>
</td>
</tr>

</table>
<p class="bodytext">If the authorization failed and the Bearer prefix was not specified, the response is as follows:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.1 401 Unauthorized</p>
<p class="program">WWW-Authenticate: Token realm=&quot;API Kaspersky Scan Engine&quot;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181074"><p><a name=181074 style="display: none;">[Topic 181074]</a></p>
	<h4 id="t234352" class="heading4">Example of an HTTP request to scan a local file</h4>
<p class="bodytext">The following example shows an HTTP request to scan a local file:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /scanfile HTTP/1.0</p>
<p class="program">Content-Length: 35</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
<p class="program">X-KAV-Timeout: 10</p>
<p class="program">&nbsp;</p>
<p class="program">* Full path to the EICAR test file * </p>
</td>
</tr>

</table>
<p class="attentionbody">If the file to scan is large, consider specifying the <code class="programcharacter">X-KAV-Timeout</code> header.</p>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Date: Mon, 10 February 2014 12:25:21 GMT</p>
<p class="program">Server: KAVHTTPD</p>
<p class="program">Content-Length: 32</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
<p class="program">&nbsp;</p>
<p class="program">DETECT EICAR-Test-File</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181076"><p><a name=181076 style="display: none;">[Topic 181076]</a></p>
	<h4 id="t234351" class="heading4">Example of an HTTP request to scan a block of memory</h4>
<p class="bodytext">The following example shows an HTTP request to scan a block of memory:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /scanmemory HTTP/1.0</p>
<p class="program">Content-Length: 35</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
<p class="program">X-KAV-Timeout: 10</p>
<p class="program">&nbsp;</p>
<p class="program">* Contents of the EICAR test file * </p>
</td>
</tr>

</table>
<p class="attentionbody">If the file to scan is large, consider specifying the <code class="programcharacter">X-KAV-Timeout</code> header.</p>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Date: Mon, 10 February 2014 12:25:21 GMT</p>
<p class="program">Server: KAVHTTPD</p>
<p class="program">Content-Length: 64</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
<p class="program">&nbsp;</p>
<p class="program">DETECT EICAR-Test-File</p>
</td>
</tr>

</table>
<p class="bodytext">You can also make a <a id="h181079" class="englishcrossreferencetemplate" href="#181078" target="_self">multipart scan request</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181078"><p><a name=181078 style="display: none;">[Topic 181078]</a></p>
	<h4 id="t234341" class="heading4">Example of a multipart HTTP request to scan a block of memory</h4>
<p class="bodytext">In Kaspersky Scan Engine, a multipart HTTP request is an HTTP request that contains request or response headers that were gathered from HTTP traffic related to the object being scanned. You can send multipart HTTP requests to improve the detection rate. </p>
<p class="attentionbody">Kaspersky Scan Engine does not support multipart HTTP requests, as defined in RFC 1341.</p>
<p class="attentionbody">To make multipart HTTP requests, use the KAV protocol version 2 by specifying it in the <code class="programcharacter">X-KAV-ProtocolVersion</code> request header.</p>
<p class="bodytext">The body of a multipart HTTP request must contain no more than three parts. These parts contain the following data:</p>
<ul class="listbullet1"><li class="listbullet1">Request headers (optional)<p class="listcontinue1">This part must begin with the &quot;<code class="programcharacter">Request headers</code>&quot; string followed by <code class="programcharacter">\r\n</code> characters. These characters must be followed by request headers from HTTP traffic related to the object that is being scanned.</p>
</li><li class="listbullet1">Response headers (optional)<p class="listcontinue1">This part must begin with the &quot;<code class="programcharacter">Response headers</code>&quot; string followed by <code class="programcharacter">\r\n</code> characters. These characters must be followed by response headers from HTTP traffic related to the object that is being scanned.</p>
</li><li class="listbullet1">Object for scanning.<p class="listcontinue1">This part can contain the full path to the file to scan (if a request is made to <code class="programcharacter">/scanfile</code>) or a string (if a request is made to <code class="programcharacter">/scanmemory</code>).</p>
</li></ul><p class="bodytext">The following example shows a multipart HTTP request to scan a block of memory:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST /scanmemory HTTP/1.0</p>
<p class="program">Content-Length: 753</p>
<p class="program">X-KAV-ProtocolVersion: 2</p>
<p class="program">X-KAV-Timeout: 10</p>
<p class="program"><code class="programcharacter">X-KAV-ObjectURL: http://example.com</code></p>
<p class="program">Content-Type: multipart/mixed; boundary=gc0p4Jq0M2Yt08jU534c0p</p>
<p class="program">&nbsp;</p>
<p class="program">--gc0p4Jq0M2Yt08jU534c0p</p>
<p class="program">Request headers</p>
<p class="program">GET /files/test.exe HTTP/1.1</p>
<p class="program">Host: source.example.com</p>
<p class="program">Accept: application/octet-stream</p>
<p class="program">Referer: http://malicious.example.com/</p>
<p class="program">Host: source.example.com</p>
<p class="program">Connection: Keep-Alive</p>
<p class="program">--gc0p4Jq0M2Yt08jU534c0p</p>
<p class="program">Response headers</p>
<p class="program">HTTP/1.1 200 OK</p>
<p class="program">Content-Type: application/octet-stream</p>
<p class="program">Content-Length: 21541</p>
<p class="program">Date: Mon, 25 Sep 2017 11:01:54 GMT</p>
<p class="program">Last-Modified: Fri, 28 Sep 2017 03:15:02 GMT</p>
<p class="program">--gc0p4Jq0M2Yt08jU534c0p</p>
<p class="program">* Contents of the EICAR test file *</p>
<p class="program">--gc0p4Jq0M2Yt08jU534c0p--</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Date: Fri, 28 Sep 2017 03:15:02 GMT</p>
<p class="program">Server: KAVHTTPD</p>
<p class="program">Content-Length: 64</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">X-KAV-ProtocolVersion: 2</p>
<p class="program">&nbsp;</p>
<p class="program">DETECT EICAR-Test-File</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181080"><p><a name=181080 style="display: none;">[Topic 181080]</a></p>
	<h4 id="t234343" class="heading4">Example of an HTTP request to check a URL</h4>
<p class="bodytext">The following example shows an HTTP request to check a URL:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program"><code class="programcharacter">POST /checkurl HTTP/1.0</code></p>
<p class="program"><code class="programcharacter">Content-Length: 27</code></p>
<p class="program"><code class="programcharacter">X-KAV-ProtocolVersion: 1</code></p>
<p class="program"><code class="programcharacter">X-KAV-Timeout: 15</code></p>
<p class="program">&nbsp;</p>
<p class="program"><code class="programcharacter">* Phishing URL to check * </code></p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Date: Mon, 10 February 2014 12:25:22 GMT</p>
<p class="program">Server: KAVHTTPD</p>
<p class="program">Content-Length: 110</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
<p class="program">&nbsp;</p>
<p class="program">DETECT PHISHING_URL</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181082"><p><a name=181082 style="display: none;">[Topic 181082]</a></p>
	<h4 id="t234350" class="heading4">Example of an HTTP request to get the release date of the anti-virus database</h4>
<p class="bodytext">The following example shows an HTTP request to get the release data of the anti-virus database:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">GET <code class="programcharacter">/basesdate</code> HTTP/1.0</p>
<p class="program">Host: example.com</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Date: Mon, 10 February 2014 15:03:21 GMT</p>
<p class="program">Server: KAVHTTPD</p>
<p class="program">Content-Length: 40</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
<p class="program">&nbsp;</p>
<p class="program">database version: 9.02.2014 15:03 GMT</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181084"><p><a name=181084 style="display: none;">[Topic 181084]</a></p>
	<h4 id="t234347" class="heading4">Example of an HTTP request to get the current KAV SDK version</h4>
<p class="bodytext">The following example shows an HTTP request to get the current KAV SDK version:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">GET <code class="programcharacter">/version</code> HTTP/1.0</p>
<p class="program">Host: example.com</p>
<p class="program">X-KAV-ProtocolVersion: 1 </p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Date: Mon, 10 February 2014 12:25:21 GMT</p>
<p class="program">Server: KAVHTTPD</p>
<p class="program">Content-Length: 27</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
<p class="program">&nbsp;</p>
<p class="program">KAV SDK version: 8.8.0.80</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181086"><p><a name=181086 style="display: none;">[Topic 181086]</a></p>
	<h4 id="t234346" class="heading4">Example of an HTTP request to get licensing information</h4>
<p class="bodytext">The following example shows an HTTP request to get licensing information:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">GET <code class="programcharacter">/licenseinfo</code> HTTP/1.0</p>
<p class="program">Host: example.com</p>
<p class="program">X-KAV-ProtocolVersion: 1 </p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response that contains licensing information when <a id="h180864" class="englishcrossreferencetemplate" href="#179852" target="_self">offline licensing mode</a> is used:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Date: Mon, 10 February 2014 12:25:21 GMT</p>
<p class="program">Server: KAVHTTPD</p>
<p class="program">Content-Length: 65</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
<p class="program">&nbsp;</p>
<p class="program">key file name: EXAMPLE.key</p>
<p class="program">license expiration date: 05.12.2020</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response that contains licensing information when the <a id="h180819" class="englishcrossreferencetemplate" href="#179855" target="_self">online licensing mode</a> is used. In this example, the license ticket has expired:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Date: Mon, 10 February 2014 12:25:21 GMT</p>
<p class="program">Server: KAVHTTPD</p>
<p class="program">Content-Length: 185</p>
<p class="program">Connection: close</p>
<p class="program">Content-Type: text/plain</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
<p class="program">&nbsp;</p>
<p class="program">activation code: EXMPL-*****-*****-12345</p>
<p class="program">license expiration date: 05.12.2020</p>
<p class="program">The license ticket has expired. Computer must be connected to the Internet to update the license ticket.</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181088"><p><a name=181088 style="display: none;">[Topic 181088]</a></p>
	<h4 id="t234345" class="heading4">Example of an HTTP request to get accumulated statistics</h4>
<p class="bodytext">The following example shows an HTTP request to get accumulated statistics:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">GET <code class="programcharacter">/getstatistics</code> HTTP/1.0</p>
<p class="program">Host: example.com</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
</td>
</tr>

</table>
<p class="bodytext">For a description of the statistics returned in the HTTP response, see the example of <a id="h193118" class="englishcrossreferencetemplate" href="#193009" target="_self">making this request in KAV protocol version 3</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181090"><p><a name=181090 style="display: none;">[Topic 181090]</a></p>
	<h4 id="t234344" class="heading4">Example of an HTTP request to clear accumulated statistics</h4>
<p class="bodytext">The following example shows an HTTP request to clear accumulated statistics:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">POST <code class="programcharacter">/clearstatistics</code> HTTP/1.0</p>
<p class="program">User-Agent: KAV HTTP Client</p>
<p class="program">Content-Length: 0</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.0 200 OK</p>
<p class="program">Date: Mon, 10 February 2014 12:25:21 GMT</p>
<p class="program">Server: KAVHTTPD</p>
<p class="program">Content-Length: 0</p>
<p class="program">Connection: close</p>
<p class="program">X-KAV-ProtocolVersion: 1</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201538"><p><a name=201538 style="display: none;">[Topic 201538]</a></p>
	<h3 id="t234374" class="heading3">Getting the list of HTTP methods supported in the service</h3>
<p class="bodytext">When Kaspersky Scan Engine is working in HTTP mode, you can make the OPTIONS request to all supported API methods. This request allows you to get information about the HTTP methods that are supported in the kavhttpd service.</p>
<p class="bodytext">To make a request, specify an API method for the OPTIONS method.</p>
<p class="bodytext">The following block shows an example of the OPTIONS request:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">OPTIONS /api/v3.1/version HTTP/1.1</p>
</td>
</tr>

</table>
<p class="bodytext">The following example shows the corresponding response:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">HTTP/1.1 200 OK</p>
<p class="program">Date: Wed, 15 Jul 2020 10:15:44 GMT</p>
<p class="program">Content-Length: 0</p>
<p class="program">Allow: OPTIONS, GET</p>
</td>
</tr>

</table>
<p class="bodytext">where <code class="programcharacter">Allow</code> contains the list of HTTP methods that are supported in this API method.</p>
<p class="bodytext">If the HTTP request contains the <code class="programcharacter">Origin</code> field (a field that contains the IP address or host name that initiates the request) and if the <code class="programcharacter">AccessControlAllowOrigin</code> element is defined in the HTTP mode configuration file, the response will contain the <code class="programcharacter">Access-Control-Allow-Origin</code> and <code class="programcharacter">Access-Control-Allow-Methods</code> fields instead of the <code class="programcharacter">Allow</code> field. In this case, the <code class="programcharacter">Access-Control-Allow-Origin</code> field can contain the values that are described in the <code class="programcharacter"><a id="h201539" class="englishcrossreferencetemplate" href="#201900" target="_self">ServerSettings &gt; CORS</a></code> section and the <code class="programcharacter">Access-Control-Allow-Methods</code> field value is similar to the <code class="programcharacter">Allow</code> field value.</p>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179883"><p><a name=179883 style="display: none;">[Topic 179883]</a></p>
	<h2 id="t234587" class="heading2">Using the sample HTTP client</h2>
<p class="bodytext">This section explains how to use the sample HTTP client from the command line. The sample HTTP client is located in <code class="programcharacter">%service_dir%/bin</code>.</p>
<p class="attentionbody">This section explains how to use the executable file of the sample HTTP client. Explaining the implementation of the sample HTTP client is beyond the scope of this documentation. The source code of the sample HTTP client is located in the <code class="programcharacter">/samples/kavhttp</code> directory of the Kaspersky Scan Engine distribution package.</p>
<p class="introheading">About the sample HTTP client</p>
<p class="bodytext">The sample HTTP client is a console application that demonstrates how to implement a client for Kaspersky Scan Engine in HTTP mode. You can also use it to scan files from the console.</p>
<p class="bodytext">The sample HTTP client makes HTTP requests to Kaspersky Scan Engine. It supports TCP connections (Windows and Linux) and UNIX socket connections (Linux only), and can pass file paths or file contents to Kaspersky Scan Engine.</p>
<p class="bodytext">When Kaspersky Scan Engine finishes scanning files, it sends a response to the sample HTTP client. The sample HTTP client <a id="h180276" class="englishcrossreferencetemplate" href="#179886" target="_self">prints the scan result to the standard output</a>.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#179884" target="_self">Syntax and options for the HTTP client</a></p><p class="relateditem"><a href="#182976" target="_self">Scanning files over TCP socket in scanfile mode</a></p><p class="relateditem"><a href="#179885" target="_self">Syntax examples</a></p><p class="relateditem"><a href="#179886" target="_self">Scan results for the HTTP client</a></p><p class="relateditem"><a href="#179887" target="_self">HTTP client connection error messages</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179884"><p><a name=179884 style="display: none;">[Topic 179884]</a></p>
	<h3 id="t234524" class="heading3">Syntax and options for the HTTP client</h3>
<p class="bodytext">You can supply one or more options to the sample HTTP client.</p>
<p class="introheading">Options</p>
<p class="bodytext">The following options are available in the sample HTTP client:</p>
<p class="tablename">Options for running the sample HTTP client</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="804" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="240"><p class="tableheading">Option</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="564"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-s</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies the address of Kaspersky Scan Engine or a path to the Unix socket. The connection string can be specified with or without quotation marks. If this option is not specified, the default <code class="programcharacter">/tmp/.kavhttpd</code> Unix socket is used.</p>
<p class="tablebodytext">The UNIX sockets are supported only on Linux systems.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-t</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies the request processing timeout, in milliseconds.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-u</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies the URL to scan.</p>
<p class="attentionbody">Only one URL can be specified at a time.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-i</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies the IP address (IPv4 or IPv6) of the host referred to by a URL. This option can only be used with <code class="programcharacter">-u</code>.</p>
<p class="tablebodytext">Specifying an IP address increases the detection rate of Kaspersky Scan Engine.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-f</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Enables the scanfile mode.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-c</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies the scan task context. If this option is specified, the request must have the <code class="programcharacter">X-KAV-ObjectURL</code> header that contains the option value, without quotation marks.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">--req</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies a path to a file with request headers that were gathered from the HTTP traffic for the scanned object.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">--resp</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies a path to a file with response headers that were gathered from the HTTP traffic for the scanned object.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-b</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Shows the release date of the anti-virus database. You can use this option to check whether <code class="programcharacter">kavhttpd</code> is running. Can be used with options <code class="programcharacter">-s</code>, <code class="programcharacter">-t</code>, and <code class="programcharacter">-j</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-v</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Shows the version of KAV SDK. You can use this option to check whether <code class="programcharacter">kavhttpd</code> is running. Can be used with options <code class="programcharacter">-s</code>, <code class="programcharacter">-t</code>, and <code class="programcharacter">-j</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-l</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Shows information about the current key file. You can use this option to check whether <code class="programcharacter">kavhttpd</code> is running. Can be used with options <code class="programcharacter">-s</code>, <code class="programcharacter">-t</code>, and <code class="programcharacter">-j</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-h</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Shows Help information.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-j</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Makes an HTTP request in JSON format.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-d</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Makes an HTTP request to launch the anti-virus database update. Can be used with options <code class="programcharacter">-s</code>, <code class="programcharacter">-t</code>, and <code class="programcharacter">-j</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-p</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Shows the status of the database update process. Can be used with options <code class="programcharacter">-s</code>, <code class="programcharacter">-t</code>, and <code class="programcharacter">-j</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">&#8209;&#8209;getstat</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Gets the accumulated statistics. Can be used with options <code class="programcharacter">-s</code>, <code class="programcharacter">-t</code>, and <code class="programcharacter">-j</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">&#8209;&#8209;clearstat</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Clears the accumulated statistics. Can be used with options <code class="programcharacter">-s</code>, <code class="programcharacter">-t</code>, and <code class="programcharacter">-j</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-o</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">When making an HTTP request in JSON format, omits objects with the <code class="programcharacter">CLEAN</code> scan result from the <code class="programcharacter">subObjectsScanResults</code> array in the response message. Can only be used with option <code class="programcharacter">-j</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">--cipher</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="bodytext">Specifies a cipher suite which must be used for exchange with the kavhttpd service. </p>
<p class="bodytext">The following cipher suites are supported in TLS 1.2:</p>
<ul class="tablelistbullet"><li class="tablelistbullet"><code class="programcharacter">ECDHE-ECDSA-AES256-GCM-SHA384</code></li><li class="tablelistbullet"><code class="programcharacter">ECDHE-ECDSA-AES256-SHA384</code></li><li class="tablelistbullet"><code class="programcharacter">ECDHE-ECDSA-AES128-GCM-SHA256</code></li><li class="tablelistbullet"><code class="programcharacter">ECDHE-ECDSA-AES128-SHA256</code></li><li class="tablelistbullet"><code class="programcharacter">ECDHE-RSA-AES256-GCM-SHA384</code></li><li class="tablelistbullet"><code class="programcharacter">ECDHE-RSA-AES256-SHA384</code></li><li class="tablelistbullet"><code class="programcharacter">ECDHE-RSA-AES128-GCM-SHA256</code></li><li class="tablelistbullet"><code class="programcharacter">ECDHE-RSA-AES128-SHA256</code></li><li class="tablelistbullet"><code class="programcharacter">ECDHE-RSA-CHACHA20-POLY1305</code></li><li class="tablelistbullet"><code class="programcharacter">DHE-RSA-AES256-GCM-SHA384</code></li><li class="tablelistbullet"><code class="programcharacter">DHE-RSA-AES256-SHA256</code></li><li class="tablelistbullet"><code class="programcharacter">DHE-RSA-AES128-SHA256</code></li><li class="tablelistbullet"><code class="programcharacter">DHE-RSA-CHACHA20-POLY1305</code></li></ul><p class="bodytext">The following cipher suites are supported in TLS 1.3:</p>
<ul class="tablelistbullet"><li class="tablelistbullet"><code class="programcharacter">TLS_AES_256_GCM_SHA384</code></li><li class="tablelistbullet"><code class="programcharacter">TLS_CHACHA20_POLY1305_SHA256</code></li><li class="tablelistbullet"><code class="programcharacter">TLS_AES_128_GCM_SHA256</code></li></ul><p class="bodytext">By default, the following value is used: <code class="programcharacter">ECDHE-ECDSA-AES256-GCM-SHA384</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">&#8209;-check&#8209;period</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Checks if the validity period of a certificate conforms to the current date, based on time zone.</p>
<p class="tablebodytext">By default, checking is not performed.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">&#8209;-check&#8209;subject</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Checks if the subject name of a certificate (<code class="programcharacter">SubjectAltNames</code> and <code class="programcharacter">Common Name</code> fields) matches the domain name of the server.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">--check&#8209;chain</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Checks a certificate by a certification path.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">--ca-path</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies a full path to the directory where CA certificates are stored. A certificate from the specified directory is used to check the validity of a TLS certificate and its configuration.</p>
<p class="tablebodytext">In Linux, if this parameter is not specified, the HTTP client uses the following paths:</p>
<ul class="tablelistbullet"><li class="tablelistbullet"><code class="programcharacter">/etc/pki/tls/certs</code></li><li class="tablelistbullet"><code class="programcharacter">/etc/ssl/certs</code></li></ul><p class="bodytext">To use the <code class="programcharacter">--ca-path</code> option, prepare the directory containing the certificates as described in <a id="h212473" class="englishcrossreferencetemplate" href="#179885" target="_self">Syntax examples</a>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">--ca-cert</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies a full path to the directory where a CA bundle is stored. The bundle file is used to check the validity of a TLS certificate and its configuration.</p>
<p class="tablebodytext">In Linux, if this parameter is not specified, the HTTP client uses one of the following files (whichever is found first):</p>
<ul class="tablelistbullet"><li class="tablelistbullet"><code class="programcharacter">/etc/ssl/certs/ca-certificates.crt</code></li><li class="tablelistbullet"><code class="programcharacter">/etc/pki/tls/certs/ca-bundle.crt</code></li><li class="tablelistbullet"><code class="programcharacter">/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem</code></li><li class="tablelistbullet"><code class="programcharacter">/etc/ssl/ca-bundle.pem</code></li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">&#8209;&#8209;repeat&#8209;timeout&nbsp;REPEAT_TIMEOUT</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies that scanning of objects will be repeated for at least <code class="programcharacter">REPEAT_TIMEOUT</code> seconds.</p>
<p class="tablebodytext">If the argument is not specified, all of the objects will be scanned one time. Otherwise, scanning will be performed for at least the specified seconds.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">--quiet </code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Suppresses scan results.That is, scan results are not displayed.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">&#8209;&#8209;threads&nbsp;THREADS&nbsp;(=1)</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies the number of threads to scan files in parallel.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">-m&nbsp;[&nbsp;&#8209;&#8209;measure&nbsp;]</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Measures and displays the following:</p>
<ul class="tablelistbullet"><li class="tablelistbullet">Scan time in the <code class="programcharacter">%H:%M:%S.%ms</code> format</li><li class="tablelistbullet">Accumulated scan statistics before and after scanning</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">--auth-field</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies the name of the request header field used for authentication.</p>
<p class="tablebodytext">If not specified, the default name <code class="programcharacter">Authorization</code> is used.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">--access-token</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Specifies the value of an API token used for authentication. </p>
<p class="tablebodytext">Combine this option with <code class="programcharacter">--auth-field</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="240"><p class="tablebodytext"><code class="programcharacter">--add-bearer-prefix</code></p>
</td>
<td style="border:1px solid #010101;" width="564"><p class="tablebodytext">Adds the <code class="programcharacter">Bearer</code> prefix to the API token value specified in <code class="programcharacter">--access-token</code>.</p>
<p class="tablebodytext">Combine this option with <code class="programcharacter">--access-token</code>.</p>
</td>
</tr>

</table>
<p class="introheading">Connection type</p>
<p class="bodytext">Two connection types are supported by the sample HTTP client:</p>
<ul class="listbullet1"><li class="listbullet1">TCP connection<p class="listcontinue1">To use a TCP connection, specify an IP address in the <code class="programcharacter">-s</code> option in the following format: &quot;<code class="programcharacter">ip_addr:port</code>&quot;.</p>
</li><li class="listbullet1">UNIX socket connection (Linux only)<p class="listcontinue1">To use a UNIX socket connection, specify the path to the socket in the <code class="programcharacter">-s</code> option.</p>
<p class="listcontinue1">This is the default option. The default socket file is <code class="programcharacter">/tmp/.kavhttpd</code>.</p>
</li></ul><p class="introheading">Timeout</p>
<p class="bodytext">The sample HTTP client uses the value specified in the <code class="programcharacter">-t</code> option to determine the scan timeout, similarly to the <code class="programcharacter">X-KAV-Timeout</code> <a id="h179981" class="englishcrossreferencetemplate" href="#179875" target="_self">header</a>.</p>
<p class="bodytext">The default timeout value is <code class="programcharacter">2000</code>.</p>
<p class="bodytext">If <code class="programcharacter">0</code> is specified in this option, the timeout is infinite.</p>
<p class="introheading">Scan mode</p>
<p class="bodytext">The sample HTTP client supports two scan modes, which you can specify by using the <code class="programcharacter">-f</code> option:</p>
<ul class="listbullet1"><li class="listbullet1">scanfile mode (<code class="programcharacter">-f</code>).<p class="listcontinue1">In this mode, the sample HTTP client passes file paths to Kaspersky Scan Engine, which reads and scans the files.</p>
<p class="listcontinue1">To send a <a id="h182977" class="englishcrossreferencetemplate" href="#182976" target="_self">scan request to a remote computer over a TCP socket</a>, you must specify the paths to the files that you want to scan or the directories that contain these files. You do not have to do that if the sample HTTP client and Kaspersky Scan Engine are located on the same computer.</p>
</li><li class="listbullet1">scanmemory mode (default).<p class="listcontinue1">In this mode, the sample HTTP client passes the file contents to Kaspersky Scan Engine, which scans the contents.</p>
<p class="attentioncontinue1">Use only the KAV_SKIP cleaning mode with the scanmemory scan mode. Kaspersky Scan Engine cannot disinfect or delete files in the scanmemory mode.</p>
</li></ul><p class="introheading">Scan task context</p>
<p class="bodytext">Kaspersky Scan Engine uses the scan task context to increase the detection rate. Using this option does not affect scanning performance.</p>
<p class="bodytext">It is recommended to use the scan task context in gateway integrations.</p>
<p class="bodytext">Use the following format for the context:</p>
<ul class="listbullet1"><li class="listbullet1">If the object to scan is received from the Internet, specify the web address of the source, including the protocol.<p class="listcontinue1">Example: <code class="programcharacter">http://example.com</code></p>
<p class="listcontinue1">The supported protocols are HTTP, HTTPS, and FTP. If the source URL is unknown, it is recommended to use <code class="programcharacter">http://example.com</code> as the scan task context.</p>
</li><li class="listbullet1">If the object to scan is received by email, specify the sender's email address. Use the following format: <code class="programcharacter">[from:%sender_address%]</code>.<p class="listcontinue1">Example: <code class="programcharacter">[from:example@example.com]</code></p>
</li></ul><p class="bodytext">If the object is received by email, but the sender's email address is unknown, it is recommended to use <code class="programcharacter">[from:test@relay.example]</code> as the scan task context.</p>
<p class="attentionbody">The scan task context is applicable to file scanning only. If you specify the scan task context for a URL, it will be ignored.</p>
<p class="introheading">Request and response headers</p>
<p class="bodytext">Specifying request and response headers that were gathered from HTTP traffic related to the scanned object improves the detection rate. It is recommended to use the request and response headers in gateway integrations.</p>
<p class="introheading">Information messages</p>
<p class="bodytext">The <code class="programcharacter">-b</code>, <code class="programcharacter">-v</code>, and <code class="programcharacter">-l</code> options can only be used together with the <code class="programcharacter">-s</code>, <code class="programcharacter">-j</code>, and <code class="programcharacter">-t</code> options. If you use them with any other option, <code class="programcharacter">kavhttp_client</code> returns an error.</p>
<p class="bodytext">You can use the <code class="programcharacter">-b</code>, <code class="programcharacter">-v</code>, and <code class="programcharacter">-l</code> options to check whether <code class="programcharacter">kavhttpd</code> is running.</p>
<p class="introheading">Scanning files</p>
<p class="bodytext">You can specify one or more files to scan, separating them by a white space. Depending on the scan mode, the sample HTTP client then passes the paths to these files or their contents to Kaspersky Scan Engine.</p>
<p class="bodytext">Also, you can specify a directory where files are stored. All files that are located inside this directory and all its subdirectories will be scanned.</p>
<p class="bodytext">Use the following syntax to scan files in scanfile mode:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">./kavhttp_client [-s &lt;ip:port | unix-socket&gt;] [-t &lt;timeout&gt;] [-c &lt;context&gt;] [--req &lt;req_file&gt;] [--resp &lt;resp_file&gt;] -f &lt;file1&gt; [&lt;file2&gt;...]</p>
</td>
</tr>

</table>
<p class="bodytext">Use the following syntax to scan the contents of files in scanmemory mode:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">./kavhttp_client [-s &lt;ip:port | unix-socket&gt;] [-t &lt;timeout&gt;] [-c &lt;context&gt;] [--req &lt;req_file&gt;] [--resp &lt;resp_file&gt;] &lt;file1&gt; [&lt;file2&gt;...]</p>
</td>
</tr>

</table>
<p class="introheading">Scanning URLs</p>
<p class="bodytext">You can specify a URL to scan. If the URL contains spaces or tabs, enclose the URL in quotation marks or make these characters percent-encoded. Similarly, if the URL contains quotation marks (<code class="programcharacter">&quot;</code>), make them percent-encoded.</p>
<p class="bodytext">Simultaneous scanning of multiple URLs is not supported. If you specify more than one URL, only the first one will be scanned.</p>
<p class="attentionbody">Files cannot be scanned when the <code class="programcharacter">-u</code> option is specified. The <code class="programcharacter">-u</code> and <code class="programcharacter">-f</code> options cannot be used together.</p>
<p class="bodytext">Use the following syntax to scan a URL:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">./kavhttp_client [-s &lt;IP:port | unix-socket&gt;] [-t &lt;timeout&gt;] [-i &lt;IP&gt;] -u &lt;URL&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="182976"><p><a name=182976 style="display: none;">[Topic 182976]</a></p>
	<h3 id="t234499" class="heading3">Scanning files over TCP socket in scanfile mode</h3>
<p class="bodytext">You can send scan requests in both scanmemory mode and scanfile mode from the HTTP client on a remote computer to the computer on which the kavhttpd service runs. </p>
<p class="bodytext">In scanmemory mode, the content of the scanned object is sent in the HTTP request message and is scanned in the system memory of the computer that the kavhttpd service runs on.</p>
<p class="bodytext">In scanfile mode, the HTTP client sends to the kavhttpd service the path to the object that is located on the same computer as the kavhttpd service, or on a remote hard disk successfully mounted on that computer. The kavhttpd service reads the object from the hard disk and scans it.</p>
<p class="bodytext">However, when Kaspersky Scan Engine receives a scan request from a client on remote computer in scanfile mode, it scans only those files that are placed at locations specified in the &lt;<code class="programcharacter">ScanningPath&gt;</code> elements of the HTTP mode configuration file. This restriction is necessary to prevent the HTTP client from accidentally scanning the whole file system from the remote computer. </p>
<p class="procedureheading">To scan a file by using a TCP socket in scanfile mode:</p>
<ol class="listnumber1"><li class="listnumber1">In a <code class="programcharacter">&lt;ScanningPath&gt;</code> element of the configuration file, <a id="h201077" class="englishcrossreferencetemplate" href="#201076" target="_self">specify the location of the file that you want to scan</a>.<p class="listcontinue1">Kaspersky Scan Engine does not add or remove objects in the directories specified by <code class="programcharacter">ScanningPath</code>. The HTTP client has to send objects to scan, then remove them after scanning.</p>
<p class="listcontinue1">The following example shows how to specify a directory that contains files to scan:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ScanningPaths&gt;</p>
<p class="program2">&lt;ScanningPath&gt;/mnt/to_scan/&lt;/ScanningPath&gt;</p>
<p class="program">&lt;/ScanningPaths&gt;</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Connect to Kaspersky Scan Engine on a remote computer by using a TCP socket and scan the file in scanfile mode. <p class="listcontinue1">The following example shows how to scan the eicar.txt file that is located in the <code class="programcharacter">/mnt/to_scan/</code> directory on the computer the kavhttpd service runs on:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -f -s 192.0.2.42:9999 /mnt/to_scan/eicar.txt</p>
</td>
</tr>

</table>
<p class="spacer"></p>
</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179885"><p><a name=179885 style="display: none;">[Topic 179885]</a></p>
	<h3 id="t234525" class="heading3">Syntax examples</h3>
<p class="bodytext">This section contains examples of using a sample HTTP client application from the command line.</p>
<p class="introheading">Scanning files and URLs</p>
<p class="bodytext">Use the default UNIX socket to scan one file by passing the file contents:</p>
<table class="tableintopic" width="642" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="642"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client eicar.txt</p>
</td>
</tr>

</table>
<p class="bodytext">Use the default UNIX socket to scan one file by passing the path to the file:</p>
<table class="tableintopic" width="642" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="642"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -f eicar.txt</p>
</td>
</tr>

</table>
<p class="bodytext">Connect to Kaspersky Scan Engine over a TCP socket and scan two files by passing their contents:</p>
<table class="tableintopic" width="642" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="642"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -s 192.0.2.42:9999 eicar.txt test.sh</p>
</td>
</tr>

</table>
<p class="bodytext">Connect to Kaspersky Scan Engine over a TCP socket and scan two files by passing their contents with a 10-second timeout:</p>
<table class="tableintopic" width="678" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="678"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -s 192.0.2.42:9999 -t 10000 eicar.txt test.sh</p>
</td>
</tr>

</table>
<p class="spacer"></p>
<p class="bodytext">Connect to Kaspersky Scan Engine over a TCP socket and scan a file by passing the file path:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -f -s 192.0.2.42:9999 /mnt/to_scan/eicar.txt</p>
</td>
</tr>

</table>
<p class="bodytext">Connect to Kaspersky Scan Engine over a TCP socket and scan a URL:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -s 192.0.2.42:9999 -u http://example.com</p>
</td>
</tr>

</table>
<p class="bodytext">Connect to Kaspersky Scan Engine over a TCP socket and scan a URL with the IP of the host referred to by the URL:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -s 192.0.2.42:9999 -i 233.252.0.1 -u http://bug.qainfo.ru/TesT/Aphish_w</p>
</td>
</tr>

</table>
<p class="bodytext">Connect to Kaspersky Scan Engine over a TCP socket and request the release date of the anti-virus database:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client &#8211;b -s 192.0.2.42:9999</p>
</td>
</tr>

</table>
<p class="introheading">Scanning files and URLs after authorizing with an API token</p>
<p class="bodytext">Authorize using an API token, connect to Kaspersky Scan Engine over a TCP socket, and scan a file by passing the file path:</p>
<table class="tableintopic" width="642" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="642"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -f -s https://192.0.2.42:443/mnt/to_scan/eicar.txt --auth-field --access-token Ab345-KAV</p>
</td>
</tr>

</table>
<p class="bodytext">Authorize using an API token, connect to Kaspersky Scan Engine over a TCP socket, and scan a URL:</p>
<table class="tableintopic" width="642" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="642"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -s https://192.0.2.42:443 -u http://example.com --auth-field --access-token Ab345-KAV</p>
</td>
</tr>

</table>
<p class="bodytext">Authorize using an API token and the Bearer authentication scheme, connect to Kaspersky Scan Engine over a TCP socket, and scan a file by passing the file path:</p>
<table class="tableintopic" width="642" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="642"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -f -s https://192.0.2.42:443 /mnt/to_scan/eicar.txt --auth-field --add-bearer-prefix --access-token Ab345-KAV</p>
</td>
</tr>

</table>
<p class="bodytext">Authorize using an API token and the Bearer authentication scheme, connect to Kaspersky Scan Engine over a TCP socket, and scan a URL:</p>
<table class="tableintopic" width="678" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="678"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -s https://192.0.2.42:443 -u http://example.com -auth-field --add-bearer-prefix --access-token Ab345-KAV</p>
</td>
</tr>

</table>
<p class="spacer"></p>
<p class="introheading">Scanning files and URLs, and checking the TLS certificate</p>
<p class="bodytext">In Linux, to use the <code class="programcharacter">--ca-path</code> option, prepare the directory containing the certificates:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">openssl rehash /mnt/your-cert-dir/</p>
</td>
</tr>

</table>
<p class="bodytext">In Windows, to use the <code class="programcharacter">--ca-path</code> option, you have to name the certificates files in the search directory as follows: <em class="emphasischaracter">&lt;hash&gt;.0</em>, <em class="emphasischaracter">&lt;hash&gt;.1</em>, <em class="emphasischaracter">&lt;hash&gt;.2, </em>etc., where <em class="emphasischaracter">&lt;hash&gt;</em> is the hash of the file (for example,<em class="emphasischaracter"> d93f38c8.0</em>).</p>
<p class="bodytext">To get the hash of a file, use the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">openssl.exe x509 -hash -noout -in &quot;full path to the certificate file&quot;</p>
</td>
</tr>

</table>
<p class="bodytext">Scan a file and specify the full path to the certificate bundle:</p>
<ul class="listbullet1"><li class="listbullet1">In Windows:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">%service_dir%\bin\kavhttp_client -f -s https://127.0.0.1:443 C:\eicar.txt -j --ca-cert C:\your-cert-dir\CertificateFile.cert</p>
</td>
</tr>

</table>
</li><li class="listbullet1">In Linux:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -f -s https://127.0.0.1:443 /mnt/to_scan/eicar.txt --ca-cert /mnt/your-cert-dir/CertificateFile.cert</p>
</td>
</tr>

</table>
</li></ul><p class="bodytext">Scan a URL and specify the path to the folder that contains the certificate file:</p>
<ul class="listbullet1"><li class="listbullet1">In Windows:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">%service_dir%\bin\kavhttp_client -s https://127.0.0.1:443 &#8211;u https://example.com -j --ca-path C:\your-cert-dir\</p>
</td>
</tr>

</table>
</li><li class="listbullet1">In Linux:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -s https://127.0.0.1:443 &#8211;u https://example.com --ca-path /mnt/your-cert-dir/</p>
</td>
</tr>

</table>
</li></ul><p class="bodytext">Scan a file and specify certificate checking options:</p>
<ul class="listbullet1"><li class="listbullet1">In Windows:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">%service_dir%\bin\kavhttp_client -f -s https://127.0.0.1:443 C:\eicar.txt -j --check-period</p>
<p class="program">%service_dir%\bin\kavhttp_client -f -s https://127.0.0.1:443 C:\eicar.txt -j --check-subject</p>
<p class="program">%service_dir%\bin\kavhttp_client -f -s https://127.0.0.1:443 C:\eicar.txt -j --check-chain</p>
</td>
</tr>

</table>
</li><li class="listbullet1">In Linux:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -f -s https://127.0.0.1:443 /mnt/to_scan/eicar.txt --check-period</p>
<p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -f -s https://127.0.0.1:443 /mnt/to_scan/eicar.txt --check-subject</p>
<p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -f -s https://127.0.0.1:443 /mnt/to_scan/eicar.txt --check-chain</p>
</td>
</tr>

</table>
</li></ul><p class="bodytext">Scan a file and specify certificate checking options within one command:</p>
<ul class="listbullet1"><li class="listbullet1">In Windows:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">%service_dir%\bin\kavhttp_client -f -s https://127.0.0.1:443 C:\eicar.txt -j --check-period --check-subject --check-chain --ca-path C:\your-cert-dir\</p>
</td>
</tr>

</table>
</li><li class="listbullet1">In Linux:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -f -s https://127.0.0.1:443 /mnt/to_scan/eicar.txt --check-period --check-subject --check-chain --ca-path /mnt/your-cert-dir/</p>
</td>
</tr>

</table>
</li></ul><p class="bodytext">Scan a file and check both the certificate bundle and the certificate file:</p>
<ul class="listbullet1"><li class="listbullet1">In Windows:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">%service_dir%\bin\kavhttp_client -f -s https://127.0.0.1:443 C:\eicar.txt  -j --ca-path C:\your-cert-dir\ --ca-cert C:\your-cert-dir\CertificateFile.cert</p>
</td>
</tr>

</table>
</li><li class="listbullet1">In Linux:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">user@computer:/opt/kaspersky/ScanEngine/bin# ./kavhttp_client -f -s https://127.0.0.1:443 /mnt/to_scan/eicar.txt  --ca-path /mnt/your-cert-dir/ --ca-cert /mnt/your-cert-dir/CertificateFile.cert</p>
</td>
</tr>

</table>
</li></ul><p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179886"><p><a name=179886 style="display: none;">[Topic 179886]</a></p>
	<h3 id="t234493" class="heading3">Scan results for the HTTP client</h3>
<p class="bodytext">For each scanned file, the sample HTTP client prints a scan result that specifies whether a scanned object is considered uninfected or malicious.</p>
<p class="bodytext">The following scan results are possible:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">CLEAN</code><p class="listcontinue1">Scanned object is considered uninfected.</p>
</li><li class="listbullet1"><code class="programcharacter">DETECT</code><p class="listcontinue1">Scanned object is considered malicious. This scan result is followed by the name of the detected object or the type of the detected URL.</p>
<p class="listcontinue1">Kaspersky Scan Engine detects URLs of the following types:</p>
<ul class="listbullet2"><li class="listbullet2">Malicious URLs. When such a URL is detected, Kaspersky Scan Engine returns <code class="programcharacter">DETECT</code> <code class="programcharacter">MALICIOUS_URL</code>. The priority of this type is 1 (highest priority).</li><li class="listbullet2">Phishing URLs. When such a URL is detected, Kaspersky Scan Engine returns <code class="programcharacter">DETECT</code> <code class="programcharacter">PHISHING_URL</code>. The priority of this type is 2.</li><li class="listbullet2">Adware URLs. When such a URL is detected, Kaspersky Scan Engine returns <code class="programcharacter">DETECT</code> <code class="programcharacter">ADWARE_URL</code>. The priority of this type is 3.<p class="attentioncontinue2">A URL of this type can only be detected when Cloud Protection is enabled.</p>
</li><li class="listbullet2">URLs leading to legitimate software that can be used by intruders to damage computers or users' personal data). When such a URL is detected, Kaspersky Scan Engine returns <code class="programcharacter">DETECT</code> <code class="programcharacter">RISKWARE_URL</code>. The priority of this type is 4 (lowest priority).<p class="attentioncontinue2">A URL of this type can only be detected when Cloud Protection is enabled.</p>
</li></ul><p class="listcontinue1">A URL can belong to several types simultaneously. In this case, Kaspersky Scan Engine returns the <code class="programcharacter">DETECT</code> scan result of the highest priority.</p>
</li><li class="listbullet1"><code class="programcharacter">DISINFECTED</code><p class="listcontinue1">Scanned object has been successfully disinfected.</p>
</li><li class="listbullet1"><code class="programcharacter">DELETED</code><p class="listcontinue1">Scanned object was deleted.</p>
</li></ul><p class="bodytext">If the scanned object contains macros, the scan result of this file is appended with &quot;<code class="programcharacter">AND CONTAINS OFFICE MACRO&quot;</code>.</p>
<p class="bodytext">Below is an example of the output produced by the sample HTTP client:</p>
<table class="tableintopic" width="564" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="564"><p class="program">./kavhttp_client test.sh service.sh eicar.txt</p>
<p class="program">Server address: /tmp/.kavhttpd</p>
<p class="program">Network timeout: 2000</p>
<p class="program">Scan mode: scanmemory</p>
<p class="program">Scan file: test.sh</p>
<p class="program">CLEAN</p>
<p class="program">Scan file: service.sh</p>
<p class="program">CLEAN</p>
<p class="program">Scan file: eicar.txt</p>
<p class="program">DETECT EICAR-Test-File</p>
</td>
</tr>

</table>
<p class="bodytext">If the scanning operation failed, the scan result will contain one of the following error codes:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">NON_SCANNED</code><p class="listcontinue1">Specified object was not scanned. The reason for it is provided as well.</p>
</li><li class="listbullet1"><code class="programcharacter">SERVER_ERROR</code><p class="listcontinue1">An error occurred in Kaspersky Scan Engine.</p>
</li><li class="listbullet1"><code class="programcharacter">CONNECTION_CLOSED</code><p class="listcontinue1">Connection was closed by Kaspersky Scan Engine.</p>
</li><li class="listbullet1"><code class="programcharacter">CLIENT_TIMEOUT</code><p class="listcontinue1">Operation timed out. This happens when the client timeout is exceeded.</p>
</li><li class="listbullet1"><code class="programcharacter">CONNECTION_FAILED</code><p class="listcontinue1">Failed to establish a connection to Kaspersky Scan Engine.</p>
</li><li class="listbullet1"><code class="programcharacter">HTTP_ERROR</code><p class="listcontinue1">The server has responded with an HTTP status code that is not equal to <code class="programcharacter">200</code>. The HTTP status code and its description are provided as well.</p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179887"><p><a name=179887 style="display: none;">[Topic 179887]</a></p>
	<h3 id="t234377" class="heading3">HTTP client connection error messages</h3>
<p class="bodytext">When a connection error occurs, the HTTP client prints an error message to the console.</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">Invalid response</code> <p class="listcontinue1">The connection was broken when the client was waiting for a response from the server. The client exits after this error.</p>
</li><li class="listbullet1"><code class="programcharacter">Invalid response</code> followed by <code class="programcharacter">CONNECTION_CLOSED</code><p class="listcontinue1">The connection was broken when the client was transmitting a file to scan to the server.</p>
</li><li class="listbullet1"><code class="programcharacter">Invalid response</code> followed by <code class="programcharacter">CLIENT_TIMEOUT</code><p class="listcontinue1">Client timeout (defined by the <code class="programcharacter">-t</code> option) was exceeded.</p>
</li><li class="listbullet1"><code class="programcharacter">HTTP_ERROR 408 Request Timeout</code><p class="listcontinue1">The processing timeout (defined by the <code class="programcharacter">SessionTimeout</code> parameter) was exceeded.</p>
</li></ul><p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179881"><p><a name=179881 style="display: none;">[Topic 179881]</a></p>
	<h2 id="t234575" class="heading2">Using a proxy server</h2>
<p class="bodytext">Kaspersky Scan Engine can use a proxy server to connect to Kaspersky cloud services.</p>
<p class="bodytext">If a proxy server is specified in the HTTP mode configuration file, Kaspersky Scan Engine does the following:</p>
<ol class="listnumber1"><li class="listnumber1">Kaspersky Scan Engine tries to establish a direct connection to the destination.<p class="attentioncontinue1">Note that this happens even if a proxy server is specified.</p>
</li><li class="listnumber1">If a direct connection cannot be established, Kaspersky Scan Engine tries to establish a connection by using the specified proxy server.</li><li class="listnumber1">If a proxy server connection cannot be established, Kaspersky Scan Engine uses offline technologies only.<p class="attentioncontinue1">Note that this also happens when network problems prevent a proxy server connection from being established. In this case, at regular intervals Kaspersky Scan Engine tries to establish a connection to the proxy server. If a connection is established before a certain timeout, Kaspersky Scan Engine uses online technologies.</p>
<p class="spacer"></p>
</li></ol><p class="attentionbody">You must restart Kaspersky Scan Engine to use the new proxy server settings.</p>
<p class="bodytext">Kaspersky Scan Engine does not print information about using online and offline technologies to the command line. You must analyze log files to get this information.</p>
<p class="bodytext">See also the information about <a id="h180102" class="englishcrossreferencetemplate" href="#179684" target="_self">enabling logging</a> and <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">specifying a proxy server</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179882"><p><a name=179882 style="display: none;">[Topic 179882]</a></p>
	<h2 id="t234555" class="heading2">Updating the anti-virus database in HTTP mode</h2>
<p class="bodytext">With default configuration, Kaspersky Scan Engine uses the anti-virus database from the <code class="programcharacter">./bin/bases</code> directory. You can update the anti-virus database by sending a signal or an HTTP request to Kaspersky Scan Engine.</p>
<p class="warningbody">When the anti-virus database is updated, the encrypted user agent string of Kaspersky Scan Engine is transferred to Kaspersky. See also the full list of data that is <a id="h180101" class="englishcrossreferencetemplate" href="#180001" target="_self">transferred to Kaspersky during an update</a>.</p>
<p class="introheading">Updating the database on demand</p>
<p class="bodytext">If you want to update the database manually, use updating on demand.</p>
<p class="procedureheading">To update the database on demand in Linux by using signals:</p>
<ol class="listnumber1"><li class="listnumber1">Before starting the <code class="programcharacter">kavhttpd</code> service, specify the update setting in kavhttpd.xml.</li><li class="listnumber1">Start the <code class="programcharacter">kavhttpd</code> service.</li><li class="listnumber1">Send a <code class="programcharacter">SIGUSR2</code> signal to the <code class="programcharacter">kavhttpd</code> service.<p class="listcontinue1">If the client and Kaspersky Scan Engine are installed and running on the same computer, you can send an HTTP request to the <code class="programcharacter">/api/v3.0/update/start</code> address to update the database. Note that if you send this request from a different computer, Kaspersky Scan Engine will throw a <code class="programcharacter">405 Method Not Allowed</code> error. If the database update has been successfully initiated, the HTTP response will contain the following JSON object:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">{</p>
<p class="program2">&quot;status&quot;: &quot;update started&quot;</p>
<p class="program">} </p>
</td>
</tr>

</table>
<p class="listcontinue1">To learn how to track the database update status, see subsection &quot;Getting the database update status&quot; below.</p>
</li></ol><p class="procedureheading">To update the database on demand in Linux by using the sample HTTP client,</p>
<p class="bodytextindent">Call the sample HTTP client with the -d option:</p>
<p class="bodytextindent"><code class="programcharacter">kavhttp_client -j -d</code></p>
<p class="procedureheading">To update the database on demand in Windows,</p>
<p class="bodytextindent">Call the sample HTTP client with the <code class="programcharacter">-d</code> option:</p>
<p class="bodytextindent"><code class="programcharacter">kavhttp_client.exe -j -d</code></p>
<p class="bodytext">See also the detailed information on <a id="h180054" class="englishcrossreferencetemplate" href="#179873" target="_self">scheduling automatic database updates</a>.</p>
<p class="introheading">Getting the database update status</p>
<p class="bodytext">If you want to obtain the database update status, send a GET request to the <code class="programcharacter">/api/v3.0/update/status</code> address or the <code class="programcharacter">/api/v3.1/update/status</code> address.</p>
<p class="attentionbody">You can only send this request if the client and Kaspersky Scan Engine are installed and running on the same computer.</p>
<p class="bodytext">When Kaspersky Scan Engine receives the request, it returns a response in the following format:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">{</p>
<p class="program2">&quot;status&quot;: &quot;%UPDATE_STATUS%&quot;,</p>
<p class="program2">&quot;progress&quot;: &quot;%UPDATE_PROGRESS%&quot;,</p>
<p class="program2">&quot;last_update_result&quot;: &quot;%UPDATE_RESULT%&quot;,</p>
<p class="program2">&quot;last_update_time&quot;: &quot;%UPDATE_TIME%&quot;,</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">where:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">status</code> is the current status of the database update. It can have one of the following values:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">&quot;in progress&quot;</code></li><li class="listbullet2"><code class="programcharacter">&quot;not started&quot;</code></li></ul></li><li class="listbullet1"><code class="programcharacter">progress</code> is the progress, in percent, of the database update.<p class="listcontinue1">This element is only included in the response if the database update is being performed at present (that is if the <code class="programcharacter">status</code> element has the value of <code class="programcharacter">&quot;in progress&quot;</code>).</p>
</li><li class="listbullet1"><code class="programcharacter">last_update_result</code> is the result of the last database update. It can have one of the following values:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">&quot;success&quot;</code></li><li class="listbullet2"><code class="programcharacter">&quot;all components are up to date&quot;</code></li><li class="listbullet2"><code class="programcharacter">&quot;invalid update sources&quot;</code></li><li class="listbullet2"><code class="programcharacter">&quot;not all components are updated&quot;</code></li><li class="listbullet2"><code class="programcharacter">&quot;download error&quot;</code></li><li class="listbullet2"><code class="programcharacter">&quot;error while updating&quot;</code></li><li class="listbullet2"><code class="programcharacter">&quot;error %ERROR_CODE% occurred&quot;</code>, where <code class="programcharacter">%ERROR_CODE%</code> is the error code received from Kaspersky Scan Engine</li></ul><p class="listcontinue1">This element is only included in the response if the database update is not in progress at present (that is if the <code class="programcharacter">status</code> element has the value of <code class="programcharacter">&quot;not started&quot;</code>).</p>
</li><li class="listbullet1"><code class="programcharacter">last_update_time</code> is the date and the time of the last database update in the following format: <code class="programcharacter">%hh%:%mm%:%ss% %DD%.%MM%.%YYYY%</code>.<p class="listcontinue1">This element is only included in the response if the database update is not in progress at present (that is if the <code class="programcharacter">status</code> element has the value of <code class="programcharacter">&quot;not started&quot;</code>).</p>
</li></ul><p class="introheading">Additional fields in KAV protocol version 3.1</p>
<p class="bodytext">If you send a GET request to the <code class="programcharacter">/api/v3.1/update/status</code> address, you can get more information about the database update process. Some database updates can be used only after a reboot of the operating system or a restart of KAV SDK. In this case a response of KAV HTTPD has the extended format:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">{</p>
<p class="program2">&quot;status&quot;: &quot;%UPDATE_STATUS%&quot;,</p>
<p class="program2">&quot;progress&quot;: &quot;%UPDATE_PROGRESS%&quot;,</p>
<p class="program2">&quot;last_update_result&quot;: &quot;%UPDATE_RESULT%&quot;,</p>
<p class="program2">&quot;last_update_time&quot;: &quot;%UPDATE_TIME%&quot;,</p>
<p class="program2">&quot;action_needed&quot;: &quot;%ACTION_NEEDED%&quot;,</p>
<p class="program2">&quot;action_apply_period&quot;: &quot;%APPLY_PERIOD%&quot;</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">Here:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">%ACTION_NEEDED%</code> is the action to perform before you can apply the updates. It can have one of the following values:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">Product restart needed</code><p class="listcontinue2">This means that you must restart KAV HTTPD.</p>
</li><li class="listbullet2"><code class="programcharacter">OS reboot needed</code><p class="listcontinue2">This means that you must reboot the operating system on which KAV HTTPD runs.</p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">%APPLY_PERIOD%</code> is the recommended period (in hours) to perform the action specified in <code class="programcharacter">%ACTION_NEEDED%</code>.<p class="listcontinue1">This action is not performed automatically, you must perform it yourself.</p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="186768"><p><a name=186768 style="display: none;">[Topic 186768]</a></p>
	<h2 id="t234433" class="heading2">Logging in HTTP mode</h2>
<p class="bodytext">This section explains how to work with logs in HTTP mode.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#179879" target="_self">Configuring logging in HTTP mode</a></p><p class="relateditem"><a href="#186767" target="_self">Format of CEF logs in HTTP mode</a></p><p class="relateditem"><a href="#186769" target="_self">Format of RAW logs in HTTP mode</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179879"><p><a name=179879 style="display: none;">[Topic 179879]</a></p>
	<h3 id="t234305" class="heading3">Configuring logging in HTTP mode</h3>
<p class="bodytext">This section explains how to manually configure logging in HTTP mode without using Kaspersky Scan Engine GUI.</p>
<p class="bodytext">See also detailed instructions on <a id="h180103" class="englishcrossreferencetemplate" href="#179928" target="_self">enabling logging</a>.</p>
<p class="introheading">Configuring logging</p>
<p class="bodytext">To configure logging, change the parameters in the httpdkavlog.ini logging configuration file (hereinafter referred to as the logging configuration file) located in the <code class="programcharacter">%service_dir%/bin</code> directory. The configuration file consists of several sections.</p>
<p class="introheading">DebugLogging section</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">LogLevel</code>&#8212;Specifies the logging level.<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">0</code><p class="listcontinue2">Disables logging. This is the default value.</p>
</li><li class="listbullet2"><code class="programcharacter">1</code><p class="listcontinue2">Enables full logging mode. Use this mode for debugging purposes.</p>
<p class="warningcontinue2">If you enable full logging mode, consider that the log messages will contain <a id="h206306" class="englishcrossreferencetemplate" href="#179925" target="_self">sensitive data</a>.</p>
<p class="attentioncontinue2">In HTTP mode, Kaspersky Scan Engine does not automatically remove log files from previous initializations. If necessary, you can remove these log files manually.</p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">LogFolder</code>&#8212;Specifies the path to a directory where log files are stored. <p class="listcontinue1">The path can be absolute or relative. A relative path is calculated relative to the directory that contains the <code class="programcharacter">kavhttpd</code> binary file.</p>
</li></ul><p class="introheading">SyslogLogging section</p>
<p class="bodytext">The settings below are available only for Linux operating systems.</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">SyslogEnabled</code>&#8212;Specifies whether the Kaspersky Scan Engine sends syslog messages.<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">0</code><p class="listcontinue2">Disables sending of syslog messages. </p>
</li><li class="listbullet2"><code class="programcharacter">1</code><p class="listcontinue2">Enables sending of syslog messages.</p>
<p class="warningcontinue2">If you enable sending syslog messages, consider that these messages will contain sensitive data, such as personal data as defined by GDPR, configuration data of the product, and licensing information.</p>
</li></ul></li></ul><p class="introheading">SyslogDestination section </p>
<p class="bodytext">This element contains a group of settings that specify the format of the logs. If it is necessary to write logs into different locations, you can specify several <code class="programcharacter">SyslogDestination</code> elements. In this case, the values of the <code class="programcharacter">SyslogTarget</code> subelements must vary.</p>
<p class="attentionbody">If <code class="programcharacter">SyslogEnabled</code> (see above) has the value of <code class="programcharacter">1</code>, you must include at least one <code class="programcharacter">SyslogDestination</code> element.</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">SyslogFormat</code>&#8212;Specifies the format of syslog messages. <p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">cef</code>&#8212;Specifies the <code class="programcharacter">cef</code> format of syslog messages.</li><li class="listbullet2"><code class="programcharacter">raw</code>&#8212;Specifies the <code class="programcharacter">raw</code> format of syslog messages. The <code class="programcharacter">raw</code> value is used when the value specified in this element is not <code class="programcharacter">cef</code> or <code class="programcharacter">raw</code>, or no value is specified in this element, or if the logging configuration file does not contain the <code class="programcharacter">SyslogFormat</code> parameter.</li></ul></li><li class="listbullet1"><code class="programcharacter">SyslogTarget</code>&#8212;Specifies the destination address for syslog messages. <p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">%PROTOCOL%%IP%:%PORT%</code>, where:<ul class="listbullet3"><li class="listbullet3"><code class="programcharacter">%PROTOCOL%</code> is a network protocol (use <code class="programcharacter">tcp://</code> or <code class="programcharacter">udp://</code> for this value). </li><li class="listbullet3"><code class="programcharacter">%IP%</code> is an IPv4 address that receives syslog messages. </li><li class="listbullet3"><code class="programcharacter">%PORT%</code> is a port that receives syslog messages.</li></ul><p class="listcontinue2">If you do not specify a protocol as described above, Kaspersky Scan Engine will use the UDP protocol.</p>
</li><li class="listbullet2"><code class="programcharacter">localhost</code>&#8212;Indicates that syslog messages are redirected to <code class="programcharacter">syslogd</code>.</li><li class="listbullet2">Path to a directory where log files with syslog messages are stored. The path must begin with <code class="programcharacter">/var/log/kaspersky</code>.<p class="listcontinue2">The directory contains the <code class="programcharacter">httpd_kav_syslog.log</code> file. Log files with syslog messages created by previous sessions are not removed. If the directory contains an old file, Kaspersky Scan Engine writes new information to this file without deleting the old data. </p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">SyslogEvents</code>&#8212;Specifies events to be logged. <p class="listcontinue1">It is allowed to specify multiple <code class="programcharacter">SyslogEvents</code> values. Each of these values sets the type of event that will be logged into the location specified in the <code class="programcharacter">SyslogTarget</code> attribute. If you specify several values for one destination, separate them with the semicolon symbol (<code class="programcharacter">;</code>).</p>
<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">Audit</code>&#8212;Specifies system audit events.</li><li class="listbullet2"><code class="programcharacter">Init</code>&#8212;Specifies service initialization events. </li><li class="listbullet2"><code class="programcharacter">Deinit</code>&#8212;Specifies service deinitialization events and watchdog events. </li><li class="listbullet2"><code class="programcharacter">Update</code>&#8212;Specifies antivirus database update and reload events.</li><li class="listbullet2"><code class="programcharacter">License</code>&#8212;Specifies license-related events.</li><li class="listbullet2"><code class="programcharacter">Engine</code>&#8212;Specifies antivirus engine events.  These events may be published frequently.</li><li class="listbullet2"><code class="programcharacter">ScanResultClean</code>&#8212;Specifies scan completion events when scanned object considered clean.</li><li class="listbullet2"><code class="programcharacter">ScanResultDetect</code>&#8212;Specifies scan completion events when threat was detected.</li><li class="listbullet2"><code class="programcharacter">ScanResultOther</code>&#8212;Specifies scan completion events when object was not scanned.</li></ul><p class="listcontinue1">If the <code class="programcharacter">SyslogDestination</code> element does not contain the <code class="programcharacter">SyslogEvents</code> child element, all the HTTP events are logged. </p>
<p class="listcontinue1">If the <code class="programcharacter">SyslogDestination</code> settings are incorrect, logging to the specified destination will be disabled.</p>
<p class="listcontinue1">When syslog logging is enabled, system audit is enabled as well. If none of the <code class="programcharacter">SyslogEvents</code> elements contains the <code class="programcharacter">Audit</code> event, system audit settings are set as follows:  <code class="programcharacter">SyslogFormat</code> is set to <code class="programcharacter">raw</code>, <code class="programcharacter">SyslogTarget</code> is set to <code class="programcharacter">localhost</code>, and <code class="programcharacter">SyslogEvents</code> is set to <code class="programcharacter">audit</code>.</p>
</li></ul><p class="attentionbody">Kaspersky Scan Engine can write debug logs and send syslog messages at the same time or separately.</p>
<p class="introheading">Structure of the logging configuration file</p>
<p class="bodytext">Following is an example of a logging configuration file:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">[DebugLogging]</p>
<p class="program">LogLevel=0</p>
<p class="program">LogFolder=logs</p>
<p class="program">[SyslogLogging]</p>
<p class="program">SyslogEnabled=0</p>
<p class="program">[SyslogDestination]</p>
<p class="program">SyslogFormat=raw</p>
<p class="program">SyslogTarget=localhost</p>
<p class="program">SyslogEvents=audit;init;deinit;update;license;engine</p>
<p class="program">[SyslogDestination]</p>
<p class="program">SyslogFormat=cef</p>
<p class="program">SyslogTarget=/var/log/kaspersky/kse_udp_lic_events</p>
<p class="program">SyslogEvents=license;update</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="186767"><p><a name=186767 style="display: none;">[Topic 186767]</a></p>
	<h3 id="t234361" class="heading3">Format of CEF logs in HTTP mode</h3>
<p class="bodytext">If Kaspersky Scan Engine is configured to write syslog messages in CEF format, the log records about events appears as follows:</p>
<p class="program">CEF:0|Kaspersky|Scan Engine HTTP Service|%VERSION%|%EVENT_CLASS_ID%|%EVENT_NAME%|%SEVERITY%| msg=%EVENT_MSG% src=%CLIENT_IP% dvcpid=%HTTP_SERVICE_PID% sproc=unix_socket dvc=%HTTP_SERVICE_IP% dvchost=%HOSTNAME% start=%EVENT_TIME% fileHash=%SCANNED_FILE_MD5_HASH% fname=%SCANNED_FILE_NAME% request=%SCANNED_URL% act=%ACTION_MADE% cs1=%SCAN_RESULT% cs1Label=Scan result cs2=%VIRUS_NAME% cs2Label=Virus name flexString1=%SDK_VERSION% flexString1Label=Anti-Virus Engine version</p>
<p class="bodytext">A record has the following fields:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">%VERSION%</code><p class="listcontinue1">Version of Kaspersky Scan Engine.</p>
</li><li class="listbullet1"><code class="programcharacter">%EVENT_CLASS_ID%</code><p class="listcontinue1">Class of the event. Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">1</code><p class="listcontinue2">Service event (not related to scanning).</p>
</li><li class="listbullet2"><code class="programcharacter">2</code><p class="listcontinue2">Event related to errors.</p>
</li><li class="listbullet2"><code class="programcharacter">3</code><p class="listcontinue2">Event related to scanning (for example, a scan result).</p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">%EVENT_NAME%</code><p class="listcontinue1">Name of the event. Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">Initializing</code>&#8212;Kaspersky Scan Engine initialized.</li><li class="listbullet2"><code class="programcharacter">Deinitializing</code>&#8212;Kaspersky Scan Engine deinitialized.</li><li class="listbullet2"><code class="programcharacter">Service event</code>&#8212;Service event occurred.</li><li class="listbullet2"><code class="programcharacter">Service error</code>&#8212;Error occurred in the kavhttpd service.</li><li class="listbullet2"><code class="programcharacter">Core error</code>&#8212;Error occurred in Kaspersky Anti-Virus Engine.</li><li class="listbullet2"><code class="programcharacter">Scan result</code>&#8212;Kaspersky Scan Engine finished scanning an object.</li><li class="listbullet2"><code class="programcharacter">Audit</code>&#8212;<a id="h221151" class="englishcrossreferencetemplate" href="#221141" target="_self">System audit</a> event occurred.</li></ul></li><li class="listbullet1"><code class="programcharacter">%SEVERITY%</code><p class="listcontinue1">Importance level of the event. The higher the level, the more important the event. Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">3</code><p class="listcontinue2">This value is specified for system audit events, informational level.</p>
</li><li class="listbullet2"><code class="programcharacter">5</code><p class="listcontinue2">This value is specified for service events, when the scanning starts, or if the scan result is <code class="programcharacter">CLEAN</code>.</p>
</li><li class="listbullet2"><code class="programcharacter">6</code><p class="listcontinue2">This value is specified for system audit events, warning level.</p>
</li><li class="listbullet2"><code class="programcharacter">7</code><p class="listcontinue2">This value is specified for initialization, deinitialization, and errors.</p>
</li><li class="listbullet2"><code class="programcharacter">8</code><p class="listcontinue2">This value is specified for system audit events (critical level) and if the scan result is something other than <code class="programcharacter">CLEAN</code>. These events are considered dangerous.</p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">%EVENT_MSG%</code><p class="listcontinue1">Description of the event. For example, the text of an error message.</p>
</li><li class="listbullet1"><code class="programcharacter">%CLIENT_IP%</code><p class="listcontinue1">IP address of the HTTP client that sent the scan request to Kaspersky Scan Engine. This field appears only if the request is sent over a TCP socket and is related to scanning.</p>
</li><li class="listbullet1"><code class="programcharacter">%HTTP_SERVICE_PID%</code><p class="listcontinue1">PID of Kaspersky Scan Engine.</p>
</li><li class="listbullet1"><code class="programcharacter">%HTTP_SERVICE_IP%</code><p class="listcontinue1">IP address that Kaspersky Scan Engine uses to receive scan requests from clients. This field appears only if Kaspersky Scan Engine receives scan requests over a TCP socket.</p>
</li><li class="listbullet1"><code class="programcharacter">%HOSTNAME%</code><p class="listcontinue1">Host name of the computer on which Kaspersky Scan Engine is working. This field appears only if syslog logging in CEF format is enabled.</p>
</li><li class="listbullet1"><code class="programcharacter">%EVENT_TIME%</code><p class="listcontinue1">Time and date of the event. The time and date are taken from the computer that Kaspersky Scan Engine runs on.</p>
</li><li class="listbullet1"><code class="programcharacter">sproc=unix_socket</code><p class="listcontinue1">This field appears only if Kaspersky Scan Engine receives scan requests over a UNIX socket.</p>
</li><li class="listbullet1"><code class="programcharacter">%SCANNED_FILE_MD5_HASH%</code><p class="listcontinue1">Hash of the object that was passed for scanning to Kaspersky Scan Engine. This field appears only if a client sent a scan request and Kaspersky Scan Engine has finished scanning.</p>
</li><li class="listbullet1"><code class="programcharacter">%SCANNED_FILE_NAME%</code><p class="listcontinue1">Name of the scanned file. If the client sent a request to scan a part of RAM, the value of this field is <code class="programcharacter">MEMORY_BLOCK</code>. This field appears only if a client sent a scan request and Kaspersky Scan Engine has finished scanning.</p>
</li><li class="listbullet1"><code class="programcharacter">%SCANNED_URL%</code><p class="listcontinue1">URL specified in the <code class="programcharacter">X-KAV-ObjectURL</code> header of the scan request. This field appears only if a client sent a scan request and Kaspersky Scan Engine has finished scanning.</p>
</li><li class="listbullet1"><code class="programcharacter">%ACTION_MADE%</code><p class="listcontinue1">Action that was performed on the detected threat or a legitimate software that can be used by intruders. This field appears only in events that contain scan results.</p>
</li><li class="listbullet1"><code class="programcharacter">%SCAN_RESULT%</code> <p class="listcontinue1">Scan result. This field appears only in events that contain scan results.</p>
</li><li class="listbullet1"><code class="programcharacter">cs1Label=Scan result</code><p class="listcontinue1">This field appears only in events that contain scan results.</p>
</li><li class="listbullet1"><code class="programcharacter">%VIRUS_NAME%</code><p class="listcontinue1">Name of the detected threat or legitimate software that can be used by intruders. This field appears only if a threat or legitimate software that can be used by intruders was detected.</p>
</li><li class="listbullet1"><code class="programcharacter">cs2Label=Virus name</code><p class="listcontinue1">This field appears only if a threat or legitimate software that can be used by intruders was detected.</p>
</li><li class="listbullet1"><code class="programcharacter">%SDK_VERSION%</code><p class="listcontinue1">Version of KAV SDK that Kaspersky Scan Engine is based on.</p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="186769"><p><a name=186769 style="display: none;">[Topic 186769]</a></p>
	<h3 id="t234363" class="heading3">Format of RAW logs in HTTP mode</h3>
<p class="bodytext">If Kaspersky Scan Engine is configured to write syslog messages in RAW format, the log records about events appear as follows:</p>
<p class="program">&lt;%PRIORITY%&gt;1 %TIMESTAMP% %HTTP_SERVICE_IP% KasperskyHTTPService %HTTP_SERVICE_PID% %MESSAGE_ID% - BOM %MESSAGE%\n</p>
<p class="bodytext">A record has the following fields:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">%PRIORITY%</code><p class="listcontinue1">Severity level of the event. Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">163</code><p class="listcontinue2">This value is specified for errors.</p>
</li><li class="listbullet2"><code class="programcharacter">165</code><p class="listcontinue2">This value is specified if the scan result is something other than <code class="programcharacter">CLEAN</code>.</p>
</li><li class="listbullet2"><code class="programcharacter">166</code><p class="listcontinue2">This value is specified for service events or if the scan result is <code class="programcharacter">CLEAN</code>.</p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">%TIMESTAMP%</code><p class="listcontinue1">Date and time of the event in the Coordinated Universal Time (UTC) time zone.</p>
</li><li class="listbullet1"><code class="programcharacter">%HTTP_SERVICE_IP%</code><p class="listcontinue1">IP address that Kaspersky Scan Engine uses to receive scan requests from clients. If Kaspersky Scan Engine receives scan requests over a UNIX socket, the field contains the host name of the computer that Kaspersky Scan Engine runs on.</p>
</li><li class="listbullet1"><code class="programcharacter">%HTTP_SERVICE_PID%</code><p class="listcontinue1">PID of Kaspersky Scan Engine.</p>
</li><li class="listbullet1"><code class="programcharacter">%MESSAGE_ID%</code><p class="listcontinue1">Class of the event. Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">AUDIT_MESSAGE</code><p class="listcontinue2">Audit event.</p>
</li><li class="listbullet2"><code class="programcharacter">SERVICE_MESSAGE</code><p class="listcontinue2">Service event.</p>
</li><li class="listbullet2"><code class="programcharacter">ERROR_MESSAGE</code><p class="listcontinue2">Error.</p>
</li><li class="listbullet2"><code class="programcharacter">SCAN_RESULT_CLEAN_MESSAGE</code><p class="listcontinue2">Scanned object is considered clean.</p>
</li><li class="listbullet2"><code class="programcharacter">SCAN_RESULT_DETECT_MESSAGE</code><p class="listcontinue2">Threat was detected.</p>
</li><li class="listbullet2"><code class="programcharacter">SCAN_RESULT_OTHER_MESSAGE</code><p class="listcontinue2">Object was not scanned.</p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">%MESSAGE%</code><p class="listcontinue1">Description of the event. For example, the text of an error message.</p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179888"><p><a name=179888 style="display: none;">[Topic 179888]</a></p>
	<h2 id="t234288" class="heading2">Building executable files for the HTTP service and the HTTP client</h2>
<p class="bodytext">You can compile the kavehttpd service and the sample HTTP client from the source code located in the <code class="programcharacter">%service_dir%/samples/kavhttp/</code> directory. </p>
<p class="introheading">Software requirements</p>
<p class="bodytext">To compile kavehttpd service and the sample HTTP client, you must install the following software on you computer:</p>
<ul class="listbullet1"><li class="listbullet1">Boost 1.72.0 or later. The kavehttpd service source files are liked with Boost dynamically, which requires the boost-devel package.<p class="listcontinue1">The boost libraries must be compiled statically. You can find a list of the necessary boost libraries in <code class="programcharacter">%service_dir%/samples/kavhttp/Makefile</code>.</p>
</li><li class="listbullet1">OpenSSL library. It is recommended to install the openssl-devel package.</li><li class="listbullet1">PostgreSQL libraries from 6.4.4 to 7 (non-inclusive). It is recommended to install the libpqxx-devel package.</li><li class="listbullet1">GNU Compiler Collection (GCC) 7.3.0 or later. Use the same version of GCC to compile Boost and the kavhttpd service.</li></ul><p class="introheading">Compiling Kaspersky Scan Engine and the sample HTTP client in Linux</p>
<p class="procedureheading">To compile Kaspersky Scan Engine and the sample HTTP client in Linux:</p>
<ol class="listnumber1"><li class="listnumber1">Navigate to the <code class="programcharacter">%service_dir%/samples/kavhttp/</code> directory.</li><li class="listnumber1">Run <code class="programcharacter">make</code>.<p class="listcontinue1">The compiled client executable files will be placed in the <code class="programcharacter">%service_dir%/bin</code> directory. The compiled service executable files will be placed in the <code class="programcharacter">%service_dir%/opt/kaspersky/ScanEngine/sdk8l3/bin/</code> directory.</p>
</li></ol><p class="bodytext">The following example demonstrates building the executable files:</p>
<table class="tableintopic" width="636" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="636"><p class="program">user@computer:/opt/kaspersky/ScanEngine# cd ./samples/kavhttp/</p>
<p class="program">user@computer:/opt/kaspersky/ScanEngine/samples/kavhttp/# make</p>
</td>
</tr>

</table>
<p class="introheading">Kaspersky Scan Engine and the sample HTTP client in Windows</p>
<p class="procedureheading">To compile Kaspersky Scan Engine and the sample HTTP client in Windows:</p>
<ol class="listnumber1"><li class="listnumber1">Navigate to the <code class="programcharacter">%service_dir%/samples/kavhttp/http_service/windows</code> folder.</li><li class="listnumber1">Do the following:<ul class="listbullet2"><li class="listbullet2">If you want to compile the kavehttpd service, open the <code class="programcharacter">kavhttpd.vcxproj</code> file in Microsoft Visual Studio 2017 and later.</li><li class="listbullet2">If you want to compile the sample HTTP client, open the <code class="programcharacter">kavhttp_client.vcxproj</code> file in Microsoft Visual Studio 2017 and later.</li></ul></li><li class="listnumber1">Right-click the project in Solution Explorer and select <span class="boldcharacter">Properties</span>.</li><li class="listnumber1">In the properties window that opens, in the left navigation tree, select <span class="boldcharacter">Configuration Properties</span> &gt; <span class="boldcharacter">Linker</span> &gt; <span class="boldcharacter">Input</span>. For the <span class="boldcharacter">Additional Dependencies</span> property, add the paths to the Boost, OpenSSL, and PostgreSQL libraries.</li><li class="listnumber1">In the left navigation tree, select <span class="boldcharacter">Configuration Properties</span> &gt; <span class="boldcharacter">/C++</span>. For the <span class="boldcharacter">Additional Include Directories</span> property, add the headers of the Boost, OpenSSL, and PostgreSQL libraries.</li><li class="listnumber1">Right-click the project in Solution Explorer, and then select <span class="boldcharacter">Build</span>.</li></ol><p class="warningbody">If you use Kaspersky Scan Engine GUI and intend to modify the provided binaries, please make sure to get prior approval for all changes from your technical account manager (TAM).</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="184798"><p><a name=184798 style="display: none;">[Topic 184798]</a></p>
	<h1 id="t234578" class="heading1">Using Kaspersky Scan Engine in ICAP mode</h1>
<p class="bodytext">This chapter contains information about using Kaspersky Scan Engine in ICAP mode.</p>
<p class="attentionbody">The ICAP mode is available only for Linux operating systems.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#192987" target="_self">Kaspersky Scan Engine and ICAP mode</a></p><p class="relateditem"><a href="#206407" target="_self">Recommendations on secure integration</a></p><p class="relateditem"><a href="#225528" target="_self">Recommended settings for ICAP mode</a></p><p class="relateditem"><a href="#192988" target="_self">Configuring Kaspersky Scan Engine in ICAP mode</a></p><p class="relateditem"><a href="#192990" target="_self">Running Kaspersky Scan Engine in ICAP mode</a></p><p class="relateditem"><a href="#221159" target="_self">Response headers</a></p><p class="relateditem"><a href="#179902" target="_self">Updating the anti-virus database in ICAP mode</a></p><p class="relateditem"><a href="#182615" target="_self">Getting accumulated statistics in ICAP mode</a></p><p class="relateditem"><a href="#186630" target="_self">Logging in ICAP mode</a></p><p class="relateditem"><a href="#219958" target="_self">Integrating Kaspersky Scan Engine with other solutions</a></p><p class="relateditem"><a href="#179905" target="_self">Building executable files for Kaspersky Scan Engine used in ICAP mode</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192987"><p><a name=192987 style="display: none;">[Topic 192987]</a></p>
	<h2 id="t234405" class="heading2">Kaspersky Scan Engine and ICAP mode</h2>
<p class="bodytext">Internet Content Adaptation Protocol (ICAP) is the standard for communication between proxy servers and service providers. In ICAP mode, Kaspersky Scan Engine works with ICAP-compliant proxy servers. Kaspersky Scan Engine scans HTTP traffic that passes through a proxy server, and URLs requested by users.</p>
<p class="bodytext">In ICAP mode, Kaspersky Scan Engine consists of the kavicapd service, configuration files, and libraries, and has the following features:</p>
<ul class="listbullet1"><li class="listbullet1">URL scan<p class="listcontinue1">Kaspersky Scan Engine allows you to scan URLs that users request from a proxy server. This function is available in both the request modification (REQMOD) mode and response modification (RESPMOD) mode of ICAP.</p>
</li><li class="listbullet1">HTTP traffic scan<p class="listcontinue1">Kaspersky Scan Engine allows you to scan incoming and outgoing HTTP traffic that passes through a proxy server. This function is available in both the request modification (REQMOD) mode and response modification (RESPMOD) mode of ICAP. </p>
<p class="listcontinue1">Scanning of multipart objects is supported.</p>
</li><li class="listbullet1">Support for the <code class="programcharacter">204 No</code> <code class="programcharacter">Content</code> HTTP status code<p class="listcontinue1">The kavicapd service can be configured to reply with this status code if the message sent by a client does not require modification.</p>
</li><li class="listbullet1">Configuring the kavicapd service behavior with <a id="h180152" class="englishcrossreferencetemplate" href="#179893" target="_self">service rules</a></li><li class="listbullet1">Partial mode<p class="listcontinue1">In this mode, also known as <em class="emphasischaracter">Data Trickling</em>, the ICAP plug-in scans files as a whole, and then divides them into batches, and sends the batched files to the user. The plug-in continues to scan files at the same time that it is sending the first batches of files to the user. This function allows users to receive large scanned files quickly.</p>
</li><li class="listbullet1">Preview mode<p class="listcontinue1">In this mode, the ICAP client sends preview requests to the ICAP plug-in. The preview requests allow you to skip objects that the plug-in does not consider malicious.</p>
</li><li class="listbullet1">ISTag updates<p class="listcontinue1">The ISTag value in the Kaspersky Scan Engine ICAP response header is updated every time after one of these events happens:</p>
<ul class="listbullet2"><li class="listbullet2">Kaspersky Scan Engine is initialized.</li><li class="listbullet2">Kaspersky Scan Engine settings are changed.</li><li class="listbullet2">The anti-virus database is updated.</li></ul></li></ul><p class="introheading">Keep-Alive connections</p>
<p class="bodytext">By default, Kaspersky Scan Engine supports <a id="h207296" class="englishcrossreferencetemplate" href="#207291" target="_self">Keep-Alive connections</a>, so it can process multiple objects one after another, by using the same connection.</p>
<p class="bodytext">To open a Keep-Alive connection, an ICAP request has to contain the <code class="programcharacter">Connection</code> field with the <code class="programcharacter">Keep-Alive</code> value.</p>
<p class="bodytext">To close the connection, an ICAP  request has to contain the <code class="programcharacter">Connection</code> field with the <code class="programcharacter">close</code> value.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="206407"><p><a name=206407 style="display: none;">[Topic 206407]</a></p>
	<h2 id="t234472" class="heading2">Recommendations on secure integration</h2>
<p class="bodytext">This section describes the recommended practices for secure integration of your product with Kaspersky Scan Engine. </p>
<p class="warningbody">Not following these recommendations may result in security issues.</p>
<p class="introheading">Use the shortest administrative distance</p>
<p class="bodytext">Configure your network so that the administrative distance between the kavicapd service and the proxy service is as short as possible.  </p>
<p class="introheading">  </p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="225528"><p><a name=225528 style="display: none;">[Topic 225528]</a></p>
	<h2 id="t240949" class="heading2">Recommended settings for ICAP mode</h2>
<p class="bodytext">This section describes the recommended settings for Kaspersky Scan Engine in ICAP mode.</p>
<p class="bodytext">If you use the Kaspersky Scan Engine GUI, specify the recommended parameters as described in the table below.</p>
<p class="tablename">Recommended settings for ICAP mode in the Kaspersky Scan Engine GUI</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="512" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="210"><p class="tableheading">Settings in the Kaspersky Scan Engine GUI</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="302"><p class="tableheading">Recommended settings</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Service &gt; Processes</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="bodytext">Equal to the number of processor cores</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Service &gt; Threads</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="bodytext">Twice the value of <code class="programcharacter">ScannersCount</code></p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Service &gt; Sessions</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">See the description of <code class="programcharacter">MaxIcapSessionsCount</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Service &gt; Partial mode</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">On</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Service &gt; Delay</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">10</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Service &gt; Chunk size</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">4</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Service &gt; Prevent re-downloading</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">On</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Service &gt; Maximum cache size</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">5000</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Service &gt; Lifetime for blocked URLs</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">1800</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Service &gt; Keep-alive</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">See the description of <code class="programcharacter">KeepAliveSettings</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Scanning &gt; Skip large objects</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">On</p>
<p class="tablebodytext">10343 KB (10.1 MB)</p>
<p class="attentionbody">Get an updated value from your TAM at least once a year.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Scanning &gt; Types of files to scan</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">Select the checkboxes:</p>
<ul class="tablelistbullet"><li class="tablelistbullet">Packed objects</li><li class="tablelistbullet">Archives</li><li class="tablelistbullet">Email databases</li><li class="tablelistbullet">Emails</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Scanning &gt; Heuristic analysis level</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">Low</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Scanning &gt; Object scan timeout</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">10000 (10 seconds)</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Scanning &gt; Maximum depth</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">5</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Scanning &gt; Scan scope in Request mode</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">URL (scans only the requested URLs)</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Scanning &gt; Scan scope in Response mode</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">Files</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="210"><p class="tablebodytext">Scanning &gt; Enable reputation checking</p>
</td>
<td style="border:1px solid #010101;" width="302"><p class="tablebodytext">See the description of <code class="programcharacter">UseKSN</code> below</p>
</td>
</tr>

</table>
<p class="bodytext">If you do not use the Kaspersky Scan Engine GUI, specify the recommended parameters in the kavicapd.xml configuration file as described in the table below.</p>
<p class="tablename">Recommended settings for ICAP mode in the configuration file</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="512" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="168"><p class="tableheading">Parameter in kavicapd.xml</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="344"><p class="tableheading">Recommended settings</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">ScannersCount</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="bodytext">Equal to the number of processor cores</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">ThreadsCount</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="bodytext">Twice the value of <code class="programcharacter">ScannersCount</code></p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">MaxIcapSessionsCount</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext">See the description of <code class="programcharacter">MaxIcapSessionsCount</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">QueueLen</p>
</td>
<td style="border:1px solid #010101;" width="344"><ul class="tablelistbullet"><li class="tablelistbullet">Greater than the <code class="programcharacter">ThreadsCount</code> value.</li><li class="tablelistbullet">At least twice the <code class="programcharacter">MaxIcapSessionsCount</code> value.</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">RAMUsageLimit</p>
</td>
<td style="border:1px solid #010101;" width="344"><ul class="tablelistbullet"><li class="tablelistbullet">Does not exceed the RAM size.</li><li class="tablelistbullet">Twice the maximum file size for scanning large files.</li><li class="tablelistbullet">Not less than 600 MB, which is twice the size of the anti-virus database and Kaspersky Scan Engine libraries (300 MB in total).</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">ScanMaxFileSize</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext">10343 KB (10.1 MB)</p>
<p class="attentionbody">Get an updated value from your TAM at least once a year.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">ScanningMode</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext">Specify the flags:</p>
<ul class="tablelistbullet"><li class="tablelistbullet">KAV_O_M_PACKED</li><li class="tablelistbullet">KAV_O_M_ARCHIVED</li><li class="tablelistbullet">KAV_O_M_MAILPLAIN</li><li class="tablelistbullet">KAV_O_M_MAILBASES</li><li class="tablelistbullet">KAV_O_M_HEURISTIC_LEVEL_SHALLOW</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">ScanTimeout</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext">10000 (10 seconds)</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">MaxArchivesScanningDepth</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext">5</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">ScanInReqMode</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext"><code class="programcharacter">URL</code> (scans only the requested URLs)</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">ScanInRespMode</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext"><code class="programcharacter">Content</code> (scans the HTTP message body)</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">TransferBeforeScanEnding</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">Delay</p>
<p class="tablebodytext">(Attribute of TransferBeforeScanEnding)</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext">10</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">ChunkSize</p>
<p class="tablebodytext">(Attribute of TransferBeforeScanEnding)</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext">4</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">BlockedUrlCacheEnabled</p>
<p class="tablebodytext">(Attribute of TransferBeforeScanEnding)</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext">1</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">BlockedUrlCacheKb</p>
<p class="tablebodytext">(Attribute of TransferBeforeScanEnding)</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext">5000</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">BlockedUrlCacheTtlSec</p>
<p class="tablebodytext">(Attribute of TransferBeforeScanEnding)</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext">1800</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">UseKSN</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext">See the description of <code class="programcharacter">UseKSN</code> below</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="168"><p class="tablebodytext">KeepAliveSettings</p>
</td>
<td style="border:1px solid #010101;" width="344"><p class="tablebodytext">See the description of <code class="programcharacter">KeepAliveSettings</code> below</p>
</td>
</tr>

</table>
<p class="bodytext"><a id="h200733" class="englishcrossreferencetemplate" href="#200690" target="_self">ScannersCount</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Processes</span>.</p>
<p class="bodytext">The recommended number of scanning processes is equal to the number of processor cores. For example, if Kaspersky Scan Engine is running on a computer with a 4-core processor, set <code class="programcharacter">ScannersCount</code> to <code class="programcharacter">4</code>.</p>
<p class="bodytext">See also the subsection &quot;Example of Kaspersky Scan Engine work in ICAP mode depending on the ScannersCount, ThreadsCount, QueueLen, and MaxIcapSessionsCount settings.&quot;</p>
<p class="bodytext"><a id="h201166" class="englishcrossreferencetemplate" href="#200691" target="_self">ThreadsCount</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Threads</span>.</p>
<p class="bodytext">The recommended number of scanning threads depends on the number of scanning processes specified in <code class="programcharacter">ScannersCount</code>: the value of <code class="programcharacter">ThreadsCount</code> is twice the value of <code class="programcharacter">ScannersCount</code>. For example, if Kaspersky Scan Engine is running on a computer with a 4-core processor and <code class="programcharacter">ScannersCount</code> is set to <code class="programcharacter">4</code>, set <code class="programcharacter">ThreadsCount</code> to <code class="programcharacter">8</code>.</p>
<p class="bodytext">See also the subsection &quot;Example of Kaspersky Scan Engine work in ICAP mode depending on the ScannersCount, ThreadsCount, QueueLen, and MaxIcapSessionsCount settings.&quot;</p>
<p class="bodytext"><a id="h201196" class="englishcrossreferencetemplate" href="#200717" target="_self">MaxIcapSessionsCount</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Sessions</span>.</p>
<p class="bodytext">When specifying the maximum number of simultaneous connections to Kaspersky Scan Engine, consider the following:</p>
<ul class="listbullet1"><li class="listbullet1">the maximum number of scanning threads (<code class="programcharacter">ThreadsCount</code>).</li><li class="listbullet1">the maximum length of the queue for scan tasks (<code class="programcharacter">QueueLen</code>).</li><li class="listbullet1">specifics of the ICAP mode: in general, kavicapd runs two threads for one scan task.</li></ul><p class="bodytext">This means that the greater the number of active connections, the faster all scanning threads are getting occupied and, as a result, the longer the queue is for scan tasks.</p>
<p class="listheading">The recommended <code class="programcharacter">MaxIcapSessionsCount</code> value is:</p>
<ul class="listbullet1"><li class="listbullet1">equal to the average number of ICAP client requests per minute.</li><li class="listbullet1">greater than the <code class="programcharacter">ScannersCount</code> value.</li><li class="listbullet1">greater than the <code class="programcharacter">ThreadsCount</code> value.</li><li class="listbullet1">exceeds the number of active processes used by the proxy server.</li><li class="listbullet1">exceeds the maximum number of connections from clients served by the proxy server that you use.</li></ul><p class="bodytext">See also the subsection &quot;Example of Kaspersky Scan Engine work in ICAP mode depending on the ScannersCount, ThreadsCount, QueueLen, and MaxIcapSessionsCount settings.&quot;</p>
<p class="bodytext"><a id="h201167" class="englishcrossreferencetemplate" href="#200692" target="_self">QueueLen</a></p>
<p class="bodytext">The length of the scan task queue must not be less than the number of scanning threads (<code class="programcharacter">ThreadsCount</code>). Otherwise, some scanning threads will never be in use. </p>
<p class="bodytext">Since scan tasks are enqueued from all open sessions, it is necessary to consider the <code class="programcharacter">MaxIcapSessionsCount</code> value. The scan task queue must not be less than <code class="programcharacter">MaxIcapSessionsCount</code>. Otherwise, some clients will receive a <code class="programcharacter">503 - Service overloaded</code> error when trying to open a session.</p>
<p class="bodytext">The recommended <code class="programcharacter">QueueLen</code> value is:</p>
<ul class="listbullet1"><li class="listbullet1">greater than the <code class="programcharacter">ThreadsCount</code> value.</li><li class="listbullet1">at least twice the <code class="programcharacter">MaxIcapSessionsCount</code> value.</li></ul><p class="bodytext">See also the subsection &quot;Example of Kaspersky Scan Engine work in ICAP mode depending on the ScannersCount, ThreadsCount, QueueLen, and MaxIcapSessionsCount settings.&quot;</p>
<p class="bodytext"><a id="h201197" class="englishcrossreferencetemplate" href="#201149" target="_self">RAMUsageLimit</a></p>
<p class="bodytext">If Kaspersky Scan Engine receives a lot of large objects to scan or a lot of simultaneous requests, the program can frequently stop request processing due to excessive consumption of system memory. When request processing stops, Kaspersky Scan Engine writes one of the following messages to the log file: <code class="programcharacter">Can't accept request: Not enough memory!</code> or <code class="programcharacter">Can't accept new request: Not enough memory!</code> The clients receive the <code class="programcharacter">503 - Service overloaded</code> error message.</p>
<p class="bodytext">We recommend that you limit the maximum amount of system memory to prevent its excessive consumption. When this limit is exceeded, Kaspersky Scan Engine stops scanning objects.</p>
<p class="bodytext">The recommended <code class="programcharacter">RAMUsageLimit</code> value:</p>
<ul class="listbullet1"><li class="listbullet1">does not exceed the RAM size.</li><li class="listbullet1">is twice the maximum file size for scanning large files. For example, scanning a 1 GB file requires about 2 GB of RAM.</li><li class="listbullet1">is not less than 600 MB, which is twice the size of the anti-virus database and Kaspersky Scan Engine libraries (300 MB in total). The reason for doubling is that the amount of system memory is doubled when the database is reloaded.</li></ul><p class="bodytext"><a id="h201198" class="englishcrossreferencetemplate" href="#200719" target="_self">ScanMaxFileSize</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Skip large objects</span>.</p>
<p class="bodytext">When specifying the maximum size of a file that Kaspersky Scan Engine can scan, consider the <code class="programcharacter">RAMUsageLimit</code> value: <code class="programcharacter">ScanMaxFileSize</code> must not be greater than <code class="programcharacter">RAMUsageLimit</code>. To improve Kaspersky Scan Engine performance, set <code class="programcharacter">ScanMaxFileSize</code> to 10343 KB (10.1 MB). This is the recommended value because it is sufficient to detect most malware.</p>
<p class="attentionbody">If you have followed the recommendation above, we also recommend consulting with your Technical Account Manager (TAM) once a year to get an updated recommended value, as the average malware size changes from year to year.</p>
<p class="bodytext"><a id="h201173" class="englishcrossreferencetemplate" href="#201123" target="_self">ScanningMode</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Types of files to scan</span> and <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Heuristic analysis level</span>.</p>
<p class="bodytext">The recommended value for <code class="programcharacter">ScanningMode</code> is the following:</p>
<p class="bodytext"><code class="programcharacter">KAV_O_M_PACKED | KAV_O_M_ARCHIVED | KAV_O_M_MAILPLAIN | KAV_O_M_MAILBASES | KAV_O_M_HEURISTIC_LEVEL_SHALLOW</code></p>
<p class="bodytext"><a id="h201168" class="englishcrossreferencetemplate" href="#200693" target="_self">ScanTimeout</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Object scan timeout</span>.</p>
<p class="bodytext">The recommended value for <code class="programcharacter">ScanTimeout</code> is <code class="programcharacter">10000</code> (10 seconds).</p>
<p class="bodytext"><a id="h207137" class="englishcrossreferencetemplate" href="#207146" target="_self">MaxArchivesScanningDepth</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Maximum depth</span>.</p>
<p class="bodytext">We recommend that you limit the maximum depth of nested archives to be unpacked during scanning. The recommended value for <code class="programcharacter">MaxArchivesScanningDepth</code> is <code class="programcharacter">5</code>.</p>
<p class="bodytext"><a id="h201200" class="englishcrossreferencetemplate" href="#200721" target="_self">ScanInReqMode</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Scan scope in Request mode</span>.</p>
<p class="bodytext">The recommended value for <code class="programcharacter">ScanInReqMode</code> is <code class="programcharacter">URL</code>. If this value is specified, Kaspersky Scan Engine scans only the requested URLs.</p>
<p class="bodytext"><a id="h201202" class="englishcrossreferencetemplate" href="#200722" target="_self">ScanInRespMode</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Scan scope in Response mode</span>.</p>
<p class="bodytext">The recommended value for <code class="programcharacter">ScanInRespMode</code> is <code class="programcharacter">Content</code>. If this value is specified, Kaspersky Scan Engine scans the HTTP message body.</p>
<p class="bodytext"><a id="h201209" class="englishcrossreferencetemplate" href="#201208" target="_self">TransferBeforeScanEnding</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span>, the <span class="guicharacter">Partial mode</span> block of settings.</p>
<p class="bodytext">This parameter prevents the client from interrupting the connection to the proxy server due to a timeout. This may happen when a client sends a large object to scan and could not wait for the scanned object to be received.</p>
<p class="bodytext">The recommended value for <code class="programcharacter">TransferBeforeScanEnding</code> is <code class="programcharacter">1</code> (enable). It is also recommended to use the default attributes:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">Delay</code>: <code class="programcharacter">10</code></li><li class="listbullet1"><code class="programcharacter">ChunkSize</code>: <code class="programcharacter">4</code><p class="listcontinue1">The value must be at least several times less than <code class="programcharacter">ScanMaxFileSize</code> (see above).</p>
</li><li class="listbullet1"><code class="programcharacter">BlockedUrlCacheEnabled</code>: <code class="programcharacter">1</code></li><li class="listbullet1"><code class="programcharacter">BlockedUrlCacheKb</code>: <code class="programcharacter">5000</code></li><li class="listbullet1"><code class="programcharacter">BlockedUrlCacheTtlSec</code>: <code class="programcharacter">1800</code></li></ul><p class="bodytext">See also the <a id="h201209_2" class="englishcrossreferencetemplate" href="#201208" target="_self">detailed description of these attributes</a>.</p>
<p class="bodytext"><a id="h201177" class="englishcrossreferencetemplate" href="#200698" target="_self">UseKSN</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Scanning</span> &gt; <span class="guicharacter">Enable reputation checking</span>.</p>
<p class="bodytext">We recommend enabling the use of data from KSN (Kaspersky Security Network). This provides faster responses to threats, improves the performance of some protection components, and reduces the likelihood of false positives.</p>
<p class="bodytext">To enable KSN, set <code class="programcharacter">UseKSN</code> to <code class="programcharacter">1</code>.</p>
<p class="bodytext">If KSN is enabled, it is also recommended to enable <em class="emphasischaracter">Phishing Protection</em> by using one of the following ways:</p>
<ul class="listbullet1"><li class="listbullet1">In the <a id="h201173_2" class="englishcrossreferencetemplate" href="#201123" target="_self">ScanningMode</a> element of the kavicapd.xml configuration file, add the <code class="programcharacter">KAV_O_M_PHISHING</code> flag.</li><li class="listbullet1">On the <a id="h182505" class="englishcrossreferencetemplate" href="#179699" target="_self">Settings &gt; Scanning</a> page of the Kaspersky Scan Engine GUI, turn on the <span class="guicharacter">Enable Phishing Protection</span> toggle switch.</li></ul><p class="bodytext">Phishing Protection is useful when Kaspersky Scan Engine checks URLs.</p>
<p class="bodytext"><a id="h207296" class="englishcrossreferencetemplate" href="#207291" target="_self">KeepAliveSettings</a></p>
<p class="bodytext">This parameter in the Kaspersky Scan Engine GUI: <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> &gt; <span class="guicharacter">Keep-alive</span>.</p>
<p class="bodytext">We recommend enabling Keep-Alive. When Keep-Alive is enabled, Kaspersky Scan Engine maintains a persistent connection even after the request has been processed and the session timed out. This gives the following advantages:</p>
<ul class="listbullet1"><li class="listbullet1">reduce network traffic</li><li class="listbullet1">reduce the use of server resources</li><li class="listbullet1">reduce latency in processing requests</li></ul><p class="bodytext">Keep-Alive is especially useful for HTTPS connections that require more CPU time and more client-server interactions.</p>
<p class="bodytext">To enable Keep-Alive, set the <a id="h207297" class="englishcrossreferencetemplate" href="#207292" target="_self">Enabled</a> element in <code class="programcharacter">KeepAliveSettings</code> to <code class="programcharacter">1</code>.</p>
<p class="bodytext">To determine the values for <a id="h207304" class="englishcrossreferencetemplate" href="#207298" target="_self">TimeoutMs</a> and <a id="h207305" class="englishcrossreferencetemplate" href="#207303" target="_self">MaxRequests</a>, estimate the number of clients and the number of requests from clients.</p>
<p class="bodytext">For example, you have estimated that the maximum number of clients is 50, so you set <code class="programcharacter">MaxICAPSessionsCount</code> to <code class="programcharacter">50</code>. If <code class="programcharacter">TimeoutMs</code> and <code class="programcharacter">MaxRequests</code> are unlimited, and all 50 clients send requests continuously, Kaspersky Scan Engine maintains connections with these 50 clients without limits. As a result, new connections cannot be established.</p>
<p class="bodytext">Another example. You have estimated that the maximum number of clients is 50, so you set <code class="programcharacter">MaxICAPSessionsCount</code> to <code class="programcharacter">50</code>. You have also estimated that the maximum number of requests from one client is 15, so you set <code class="programcharacter">MaxRequests</code> to <code class="programcharacter">15</code>. If you did not set the limit for <code class="programcharacter">TimeoutMs</code>, and clients do not send 15 requests, Kaspersky Scan Engine maintains connections with these 50 clients without limits, so new connections cannot be established.</p>
<p class="introheading">Example of Kaspersky Scan Engine work in ICAP mode depending on the ScannersCount, ThreadsCount, QueueLen, and MaxIcapSessionsCount settings</p>
<p class="bodytext">Let's say Kaspersky Scan Engine is installed on a computer with four CPU cores, there are 140 simultaneous connections to this computer, and Kaspersky Scan Engine is configured as follows:</p>
<ul class="listbullet1"><li class="listbullet1">ScannersCount = 4</li><li class="listbullet1">ThreadsCount = 8</li><li class="listbullet1">QueueLen = 200</li><li class="listbullet1">MaxIcapSessionsCount = 100</li></ul><p class="bodytext">In this case:</p>
<ol class="listnumber1"><li class="listnumber1">Kaspersky Scan Engine tries to open connections for all 140 clients. Generally, 100 sessions are guaranteed to be open. The remaining 40 clients will probably receive the error <code class="programcharacter">429: Too many requests</code>.</li><li class="listnumber1">The open sessions form a queue of scanning tasks. Ideally, a queue of 200 tasks is guaranteed.<p class="listcontinue1">If the <code class="programcharacter">QueueLen</code> value limits the queue length to less than 200 tasks, the rest of the clients will receive the error <code class="programcharacter">500 - Internal Server Error</code>.</p>
</li><li class="listnumber1">Kaspersky Scan Engine runs four scanning processes.</li><li class="listnumber1">Four scanning processes create eight threads for simultaneous processing of eight scanning tasks from the queue. The remaining 192 scanning tasks are queued.</li></ol><p class="bodytext">If <code class="programcharacter">500: Internal Server Error</code> is returned to the client, it may mean that the queue length limit specified in <code class="programcharacter">QueueLen</code> has been reached. In this case, you can do one of the following:</p>
<ul class="listbullet1"><li class="listbullet1">Decrease <code class="programcharacter">MaxIcapSessionsCount</code>.<p class="listcontinue1">Before decreasing <code class="programcharacter">MaxIcapSessionsCount</code>, evaluate your solution scalability needs. If <code class="programcharacter">MaxIcapSessionsCount</code> is decreased, all clients over the number specified in <code class="programcharacter">MaxIcapSessionsCount</code> will be unable to create a session and  will receive the error <code class="programcharacter">429: Too many requests</code>.</p>
</li><li class="listbullet1">Increase <code class="programcharacter">QueueLen</code>.<p class="listcontinue1">Before increasing <code class="programcharacter">QueueLen</code>, evaluate your solution scalability needs. If the <code class="programcharacter">QueueLen</code> is too large and the bandwidth is low, the request processing time can increase so much that the client is disconnected before Kaspersky Scan Engine finishes processing the request. </p>
</li></ul><p class="bodytext">If <code class="programcharacter">503: Service overloaded</code> is returned to the client, it may mean that the system memory consumption limit has been reached while the request was being processed (the log contains the record <code class="programcharacter">Not enough memory</code>).  In this case, increase the <code class="programcharacter">RAMUsageLimit</code> value.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192988"><p><a name=192988 style="display: none;">[Topic 192988]</a></p>
	<h2 id="t234302" class="heading2">Configuring Kaspersky Scan Engine in ICAP mode</h2>
<p class="bodytext">This section explains how to manually configure Kaspersky Scan Engine for use in ICAP mode, without using Kaspersky Scan Engine GUI.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#192989" target="_self">ICAP mode configuration file</a></p><p class="relateditem"><a href="#206590" target="_self">Configuring Format Recognizer for use in ICAP mode</a></p><p class="relateditem"><a href="#179893" target="_self">Configuring service rules</a></p><p class="relateditem"><a href="#192475" target="_self">Changing variables in the ICAP mode unit file</a></p><p class="relateditem"><a href="#179895" target="_self">Working with response templates and scripts</a></p><p class="relateditem"><a href="#179897" target="_self">Specifying paths to plug-ins and libraries</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192989"><p><a name=192989 style="display: none;">[Topic 192989]</a></p>
	<h3 id="t234385" class="heading3">ICAP mode configuration file</h3>
<p class="bodytext">The ICAP mode configuration file, <code class="programcharacter">kavicapd.xml</code>, consists of several sections that specify settings for the kavicapd service and KAV SDK.</p>
<p class="introheading">Preparing the ICAP mode configuration file after manual installation</p>
<p class="bodytext">If you <a id="h181517" class="englishcrossreferencetemplate" href="#180652" target="_self">installed Kaspersky Scan Engine manually</a>, you need to copy the ICAP mode configuration to a location where kavicapd service can find it. By default, the configuration file is located at <code class="programcharacter">%distr_kit%/etc/kavicapd.xml</code>.</p>
<p class="bodytext">After <a id="h181517_2" class="englishcrossreferencetemplate" href="#180652" target="_self">installing Kaspersky Scan Engine</a>, copy <code class="programcharacter">kavicapd.xml</code> to your preferred location:</p>
<ul class="listbullet1"><li class="listbullet1">If you copy <code class="programcharacter">kavicapd.xml</code> to the <code class="programcharacter">/etc/</code> directory, Kaspersky Scan Engine automatically finds and parses this file.</li><li class="listbullet1">If you copy <code class="programcharacter">kavicapd.xml</code> to a different location, you need to set the path to this location when you start Kaspersky Scan Engine <a id="h193471" class="englishcrossreferencetemplate" href="#179900" target="_self">manually</a>.</li></ul><p class="introheading">Parameters of the ICAP mode configuration file</p>
<p class="bodytext">Following are the sections of the ICAP mode configuration file, kavicapd.xml. An example configuration file is at the end.</p>
<p class="bodytext">The ICAP mode configuration file contains the following parent elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h201223" class="englishcrossreferencetemplate" href="#201103" target="_self">SDKSettings</a></li><li class="listbullet1"><a id="h201224" class="englishcrossreferencetemplate" href="#200603" target="_self">KSNSettings</a></li><li class="listbullet1"><a id="h201226" class="englishcrossreferencetemplate" href="#200605" target="_self">UpdateSettings</a></li><li class="listbullet1"><a id="h201225" class="englishcrossreferencetemplate" href="#200604" target="_self">ProxySettings</a></li><li class="listbullet1"><a id="h206618" class="englishcrossreferencetemplate" href="#206616" target="_self">FormatRecognizerSettings</a></li><li class="listbullet1"><a id="h201227" class="englishcrossreferencetemplate" href="#201129" target="_self">ICAPSettings</a></li></ul><p class="warningbody">Some sections of the configuration file are optional. However, if a section exists in the configuration file, all of its child elements must be present. Elements must not be empty, unless stated otherwise.</p>
<p class="introheading">Structure of the configuration file</p>
<p class="bodytext">Following is an example ICAP mode configuration file.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Configuration&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;SDKSettings&gt;</p>
<p class="program3">&lt;ScannersCount&gt;4&lt;/ScannersCount&gt;</p>
<p class="program3">&lt;ThreadsCount&gt;8&lt;/ThreadsCount&gt;</p>
<p class="program3">&lt;QueueLen&gt;1024&lt;/QueueLen&gt;</p>
<p class="program3">&lt;ScanTimeout&gt;10000&lt;/ScanTimeout&gt; &lt;!-- 0 = unlimited --&gt;</p>
<p class="program3">&lt;LicensePath&gt;<code class="programcharacter">/opt/kasper</code>sky/ScanEngine/bin&lt;/LicensePath&gt;</p>
<p class="program3">&lt;BasesPath&gt;<code class="programcharacter">/opt/kasper</code>sky/ScanEngine/bin/bases&lt;/BasesPath&gt;</p>
<p class="program3">&lt;TempPath&gt;/tmp/kavicapd&lt;/TempPath&gt;</p>
<p class="program3">&lt;LicensingMode&gt;1&lt;/LicensingMode&gt;&lt;!-- 1 = offline licensing mode; 2 - online licensing mode --&gt;</p>
<p class="program3">&lt;ScanningMode&gt;KAV_O_M_PACKED | KAV_O_M_ARCHIVED | KAV_O_M_MAILPLAIN | KAV_O_M_MAILBASES | KAV_O_M_HEURISTIC_LEVEL_SHALLOW&lt;/ScanningMode&gt;</p>
<p class="program3">&lt;MaxArchivesScanningDepth&gt;0&lt;/MaxArchivesScanningDepth&gt;</p>
<p class="program2">&lt;/SDKSettings&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;KSNSettings&gt;</p>
<p class="program3">&lt;UseKSN&gt;0&lt;/UseKSN&gt;</p>
<p class="program3">&lt;ObjectCheckOnDemandTimeoutMs&gt;10000&lt;/ObjectCheckOnDemandTimeoutMs&gt;</p>
<p class="program3">&lt;CacheSizeKb&gt;30720&lt;/CacheSizeKb&gt;</p>
<p class="program2">&lt;/KSNSettings&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;UpdateSettings&gt;</p>
<p class="program3">&lt;DisableBackup&gt;0&lt;/DisableBackup&gt;</p>
<p class="program3">&lt;UpdatePeriodMinutes&gt;30&lt;/UpdatePeriodMinutes&gt;  &lt;!-- 0 = turn update off --&gt;</p>
<p class="program3">&lt;UseOnlyCustomSources&gt;0&lt;/UseOnlyCustomSources&gt;</p>
<p class="program3">&lt;UpdateSources&gt;</p>
<p class="program4">&lt;!-- &lt;Source&gt;&lt;/Source&gt; --&gt;</p>
<p class="program3">&lt;/UpdateSources&gt;</p>
<p class="program3">&lt;UpdatesCertFile&gt;&lt;/UpdatesCertFile&gt;</p>
<p class="program3">&lt;CertificateConfirmationAction&gt;0&lt;/CertificateConfirmationAction&gt;</p>
<p class="program3">&lt;UseReducedBases&gt;0&lt;/UseReducedBases&gt;</p>
<p class="program2">&lt;/UpdateSettings&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;ProxySettings&gt;</p>
<p class="program3">&lt;UseProxy&gt;0&lt;/UseProxy&gt;</p>
<p class="program3">&lt;Host&gt;myproxy.mycompany.com&lt;/Host&gt;</p>
<p class="program3">&lt;Port&gt;3128&lt;/Port&gt;</p>
<p class="program3">&lt;User&gt;doOTrypDTxpVJxUHYeKQTw==&lt;/User&gt;</p>
<p class="program3">&lt;Pass&gt;8mSHXFix3uL+RP9oNeKDZQ==&lt;/Pass&gt;</p>
<p class="program2">&lt;/ProxySettings&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;FormatRecognizerSettings&gt;</p>
<p class="program3">&lt;FormatsToSkipScanning&gt;</p>
<p class="program4">&lt;KAV_FF_GENERAL_TXT/&gt;</p>
<p class="program4">&lt;KAV_FF_GENERAL_CSV/&gt;</p>
<p class="program4">&lt;KAV_FF_AUDIO_WMA/&gt;</p>
<p class="program3">&lt;/FormatsToSkipScanning&gt;</p>
<p class="program2">&lt;/FormatRecognizerSettings&gt;</p>
<p class="program">&nbsp;</p>
<p class="program2">&lt;ICAPSettings&gt;</p>
<p class="program3">&lt;Port&gt;1344&lt;/Port&gt;</p>
<p class="program3">&lt;ReqModeAddress&gt;req&lt;/ReqModeAddress&gt;</p>
<p class="program3">&lt;RespModeAddress&gt;resp&lt;/RespModeAddress&gt;</p>
<p class="program3">&lt;MaxIcapSessionsCount&gt;100&lt;/MaxIcapSessionsCount&gt;</p>
<p class="program3">&lt;ScanMaxFileSize&gt;0&lt;/ScanMaxFileSize&gt; &lt;!-- 0 = unlimited --&gt;</p>
<p class="program3">&lt;RAMUsageLimit&gt;0&lt;/RAMUsageLimit&gt; &lt;!-- 0 = unlimited --&gt;</p>
<p class="program3">&lt;Allow204&gt;0&lt;/Allow204&gt;</p>
<p class="program3">&lt;KeepAliveSettings&gt;&lt;!-- Support for processing multiple requests during one connection --&gt;</p>
<p class="program4">&lt;Enabled&gt;1&lt;/Enabled&gt;</p>
<p class="program4">&lt;TimeoutMs&gt;5000&lt;/TimeoutMs&gt;</p>
<p class="program4">&lt;MaxRequests&gt;1000&lt;/MaxRequests&gt;</p>
<p class="program3">&lt;/KeepAliveSettings&gt;</p>
<p class="program3">&lt;RequestingICAPHeaders&gt;</p>
<p class="program4">&lt;ICAPHeader&gt;HTTPUserNameICAPHeader&lt;/ICAPHeader&gt;</p>
<p class="program4">&lt;ICAPHeader&gt;HTTPClientIpICAPHeader&lt;/ICAPHeader&gt;</p>
<p class="program3">&lt;/RequestingICAPHeaders&gt;</p>
<p class="program3">&lt;HTTPClientIpICAPHeader&gt;X-Client-IP&lt;/HTTPClientIpICAPHeader&gt;</p>
<p class="program3">&lt;HTTPUserNameICAPHeader&gt;X-Client-Username&lt;/HTTPUserNameICAPHeader&gt;</p>
<p class="program3">&lt;VirusNameICAPHeader&gt;&lt;/VirusNameICAPHeader&gt;</p>
<p class="program3">&lt;DatabaseVersionICAPHeader&gt;X-AV-Database-time&lt;/DatabaseVersionICAPHeader&gt;</p>
<p class="program3">&lt;SendInfectionFoundICAPHeader&gt;0&lt;/SendInfectionFoundICAPHeader&gt;</p>
<p class="program3">&lt;SendResponseInfoICAPHeader&gt;0&lt;/SendResponseInfoICAPHeader&gt;</p>
<p class="program3">&lt;SendResponseDescICAPHeader&gt;0&lt;/SendResponseDescICAPHeader&gt;</p>
<p class="program3">&lt;SendViolationsFoundICAPHeader&gt;0&lt;/SendViolationsFoundICAPHeader&gt;</p>
<p class="program3">&lt;ScanInReqMode&gt;All&lt;/ScanInReqMode&gt;</p>
<p class="program3">&lt;ScanInRespMode&gt;Content&lt;/ScanInRespMode&gt;</p>
<p class="program3">&lt;RulesFilePath&gt;/opt/kaspersky/ScanEngine/icap_data/kavicapd_gui_rules.conf&lt;/RulesFilePath&gt;</p>
<p class="program3">&lt;CmdPath&gt;/opt/kaspersky/ScanEngine/icap_data/scripts&lt;/CmdPath&gt;</p>
<p class="program3">&lt;ResponsesPath&gt;/opt/kaspersky/ScanEngine/icap_data/templates&lt;/ResponsesPath&gt;</p>
<p class="program3">&lt;TransferBeforeScanEnding Delay=&quot;10&quot; ChunkSize=&quot;4&quot; BlockedUrlCacheEnabled=&quot;1&quot; BlockedUrlCacheKb=&quot;5000&quot; BlockedUrlCacheTtlSec=&quot;1800&quot;&gt;0&lt;/TransferBeforeScanEnding&gt;</p>
<p class="program3">&lt;Exclusions&gt;</p>
<p class="program3">&lt;!-- Signs of highly likely uninfected resources. --&gt;</p>
<p class="program3">&lt;!-- Note: ContentSize - more or equal (use only once), ContentType - as is, RequestURL - masks can be used --&gt;</p>
<p class="program3">&lt;!--</p>
<p class="program4">&lt;ContentSize&gt;102400&lt;/ContentSize&gt;</p>
<p class="program4">&lt;ContentType&gt;audio/mpeg&lt;/ContentType&gt;</p>
<p class="program4">&lt;ContentType&gt;image/jpeg&lt;/ContentType&gt;</p>
<p class="program4">&lt;RequestURL&gt;*.kaspersky.com/.*&lt;/RequestURL&gt;</p>
<p class="program">		--&gt;</p>
<p class="program3">&lt;/Exclusions&gt;</p>
<p class="program3">&lt;!-- Possible values: update, reload, reopen-log (reopens syslog format log files) --&gt;</p>
<p class="program3">&lt;USR1SignalAction&gt;update&lt;/USR1SignalAction&gt; </p>
<p class="program3">&lt;USR2SignalAction&gt;reopen-log&lt;/USR2SignalAction&gt;</p>
<p class="program3">&lt;!-- The path to the logging configuration file. Only this file will be used as the ICAP logging configuration file. If the LoggingConfigFilePath element has the empty value, the icapdkavlog.conf file located in the kavicapd binary file directory is used. --&gt;</p>
<p class="program3">&lt;LoggingConfigFilePath&gt;&lt;/LoggingConfigFilePath&gt;</p>
<p class="program2">&lt;/ICAPSettings&gt;</p>
<p class="program">&nbsp;</p>
<p class="program">&lt;/Configuration&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201103"><p><a name=201103 style="display: none;">[Topic 201103]</a></p>
	<h4 id="t234504" class="heading4">SDKSettings</h4>
<p class="bodytext">Specifies KAV SDK settings.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">SDKSettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h200733" class="englishcrossreferencetemplate" href="#200690" target="_self">ScannersCount</a></li><li class="listbullet1"><a id="h201166" class="englishcrossreferencetemplate" href="#200691" target="_self">ThreadsCount</a></li><li class="listbullet1"><a id="h201167" class="englishcrossreferencetemplate" href="#200692" target="_self">QueueLen</a></li><li class="listbullet1"><a id="h201168" class="englishcrossreferencetemplate" href="#200693" target="_self">ScanTimeout</a></li><li class="listbullet1"><a id="h201169" class="englishcrossreferencetemplate" href="#201118" target="_self">LicensePath</a></li><li class="listbullet1"><a id="h201170" class="englishcrossreferencetemplate" href="#201120" target="_self">BasesPath</a></li><li class="listbullet1"><a id="h201171" class="englishcrossreferencetemplate" href="#200697" target="_self">TempPath</a></li><li class="listbullet1"><a id="h201173" class="englishcrossreferencetemplate" href="#201123" target="_self">ScanningMode</a></li><li class="listbullet1"><a id="h201174" class="englishcrossreferencetemplate" href="#201124" target="_self">LicensingMode</a></li><li class="listbullet1"><a id="h207137" class="englishcrossreferencetemplate" href="#207146" target="_self">MaxArchivesScanningDepth</a></li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of an <em class="emphasischaracter">SDKSettings</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;SDKSettings&gt;</p>
<p class="program2">&lt;ScannersCount&gt;4&lt;/ScannersCount&gt;</p>
<p class="program2">&lt;ThreadsCount&gt;8&lt;/ThreadsCount&gt;</p>
<p class="program2">&lt;QueueLen&gt;1024&lt;/QueueLen&gt;</p>
<p class="program2">&lt;ScanTimeout&gt;10000&lt;/ScanTimeout&gt; &lt;!-- 0 = unlimited --&gt;</p>
<p class="program2">&lt;LicensePath&gt;/opt/kaspersky/ScanEngine/bin&lt;/LicensePath&gt;</p>
<p class="program2">&lt;BasesPath&gt;/opt/kaspersky/ScanEngine/bin/bases&lt;/BasesPath&gt;</p>
<p class="program2">&lt;TempPath&gt;/tmp/kavicapd&lt;/TempPath&gt;</p>
<p class="program2">&lt;LicensingMode&gt;1&lt;/LicensingMode&gt;&lt;!-- 1 = offline licensing mode; 2 - online licensing mode --&gt;	</p>
<p class="program2">&lt;ScanningMode&gt;KAV_O_M_PACKED | KAV_O_M_ARCHIVED | KAV_O_M_MAILPLAIN | KAV_O_M_MAILBASES | KAV_O_M_HEURISTIC_LEVEL_SHALLOW&lt;/ScanningMode&gt;</p>
<p class="program2">&lt;MaxArchivesScanningDepth&gt;0&lt;/MaxArchivesScanningDepth&gt;</p>
<p class="program">&lt;/SDKSettings&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200690"><p><a name=200690 style="display: none;">[Topic 200690]</a></p>
	<h5 id="t234498" class="heading5">ScannersCount</h5>
<p class="bodytext">Specifies the number of scanning processes. You can have up to 256 scanning processes.  </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">SDKSettings &gt; ScannersCount</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer and cannot be <code class="programcharacter">0</code>. The default value is <code class="programcharacter">4</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ScannersCount&gt;4&lt;/ScannersCount&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200691"><p><a name=200691 style="display: none;">[Topic 200691]</a></p>
	<h5 id="t234530" class="heading5">ThreadsCount</h5>
<p class="bodytext">Specifies the total number of scanning threads in all processes. You can have up to 256 scanning threads.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">SDKSettings &gt; ThreadsCount</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value must be an unsigned integer and cannot be <code class="programcharacter">0</code>. The default value is <code class="programcharacter">8</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ThreadsCount&gt;8&lt;/ThreadsCount&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200692"><p><a name=200692 style="display: none;">[Topic 200692]</a></p>
	<h5 id="t234469" class="heading5">QueueLen</h5>
<p class="bodytext">Specifies the length of the scan task queue.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">SDKSettings &gt; QueueLen</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The default value is <code class="programcharacter">1024</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;QueueLen&gt;1024&lt;/QueueLen&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200693"><p><a name=200693 style="display: none;">[Topic 200693]</a></p>
	<h5 id="t234503" class="heading5">ScanTimeout</h5>
<p class="bodytext">Specifies the scanning timeout, in milliseconds (ms).</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">SDKSettings &gt; ScanTimeout</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The default value is <code class="programcharacter">10000</code> (10 seconds).</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ScanTimeout&gt;10000&lt;/ScanTimeout&gt; &lt;!-- 0 = unlimited --&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201118"><p><a name=201118 style="display: none;">[Topic 201118]</a></p>
	<h5 id="t234425" class="heading5">LicensePath</h5>
<p class="bodytext">Specifies an absolute path to a directory where the application ID file, licensing file, and key file are stored.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">SDKSettings &gt; LicensePath</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This is a string value. Kaspersky Scan Engine looks for these files in the following directories:</p>
<ul class="listbullet1"><li class="listbullet1">The directory that is specified in <code class="programcharacter">LicensePath</code>.</li><li class="listbullet1">The directory that contains the <code class="programcharacter">kavicapd</code> executable file.</li><li class="listbullet1">The <code class="programcharacter">%service_dir%/ppl</code> directory.</li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;LicensePath&gt;<code class="programcharacter">/opt/kasper</code>sky/ScanEngine/bin&lt;/LicensePath&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201120"><p><a name=201120 style="display: none;">[Topic 201120]</a></p>
	<h5 id="t234284" class="heading5">BasesPath</h5>
<p class="bodytext">Specifies an absolute path to a directory where the anti-virus database is located.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">SDKSettings &gt; BasesPath</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The default value is <code class="programcharacter">/opt/kaspersky/ScanEngine/bin/bases</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;BasesPath&gt;<code class="programcharacter">/opt/kasper</code>sky/ScanEngine/bin/bases&lt;/BasesPath&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200697"><p><a name=200697 style="display: none;">[Topic 200697]</a></p>
	<h5 id="t234528" class="heading5">TempPath</h5>
<p class="bodytext">Specifies an absolute path to a directory where the files created at runtime are stored.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">SDKSettings &gt; TempPath</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The default value is <code class="programcharacter">/tmp/kavicapd</code>.</p>
<p class="warningbody">Do not delete any files from this directory.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;TempPath&gt;/tmp/kavicapd&lt;/TempPath&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201123"><p><a name=201123 style="display: none;">[Topic 201123]</a></p>
	<h5 id="t234501" class="heading5">ScanningMode</h5>
<p class="bodytext">Specifies a file scanning mode.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">SDKSettings &gt; ScanningMode</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">A scanning mode is defined by a combination of flags separated by pipes (<code class="programcharacter">|</code>).</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">ScanningMode element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="234"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="276"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">KAV_O_M_PACKED</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Scan compressed executable files.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">KAV_O_M_ARCHIVED</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Scan archived files.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">KAV_O_M_MAILBASES</code></p>
<p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Scan files that contain email databases.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">KAV_O_M_MAILPLAIN</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Scan email messages.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">KAV_O_M_HEURISTIC_LEVEL_SHALLOW</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Set the scanning level of the advanced heuristic code analyzer to shallow (the Low level in the graphical user interface).</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">KAV_O_M_HEURISTIC_LEVEL_MEDIUM</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Set the scanning level of the advanced heuristic code analyzer to medium (the Medium level in the graphical user interface).</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">KAV_O_M_HEURISTIC_LEVEL_DETAIL</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Set the scanning level of the advanced heuristic code analyzer to detail (the High level in the graphical user interface).</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">KAV_O_M_MSOFFICE_MACRO</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Block clean Microsoft Office document files that contain macros, and then notify the user.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">KAV_O_M_PHISHING</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Enable Phishing protection.</p>
</td>
</tr>

</table>
<p class="bodytext">The default value is <code class="programcharacter">KAV_O_M_PACKED | KAV_O_M_ARCHIVED | KAV_O_M_MAILPLAIN | KAV_O_M_MAILBASES | KAV_O_M_HEURISTIC_LEVEL_SHALLOW</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ScanningMode&gt;KAV_O_M_PACKED | KAV_O_M_ARCHIVED | KAV_O_M_MAILPLAIN | KAV_O_M_MAILBASES | KAV_O_M_HEURISTIC_LEVEL_SHALLOW&lt;/ScanningMode&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201124"><p><a name=201124 style="display: none;">[Topic 201124]</a></p>
	<h5 id="t234429" class="heading5">LicensingMode</h5>
<p class="bodytext">Specifies the licensing mode used in Kaspersky Scan Engine.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">SDKSettings &gt; LicensingMode</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">Possible values:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">1&#8212;</code><a id="h180864" class="englishcrossreferencetemplate" href="#179852" target="_self">Offline licensing mode</a></li><li class="listbullet1"><code class="programcharacter">2&#8212;</code><a id="h180819" class="englishcrossreferencetemplate" href="#179855" target="_self">Online licensing mode</a></li></ul><p class="bodytext">The default value is <code class="programcharacter">1</code>.</p>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="207146"><p><a name=207146 style="display: none;">[Topic 207146]</a></p>
	<h5 id="t234451" class="heading5">MaxArchivesScanningDepth</h5>
<p class="bodytext">Specifies the maximum depth of nested archives to be unpacked during scanning. This parameter is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">SDKSettings &gt; MaxArchivesScanningDepth</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The value must be an unsigned integer. </p>
<p class="bodytext">The default value is <code class="programcharacter">0</code>.</p>
<p class="bodytext">The recommended value is <code class="programcharacter">5</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;MaxArchivesScanningDepth&gt;0&lt;/MaxArchivesScanningDepth&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200603"><p><a name=200603 style="display: none;">[Topic 200603]</a></p>
	<h4 id="t234420" class="heading4">KSNSettings</h4>
<p class="bodytext">Specifies Kaspersky Security Network (KSN) settings.</p>
<p class="bodytext">This is an optional section. If this section is absent from the configuration file, KSN is not used.</p>
<p class="attentionbody">By using KSN, you agree to transfer data to Kaspersky as described in the About data provision.txt file. See also the detailed information <a id="h155880" class="englishcrossreferencetemplate" href="#185034" target="_self">about data provisioning</a>.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KSNSettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h201177" class="englishcrossreferencetemplate" href="#200698" target="_self">UseKSN</a></li><li class="listbullet1"><a id="h200775" class="englishcrossreferencetemplate" href="#200702" target="_self">ObjectCheckOnDemandTimeoutMs</a></li><li class="listbullet1"><a id="h200776" class="englishcrossreferencetemplate" href="#200703" target="_self">CacheSizeKb</a></li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of a <em class="emphasischaracter">KSNSettings</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;KSNSettings&gt;</p>
<p class="program2">&lt;UseKSN&gt;0&lt;/UseKSN&gt;</p>
<p class="program2">&lt;ObjectCheckOnDemandTimeoutMs&gt;10000&lt;/ObjectCheckOnDemandTimeoutMs&gt;</p>
<p class="program2">&lt;CacheSizeKb&gt;30720&lt;/CacheSizeKb&gt;</p>
<p class="program">&lt;/KSNSettings&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200698"><p><a name=200698 style="display: none;">[Topic 200698]</a></p>
	<h5 id="t234563" class="heading5">UseKSN</h5>
<p class="bodytext">A Boolean value that defines whether KSN is enabled.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KSNSettings &gt; UseKSN</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">UseKSN element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="234"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="276"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">KSN is disabled.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">KSN is enabled. It also automatically enables the <code class="programcharacter">KAV_O_M_COMPOSITE_SCAN_KSN</code> flag.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UseKSN&gt;0&lt;/UseKSN&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200702"><p><a name=200702 style="display: none;">[Topic 200702]</a></p>
	<h5 id="t234461" class="heading5">ObjectCheckOnDemandTimeoutMs</h5>
<p class="bodytext">Specifies the timeout for checking the reputation of files or URLs in KSN cloud, in milliseconds (ms).</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KSNSettings &gt; ObjectCheckOnDemandTimeoutMs</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This value cannot be <code class="programcharacter">0</code>.</p>
<p class="bodytext">The default value is <code class="programcharacter">10000</code> (10 seconds).</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ObjectCheckOnDemandTimeoutMs&gt;10000&lt;/ObjectCheckOnDemandTimeoutMs&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200703"><p><a name=200703 style="display: none;">[Topic 200703]</a></p>
	<h5 id="t234290" class="heading5">CacheSizeKb</h5>
<p class="bodytext">Specifies the maximum size, in kilobytes (KB), of the KSN status cache.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">KSNSettings &gt; CacheSizeKb</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This cache is used by Kaspersky Scan Engine to store scan results obtained from KSN.</p>
<p class="bodytext">The default value is <code class="programcharacter">30720</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;CacheSizeKb&gt;30720&lt;/CacheSizeKb&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200604"><p><a name=200604 style="display: none;">[Topic 200604]</a></p>
	<h4 id="t234467" class="heading4">ProxySettings</h4>
<p class="bodytext">The following parameters specify proxy server settings for Kaspersky Scan Engine. Kaspersky Scan Engine uses these settings when it connects to the Internet.</p>
<p class="bodytext">This is an optional section. If this section is absent from the configuration file, Kaspersky Scan Engine does not use a proxy server when connecting to the Internet.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ProxySettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h200781" class="englishcrossreferencetemplate" href="#200704" target="_self">UseProxy</a></li><li class="listbullet1"><a id="h200782" class="englishcrossreferencetemplate" href="#200705" target="_self">Host</a></li><li class="listbullet1"><a id="h200783" class="englishcrossreferencetemplate" href="#200706" target="_self">Port</a></li><li class="listbullet1"><a id="h200784" class="englishcrossreferencetemplate" href="#200707" target="_self">User</a></li><li class="listbullet1"><a id="h200785" class="englishcrossreferencetemplate" href="#200708" target="_self">Pass</a></li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of a <em class="emphasischaracter">ProxySettings</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ProxySettings&gt;</p>
<p class="program2">&lt;UseProxy&gt;0&lt;/UseProxy&gt;</p>
<p class="program2">&lt;Host&gt;myproxy.mycompany.com&lt;/Host&gt;</p>
<p class="program2">&lt;Port&gt;3128&lt;/Port&gt;</p>
<p class="program2">&lt;User&gt;doOTrypDTxpVJxUHYeKQTw==&lt;/User&gt;</p>
<p class="program2">&lt;Pass&gt;8mSHXFix3uL+RP9oNeKDZQ==&lt;/Pass&gt;</p>
<p class="program">&lt;/ProxySettings&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200704"><p><a name=200704 style="display: none;">[Topic 200704]</a></p>
	<h5 id="t234566" class="heading5">UseProxy</h5>
<p class="bodytext">A Boolean value that defines whether Kaspersky Scan Engine uses a proxy server when connecting to the Internet.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ProxySettings &gt; UseProxy</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">UseProxy element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="234"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="276"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Proxy server is not used.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Proxy server is used.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UseProxy&gt;0&lt;/UseProxy&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200705"><p><a name=200705 style="display: none;">[Topic 200705]</a></p>
	<h5 id="t234376" class="heading5">Host</h5>
<p class="bodytext">Specifies the proxy server IP address (IPv4 or IPv6) or a domain name.</p>
<p class="bodytext">If a proxy server is used, this parameter is mandatory.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ProxySettings &gt; Host</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">Do not specify the protocol (http:// or https://) in this parameter.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Host&gt;myproxy.mycompany.com&lt;/Host&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200706"><p><a name=200706 style="display: none;">[Topic 200706]</a></p>
	<h5 id="t234463" class="heading5">Port</h5>
<p class="bodytext">Specifies the port number of the proxy server.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ProxySettings &gt; Port</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The default value is <code class="programcharacter">3128</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Port&gt;3128&lt;/Port&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200707"><p><a name=200707 style="display: none;">[Topic 200707]</a></p>
	<h5 id="t234568" class="heading5">User</h5>
<p class="bodytext">Specifies the encrypted user name that is used for authenticating on a proxy server. The user name is encrypted by the <code class="programcharacter">kav_encrypt</code> utility.</p>
<p class="bodytext">If a proxy server is used, this parameter is mandatory.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ProxySettings &gt; User</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">If the <code class="programcharacter">User</code> parameter and the <code class="programcharacter">Pass</code> parameter are empty, an anonymous proxy server is used.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;User&gt;doOTrypDTxpVJxUHYeKQTw==&lt;/User&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200708"><p><a name=200708 style="display: none;">[Topic 200708]</a></p>
	<h5 id="t234462" class="heading5">Pass</h5>
<p class="bodytext">Specifies the encrypted password that is used for authenticating on a proxy server. The value is encrypted by the <code class="programcharacter">kav_encrypt</code> utility.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ProxySettings &gt; Pass</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">If the <code class="programcharacter">User</code> parameter and the <code class="programcharacter">Pass</code> parameter are empty, an anonymous proxy server is used.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Pass&gt;8mSHXFix3uL+RP9oNeKDZQ==&lt;/Pass&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200605"><p><a name=200605 style="display: none;">[Topic 200605]</a></p>
	<h4 id="t234550" class="heading4">UpdateSettings</h4>
<p class="bodytext">The following parameters specify update settings for Kaspersky Scan Engine.</p>
<p class="bodytext">This is an optional section. If this section is absent from the configuration file, updating is disabled.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h201186" class="englishcrossreferencetemplate" href="#200709" target="_self">DisableBackup</a></li><li class="listbullet1"><a id="h200787" class="englishcrossreferencetemplate" href="#200710" target="_self">UpdatePeriodMinutes</a></li><li class="listbullet1"><a id="h201188" class="englishcrossreferencetemplate" href="#200711" target="_self">UseOnlyCustomSources</a></li><li class="listbullet1"><a id="h201189" class="englishcrossreferencetemplate" href="#200712" target="_self">UpdateSources</a></li><li class="listbullet1"><a id="h201190" class="englishcrossreferencetemplate" href="#200713" target="_self">UpdatesCertFile</a></li><li class="listbullet1"><a id="h201191" class="englishcrossreferencetemplate" href="#200714" target="_self">CertificateConfirmationAction</a></li><li class="listbullet1"><a id="h200792" class="englishcrossreferencetemplate" href="#200715" target="_self">UseReducedBases</a></li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of a <em class="emphasischaracter">UpdateSettings</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UpdateSettings&gt;</p>
<p class="program2">&lt;DisableBackup&gt;0&lt;/DisableBackup&gt;</p>
<p class="program2">&lt;UpdatePeriodMinutes&gt;30&lt;/UpdatePeriodMinutes&gt;  &lt;!-- 0 = turn update off --&gt;</p>
<p class="program2">&lt;UseOnlyCustomSources&gt;0&lt;/UseOnlyCustomSources&gt;</p>
<p class="program2">&lt;UpdateSources&gt;</p>
<p class="program3">&lt;!-- &lt;Source&gt;&lt;/Source&gt; --&gt;</p>
<p class="program2">&lt;/UpdateSources&gt;</p>
<p class="program2">&lt;UpdatesCertFile&gt;&lt;/UpdatesCertFile&gt;</p>
<p class="program2">&lt;CertificateConfirmationAction&gt;0&lt;/CertificateConfirmationAction&gt;</p>
<p class="program2">&lt;UseReducedBases&gt;0&lt;/UseReducedBases&gt;</p>
<p class="program">&lt;/UpdateSettings&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200709"><p><a name=200709 style="display: none;">[Topic 200709]</a></p>
	<h5 id="t234322" class="heading5">DisableBackup</h5>
<p class="bodytext">A Boolean value that defines whether anti-virus database backup is enabled. </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; DisableBackup</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">DisableBackup element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="234"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="276"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Anti-virus database backup is enabled.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Anti-virus database backup is disabled.</p>
</td>
</tr>

</table>
<p class="bodytext"></p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;DisableBackup&gt;0&lt;/DisableBackup&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200710"><p><a name=200710 style="display: none;">[Topic 200710]</a></p>
	<h5 id="t234546" class="heading5">UpdatePeriodMinutes</h5>
<p class="bodytext">Specifies the interval between automatic updates (in minutes). </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; UpdatePeriodMinutes</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The maximum value is <code class="programcharacter">44640</code>.</p>
<p class="bodytext">If this parameter is <code class="programcharacter">0</code>, Kaspersky Scan Engine does not perform automatic updates.</p>
<p class="bodytext">The default value is <code class="programcharacter">30</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UpdatePeriodMinutes&gt;30&lt;/UpdatePeriodMinutes&gt;  &lt;!-- 0 = turn update off --&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200711"><p><a name=200711 style="display: none;">[Topic 200711]</a></p>
	<h5 id="t234565" class="heading5">UseOnlyCustomSources</h5>
<p class="bodytext">Specifies whether Kaspersky update servers are used as a source of updates.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; UseOnlyCustomSources</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">UseOnlyCustomSources element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="234"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="276"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Kaspersky update servers are used along with custom update sources.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">Only custom update sources are used.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UseOnlyCustomSources&gt;0&lt;/UseOnlyCustomSources&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200712"><p><a name=200712 style="display: none;">[Topic 200712]</a></p>
	<h5 id="t234552" class="heading5">UpdateSources</h5>
<p class="bodytext">Contains custom update sources.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; UpdateSources</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><em class="emphasischaracter">Source</em><p class="listcontinue1">Specifies a custom update source.</p>
<p class="listcontinue1">If Kaspersky Scan Engine must use TLS when connecting to a custom update source, you must specify the <code class="programcharacter">https://</code> protocol in the address of this custom update source.</p>
</li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UpdateSources&gt;</p>
<p class="program2">&lt;!-- &lt;Source&gt;&lt;/Source&gt; --&gt;</p>
<p class="program">&lt;/UpdateSources&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200713"><p><a name=200713 style="display: none;">[Topic 200713]</a></p>
	<h5 id="t234548" class="heading5">UpdatesCertFile</h5>
<p class="bodytext">Path to the PEM-formatted root certificate to be used for downloading updates from custom HTTPS update servers. </p>
<p class="bodytext">The parameter is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; UpdatesCertFile</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Values</p>
<p class="bodytext">You can specify either an absolute or relative path. A relative path is relative to the location of the <code class="programcharacter">kavicapd</code> executable file.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UpdatesCertFile&gt;&lt;/UpdatesCertFile&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200714"><p><a name=200714 style="display: none;">[Topic 200714]</a></p>
	<h5 id="t234292" class="heading5">CertificateConfirmationAction</h5>
<p class="bodytext">Action to undertake if the update server uses an untrusted certificate.</p>
<p class="bodytext">The parameter is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; CertificateConfirmationAction</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">CertificateConfirmationAction element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="234"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="276"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">The update server must not be used.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">The update server must be still used.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;CertificateConfirmationAction&gt;0&lt;/CertificateConfirmationAction&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200715"><p><a name=200715 style="display: none;">[Topic 200715]</a></p>
	<h5 id="t234570" class="heading5">UseReducedBases</h5>
<p class="bodytext">Specifies a parameter that is one of the terms that defines whether a reduced databases kit is updated or not.</p>
<p class="bodytext">The parameter is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">UpdateSettings &gt; UseReducedBases</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">UseReducedBases element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="234"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="276"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">The full databases kit is always updated.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="276"><p class="tablebodytext">The built-in functionality of KAV SDK updates the reduced kit, if all terms of updating to a reduced databases kit are observed. If at least one of the acceptance terms is not observed, the full databases kit is updated.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UseReducedBases&gt;0&lt;/UseReducedBases&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201129"><p><a name=201129 style="display: none;">[Topic 201129]</a></p>
	<h4 id="t234388" class="heading4">ICAPSettings</h4>
<p class="bodytext">Specifies ICAP settings for Kaspersky Scan Engine.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h201195" class="englishcrossreferencetemplate" href="#200716" target="_self">Port</a></li><li class="listbullet1"><a id="h207258" class="englishcrossreferencetemplate" href="#207194" target="_self">ReqModeAddress</a></li><li class="listbullet1"><a id="h207259" class="englishcrossreferencetemplate" href="#207240" target="_self">RespModeAddress</a></li><li class="listbullet1"><a id="h201196" class="englishcrossreferencetemplate" href="#200717" target="_self">MaxIcapSessionsCount</a></li><li class="listbullet1"><a id="h201197" class="englishcrossreferencetemplate" href="#201149" target="_self">RAMUsageLimit</a></li><li class="listbullet1"><a id="h201198" class="englishcrossreferencetemplate" href="#200719" target="_self">ScanMaxFileSize</a></li><li class="listbullet1"><a id="h201199" class="englishcrossreferencetemplate" href="#200720" target="_self">Allow204</a></li><li class="listbullet1"><a id="h207296" class="englishcrossreferencetemplate" href="#207291" target="_self">KeepAliveSettings</a></li><li class="listbullet1"><a id="h225224" class="englishcrossreferencetemplate" href="#225221" target="_self">RequestingICAPHeaders</a></li><li class="listbullet1"><a id="h201206" class="englishcrossreferencetemplate" href="#200726" target="_self">HTTPClientIpICAPHeader</a></li><li class="listbullet1"><a id="h201207" class="englishcrossreferencetemplate" href="#200727" target="_self">HTTPUserNameICAPHeader</a></li><li class="listbullet1"><a id="h201215" class="englishcrossreferencetemplate" href="#201214" target="_self">VirusNameICAPHeader</a></li><li class="listbullet1"><a id="h225157" class="englishcrossreferencetemplate" href="#225156" target="_self">DatabaseVersionICAPHeader</a></li><li class="listbullet1"><a id="h224483" class="englishcrossreferencetemplate" href="#221147" target="_self">SendInfectionFoundICAPHeader</a></li><li class="listbullet1"><a id="h224486" class="englishcrossreferencetemplate" href="#221160" target="_self">SendResponseDescICAPHeader</a></li><li class="listbullet1"><a id="h224484" class="englishcrossreferencetemplate" href="#221161" target="_self">SendResponseInfoICAPHeader</a></li><li class="listbullet1"><a id="h224485" class="englishcrossreferencetemplate" href="#221162" target="_self">SendViolationsFoundICAPHeader</a></li><li class="listbullet1"><a id="h201200" class="englishcrossreferencetemplate" href="#200721" target="_self">ScanInReqMode</a></li><li class="listbullet1"><a id="h201202" class="englishcrossreferencetemplate" href="#200722" target="_self">ScanInRespMode</a></li><li class="listbullet1"><a id="h201203" class="englishcrossreferencetemplate" href="#201153" target="_self">RulesFilePath</a></li><li class="listbullet1"><a id="h201204" class="englishcrossreferencetemplate" href="#201154" target="_self">CmdPath</a></li><li class="listbullet1"><a id="h201205" class="englishcrossreferencetemplate" href="#201155" target="_self">ResponsesPath</a></li><li class="listbullet1"><a id="h201209" class="englishcrossreferencetemplate" href="#201208" target="_self">TransferBeforeScanEnding</a></li><li class="listbullet1"><a id="h201210" class="englishcrossreferencetemplate" href="#200729" target="_self">Exclusions</a></li><li class="listbullet1"><a id="h201212" class="englishcrossreferencetemplate" href="#201163" target="_self">USR1SignalAction</a></li><li class="listbullet1"><a id="h201213" class="englishcrossreferencetemplate" href="#201164" target="_self">USR2SignalAction</a></li><li class="listbullet1"><a id="h201211" class="englishcrossreferencetemplate" href="#200730" target="_self">LoggingConfigFilePath</a></li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of an <em class="emphasischaracter">ICAPSettings</em> element.</p>
<table class="tableintopic" width="726" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="726"><p class="program">&lt;ICAPSettings&gt;</p>
<p class="program2">&lt;Port&gt;1344&lt;/Port&gt;</p>
<p class="program2">&lt;ReqModeAddress&gt;req&lt;/ReqModeAddress&gt;</p>
<p class="program2">&lt;RespModeAddress&gt;resp&lt;/RespModeAddress&gt;</p>
<p class="program2">&lt;MaxIcapSessionsCount&gt;100&lt;/MaxIcapSessionsCount&gt;</p>
<p class="program2">&lt;ScanMaxFileSize&gt;0&lt;/ScanMaxFileSize&gt; &lt;!-- 0 = unlimited --&gt;</p>
<p class="program2">&lt;RAMUsageLimit&gt;0&lt;/RAMUsageLimit&gt; &lt;!-- 0 = unlimited --&gt;</p>
<p class="program2">&lt;Allow204&gt;0&lt;/Allow204&gt;</p>
<p class="program2">&lt;KeepAliveSettings&gt;&lt;!-- Support for processing multiple requests during one connection --&gt;</p>
<p class="program3">&lt;Enabled&gt;1&lt;/Enabled&gt;</p>
<p class="program3">&lt;TimeoutMs&gt;5000&lt;/TimeoutMs&gt;</p>
<p class="program3">&lt;MaxRequests&gt;1000&lt;/MaxRequests&gt;</p>
<p class="program2">&lt;/KeepAliveSettings&gt;</p>
<p class="program2">&lt;RequestingICAPHeaders&gt;</p>
<p class="program3">&lt;ICAPHeader&gt;HTTPUserNameICAPHeader&lt;/ICAPHeader&gt;</p>
<p class="program3">&lt;ICAPHeader&gt;HTTPClientIpICAPHeader&lt;/ICAPHeader&gt;</p>
<p class="program2">&lt;/RequestingICAPHeaders&gt;</p>
<p class="program2">&lt;HTTPClientIpICAPHeader&gt;X-Client-IP&lt;/HTTPClientIpICAPHeader&gt;</p>
<p class="program2">&lt;HTTPUserNameICAPHeader&gt;X-Client-Username&lt;/HTTPUserNameICAPHeader&gt;</p>
<p class="program2">&lt;VirusNameICAPHeader&gt;&lt;/VirusNameICAPHeader&gt;</p>
<p class="program2">&lt;DatabaseVersionICAPHeader&gt;X-AV-Database-time&lt;/DatabaseVersionICAPHeader&gt;</p>
<p class="program2">&lt;SendInfectionFoundICAPHeader&gt;0&lt;/SendInfectionFoundICAPHeader&gt;</p>
<p class="program2">&lt;SendResponseDescICAPHeader&gt;0&lt;/SendResponseDescICAPHeader&gt;</p>
<p class="program2">&lt;SendResponseInfoICAPHeader&gt;0&lt;/SendResponseInfoICAPHeader&gt;</p>
<p class="program2">&lt;SendViolationsFoundICAPHeader&gt;0&lt;/SendViolationsFoundICAPHeader&gt;</p>
<p class="program2">&lt;ScanInReqMode&gt;All&lt;/ScanInReqMode&gt;</p>
<p class="program2">&lt;ScanInRespMode&gt;Content&lt;/ScanInRespMode&gt;</p>
<p class="program2">&lt;RulesFilePath&gt;/opt/kaspersky/ScanEngine/icap_data/kavicapd_gui_rules.conf&lt;/RulesFilePath&gt;</p>
<p class="program2">&lt;CmdPath&gt;/opt/kaspersky/ScanEngine/icap_data/scripts&lt;/CmdPath&gt;</p>
<p class="program2">&lt;ResponsesPath&gt;/opt/kaspersky/ScanEngine/icap_data/templates&lt;/ResponsesPath&gt;</p>
<p class="program2">&lt;TransferBeforeScanEnding Delay=&quot;10&quot; ChunkSize=&quot;4&quot; BlockedUrlCacheEnabled=&quot;1&quot; BlockedUrlCacheKb=&quot;5000&quot; BlockedUrlCacheTtlSec=&quot;1800&quot;&gt;0&lt;/TransferBeforeScanEnding&gt;</p>
<p class="program2">&lt;Exclusions&gt;</p>
<p class="program2">&lt;!-- Signs of highly likely uninfected resources. --&gt;</p>
<p class="program2">&lt;!-- Note: ContentSize - more or equal (use only once), ContentType - as is, RequestURL - masks can be used --&gt;</p>
<p class="program2">&lt;!--</p>
<p class="program3">&lt;ContentSize&gt;102400&lt;/ContentSize&gt;</p>
<p class="program3">&lt;ContentType&gt;audio/mpeg&lt;/ContentType&gt;</p>
<p class="program3">&lt;ContentType&gt;image/jpeg&lt;/ContentType&gt;</p>
<p class="program3">&lt;RequestURL&gt;*.kaspersky.com/.*&lt;/RequestURL&gt;</p>
<p class="program">	--&gt;</p>
<p class="program2">&lt;/Exclusions&gt;</p>
<p class="program2">&lt;!-- Possible values: update, reload, reopen-log (reopens syslog format log files) --&gt;</p>
<p class="program2">&lt;USR1SignalAction&gt;update&lt;/USR1SignalAction&gt; </p>
<p class="program2">&lt;USR2SignalAction&gt;reopen-log&lt;/USR2SignalAction&gt;</p>
<p class="program2">&lt;!-- The path to the logging configuration file. Only this file will be used as the ICAP logging configuration file. If the LoggingConfigFilePath element has the empty value, the icapdkavlog.conf file located in the kavicapd binary file directory is used. --&gt;</p>
<p class="program2">&lt;LoggingConfigFilePath&gt;&lt;/LoggingConfigFilePath&gt;</p>
<p class="program">&lt;/ICAPSettings&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200716"><p><a name=200716 style="display: none;">[Topic 200716]</a></p>
	<h5 id="t234464" class="heading5">Port</h5>
<p class="bodytext">Specifies the port number of Kaspersky Scan Engine.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; Port</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The default value is <code class="programcharacter">1344</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Port&gt;1344&lt;/Port&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="207194"><p><a name=207194 style="display: none;">[Topic 207194]</a></p>
	<h5 id="t234476" class="heading5">ReqModeAddress</h5>
<p class="bodytext">The address that kavicapd uses to process requests in the request mode. This address is the part of the full URL, as shown in the following example:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">icap://icap-server.example.com:1344/req</p>
</td>
</tr>

</table>
<p class="bodytext">In the example above, the default value <code class="programcharacter">req</code> is used. You can specify a different value in <code class="programcharacter">ReqModeAddress</code> (for example, <code class="programcharacter">avscan</code>):</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">icap://icap-server.example.com:1344/avscan</p>
</td>
</tr>

</table>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; ReqModeAddress</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Values</p>
<p class="bodytext">The value must meet the following requirements:</p>
<ul class="listbullet1"><li class="listbullet1">1 to 16 characters long.</li><li class="listbullet1">Valid characters:<ul class="listbullet2"><li class="listbullet2">Lowercase and uppercase Latin letters.</li><li class="listbullet2">Special characters: _ and -. </li></ul></li></ul><p class="bodytext">The default value is <code class="programcharacter">req</code>.</p>
<p class="attentionbody">Do not use the same value for <code class="programcharacter">ReqModeAddress</code> and <code class="programcharacter">RespModeAddress</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ReqModeAddress&gt;req&lt;/ReqModeAddress&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="207240"><p><a name=207240 style="display: none;">[Topic 207240]</a></p>
	<h5 id="t234480" class="heading5">RespModeAddress</h5>
<p class="bodytext">The address that kavicapd uses to process responses in the response mode. This address is the part of the full URL, as shown in the following example:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">icap://icap-server.example.com:1344/resp</p>
</td>
</tr>

</table>
<p class="bodytext">In the example above, the default value <code class="programcharacter">resp</code> is used. You can specify a different value in <code class="programcharacter">RespModeAddress</code> (for example, <code class="programcharacter">avscan</code>):</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">icap://icap-server.example.com:1344/avscan</p>
</td>
</tr>

</table>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; RespModeAddress</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Values</p>
<p class="bodytext">The value must meet the following requirements:</p>
<ul class="listbullet1"><li class="listbullet1">1 to 16 characters long.</li><li class="listbullet1">Valid characters:<ul class="listbullet2"><li class="listbullet2">Lowercase and uppercase Latin letters.</li><li class="listbullet2">Special characters: _ and -. </li></ul></li></ul><p class="bodytext">The default value is <code class="programcharacter">resp</code>.</p>
<p class="attentionbody">Do not use the same value for <code class="programcharacter">ReqModeAddress</code> and <code class="programcharacter">RespModeAddress</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;RespModeAddress&gt;resp&lt;/RespModeAddress&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200717"><p><a name=200717 style="display: none;">[Topic 200717]</a></p>
	<h5 id="t234453" class="heading5">MaxIcapSessionsCount</h5>
<p class="bodytext">Specifies the maximum number of simultaneous connections to Kaspersky Scan Engine.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; MaxIcapSessionsCount</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;MaxIcapSessionsCount&gt;100&lt;/MaxIcapSessionsCount&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201149"><p><a name=201149 style="display: none;">[Topic 201149]</a></p>
	<h5 id="t234470" class="heading5">RAMUsageLimit</h5>
<p class="bodytext">Specifies the maximum amount of system memory, in kilobytes (KB) that can be allocated by Kaspersky Scan Engine.</p>
<p class="attentionbody">Setting <code class="programcharacter">RAMUsageLimit</code> is not recommended for machines with limited CPU performance. For example, when the scan engine is running on a virtual machine, and the CPU resources of the physical host are shared with other virtual machines or processes.</p>
<p class="bodytext">This measure prevents the operating system from running out of memory. Excessive use of system memory (in this case, RAM) can occur when Kaspersky Scan Engine scans large files or receives a lot of simultaneous scan requests. When the <code class="programcharacter">RAMUsageLimit </code>limit is reached, Kaspersky Scan Engine stops processing the object that caused the excessive consumption of memory.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; RAMUsageLimit</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="introheading">Value</p>
<p class="bodytext">The recommended <code class="programcharacter">RAMUsageLimit</code> value:</p>
<ul class="listbullet1"><li class="listbullet1">does not exceed the RAM size.</li><li class="listbullet1">is twice the maximum file size for scanning large files. For example, scanning a 1 GB file requires about 2 GB of RAM.</li><li class="listbullet1">is not less than 600 MB, which is twice the size of the anti-virus database and Kaspersky Scan Engine libraries (300 MB in total). The reason for doubling is that the amount of system memory is doubled when the database is reloaded.</li></ul><p class="bodytext">Kaspersky Scan Engine also requires memory resources for all of its components.</p>
<p class="attentionbody">Do not set the value of <code class="programcharacter">RAMUsageLimit</code> lower than 7 MB. This is the minimum amount of system memory required to ensure the proper functioning of Kaspersky Scan Engine.</p>
<p class="bodytext">If the value of this parameter is <code class="programcharacter">0</code>, the amount of system memory that can be allocated by Kaspersky Scan Engine is not limited.</p>
<p class="bodytext">The default value is <code class="programcharacter">0</code>.</p>
<p class="attentionbody">If the value of this parameter is set to <code class="programcharacter">0</code>, the operating system may run out of memory. If Kaspersky Scan Engine uses too much system memory, the operating system may stop the service. </p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;RAMUsageLimit&gt;0&lt;/RAMUsageLimit&gt; &lt;!-- 0 = unlimited --&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200719"><p><a name=200719 style="display: none;">[Topic 200719]</a></p>
	<h5 id="t234496" class="heading5">ScanMaxFileSize</h5>
<p class="bodytext">Specifies the maximum size (in kilobytes) of a file that can be scanned by Kaspersky Scan Engine.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; ScanMaxFileSize</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">If the value of this parameter is 0, Kaspersky Scan Engine will scan files of any size.</p>
<p class="bodytext">If you specify the value for the <code class="programcharacter"><a id="h200816" class="englishcrossreferencetemplate" href="#200813" target="_self">ContentSize</a></code> parameter, Kaspersky Scan Engine will use it instead of the value of <code class="programcharacter">ScanMaxFileSize</code>. This applies both to requests made in preview mode and regular requests.</p>
<p class="bodytext">The default value is <code class="programcharacter">0</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ScanMaxFileSize&gt;0&lt;/ScanMaxFileSize&gt; &lt;!-- 0 = unlimited --&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200720"><p><a name=200720 style="display: none;">[Topic 200720]</a></p>
	<h5 id="t234276" class="heading5">Allow204</h5>
<p class="bodytext">A Boolean value that defines whether Kaspersky Scan Engine sends a 204 No Content HTTP status code instead of unchanged data to the proxy server.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; Allow204</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">Allow204 element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Kaspersky Scan Engine returns unchanged data.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Kaspersky Scan Engine returns a <code class="programcharacter">204 No Content HTTP</code> status code instead of unchanged data.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Allow204&gt;0&lt;/Allow204&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="207291"><p><a name=207291 style="display: none;">[Topic 207291]</a></p>
	<h5 id="t234416" class="heading5">KeepAliveSettings</h5>
<p class="bodytext">By default, Kaspersky Scan Engine supports Keep-Alive (persistent connections), so an ICAP client can use the same connection to send multiple requests. With <code class="programcharacter">KeepAliveSettings</code>, you can configure Keep-Alive support or even disable it.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings</code> &gt; <code class="programcharacter">KeepAliveSettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h207297" class="englishcrossreferencetemplate" href="#207292" target="_self">Enabled</a></li><li class="listbullet1"><a id="h207304" class="englishcrossreferencetemplate" href="#207298" target="_self">TimeoutMs</a></li><li class="listbullet1"><a id="h207305" class="englishcrossreferencetemplate" href="#207303" target="_self">MaxRequests</a></li><li class="listbullet1"><a id="h225388" class="englishcrossreferencetemplate" href="#221376" target="_self">UseAlways</a></li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;KeepAliveSettings&gt;</p>
<p class="program2">&lt;Enabled&gt;1&lt;/Enabled&gt;</p>
<p class="program2">&lt;TimeoutMs&gt;5000&lt;/TimeoutMs&gt;</p>
<p class="program2">&lt;MaxRequests&gt;1000&lt;/MaxRequests&gt;</p>
<p class="program">&lt;/KeepAliveSettings&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="207292"><p><a name=207292 style="display: none;">[Topic 207292]</a></p>
	<h6 id="t234340" class="heading6">Enabled</h6>
<p class="bodytext">Specifies if Keep-Alive support is enabled or disabled.</p>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; KeepAliveSettings &gt; Enabled</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">Valid values:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">0</code> - Keep-Alive support is disabled.</li><li class="listbullet1"><code class="programcharacter">1</code> - Keep-Alive support is enabled.</li></ul><p class="bodytext">The default value is <code class="programcharacter">1</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Enabled&gt;1&lt;/Enabled&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="207298"><p><a name=207298 style="display: none;">[Topic 207298]</a></p>
	<h6 id="t234533" class="heading6">TimeoutMs</h6>
<p class="bodytext">The amount of time an idle connection has to be kept open (in milliseconds), while waiting for a new request from an ICAP client.</p>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; KeepAliveSettings &gt; TimeoutMs</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The valid value is an integer from <code class="programcharacter">0</code> to <code class="programcharacter">18000</code> <code class="programcharacter">(</code>milliseconds).</p>
<p class="bodytext">If <code class="programcharacter">TimeoutMs</code> is set to <code class="programcharacter">0</code>, there is no time limit for the connection.</p>
<p class="bodytext">The default value is <code class="programcharacter">5000</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;TimeoutMs&gt;5000&lt;/TimeoutMs&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="207303"><p><a name=207303 style="display: none;">[Topic 207303]</a></p>
	<h6 id="t234456" class="heading6">MaxRequests</h6>
<p class="bodytext">The maximum number of requests for one connection before the connection is closed.</p>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; KeepAliveSettings &gt; MaxRequests</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The valid value is an integer from <code class="programcharacter">0</code> to <code class="programcharacter">1000</code>.</p>
<p class="bodytext">If <code class="programcharacter">MaxRequests</code> is set to <code class="programcharacter">0</code>, the number of requests for one connection is not limited.</p>
<p class="bodytext">The default value is <code class="programcharacter">1000</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;MaxRequests&gt;1000&lt;/MaxRequests&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221376"><p><a name=221376 style="display: none;">[Topic 221376]</a></p>
	<h6 id="t234560" class="heading6">UseAlways</h6>
<p class="bodytext">Specifies if Kaspersky Scan Engine always uses a Keep-Alive connection, even when ICAP clients do not request it. </p>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; KeepAliveSettings &gt; UseAlways</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">Valid values:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">0</code> - Kaspersky Scan Engine uses a Keep-Alive connection only when ICAP clients request it.</li><li class="listbullet1"><code class="programcharacter">1</code> - Kaspersky Scan Engine always uses a Keep-Alive connection.</li></ul><p class="bodytext">The default value is <code class="programcharacter">0</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;UseAlways&gt;0&lt;/UseAlways&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="225221"><p><a name=225221 style="display: none;">[Topic 225221]</a></p>
	<h5 id="t234478" class="heading5">RequestingICAPHeaders</h5>
<p class="bodytext">Indicates whether Kaspersky Scan Engine must include the <code class="programcharacter">X-Include</code> header in its response to the OPTIONS request from the ICAP client.</p>
<p class="bodytext">This element is optional and it can be empty. If the element is empty, Kaspersky Scan Engine does not include the <code class="programcharacter">X-Include</code> header in responses.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings</code> &gt; <code class="programcharacter">RequestingICAPHeaders</code></p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the <a id="h225223" class="englishcrossreferencetemplate" href="#225222" target="_self">ICAPHeader</a> nested elements.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;RequestingICAPHeaders&gt;</p>
<p class="program2">&lt;ICAPHeader&gt;HTTPUserNameICAPHeader&lt;/ICAPHeader&gt;</p>
<p class="program2">&lt;ICAPHeader&gt;HTTPClientIpICAPHeader&lt;/ICAPHeader&gt;</p>
<p class="program">&lt;/RequestingICAPHeaders&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="225222"><p><a name=225222 style="display: none;">[Topic 225222]</a></p>
	<h6 id="t234387" class="heading6">ICAPHeader</h6>
<p class="bodytext">Indicates whether Kaspersky Scan Engine must include the headers specified in <a id="h201207" class="englishcrossreferencetemplate" href="#200727" target="_self">HTTPUserNameICAPHeader</a> and <a id="h201206" class="englishcrossreferencetemplate" href="#200726" target="_self">HTTPClientIpICAPHeader</a> in its response to the OPTIONS request from the ICAP client.</p>
<p class="bodytext">This element cannot be empty.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; RequestingICAPHeaders &gt; ICAPHeader</code></p>
<p class="introheading">Value</p>
<p class="tablename">ICAPHeader element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="bodytext"><code class="programcharacter">HTTPUserNameICAPHeader</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Kaspersky Scan Engine includes the value specified in <a id="h201207_2" class="englishcrossreferencetemplate" href="#200727" target="_self">HTTPUserNameICAPHeader</a> in the <code class="programcharacter">X-Include</code> response header field.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="bodytext"><code class="programcharacter">HTTPClientIpICAPHeader</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Kaspersky Scan Engine includes the value specified in <a id="h201206_2" class="englishcrossreferencetemplate" href="#200726" target="_self">HTTPClientIpICAPHeader</a> in the <code class="programcharacter">X-Include</code> response header field.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ICAPHeader&gt;HTTPUserNameICAPHeader&lt;/ICAPHeader&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200726"><p><a name=200726 style="display: none;">[Topic 200726]</a></p>
	<h5 id="t234380" class="heading5">HTTPClientIpICAPHeader</h5>
<p class="bodytext">Specifies the name of the header field in which the IP address of the HTTP client is contained.</p>
<p class="bodytext">The field name must consist of characters allowed for header field names according to <a class="hyperlinktemplate" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" target="_blank">RFC 7230</a>.</p>
<p class="bodytext">This element is optional. </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; HTTPClientIpICAPHeader</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This element can have an empty value.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;HTTPClientIpICAPHeader&gt;X-Client-IP&lt;/HTTPClientIpICAPHeader&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200727"><p><a name=200727 style="display: none;">[Topic 200727]</a></p>
	<h5 id="t234383" class="heading5">HTTPUserNameICAPHeader</h5>
<p class="bodytext">Specifies the name of the header field in which the name of the HTTP client is contained.</p>
<p class="bodytext">The field name must consist of the characters allowed for header field names according to <a class="hyperlinktemplate" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" target="_blank">RFC 7230</a>.</p>
<p class="bodytext">This element is optional. </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; HTTPUserNameICAPHeader</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">This element can have an empty value.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;HTTPUserNameICAPHeader&gt;X-Client-Username&lt;/HTTPUserNameICAPHeader&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201214"><p><a name=201214 style="display: none;">[Topic 201214]</a></p>
	<h5 id="t234593" class="heading5">VirusNameICAPHeader</h5>
<p class="bodytext">Specifies the name of the header field in which the name of the detected threat or a type of legitimate software that can be used by intruders is contained.</p>
<p class="bodytext">The field name must consist of the characters allowed for header field names according to <a class="hyperlinktemplate" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" target="_blank">RFC 7230</a>.</p>
<p class="bodytext">The header field contains several names if more than one object is detected in a request that has passed through a proxy server for scanning. Multiple names are specified in any order and separated by a comma (&quot;,&quot;). </p>
<p class="bodytext">The maximum size of a value that can be contained in the header field is 10 KB (kilobytes). </p>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; VirusNameICAPHeader</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Values</p>
<p class="bodytext">This element can have an empty value. If nothing is detected during scanning, the field specified in the <code class="programcharacter">VirusNameICAPHeader</code>  element is absent from the response header. </p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;VirusNameICAPHeader&gt;X-Virus-ID&lt;/VirusNameICAPHeader&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="225156"><p><a name=225156 style="display: none;">[Topic 225156]</a></p>
	<h5 id="t234319" class="heading5">DatabaseVersionICAPHeader</h5>
<p class="bodytext">Specifies the name of the response header field that contains information about the anti-virus database version used by Kaspersky Scan Engine to scan objects.</p>
<p class="bodytext">This element is optional.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; DatabaseVersionICAPHeader</code></p>
<p class="introheading">Value</p>
<p class="bodytext">The value must consist of characters allowed for header field names according to <a class="hyperlinktemplate" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" target="_blank">RFC 7230</a>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;DatabaseVersionICAPHeader&gt;X-AV-Database-time&lt;/DatabaseVersionICAPHeader&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221147"><p><a name=221147 style="display: none;">[Topic 221147]</a></p>
	<h5 id="t234508" class="heading5">SendInfectionFoundICAPHeader</h5>
<p class="bodytext">Specifies whether Kaspersky Scan Engine includes the <code class="programcharacter"><a id="h221163" class="englishcrossreferencetemplate" href="#221159" target="_self">X-Infection-Found</a></code> header in its response to the ICAP client. </p>
<p class="bodytext">This is an optional element. If this element is absent from the configuration file, the <code class="programcharacter">0</code> value is used.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; SendInfectionFoundICAPHeader</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">SendInfectionFoundICAPHeader element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Include the <code class="programcharacter">X-Infection-Found</code> header in responses to the ICAP client.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Do not include the <code class="programcharacter">X-Infection-Found</code> header in responses to the ICAP client.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;SendInfectionFoundICAPHeader&gt;1&lt;/SendInfectionFoundICAPHeader&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221160"><p><a name=221160 style="display: none;">[Topic 221160]</a></p>
	<h5 id="t234509" class="heading5">SendResponseDescICAPHeader</h5>
<p class="bodytext">Specifies whether Kaspersky Scan Engine includes the <code class="programcharacter"><a id="h221163" class="englishcrossreferencetemplate" href="#221159" target="_self">X-Response-Desc</a></code> header in its response to the ICAP client. </p>
<p class="bodytext">This is an optional element. If this element is absent from the configuration file, the <code class="programcharacter">0</code> value is used.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; SendResponseDescICAPHeader</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">SendResponseDescICAPHeader element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Include the <code class="programcharacter">X-Response-Desc</code> header in responses to the ICAP client.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Do not include the <code class="programcharacter">X-Response-Desc</code> header in responses to the ICAP client.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;SendResponseDescICAPHeader&gt;1&lt;/SendResponseDescICAPHeader&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221161"><p><a name=221161 style="display: none;">[Topic 221161]</a></p>
	<h5 id="t234510" class="heading5">SendResponseInfoICAPHeader</h5>
<p class="bodytext">Specifies whether Kaspersky Scan Engine includes the <code class="programcharacter"><a id="h221163" class="englishcrossreferencetemplate" href="#221159" target="_self">X-Response-Info</a></code> header in its response to the ICAP client. </p>
<p class="bodytext">This is an optional element. If this element is absent from the configuration file, the <code class="programcharacter">0</code> value is used.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; SendResponseInfoICAPHeader</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">SendResponseInfoICAPHeader element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Include the <code class="programcharacter">X-Response-Info</code> header in responses to the ICAP client.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Do not include the <code class="programcharacter">X-Response-Info</code> header in responses to the ICAP client.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;SendResponseInfoICAPHeader&gt;1&lt;/SendResponseInfoICAPHeader&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221162"><p><a name=221162 style="display: none;">[Topic 221162]</a></p>
	<h5 id="t234511" class="heading5">SendViolationsFoundICAPHeader</h5>
<p class="bodytext">Specifies whether Kaspersky Scan Engine includes the <code class="programcharacter"><a id="h221163" class="englishcrossreferencetemplate" href="#221159" target="_self">X-Violations-Found</a></code> header in its response to the ICAP client. </p>
<p class="bodytext">This is an optional element. If this element is absent from the configuration file, the <code class="programcharacter">0</code> value is used.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; SendViolationsFoundICAPHeader</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">SendViolationsFoundICAPHeader element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Include the <code class="programcharacter">X-Violations-Found</code> header in responses to the ICAP client.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Do not include the <code class="programcharacter">X-Violations-Found</code> header in responses to the ICAP client.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;SendViolationsFoundICAPHeader&gt;1&lt;/SendViolationsFoundICAPHeader&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>
<p class="bodytext"></p>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200721"><p><a name=200721 style="display: none;">[Topic 200721]</a></p>
	<h5 id="t234494" class="heading5">ScanInReqMode</h5>
<p class="bodytext">Specifies the types of content that Kaspersky Scan Engine must scan in request modification (REQMOD) mode.</p>
<p class="bodytext">This is an optional element. If this element is absent from the configuration file, the <code class="programcharacter">All</code> value is used.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; ScanInReqMode</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">ScanInReqMode element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">Content</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Only scan the HTTP message body.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">Url</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Only scan the requested URL.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">All</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Scan the HTTP message body and the requested URL.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Empty value</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Do not scan HTTP messages in request modification (REQMOD) mode.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ScanInReqMode&gt;All&lt;/ScanInReqMode&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200722"><p><a name=200722 style="display: none;">[Topic 200722]</a></p>
	<h5 id="t234495" class="heading5">ScanInRespMode</h5>
<p class="bodytext">Specifies the types of content that Kaspersky Scan Engine must scan in response modification (RESPMOD) mode.</p>
<p class="bodytext">This is an optional element. If this element is absent from the configuration file, the <code class="programcharacter">All</code> value is used.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; ScanInRespMode</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">ScanInRespMode element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">Content</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Only scan the HTTP message body.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">Url</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Only scan the requested URL.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">All</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Scan the HTTP message body and the requested URL.</p>
<p class="tablebodytext">This value is default.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Empty value</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Do not scan HTTP messages in response modification (RESPMOD) mode.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ScanInRespMode&gt;All&lt;/ScanInRespMode&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201153"><p><a name=201153 style="display: none;">[Topic 201153]</a></p>
	<h5 id="t234483" class="heading5">RulesFilePath</h5>
<p class="bodytext">Specifies an absolute path to a file that contains <a id="h180152" class="englishcrossreferencetemplate" href="#179893" target="_self">service action rules</a>.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; RulesFilePath</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The default value is <code class="programcharacter">/opt/kaspersky/ScanEngine/icap_data/kavicapd_gui_rules.conf</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;RulesFilePath&gt;<code class="programcharacter">/opt/kasper</code>sky/ScanEngine/icap_data/kavicapd_gui_rules.conf&lt;/RulesFilePath&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201154"><p><a name=201154 style="display: none;">[Topic 201154]</a></p>
	<h5 id="t234297" class="heading5">CmdPath</h5>
<p class="bodytext">Specifies an absolute path to a directory containing scripts that can be executed when the corresponding rules are triggered.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; CmdPath</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The default value is <code class="programcharacter">/opt/kaspersky/ScanEngine/icap_data/scripts</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;CmdPath&gt;<code class="programcharacter">/opt/kasper</code>sky/ScanEngine/icap_data/scripts&lt;/CmdPath&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201155"><p><a name=201155 style="display: none;">[Topic 201155]</a></p>
	<h5 id="t234482" class="heading5">ResponsesPath</h5>
<p class="bodytext">Specifies an absolute path to a directory containing response templates that can be executed when the corresponding rules are triggered.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; ResponsesPath</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The default value is <code class="programcharacter">/opt/kaspersky/ScanEngine/icap_data/templates</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ResponsesPath&gt;<code class="programcharacter">/opt/kasper</code>sky/ScanEngine/icap_data/templates&lt;/ResponsesPath&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201208"><p><a name=201208 style="display: none;">[Topic 201208]</a></p>
	<h5 id="t234538" class="heading5">TransferBeforeScanEnding</h5>
<p class="bodytext">Specifies Partial mode (Data Trickling) for the files that are sent to the proxy server. This mode allows the scanning of files as a whole and partially sending them to a user before the scan is finished. Object transferring starts after as many seconds after the object receiving starts as specified in the <code class="programcharacter">Delay</code> attribute and is performed in chunks. Notice that no more than one chunk per second is transferred. This feature is necessary to prevent a user's browser from interrupting the connection to the proxy server due to the timeout.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; TransferBeforeScanEnding</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has the following attributes.</p>
<p class="tablename">TransferBeforeScanEnding element attributes</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Attribute</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">Delay</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">The interval (in seconds) between the start of receiving an object and the start of sending its first chunk.</p>
<p class="tablebodytext">Optional attribute. The range of possible values is from 1 to 3600.</p>
<p class="tablebodytext">The preset value is <code class="programcharacter">10</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">ChunkSize</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Size of the transferred chunks in the period between the start of receiving the object and the end of scanning. Since chunks are transferred no more than one per second, <code class="programcharacter">ChunkSize</code> specifies the maximum transfer speed (in kilobytes per second) until the scan is completed. After that, if the object is clean, the rest of the object transfers without a speed limit.</p>
<p class="tablebodytext">Optional attribute. The range of possible values is from 1 to 1024.</p>
<p class="tablebodytext">The preset value is <code class="programcharacter">4</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">BlockedUrlCacheEnabled</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="bodytext">Specifies how re-download attempts from a user's browser must be handled in the Partial mode. This feature is necessary to prevent a user's browser from automatically re-downloading the blocked files. The re-downloading prevention mechanism works only when the <code class="programcharacter">TransferBeforeScanEnding</code> option is enabled.</p>
<p class="bodytext">You can specify one of the following values for the attribute:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">0</code><p class="listcontinue1">Re-downloading prevention mechanism is disabled.</p>
</li><li class="listbullet1"><code class="programcharacter">1</code><p class="listcontinue1">Re-downloading prevention mechanism is enabled. This value is preset.</p>
</li></ul><p class="bodytext">If this attribute is omitted, the re-downloading prevention mechanism is enabled.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">BlockedUrlCacheKb</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Maximum cache size for blocked URLs, in KB. This is the maximum amount of RAM that can be allocated for a blocked URL's cache.</p>
<p class="tablebodytext">The range of possible values is from 1 to 100000.</p>
<p class="tablebodytext">The preset value is <code class="programcharacter">5000</code>.</p>
<p class="tablebodytext">If this attribute is omitted, the preset value is used.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">BlockedUrlCacheTtlSec</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Lifetime for blocked URLs in the cache, in seconds.</p>
<p class="tablebodytext">The range of possible values is from 1 to 604800 (one week).</p>
<p class="tablebodytext">The preset value is <code class="programcharacter">1800</code>.</p>
<p class="tablebodytext">If this attribute is omitted, the preset value is used.</p>
</td>
</tr>

</table>
<p class="bodytext">Choose the appropriate values for the <code class="programcharacter">ChunkSize</code> and the <code class="programcharacter">Delay</code> attributes. Therefore, it is not recommended to specify a too large <code class="programcharacter">ChunkSize</code> value and a too small <code class="programcharacter">Delay</code> value. If this recommendation is not followed, the scanned object can be sent almost wholly (without the last chunk) long before the end of the scan and the user's browser will interrupt the connection.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">TransferBeforeScanEnding element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">0</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">The file is sent only after the scanning ends.</p>
<p class="tablebodytext">This value is preset.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">1</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">The file can be sent before the scanning ends.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;TransferBeforeScanEnding Delay=&quot;10&quot; ChunkSize=&quot;4&quot; BlockedURLCacheEnabled=&quot;1&quot; BlockedURLCacheKb=&quot;5000&quot; BlockedURLCacheTtlSec=&quot;1800&quot;&gt;1&lt;/TransferBeforeScanEnding&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200729"><p><a name=200729 style="display: none;">[Topic 200729]</a></p>
	<h5 id="t234354" class="heading5">Exclusions</h5>
<p class="bodytext">Specifies the rules for the preview mode. This feature allows the ICAP client to send preview requests to the ICAP server, and then not to scan the objects that are not considered malicious.</p>
<p class="bodytext">If at least one of these parameters is specified, the ICAP plug-in will process requests in the preview mode. To allow a proxy server to send requests in this mode, change its settings accordingly. </p>
<p class="attentionbody">Notice that If you turn on preview mode in the ICAP plug-in, but not in the proxy server, Kaspersky Scan Engine will process HTTP requests as if preview mode is not enabled.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; Exclusions</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h200816" class="englishcrossreferencetemplate" href="#200813" target="_self">ContentSize</a></li><li class="listbullet1"><a id="h200817" class="englishcrossreferencetemplate" href="#200814" target="_self">ContentType</a></li><li class="listbullet1"><a id="h200818" class="englishcrossreferencetemplate" href="#200815" target="_self">RequestURL</a></li></ul><p class="bodytext">If the object to scan complies with at least one of the rules above, the ICAP plug-in returns the code <code class="programcharacter">204</code>, regardless of the value that the <code class="programcharacter">Allow204</code> parameter of the kavicapd.xml file contains. If the object to scan does not comply with any of the rules, the ICAP plug-in returns the error code <code class="programcharacter">100,</code> and then waits for the ICAP client to send this object.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;Exclusions&gt;</p>
<p class="program2">&lt;ContentSize&gt;2048&lt;/ContentSize&gt;</p>
<p class="program2">&lt;ContentType&gt;video/mp4&lt;/ContentType&gt; </p>
<p class="program2">&lt;RequestURL&gt;example.com&lt;/RequestURL&gt;</p>
<p class="program">&lt;/Exclusions&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200813"><p><a name=200813 style="display: none;">[Topic 200813]</a></p>
	<h6 id="t234311" class="heading6">ContentSize</h6>
<p class="bodytext">The exclusion rule for the size (KB) of the transmitted object.</p>
<p class="bodytext">You can set this parameter only once. This parameter may be absent if you explicitly omitted it.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; Exclusions &gt; ContentSize</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">If the <code class="programcharacter">Content-Length</code> header is present in the HTTP request, <code class="programcharacter">ContentSize</code> is compared to its value. Otherwise, <code class="programcharacter">ContentSize</code> is compared to the real size of the object. If any of these values are equal to or greater than the <code class="programcharacter">ContentSize</code> value, the ICAP plug-in does not scan this object. This applies both to requests made in preview mode and regular requests.</p>
<p class="bodytext">If you specify the value for the <code class="programcharacter">ContentSize</code> parameter, Kaspersky Scan Engine will use it instead of the value of <code class="programcharacter"><a id="h201198" class="englishcrossreferencetemplate" href="#200719" target="_self">ScanMaxFileSize</a></code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ContentSize&gt;2048&lt;/ContentSize&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200814"><p><a name=200814 style="display: none;">[Topic 200814]</a></p>
	<h6 id="t234312" class="heading6">ContentType</h6>
<p class="bodytext">The exclusion rule for the object type that is specified in the <code class="programcharacter">Content-Type</code> field.</p>
<p class="bodytext">You can set this parameter one or more times. The ICAP plug-in will check all of these parameters. This parameter may be absent if you explicitly omitted it.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; Exclusions &gt; ContentType</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">If the <code class="programcharacter">Content-Type</code> field contains the value that is specified at the <code class="programcharacter">ContentType</code> element, the ICAP plug-in does not scan this object. </p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;ContentType&gt;video/mp4&lt;/ContentType&gt; </p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200815"><p><a name=200815 style="display: none;">[Topic 200815]</a></p>
	<h6 id="t234479" class="heading6">RequestURL</h6>
<p class="bodytext">URL to skip.</p>
<p class="bodytext">You can set this parameter one or more times. The ICAP plug-in will check all of these parameters. </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; Exclusions &gt; RequestURL</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">The specified URL must not include scheme, query, and fragment components. If the requested URL matches with at least one of the <code class="programcharacter">RequestURL</code> element values, the ICAP plug-in does not scan this URL. Before matching the requested URL with the rule value from the <code class="programcharacter">RequestURL</code> field, the ICAP plug-in applies normalizing rules to this URL.</p>
<p class="bodytext">The <code class="programcharacter">RequestURL</code> parameter may contain masks.</p>
<p class="bodytext">You can specify the asterisk (*) wildcard character as a substitute for a sequence of characters that constitute an entire domain name from the third level of the domain and above. For example, <code class="programcharacter">*.domain.com</code>. This value includes all subdomains of <code class="programcharacter">domain.com</code>.</p>
<p class="bodytext">The asterisk (*) and question mark (?) wildcard characters can be used in a path component of the URL to substitute for any sequence of characters, or a single character, respectively. For example, <code class="programcharacter">domain.com/test/page/*</code>.</p>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;RequestURL&gt;example.com&lt;/RequestURL&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201163"><p><a name=201163 style="display: none;">[Topic 201163]</a></p>
	<h5 id="t234588" class="heading5">USR1SignalAction</h5>
<p class="bodytext">Specifies an action that must be performed on receiving the <code class="programcharacter">SIGUSR1</code> signal.</p>
<p class="bodytext">If this parameter is not specified in the configuration file, the ICAP service updates the database on receiving the signal.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; USR1SignalAction</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">USR1SignalAction element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">reload</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Reloads the database without updating it. It is assumed that the files in the database directory are already up to date and must be reloaded.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">update</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Updates and reloads the database by using the built-in functionality of Kaspersky Scan Engine.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">reopen-log</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Closes all log files in the syslog format that are being opened, then opens them again for writing logs at the end of these files. If the files are missed, the ICAP plug-in will create them. This setting allows rotating logs by using the logrotate utility in default mode or when the create directive is used.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;USR1SignalAction&gt;update&lt;/USR1SignalAction&gt; </p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201164"><p><a name=201164 style="display: none;">[Topic 201164]</a></p>
	<h5 id="t234589" class="heading5">USR2SignalAction</h5>
<p class="bodytext">Specifies an action that must be performed on receiving the <code class="programcharacter">SIGUSR2</code> signal.</p>
<p class="bodytext">If this parameter is not specified in the configuration file, the ICAP service updates the database on receiving the signal.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; USR2SignalAction</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Possible values</p>
<p class="bodytext">This element has the following possible values.</p>
<p class="tablename">USR2SignalAction element possible values</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">reload</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Reloads the database without updating it. It is assumed that the files in the database directory are already up to date and must be reloaded.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">update</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Updates and reloads the database by using the built-in functionality of Kaspersky Scan Engine.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">reopen-log</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Closes all log files in syslog format that are being opened, then opens them again for writing logs at the end of these files. If the files are missed, the ICAP plug-in will create them. This setting allows rotating the logs by using the logrotate utility in default mode or when the create directive is used.</p>
</td>
</tr>

</table>
<p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;USR2SignalAction&gt;reopen-log&lt;/USR2SignalAction&gt; </p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="200730"><p><a name=200730 style="display: none;">[Topic 200730]</a></p>
	<h5 id="t234436" class="heading5">LoggingConfigFilePath</h5>
<p class="bodytext">Specifies the path to the logging configuration file.</p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">ICAPSettings &gt; LoggingConfigFilePath</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Value</p>
<p class="bodytext">You can use the logging configuration file located in the kavicapd binary file directory or place this file in any other directory:</p>
<ul class="listbullet1"><li class="listbullet1">To use the logging configuration file located in the kavicapd binary file directory, leave the value of the <code class="programcharacter">LoggingConfigFilePath</code> element empty.</li><li class="listbullet1">To place the logging configuration file in any other directory, specify the path to this file. Notice that the service interprets this value as the path to the file, not the path to the directory. Also, you can specify the path relative to the directory that holds kavicapd executable file.</li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of this element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;!-- The path to the logging configuration file. Only this file will be used as the ICAP logging configuration file. If the LoggingConfigFilePath element has an empty value, the icapdkavlog.conf file located in the kavicapd binary file directory is used. --&gt;</p>
<p class="program">&lt;LoggingConfigFilePath&gt;&lt;/LoggingConfigFilePath&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="206616"><p><a name=206616 style="display: none;">[Topic 206616]</a></p>
	<h4 id="t234366" class="heading4">FormatRecognizerSettings</h4>
<p class="bodytext">Specifies Format Recognizer settings. </p>
<p class="introheading">Path</p>
<p class="bodytext"><code class="programcharacter">FormatRecognizerSettings</code></p>
<p class="introheading">Attributes</p>
<p class="bodytext">This element has no attributes.</p>
<p class="spacer"></p>
<p class="spacer"></p>
<p class="introheading">Nested elements</p>
<p class="bodytext">This element is a container for the following nested elements:</p>
<ul class="listbullet1"><li class="listbullet1"><em class="emphasischaracter">FormatsToSkipScanning</em><p class="listcontinue1">Specifies which <a id="h180224" class="englishcrossreferencetemplate" href="#180222" target="_self">file formats</a> must not be scanned by Kaspersky Scan Engine in ICAP mode.</p>
<p class="listcontinue1">To disable the format skipping functionality, remove the <code class="programcharacter">FormatRecognizerSettings</code> section from the configuration file or leave the <code class="programcharacter">FormatsToSkipScanning</code> list empty.</p>
</li></ul><p class="introheading">Example</p>
<p class="bodytext">The following is an example of a <em class="emphasischaracter">FormatRecognizerSettings</em> element.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;FormatRecognizerSettings&gt;</p>
<p class="program2">&lt;FormatsToSkipScanning&gt;</p>
<p class="program3">&lt;KAV_FF_GENERAL_TXT/&gt;</p>
<p class="program3">&lt;KAV_FF_GENERAL_CSV/&gt;</p>
<p class="program3">&lt;KAV_FF_AUDIO_WMA/&gt;</p>
<p class="program2">&lt;/FormatsToSkipScanning&gt;</p>
<p class="program">&lt;/FormatRecognizerSettings&gt;</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="206590"><p><a name=206590 style="display: none;">[Topic 206590]</a></p>
	<h3 id="t234300" class="heading3">Configuring Format Recognizer for use in ICAP mode</h3>
<p class="bodytext">Format Recognizer is a component that can be used in Kaspersky Scan Engine to recognize and skip files of certain formats during the scanning process. Skipping files increases the processing speed of Kaspersky Scan Engine.</p>
<p class="introheading">Enabling Format Recognizer</p>
<p class="procedureheading">To enable Format Recognizer:</p>
<ol class="listnumber1"><li class="listnumber1">In the <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">ICAP mode configuration file</a>, locate the <code class="programcharacter">FormatRecognizerSettings</code> section.<p class="listcontinue1">If this section is missing, add it manually as follows:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;FormatRecognizerSettings&gt;</p>
<p class="program">...</p>
<p class="program">&lt;/FormatRecognizerSettings&gt;  </p>
</td>
</tr>

</table>
</li><li class="listnumber1">Within this section, in the <code class="programcharacter">FormatsToSkipScanning</code> list, specify which <a id="h180224" class="englishcrossreferencetemplate" href="#180222" target="_self">file formats</a> must not be scanned by Kaspersky Scan Engine, as follows:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;FormatRecognizerSettings&gt;</p>
<p class="program2">&lt;FormatsToSkipScanning&gt;</p>
<p class="program3">&lt;KAV_FF_GENERAL_TXT/&gt;</p>
<p class="program3">...</p>
<p class="program3">&lt;KAV_FF_AUDIO_WMA/&gt;</p>
<p class="program2">&lt;/FormatsToSkipScanning&gt;</p>
<p class="program">&lt;/FormatRecognizerSettings&gt;</p>
</td>
</tr>

</table>
</li><li class="listnumber1">For the changes to take effect, restart the <code class="programcharacter">kavicapd</code> service with the following command:<p class="listcontinue1"><code class="programcharacter">service kavicapd restart</code></p>
</li></ol><p class="bodytext">Format Recognizer will start recognizing and skipping files of the formats specified in the <code class="programcharacter">FormatsToSkipScanning</code> list. Kaspersky Scan Engine will not scan the skipped files, which will increase its processing speed.</p>
<p class="introheading">Disabling Format Recognizer</p>
<p class="procedureheading">To disable Format Recognizer:</p>
<ol class="listnumber1"><li class="listnumber1">In the <a id="h180154_2" class="englishcrossreferencetemplate" href="#192989" target="_self">ICAP mode configuration file</a>, remove the <code class="programcharacter">FormatRecognizerSettings</code> section or leave the <code class="programcharacter">FormatsToSkipScanning</code> list empty.</li><li class="listnumber1">For the changes to take effect, restart the <code class="programcharacter">kavicapd</code> service with the following command:<p class="listcontinue1"><code class="programcharacter">service kavicapd restart</code></p>
</li></ol><p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179893"><p><a name=179893 style="display: none;">[Topic 179893]</a></p>
	<h3 id="t234307" class="heading3">Configuring service rules</h3>
<p class="bodytext">Rules define the behavior of Kaspersky Scan Engine in ICAP mode. These rules are listed in a service rules configuration file located in the <code class="programcharacter">/opt/kaspersky/ScanEngine/icap_data/</code> directory. The location of this file is specified in the <code class="programcharacter">RulesFilePath</code> parameter of the <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">ICAP mode configuration file</a>. A sample configuration file, kavicapd_gui_rules.conf, is included in the distribution kit.</p>
<p class="attentionbody">Each rule listed in the configuration file must be placed on a separate line.</p>
<p class="introheading">Rule syntax</p>
<p class="bodytext">A <code class="programcharacter">kavicapd</code> service rule consists of three parts:</p>
<ul class="listbullet1"><li class="listbullet1">ICAP mode<p class="listcontinue1">Possible values: </p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">REQ</code><p class="listcontinue2">Request modification (REQMOD) mode</p>
</li><li class="listbullet2"><code class="programcharacter">RESP</code><p class="listcontinue2">Response modification (RESPMOD) mode</p>
</li><li class="listbullet2"><code class="programcharacter">ANY</code><p class="listcontinue2">Any of the modes listed above</p>
</li></ul></li><li class="listbullet1">Scan result<p class="listcontinue1">Possible values are listed below.</p>
<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">NON_SCANNED</code><p class="listcontinue2">The object was not scanned.</p>
</li><li class="listbullet2"><code class="programcharacter">FAILED</code><p class="listcontinue2">Scan failed.</p>
</li><li class="listbullet2"><code class="programcharacter">PHISHING</code><p class="listcontinue2">A phishing web address is detected.</p>
</li><li class="listbullet2"><code class="programcharacter">DETECT</code><p class="listcontinue2">The scanned object or URL is infected.</p>
</li><li class="listbullet2"><code class="programcharacter">MACRO</code><p class="listcontinue2">A Microsoft Office document containing a macro is detected.</p>
</li><li class="listbullet2"><code class="programcharacter">CLEAN</code><p class="listcontinue2">The scanned object is clean (non-infected).</p>
</li></ul></li><li class="listbullet1">Response of Kaspersky Scan Engine in ICAP mode<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">SET_RESP=&lt;response_template&gt;</code><p class="listcontinue2">Kaspersky Scan Engine sends an HTML <a id="h180188" class="englishcrossreferencetemplate" href="#179895" target="_self">response template</a> with the specified name to a proxy server.</p>
</li><li class="listbullet2"><code class="programcharacter">EXEC_CMD=&lt;script&gt;</code><p class="listcontinue2">Kaspersky Scan Engine executes a script with the specified name.</p>
</li><li class="listbullet2"><code class="programcharacter">NONE</code><p class="listcontinue2">Kaspersky Scan Engine does not modify the scanned object.</p>
</li></ul><p class="listcontinue1">If the Kaspersky Scan Engine response is not specified in a rule, the default value of <code class="programcharacter">NONE</code> is used. </p>
</li></ul><p class="introheading">Understanding scan results</p>
<p class="bodytext">In ICAP mode, Kaspersky Scan Engine scans both HTTP traffic and web addresses requested by users. Scan results are ranked by severity, with the most severe result having the rank of <code class="programcharacter">1</code>. The following list shows the ranking of supported scan results by severity:</p>
<ol class="listnumber1"><li class="listnumber1"><code class="programcharacter">PHISHING</code></li><li class="listnumber1"><code class="programcharacter">DETECT</code></li><li class="listnumber1"><code class="programcharacter">MACRO</code></li><li class="listnumber1"><code class="programcharacter">NON_SCANNED</code></li><li class="listnumber1"><code class="programcharacter">FAILED</code></li><li class="listnumber1"><code class="programcharacter">CLEAN</code></li></ol><p class="bodytext">If a traffic scan and a URL scan produce different scan results, the result with the highest severity level is chosen as the summary scan result. If both scan results are <code class="programcharacter">DETECT</code>, the summary scan result is also <code class="programcharacter">DETECT</code>, and the name of the detected object returned by Kaspersky Scan Engine is taken from the result of a URL scan. The scan results used in service rules are summary scan results.</p>
<p class="introheading">Sample rules</p>
<p class="bodytext">Below are a few sample rules that you can specify:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">RESP DETECT SET_RESP=detect_resp EXEC_CMD=admin_notify</p>
<p class="program">RESP FAILED SET_RESP=err_resp</p>
<p class="program">REQ FAILED EXEC_CMD=admin_notify</p>
<p class="program">REQ CLEAN</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192475"><p><a name=192475 style="display: none;">[Topic 192475]</a></p>
	<h3 id="t234295" class="heading3">Changing variables in the ICAP mode unit file</h3>
<p class="bodytext">You can configure Kaspersky Scan Engine by changing one or more variables in its unit file, <code class="programcharacter">%distr_kit%/etc/kavicapd.service</code>.</p>
<p class="introheading">Changing the path to the Kaspersky Scan Engine PID file</p>
<p class="bodytext">You can change this variable if you want to create a PID file of Kaspersky Scan Engine in a directory other than <code class="programcharacter">/var/run/kavicapd.pid</code>.</p>
<p class="bodytext">The following example shows how this variable is set in the unit file:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">PIDFile=/var/run/kavicapd.pid</p>
</td>
</tr>

</table>
<p class="introheading">Changing environment variables</p>
<p class="bodytext">You must change these environment variables if Kaspersky Scan Engine is located in a directory other than <code class="programcharacter">/opt/kaspersky/ScanEngine</code>.</p>
<p class="bodytext">The unit file uses the following environment variables:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">SDKPATH</code>&#8212;Specifies the directory where Kaspersky Scan Engine is located. The following example shows how this variable is set in the unit file:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">Environment=SDKPATH=/opt/kaspersky/ScanEngine</p>
</td>
</tr>

</table>
</li><li class="listbullet1"><code class="programcharacter">KL_PLUGINS_PATH</code>&#8212;Specifies the path to the directory containing the PPL plug-in files used by Kaspersky Scan Engine. The following example shows how this variable is set in the unit file:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">Environment=KL_PLUGINS_PATH=/ppl</p>
</td>
</tr>

</table>
</li><li class="listbullet1"><code class="programcharacter">LD_LIBRARY_PATH</code>&#8212;Specifies the path to the directory containing shared libraries used by Kaspersky Scan Engine. The following block shows how this variable is set in the unit file:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">Environment=LD_LIBRARY_PATH=/lib:/ppl</p>
</td>
</tr>

</table>
</li></ul><p class="introheading">Changing paths in the command executed on kavicapd startup</p>
<p class="bodytext">You must change paths in the command executed on kavicapd startup if you put the <code class="programcharacter">kavicapd</code> executable file or the ICAP mode configuration file in directories different from the ones specified in the unit file, or if you want to create a PID file of Kaspersky Scan Engine in a directory other from <code class="programcharacter">/var/run/kavicapd.pid</code>.</p>
<p class="bodytext">The following example shows how this command is set in the unit file:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">ExecStart=/bin/sh -c 'cd ${SDKPATH}/bin; ./kavicapd -c /etc/kavicapd.xml -p /var/run/kavicapd.pid'</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179895"><p><a name=179895 style="display: none;">[Topic 179895]</a></p>
	<h3 id="t234596" class="heading3">Working with response templates and scripts</h3>
<p class="bodytext">Rules allow you to specify response templates that can be returned in place of blocked web pages, and to specify scripts that can be executed upon detection, for example, to notify the system administrator. </p>
<p class="bodytext">The Kaspersky Scan Engine distribution package contains sample response templates and a sample script that sends information about an incident to <code class="programcharacter">syslog</code>.</p>
<p class="introheading">Working with response templates</p>
<p class="bodytext">Kaspersky Scan Engine is shipped with the following sample response templates located in the <code class="programcharacter">/opt/kaspersky/ScanEngine/icap_data/templates</code> directory: </p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">detect_req</code> <p class="listcontinue1">This template is returned when a threat or a type of legitimate software that can be used by intruders to damage a user's computer or personal data is detected in request modification (REQMOD) mode. </p>
</li><li class="listbullet1"><code class="programcharacter">detect_res</code> <p class="listcontinue1">This template is returned when a threat or a type of legitimate software that can be used by intruders to damage a user's computer or personal data is detected in response modification (RESPMOD) mode.</p>
</li><li class="listbullet1"><code class="programcharacter">macro_req</code><p class="listcontinue1">This template is returned when a Microsoft Office document file that contains a macro is detected in the request modification (REQMOD) mode.</p>
</li><li class="listbullet1"><code class="programcharacter">macro_resp</code><p class="listcontinue1">This template is returned when a Microsoft Office document file that contains a macro is detected in the response modification (RESPMOD) mode.</p>
</li></ul><p class="bodytext">You can create custom response templates and <a id="h180152" class="englishcrossreferencetemplate" href="#179893" target="_self">configure Kaspersky Scan Engine to return them with the modified message</a>. Like sample response templates, custom response templates can use a detection context that provides additional information to a user. For more information on the detection context, see subsection &quot;Using the detection context in response templates and scripts&quot; below.</p>
<p class="attentionbody">Even though Kaspersky Scan Engine returns response templates in place of blocked web pages, some browsers may not display these templates, returning a <code class="programcharacter">403</code> <code class="programcharacter">Forbidden</code> HTTP status code instead.</p>
<p class="introheading">Working with scripts</p>
<p class="bodytext">Kaspersky Scan Engine is shipped with a <code class="programcharacter">send_syslog</code> script located in the /opt/kaspersky/ScanEngine/icap_data/scripts directory.</p>
<p class="bodytext">The <code class="programcharacter">send_syslog</code> script displays a message about a detected object and redirects the message to <code class="programcharacter">logger</code>. </p>
<p class="bodytext">You can create custom shell scripts and <a id="h180152_2" class="englishcrossreferencetemplate" href="#179893" target="_self">configure Kaspersky Scan Engine to execute them upon detection</a>. Like the sample script, custom scripts can use the detection context that provides additional information to a user. For more information on the detection context, see subsection &quot;Using the detection context in response templates and scripts&quot; below.</p>
<p class="bodytext">Custom scripts run in parallel threads. The maximum number of these threads is 100.</p>
<p class="introheading">Using the detection context in response templates and scripts</p>
<p class="bodytext">Response templates and scripts support the detection context. When a response template is displayed, context variables are replaced with values returned by Kaspersky Scan Engine. To use the detection context in a script, reference context variables as environment variables.</p>
<p class="bodytext">The following variables are supported in the detection context:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">_VirusName_</code>&#8212;Name of the detected object.</li><li class="listbullet1"><code class="programcharacter">_DateTime_</code>&#8212;Date and time of the incident (in the <code class="programcharacter">YYYY-MM-DD HH:MM:MS</code> format).</li><li class="listbullet1"><code class="programcharacter">_ICAPDVersion_</code>&#8212;Version of the ICAP plug-in. </li><li class="listbullet1"><code class="programcharacter">_URL_</code>&#8212;Requested URL.</li></ul><p class="bodytext">You can use the detection context in custom response templates and scripts.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179897"><p><a name=179897 style="display: none;">[Topic 179897]</a></p>
	<h3 id="t234520" class="heading3">Specifying paths to plug-ins and libraries</h3>
<p class="bodytext">Before the <code class="programcharacter">kavicapd</code> service is ready to run, the following paths must be specified:</p>
<ul class="listbullet1"><li class="listbullet1">Plug-in path<p class="listcontinue1">Path to a directory with PPL plug-in files.</p>
</li><li class="listbullet1">Library path<p class="listcontinue1">Path to a directory with shared libraries.</p>
</li></ul><p class="bodytext">The paths to plug-ins and shared libraries can be specified by exporting the <code class="programcharacter">KL_PLUGINS_PATH</code> and <code class="programcharacter">LD_LIBRARY_PATH</code> environment variables, respectively.</p>
<p class="bodytext">The <code class="programcharacter">KL_PLUGINS_PATH</code> and <code class="programcharacter">LD_LIBRARY_PATH</code> variables can be exported manually, or automatically by using the ICAP systemd unit file. You can also use the kavicapd.sh shell script, which exports <code class="programcharacter">KL_PLUGINS_PATH</code> and <code class="programcharacter">LD_LIBRARY_PATH</code> and starts the <code class="programcharacter">kavicapd</code> service.</p>
<p class="introheading">Specifying the path to plug-ins and libraries manually</p>
<p class="bodytext">This method requires exporting the variables each time before you start the <code class="programcharacter">kavicapd</code> service in a new session (the variables only exist during the current shell session). </p>
<p class="bodytext">The following example shows how to export the variables manually:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">[user@host ~]$ export KL_PLUGINS_PATH=&quot;/opt/kaspersky/ScanEngine/ppl&quot;</p>
<p class="program">[user@host&nbsp;~]$&nbsp;export&nbsp;LD_LIBRARY_PATH=&quot;/opt/kaspersky/ScanEngine/lib:${KL_PLUGINS_PATH}:${LD_LIBRARY_PATH}&quot;</p>
</td>
</tr>

</table>
<p class="spacer"></p>
<p class="introheading">Specifying the path to plug-ins and libraries with the kavicapd.sh shell script</p>
<p class="bodytext">You can modify kavicapd.sh so that it exports the variables automatically. </p>
<p class="procedureheading">To export the variables by means of the kavicapd.sh shell script:</p>
<ol class="listnumber1"><li class="listnumber1">Open kavicapd.sh for editing and locate the following lines:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">SDK_PATH=$PWD/../../../..</p>
<p class="program">KL_PLUGINS_PATH=$SDK_PATH/ppl</p>
<p class="program">LD_LIBRARY_PATH=$SDK_PATH/lib:$KL_PLUGINS_PATH:$LD_LIBRARY_PATH </p>
</td>
</tr>

</table>
</li><li class="listnumber1">Change the values of <code class="programcharacter">SDKPATH</code>, <code class="programcharacter">KL_PLUGINS_PATH</code>, and <code class="programcharacter">LD_LIBRARY_PATH</code> to point to the location of the KAV SDK directory, plug-in directory, and libraries directory, respectively.</li></ol><p class="bodytext">The kavicapd.sh shell script will export the variables when it is executed.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192990"><p><a name=192990 style="display: none;">[Topic 192990]</a></p>
	<h2 id="t234489" class="heading2">Running Kaspersky Scan Engine in ICAP mode</h2>
<p class="bodytext">This section describes how to run Kaspersky Scan Engine in ICAP mode.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#192397" target="_self">Running Kaspersky Scan Engine in ICAP mode with the systemd unit file</a></p><p class="relateditem"><a href="#179900" target="_self">Running Kaspersky Scan Engine in ICAP mode manually</a></p><p class="relateditem"><a href="#179901" target="_self">Running Kaspersky Scan Engine in ICAP mode with kavicapd shell script</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192397"><p><a name=192397 style="display: none;">[Topic 192397]</a></p>
	<h3 id="t234492" class="heading3">Running Kaspersky Scan Engine in ICAP mode with the systemd unit file</h3>
<p class="bodytext">You can run the Kaspersky Scan Engine in ICAP mode by using the kavicapd.service unit file for <code class="programcharacter">systemd</code>. The unit file allows you to add the kavicapd service to the service startup list and to manage the service manually from the command line.</p>
<p class="attentionbody">This section assumes that you want to add the kavicapd service for all users. For information on how to add and manage a service under a specific user, please see the official documentation for <code class="programcharacter">systemd</code> and <code class="programcharacter">systemctl</code>.</p>
<p class="introheading">Starting Kaspersky Scan Engine automatically</p>
<p class="bodytext">To start Kaspersky Scan Engine automatically, add kavicapd to the service startup list.</p>
<p class="procedureheading">To add kavicapd to the service startup list:</p>
<ol class="listnumber1"><li class="listnumber1">Place the kavicapd.service unit file in the <code class="programcharacter">/etc/systemd/system/</code> directory.</li><li class="listnumber1">If necessary, <a id="h192507" class="englishcrossreferencetemplate" href="#192475" target="_self">edit the unit file</a>.</li><li class="listnumber1">Reload <code class="programcharacter">systemd</code> by running the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl daemon-reload</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Make sure that the kavicapd.service unit file is installed by running the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl list-unit-files</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Enable kavicapd to launch when the system starts by running the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl enable kavicapd.service</p>
</td>
</tr>

</table>
</li></ol><p class="introheading">Getting the status of the kavicapd service</p>
<p class="bodytext">To get the status of the kavicapd service, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">service kavicapd status</p>
</td>
</tr>

</table>
<p class="introheading">Remove Kaspersky Scan Engine from the service startup list</p>
<p class="bodytext">To remove kavicapd from the service startup list, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl disable kavicapd.service</p>
</td>
</tr>

</table>
<p class="introheading">Managing Kaspersky Scan Engine with systemd from the terminal</p>
<p class="bodytext">To start kavicapd without rebooting the computer, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl start kavicapd</p>
</td>
</tr>

</table>
<p class="bodytext">To stop kavicapd without rebooting the computer, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl stop kavicapd</p>
</td>
</tr>

</table>
<p class="bodytext">To update the anti-virus database, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl reload kavicapd</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179900"><p><a name=179900 style="display: none;">[Topic 179900]</a></p>
	<h3 id="t234490" class="heading3">Running Kaspersky Scan Engine in ICAP mode manually</h3>
<p class="bodytext">You can run the <code class="programcharacter">kavicapd</code> service by executing the kavicapd binary file manually.</p>
<p class="bodytext">Before executing the file, make sure that the paths to the <a id="h180129" class="englishcrossreferencetemplate" href="#179897" target="_self">directories that contain plug-ins and libraries</a> are specified correctly.</p>
<p class="bodytext">The following options are available when the <code class="programcharacter">kavicapd</code> service is run manually:</p>
<p class="tablename">Options for running the kavicapd binary file</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="696" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="72"><p class="tableheading">Option</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="624"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="72"><p class="tablebodytext"><code class="programcharacter">-c &lt;path&gt;</code></p>
</td>
<td style="border:1px solid #010101;" width="624"><p class="tablebodytext">Mandatory parameter.</p>
<p class="tablebodytext">Specifies the path to the <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">ICAP mode configuration file</a>.</p>
<p class="tablebodytext">The path can be absolute or relative. The relative path is specified relative to the current working directory.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="72"><p class="tablebodytext"><code class="programcharacter">-p &lt;path&gt;</code></p>
</td>
<td style="border:1px solid #010101;" width="624"><p class="tablebodytext">Mandatory parameter.</p>
<p class="tablebodytext">Specifies the path to the PID file. </p>
<p class="tablebodytext">The path can be absolute or relative. The relative path is specified relative to the current working directory.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="72"><p class="tablebodytext"><code class="programcharacter">-w</code></p>
</td>
<td style="border:1px solid #010101;" width="624"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Runs the <code class="programcharacter">kavicapd</code> service in watchdog<code class="programcharacter"> </code>mode.</p>
<p class="tablebodytext">In this mode, the <code class="programcharacter">kavicapd</code> service automatically restarts if it freezes or crashes.</p>
</td>
</tr>

</table>
<p class="spacer"></p>
<p class="bodytext">If you execute the kavicapd binary file without specifying any option, the list of supported options is displayed.</p>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179901"><p><a name=179901 style="display: none;">[Topic 179901]</a></p>
	<h3 id="t234491" class="heading3">Running Kaspersky Scan Engine in ICAP mode with kavicapd shell script</h3>
<p class="bodytext">You can run the <code class="programcharacter">kavicapd</code> service by executing the <code class="programcharacter">/opt/kaspersky/ScanEngine/bin/kavicapd.sh</code> shell script manually. Before executing the script, make sure that the paths to the <a id="h180129" class="englishcrossreferencetemplate" href="#179897" target="_self">directories that contain plug-ins and libraries</a> are specified correctly.</p>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221159"><p><a name=221159 style="display: none;">[Topic 221159]</a></p>
	<h2 id="t234481" class="heading2">Response headers</h2>
<p class="introheading">X-Include</p>
<p class="bodytext">Kaspersky Scan Engine includes this header in its response to the OPTIONS request from the ICAP client when the following conditions are met:</p>
<ul class="listbullet1"><li class="listbullet1">There is at least one <a id="h225223" class="englishcrossreferencetemplate" href="#225222" target="_self">ICAPHeader</a> element and it contains either the <code class="programcharacter">HTTPUserNameICAPHeader</code> or <code class="programcharacter">HTTPClientIpICAPHeader</code> value:<ul class="listbullet2"><li class="listbullet2">If <code class="programcharacter">HTTPUserNameICAPHeader</code> is specified in <code class="programcharacter">ICAPHeader</code>, there must be the <a id="h201207" class="englishcrossreferencetemplate" href="#200727" target="_self">HTTPUserNameICAPHeader</a> element and it should not be empty.</li><li class="listbullet2">If <code class="programcharacter">HTTPClientIpICAPHeader</code> is specified in <code class="programcharacter">ICAPHeader</code>, there must be the <a id="h201206" class="englishcrossreferencetemplate" href="#200726" target="_self">HTTPClientIpICAPHeader</a> element and it should not be empty.</li></ul></li></ul><p class="bodytext">The <code class="programcharacter">X-Include</code> header includes headers specified in <code class="programcharacter">HTTPUserNameICAPHeader</code> and <code class="programcharacter">HTTPClientIpICAPHeader</code> as a comma-separated list. The default values for these headers are <code class="programcharacter">X-Client-Username</code> and <code class="programcharacter">X-Client-IP</code> respectively. The following is an example of the <code class="programcharacter">X-Include</code> header:</p>
<p class="bodytext"><code class="programcharacter">X-Include: X-Client-IP, X-Client-Username</code></p>
<p class="bodytext">The <code class="programcharacter">X-Include</code> header can also include only one of these headers, for example:</p>
<p class="bodytext"><code class="programcharacter">X-Include: X-Client-Username</code></p>
<p class="bodytext"><a id="h225224" class="englishcrossreferencetemplate" href="#225221" target="_self">RequestingICAPHeaders</a> specifies which headers are included in <code class="programcharacter">X-Include</code>.</p>
<p class="introheading">X-Infection-Found</p>
<p class="bodytext">This header contains types of the detected threats or legitimate objects that can be used by attackers. You can specify whether Kaspersky Scan Engine includes this header in its response in the <code class="programcharacter"><a id="h224483" class="englishcrossreferencetemplate" href="#221147" target="_self">SendInfectionFoundICAPHeader</a></code> element. The header will be present only if a threat or legitimate object that can be used by attackers is detected during scanning.</p>
<p class="bodytext">The header has the following format:</p>
<p class="program"><code class="programcharacter">X-Infection-Found: Type=0; Resolution=0; Threat={Threat_type};</code></p>
<p class="bodytext">Here, <code class="programcharacter">{Threat_type}</code> is the type of the threat or legitimate software that can be used by intruders. If Kaspersky Scan Engine detects several objects, all types are listed, separated by the comma symbol (<code class="programcharacter">,</code>).</p>
<p class="attentionbody">In the current version of Kaspersky Scan Engine, the values of <code class="programcharacter">Type</code> and <code class="programcharacter">Resolution</code> are always <code class="programcharacter">0</code>.</p>
<p class="introheading">X-Response-Desc</p>
<p class="bodytext">This header contains the descriptions of the detected threats or legitimate objects that can be used by attackers. You can specify whether Kaspersky Scan Engine includes this header in its response in the <code class="programcharacter"><a id="h224486" class="englishcrossreferencetemplate" href="#221160" target="_self">SendResponseDescICAPHeader</a></code> element. The header will be present only if a threat or legitimate object that can be used by attackers is detected during scanning.</p>
<p class="bodytext">The header has the following format:</p>
<p class="program">X-Response-Desc: {Text}</p>
<p class="bodytext">Here, <code class="programcharacter">{Text}</code> can have the following values:</p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Trojan malicious object detected</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">A Trojan was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Malicious tool detected</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Malware was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Highly dangerous malicious object detected</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">A highly dangerous malicious object that cannot be classified using either of available classes of malware was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Medium dangerous malicious object detected</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">A mediumly dangerous malicious object that cannot be classified using either of available classes of malware was detected. </p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Virware malicious object detected</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">A program that infects other files by adding its own code to them in order to gain control of the infected files when they are opened was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Malicious URL</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">A malicious URL was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Phishing URL</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">A phishing URL was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Malicious host</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">An IP address of a malicious host was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Adware URL</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">A URL that leads to adware was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Riskware URL</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">A URL that leads to legitimate software that can be used by intruders was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Adware host</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">An IP address of adware was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Riskware host</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">An IP address of a host that stores legitimate software that can be used by intruders was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Detected legitimate software that can be used by intruders to damage your computer or personal data</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">An application that has no malicious features but could be a part of the development environment for malicious programs was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Detected an attempt of unauthorized use of pay-per-use Internet services which are commonly pornographic websites (pornodialer), or pornotools, or a pornodownloader</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">An attempt of unauthorized use of pay-per-use Internet services (which are commonly pornographic websites) was  detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Adware detected</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">A URL that leads to adware was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Multiple threats detected</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">Multiple objects were detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Detected a highly dangerous malicious object that cannot be classified using either of available classes of malware</p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">A highly dangerous unclassified object was detected.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">MS Office document containing a macro is detected </p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">A Microsoft Office document containing a macro was detected.</p>
</td>
</tr>

</table>
<p class="introheading">X-Response-Info</p>
<p class="bodytext">This header contains the status of the scanned object or the response to the <code class="programcharacter">OPTIONS</code> requests. You can specify whether Kaspersky Scan Engine includes this header in its response in the <code class="programcharacter"><a id="h224484" class="englishcrossreferencetemplate" href="#221161" target="_self">SendResponseInfoICAPHeader</a></code> element.</p>
<p class="bodytext">The header has the following format:</p>
<p class="program">X-Response-Info: {Token}</p>
<p class="bodytext">Here, <code class="programcharacter">{Token}</code> can have the following values:</p>
<table class="tableintopic" width="510" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Value</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="336"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">Allowed</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">The scanned file or URL is not malicious.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">Blocked</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">This response can appear for the following reasons:</p>
<ul class="tablelistbullet"><li class="tablelistbullet">A threat or legitimate software that can be used by intruders was detected</li><li class="tablelistbullet">A macros was detected</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext"><code class="programcharacter">Options</code></p>
</td>
<td style="border:1px solid #010101;" width="336"><p class="tablebodytext">The answer to the <code class="programcharacter">OPTIONS</code> requests.</p>
</td>
</tr>

</table>
<p class="introheading">X-Violations-Found</p>
<p class="bodytext">This header contains information about the scanned file and the threats or legitimate software that can be used by intruders detected in this file. You can specify whether Kaspersky Scan Engine includes this header in its response in the <code class="programcharacter"><a id="h224485" class="englishcrossreferencetemplate" href="#221162" target="_self">SendViolationsFoundICAPHeader</a></code> element. The header will be present only if a threat or legitimate object that can be used by attackers is detected during scanning.</p>
<p class="bodytext">The header has the following format:</p>
<p class="program"><code class="programcharacter">X-Violations-Found: {Count}</code></p>
<p class="program"><code class="programcharacter">    {File_name}</code></p>
<p class="program"><code class="programcharacter">    {Description}</code></p>
<p class="program"><code class="programcharacter">    {Problem_ID}</code></p>
<p class="program"><code class="programcharacter">    {Resolution_ID}</code></p>
<p class="bodytext">Here, <code class="programcharacter">{count}</code> is the number of the objects that were detected in the file, <code class="programcharacter">{File_name}</code> is the name of the file, <code class="programcharacter">{Description}</code> is the name of the first detected threat or legitimate object that can be used by attackers in the file, <code class="programcharacter">{Problem_ID}</code> is the identifier of the detected threat or legitimate object that can be used by attackers, <code class="programcharacter">{Resolution_ID}</code> is the identifier of the action performed on the object by Kaspersky Scan Engine.</p>
<p class="attentionbody">In the current version of Kaspersky Scan Engine, the value of {<code class="programcharacter">Resolution_ID}</code> is always <code class="programcharacter">0</code>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179902"><p><a name=179902 style="display: none;">[Topic 179902]</a></p>
	<h2 id="t234556" class="heading2">Updating the anti-virus database in ICAP mode</h2>
<p class="bodytext">In ICAP mode, Kaspersky Scan Engine supports several ways of updating the anti-virus database.</p>
<p class="warningbody">When the anti-virus database is updated, the encrypted user agent string of KAV SDK is transferred to Kaspersky. See also the full list of data that is <a id="h180101" class="englishcrossreferencetemplate" href="#180001" target="_self">transferred to Kaspersky during an update</a>.</p>
<p class="bodytext">Perform one of the following actions to update the anti-virus database:</p>
<ul class="listbullet1"><li class="listbullet1">Configure automatic database updates in the <code class="programcharacter">UpdateSettings</code> section of the <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">ICAP mode configuration file</a>.</li><li class="listbullet1">Send a <code class="programcharacter">SIGUSR2</code> signal to the <code class="programcharacter">kavicapd</code> service. <p class="listcontinue1">Kaspersky Scan Engine must be configured to update the database on this signal.</p>
</li></ul><p class="bodytext">When you use one of these methods, a newer version of the database is automatically loaded by Kaspersky Scan Engine.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="182615"><p><a name=182615 style="display: none;">[Topic 182615]</a></p>
	<h2 id="t234368" class="heading2">Getting accumulated statistics in ICAP mode</h2>
<p class="bodytext">In ICAP mode, Kaspersky Scan Engine collects information about its usage and creates statistics from this data. These statistics are stored on your hard disk. You can view the statistics to monitor trends in the data requested from your network. For example, you can check if users in your network are trying to download a lot of malicious files.</p>
<p class="procedureheading">To view accumulated statistics:</p>
<ol class="listnumber1"><li class="listnumber1">Open the directory specified in the <code class="programcharacter">TempPath</code> element of the <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">configuration file</a>.</li><li class="listnumber1">Find the <code class="programcharacter">report.json</code> file and open it.</li></ol><p class="bodytext">Following is an example of the <code class="programcharacter">report.json</code> file.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">{</p>
<p class="program2">&quot;statistics&quot;: {</p>
<p class="program3">&quot;total_requests&quot;: 3,</p>
<p class="program3">&quot;infected_requests&quot;: 3,</p>
<p class="program3">&quot;not_scanned_requests&quot;: 0,</p>
<p class="program3">&quot;error_requests&quot;: 0,</p>
<p class="program3">&quot;engine_errors&quot;: 1,</p>
<p class="program3">&quot;processed_data&quot;: 204,</p>
<p class="program3">&quot;infected_data&quot;: 0,</p>
<p class="program3">&quot;processed_urls&quot;: 1,</p>
<p class="program3">&quot;infected_urls&quot;: 1</p>
<p class="program2">}</p>
<p class="program">}</p>
</td>
</tr>

</table>
<p class="bodytext">where <code class="programcharacter">statistics</code> is an object containing the following accumulated statistics:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">total_requests</code>&#8212;The total number of received requests in response modification (RESPMOD) mode and request modification (REQMOD) mode.</li><li class="listbullet1"><code class="programcharacter">infected_requests</code>&#8212;The number of requests for which Kaspersky Scan Engine returned a <code class="programcharacter">DETECT</code>, <code class="programcharacter">PHISHING</code>, or <code class="programcharacter">MACRO</code> scan result.</li><li class="listbullet1"><code class="programcharacter">not_scanned_requests</code>&#8212;The number of valid scan requests that were not processed. <p class="listcontinue1">Possible reasons: </p>
<ul class="listbullet2"><li class="listbullet2">The object is too big or too small.</li><li class="listbullet2">The object is an encrypted archive.</li><li class="listbullet2">Kaspersky Scan Engine is configured to skip objects of the format that the object belongs to. </li></ul></li><li class="listbullet1"><code class="programcharacter">error_requests</code>&#8212;The number of incorrect ICAP requests that were received by Kaspersky Scan Engine.</li><li class="listbullet1"><code class="programcharacter">engine_errors</code>&#8212;The number of requests for which Kaspersky Scan Engine returned a <code class="programcharacter">FAILED</code> scan result.</li><li class="listbullet1"><code class="programcharacter">processed_data</code>&#8212;The total amount of scanned data in bytes.<p class="listcontinue1">This includes objects scanned in RESPMOD mode and objects in POST requests that were scanned in REQMOD mode.</p>
</li><li class="listbullet1"><code class="programcharacter">infected_data</code>&#8212;The amount of scanned data, in bytes, for which Kaspersky Scan Engine returned a <code class="programcharacter">DETECT,</code> <code class="programcharacter">PHISHING</code>, or <code class="programcharacter">MACRO</code> scan result.<p class="listcontinue1">This includes objects scanned in RESPMOD mode and objects in POST requests that were scanned in REQMOD mode. </p>
</li><li class="listbullet1"><code class="programcharacter">processed_urls</code>&#8212;The total number of checked URLs.</li><li class="listbullet1"><code class="programcharacter">infected_urls</code>&#8212;The number of URLs for which Kaspersky Scan Engine returned a <code class="programcharacter">DETECT</code> or <code class="programcharacter">PHISHING</code> scan result.</li></ul><p class="introheading">Resetting statistics</p>
<p class="bodytext">You can reset accumulated statistics at any time.</p>
<p class="procedureheading">To reset accumulated statistics:</p>
<ol class="listnumber1"><li class="listnumber1">Open the directory specified in the <code class="programcharacter">TempPath</code> element of the <a id="h180154_2" class="englishcrossreferencetemplate" href="#192989" target="_self">configuration file</a>.</li><li class="listnumber1">Find the <code class="programcharacter">report.json</code> file and delete it.</li></ol><p class="bodytext">The kavicapd service will create a new <code class="programcharacter">report.json</code> file with all statistics set to <code class="programcharacter">0</code>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="186630"><p><a name=186630 style="display: none;">[Topic 186630]</a></p>
	<h2 id="t234434" class="heading2">Logging in ICAP mode</h2>
<p class="bodytext">This section explains how to work with logs in ICAP mode.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#179896" target="_self">Configuring logging in ICAP mode</a></p><p class="relateditem"><a href="#186631" target="_self">Format of CEF logs in ICAP mode</a></p><p class="relateditem"><a href="#186652" target="_self">Format of RAW logs in ICAP mode</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179896"><p><a name=179896 style="display: none;">[Topic 179896]</a></p>
	<h3 id="t234306" class="heading3">Configuring logging in ICAP mode</h3>
<p class="bodytext">This section explains how to manually configure logging in ICAP mode without using Kaspersky Scan Engine GUI.</p>
<p class="bodytext">In ICAP mode, Kaspersky Scan Engine can log its activity. Logging settings are specified in the icapdkavlog.conf configuration file (hereinafter referred to as the logging configuration file), located in the <code class="programcharacter">/opt/kaspersky/ScanEngine/bin</code> directory. </p>
<p class="bodytext">You can change the logging settings after the <code class="programcharacter">kavicapd</code> service is started. </p>
<p class="bodytext">See also the detailed instructions on <a id="h180103" class="englishcrossreferencetemplate" href="#179928" target="_self">enabling logging</a>.</p>
<p class="introheading">Elements of the logging configuration file</p>
<p class="bodytext"><code class="programcharacter">Logging</code>&#8212;The root element of the file. This element has two child elements: <code class="programcharacter">DebugLogging</code> and <code class="programcharacter">SyslogLogging</code>.</p>
<p class="introheading">DebugLogging Section</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">DebugLogging</code> is a parent element that contains setting for logs that are written directly to the log files and can help identify service malfunctions.<p class="listcontinue1">This element has the following child elements.</p>
</li><li class="listbullet1"><code class="programcharacter">Level</code>&#8212;Specifies the logging level. <p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">none</code> or <code class="programcharacter">non</code> <p class="listcontinue2">Logging is disabled.</p>
</li><li class="listbullet2"><code class="programcharacter">debug</code> or <code class="programcharacter">dbg</code><p class="listcontinue2">Debug level. At this logging level, Kaspersky Scan Engine logs information that can help identify problems, such as changes in the state of a proxy server connection or return values of Kaspersky Scan Engine functions.</p>
</li></ul><p class="warningcontinue1">If you enable the debug level of logging, consider that the log messages will contain <a id="h206306" class="englishcrossreferencetemplate" href="#179925" target="_self">sensitive data</a>.</p>
<p class="listcontinue1">The default value is <code class="programcharacter">none</code>.</p>
</li><li class="listbullet1"><code class="programcharacter">Target</code>&#8212;The parent element for parameters that specify where logs must be written.</li><li class="listbullet1"><code class="programcharacter">File</code>&#8212;Indicates that logs are written directly to log files. It also specifies the properties of log files. <p class="listcontinue1">This element has the following attributes:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">size_limit</code>&#8212;Specifies the maximum possible size of a log file, in megabytes (MB).<p class="listcontinue2">If the value of this attribute is <code class="programcharacter">0</code>, the log file has no size limit.</p>
<p class="listcontinue2">The default value is <code class="programcharacter">0</code>.</p>
</li><li class="listbullet2"><code class="programcharacter">folder</code>&#8212;Specifies the directory where log files are stored.<p class="listcontinue2">The path can be absolute or relative. The relative path is specified relative to the directory that holds the kavicapd executable file. </p>
<p class="listcontinue2">The default value is <code class="programcharacter">./logs</code>.</p>
</li><li class="listbullet2"><code class="programcharacter">clear_folder</code>&#8212;Specifies whether Kaspersky Scan Engine must delete old logs on initialization.<p class="listcontinue2">Kaspersky Scan Engine deletes old log files only if the value of this parameter is<code class="programcharacter"> 1</code>, <code class="programcharacter">yes</code>, <code class="programcharacter">true</code>, <code class="programcharacter">on</code>, or <code class="programcharacter">enabled</code>. If the value of this parameter is <code class="programcharacter">0</code>, <code class="programcharacter">no</code>, <code class="programcharacter">false</code>, <code class="programcharacter">off</code>, or <code class="programcharacter">disabled</code>, Kaspersky Scan Engine does not delete old log files. Notice that Kaspersky Scan Engine checks this parameter and deletes logs at the time the service starts. If the value of this parameter is set to <code class="programcharacter">1</code>, <code class="programcharacter">yes</code>, <code class="programcharacter">true</code>, <code class="programcharacter">on</code>, or <code class="programcharacter">enabled</code> when the service is already running, log files are not deleted until the service is restarted.  </p>
<p class="listcontinue2">The default value is <code class="programcharacter">0</code>.</p>
</li></ul><p class="listcontinue1">Generated log files are named as follows: icapdkav_&lt;pid&gt;_&lt;date_time&gt;_&lt;log_number&gt;.log, where &lt;pid&gt; is the PID of the process, &lt;date_time&gt; is local system date in the <code class="programcharacter">YYYY-MM-DDhhmmss</code> format, and &lt;log_number&gt; is the number of the log (this parameter is appended to the file name only if the icapdkav_&lt;pid&gt;_&lt;date_time&gt;.log log file already exists).</p>
</li></ul><p class="introheading">SyslogLogging Section</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">SyslogLogging</code> is a parent element that contains setting for logs that are redirected to <code class="programcharacter">syslogd</code>. <p class="listcontinue1">This element has the following child elements:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">SyslogEnabled</code>&#8212;Specifies whether Kaspersky Scan Engine sends syslog messages.<p class="listcontinue2">Possible values:</p>
<ul class="listbullet3"><li class="listbullet3"><code class="programcharacter">0</code>, <code class="programcharacter">false</code>, <code class="programcharacter">no</code>, <code class="programcharacter">off</code>, or <code class="programcharacter">disabled</code><p class="listcontinue3">Disables sending of syslog messages.</p>
</li><li class="listbullet3">Any other value<p class="listcontinue3">Enables sending of syslog messages.</p>
</li></ul><p class="warningcontinue2">If you enable sending syslog messages, consider that these messages will contain sensitive data, such as personal data as defined by GDPR, configuration data of the product, and licensing information.</p>
</li><li class="listbullet2"><code class="programcharacter">Syslog</code> specifies settings related to syslog messages. <p class="listcontinue2">This element has the following attributes:</p>
<ul class="listbullet3"><li class="listbullet3"><code class="programcharacter">destination</code>&#8212;Specifies the destination for syslog messages.<p class="listcontinue3">The following destinations are possible:</p>
<ul class="listbullet4"><li class="listbullet4">IP address. In this case, specify the<code class="programcharacter"> %PROTOCOL%%IP%:%PORT% </code>value, where <code class="programcharacter">%PROTOCOL%</code> is a network protocol (use <code class="programcharacter">tcp://</code> or <code class="programcharacter">udp://</code> for this value), <code class="programcharacter">%IP%</code> is an IPv4 address that receives syslog messages, <code class="programcharacter">%PORT%</code> is a port that receives syslog messages. If you do not specify a protocol as described above, KAV SDK will use the UDP protocol.</li><li class="listbullet4">Syslog daemon. In this case, specify the <code class="programcharacter">localhost </code>value to redirect syslog messages to a syslog daemon.</li><li class="listbullet4">Log file. In this case, specify the path to the directory where the log file will be created. The path must begin with <code class="programcharacter">/var/log/kaspersky</code>. The log file with syslog messages created by previous sessions is not removed and  the ICAP plug-in appends new information to this file.</li></ul><p class="listcontinue3">If it is necessary to write logs into the different locations, you can specify several <code class="programcharacter">Syslog</code> elements. In this case, the <code class="programcharacter">destination</code> attribute values of these elements must vary.</p>
</li><li class="listbullet3"><code class="programcharacter">format</code>&#8212;Specifies the format of syslog messages.<p class="listcontinue3">Possible values:</p>
<ul class="listbullet4"><li class="listbullet4"><code class="programcharacter">cef</code>&#8212;Specifies the <a id="h193363" class="englishcrossreferencetemplate" href="#186631" target="_self">CEF format</a> of syslog messages.</li><li class="listbullet4"><code class="programcharacter">raw</code>&#8212;Specifies the <a id="h193364" class="englishcrossreferencetemplate" href="#186652" target="_self">RAW format</a> of syslog messages. The <code class="programcharacter">raw</code> value is used when the value specified in this element is not <code class="programcharacter">cef</code> or <code class="programcharacter">raw</code>, or no value is specified in this element, or if the logging configuration file does not contain the <code class="programcharacter">SyslogFormat</code> parameter.</li></ul></li></ul><p class="listcontinue2"><code class="programcharacter">Syslog</code> may have the following child element:</p>
<ul class="listbullet3"><li class="listbullet3"><code class="programcharacter">LoggedEvent</code>&#8212;Specifies events to be logged. <p class="listcontinue3">It is allowed to specify multiple <code class="programcharacter">LoggedEvent</code> values. Each of these values sets the type of event that will be logged into the location specified in the <code class="programcharacter">destination</code> attribute.</p>
<p class="listcontinue3">Possible values:</p>
<ul class="listbullet4"><li class="listbullet4"><code class="programcharacter">Audit</code>&#8212;Specifies system audit events.</li><li class="listbullet4"><code class="programcharacter">Init</code>&#8212;Specifies service initialization events. </li><li class="listbullet4"><code class="programcharacter">Deinit</code>&#8212;Specifies service deinitialization events and watchdog events. </li><li class="listbullet4"><code class="programcharacter">Update</code>&#8212;Specifies antivirus database update and reload events.</li><li class="listbullet4"><code class="programcharacter">License</code>&#8212;Specifies license-related events.</li><li class="listbullet4"><code class="programcharacter">Engine</code>&#8212;Specifies antivirus engine events.  These events may be published frequently.</li><li class="listbullet4"><code class="programcharacter">ScanResultClean</code>&#8212;Specifies scan completion events when scanned object considered clean.</li><li class="listbullet4"><code class="programcharacter">ScanResultDetect</code>&#8212;Specifies scan completion events when threat was detected.</li><li class="listbullet4"><code class="programcharacter">ScanResultOther</code>&#8212;Specifies scan completion events when object was not scanned.</li></ul><p class="listcontinue3">If the <code class="programcharacter">Syslog</code> element does not contain the <code class="programcharacter">LoggedEvent</code> child element, all the ICAP events logged. </p>
<p class="listcontinue3">If the <code class="programcharacter">Syslog</code> settings are incorrect, logging to the specified destination will be disabled.</p>
<p class="listcontinue3">When syslog logging is enabled, system audit is enabled as well. If none of the <code class="programcharacter">SyslogEvents</code> elements contains the <code class="programcharacter">Audit</code> event, system audit settings are set as follows:  <code class="programcharacter">SyslogFormat</code> is set to <code class="programcharacter">raw</code>, <code class="programcharacter">SyslogTarget</code> is set to <code class="programcharacter">localhost</code>, and <code class="programcharacter">SyslogEvents</code> is set to <code class="programcharacter">audit</code>.</p>
</li></ul></li></ul></li></ul><p class="attentionbody">Kaspersky Scan Engine can write debug logs and send syslog messages at the same time or separately.</p>
<p class="introheading">Structure of the logging configuration file</p>
<p class="bodytext">Following is an example of a logging configuration file:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">&lt;?xml version=&quot;1.0&quot;?&gt;</p>
<p class="program">&lt;Logging&gt;</p>
<p class="program2">&lt;DebugLogging&gt;</p>
<p class="program3">&lt;Level&gt;debug&lt;/Level&gt;</p>
<p class="program3">&lt;File size_limit=&quot;10&quot; folder=&quot;./logs/scanevents&quot; clear_folder=&quot;1&quot;/&gt;</p>
<p class="program2">&lt;/DebugLogging&gt;</p>
<p class="program2">&lt;SyslogLogging&gt;</p>
<p class="program3">&lt;SyslogEnabled&gt;1&lt;/SyslogEnabled&gt;</p>
<p class="program3">&lt;Syslog destination=&quot;udp://192.168.1.1&quot; format=&quot;cef&quot;&gt;</p>
<p class="program4">&lt;LoggedEvent&gt;ScanResultClean&lt;/LoggedEvent&gt;</p>
<p class="program4">&lt;LoggedEvent&gt;ScanResultDetect&lt;/LoggedEvent&gt;</p>
<p class="program3">&lt;/Syslog&gt;</p>
<p class="program3">&lt;Syslog destination=&quot;localhost&quot; format=&quot;raw&quot;&gt;</p>
<p class="program4">&lt;LoggedEvent&gt;ScanResultOther&lt;/LoggedEvent&gt;</p>
<p class="program3">&lt;/Syslog&gt;</p>
<p class="program3">&lt;Syslog destination=&quot;/opt/kav/sdk8l3/logs&quot; format=&quot;raw&quot;&gt;</p>
<p class="program4">&lt;LoggedEvent&gt;Audit&lt;/LoggedEvent&gt;</p>
<p class="program4">&lt;LoggedEvent&gt;Engine&lt;/LoggedEvent&gt;</p>
<p class="program3">&lt;/Syslog&gt;</p>
<p class="program2">&lt;/SyslogLogging&gt;</p>
<p class="program">&lt;/Logging&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="186631"><p><a name=186631 style="display: none;">[Topic 186631]</a></p>
	<h3 id="t234362" class="heading3">Format of CEF logs in ICAP mode</h3>
<p class="bodytext">If Kaspersky Scan Engine is configured to write syslog messages in CEF format, the log records about events appears as follows:</p>
<p class="program">CEF:0|Kaspersky|Scan Engine ICAP Service|%VERSION%|%EVENT_CLASS_ID%|%EVENT_NAME%|%SEVERITY%| msg=%EVENT_MSG% src=%CLIENT_IP% dvcpid=%ICAP_SERVER_PID% dvc=%HTTP_SERVICE_IP% dvchost=%HOSTNAME% cs2=%HTTP_USER_NAME% cs2Label=X-Client-Username cs3=%HTTP_USER_IP% cs3Label=X-Client-IP start=%EVENT_TIME% fileHash=%SCANNED_FILE_HASH% request=%SCANNED_URL% cs1=%SCAN_RESULT% cs1Label=Scan result cs4=%VIRUS_NAME% cs4Label=Virus name cs5=%SCANNED_FILE_SHA256_HASH% cs5Label=SHA256 cs6=%ICAP_MODE% cs6Label=ICAP mode cn1=%REQUEST_LENGTH% cn1Label=Request size flexString1=%SDK_VERSION% flexString1Label=Anti-Virus Engine version</p>
<p class="bodytext">A record has the following fields:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">%VERSION%</code><p class="listcontinue1">Version of Kaspersky Scan Engine.</p>
</li><li class="listbullet1"><code class="programcharacter">%EVENT_CLASS_ID%</code><p class="listcontinue1">Class of the event. Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">1</code><p class="listcontinue2">Service event (not related to scanning).</p>
</li><li class="listbullet2"><code class="programcharacter">2</code><p class="listcontinue2">Event related to errors.</p>
</li><li class="listbullet2"><code class="programcharacter">3</code><p class="listcontinue2">Event related to scanning (for example, a scan result).</p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">%EVENT_NAME%</code><p class="listcontinue1">Name of the event. Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">Initializing</code>&#8212;Kaspersky Scan Engine initialized.</li><li class="listbullet2"><code class="programcharacter">Deinitializing</code>&#8212;Kaspersky Scan Engine deinitialized, a watchdog event occurred, or the service process is absent.</li><li class="listbullet2"><code class="programcharacter">Update event</code>&#8212;Anti-malware databases update started or finished.</li><li class="listbullet2"><code class="programcharacter">License event</code>&#8212;License-related event.</li><li class="listbullet2"><code class="programcharacter">Engine event</code>&#8212;Antivirus engine event occurred.</li><li class="listbullet2"><code class="programcharacter">Scan result clean</code>&#8212;Scanned object considered clean.</li><li class="listbullet2"><code class="programcharacter">Scan result detect</code>&#8212;Threat was detected.</li><li class="listbullet2"><code class="programcharacter">Scan result other</code>&#8212;Object was not scanned.</li><li class="listbullet2"><code class="programcharacter">Audit</code>&#8212;<a id="h221151" class="englishcrossreferencetemplate" href="#221141" target="_self">System audit</a> event occurred.</li></ul></li><li class="listbullet1"><code class="programcharacter">%SEVERITY%</code><p class="listcontinue1">Importance level of the event. The higher the level, the more important the event. Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">3</code><p class="listcontinue2">This value is specified for system audit events, informational level.</p>
</li><li class="listbullet2"><code class="programcharacter">5</code><p class="listcontinue2">This value is specified for service events when the scanning starts or if the scan result is <code class="programcharacter">CLEAN</code>.</p>
</li><li class="listbullet2"><code class="programcharacter">6</code><p class="listcontinue2">This value is specified for system audit events, warning level.</p>
</li><li class="listbullet2"><code class="programcharacter">7</code><p class="listcontinue2">This value is specified for initialization, deinitialization, and errors.</p>
</li><li class="listbullet2"><code class="programcharacter">8</code><p class="listcontinue2">This value is specified for system audit events (critical level) and if the scan result is something other than <code class="programcharacter">CLEAN</code>. These events are considered dangerous.</p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">%EVENT_MSG%</code><p class="listcontinue1">Description of the event. For example, the text of an error message.</p>
</li><li class="listbullet1"><code class="programcharacter">%CLIENT_IP%</code><p class="listcontinue1">IP address of the ICAP client that sent the scan request to Kaspersky Scan Engine. This field appears only in scan result events (<code class="programcharacter">ScanResultClean</code>, <code class="programcharacter">ScanResultDetect</code>, <code class="programcharacter">ScanResultOther</code> event types).</p>
</li><li class="listbullet1"><code class="programcharacter">%ICAP_SERVER_PID%</code><p class="listcontinue1">PID of Kaspersky Scan Engine.</p>
</li><li class="listbullet1"><code class="programcharacter">%HTTP_SERVICE_IP%</code><p class="listcontinue1">IP address that Kaspersky Scan Engine uses to receive scan requests from clients. This field appears only if syslog logging in CEF format is enabled.</p>
</li><li class="listbullet1"><code class="programcharacter">%HOSTNAME%</code><p class="listcontinue1">Host name of the computer on which Kaspersky Scan Engine is working. This field appears only if syslog logging in CEF format is enabled.</p>
</li><li class="listbullet1"><code class="programcharacter">%HTTP_USER_NAME%</code><p class="listcontinue1">Name of the HTTP client specified in a custom request header field. The name of this request header field is specified in the <code class="programcharacter"><a id="h201207" class="englishcrossreferencetemplate" href="#200727" target="_self">HTTPUserNameICAPHeader</a></code> element of the ICAP mode configuration file.</p>
<p class="listcontinue1">The <code class="programcharacter">cs2</code> (<code class="programcharacter">%HTTP_USER_NAME%</code>) and <code class="programcharacter">cs2Label</code> fields appear only if the value of <code class="programcharacter">%EVENT_CLASS_ID%</code> is 3, and if the <code class="programcharacter">HTTPUserNameICAPHeader</code> element in the ICAP mode configuration file exists and is not empty. If the <code class="programcharacter">HTTPUserNameICAPHeader</code> element does not exist or is empty, the <code class="programcharacter">cs2</code> (<code class="programcharacter">%HTTP_USER_NAME%</code>) and <code class="programcharacter">cs2Label</code> fields are absent in the Syslog message.</p>
<p class="listcontinue1">If the value of the custom header field is empty (the HTTP client name is not specified in the request), the <code class="programcharacter">cs2</code> value (<code class="programcharacter">%HTTP_USER_NAME%</code>) in the Syslog message is &quot;-&quot;.</p>
</li><li class="listbullet1"><code class="programcharacter">%HTTP_USER_IP%</code><p class="listcontinue1">IP address of the HTTP client specified in a custom request header field. The name of this request header field is specified in the <code class="programcharacter"><a id="h201206" class="englishcrossreferencetemplate" href="#200726" target="_self">HTTPClientIpICAPHeader</a></code> element of the ICAP mode configuration file.</p>
<p class="listcontinue1">The <code class="programcharacter">cs3</code> (<code class="programcharacter">%HTTP_USER_IP%</code>) and <code class="programcharacter">cs3Label</code> fields appear only if the value of <code class="programcharacter">%EVENT_CLASS_ID%</code> is 3, and if the <code class="programcharacter">HTTPClientIpICAPHeader</code> element in the ICAP mode configuration file exists and is not empty. If the <code class="programcharacter">HTTPClientIpICAPHeader</code> element does not exist or is empty, the <code class="programcharacter">cs3</code> (<code class="programcharacter">%HTTP_USER_IP%</code>) and <code class="programcharacter">cs3Label</code> fields are absent in the Syslog message.</p>
<p class="listcontinue1">If the value of the custom header field is empty (the IP address of the HTTP client is not specified in the request), the <code class="programcharacter">cs3</code> value (<code class="programcharacter">%HTTP_USER_IP%</code>) in the Syslog message is &quot;-&quot;.</p>
</li><li class="listbullet1"><code class="programcharacter">%EVENT_TIME%</code><p class="listcontinue1">Time and date of the event. The time and date are taken from the computer that Kaspersky Scan Engine runs on.</p>
</li><li class="listbullet1"><code class="programcharacter">%SCANNED_FILE_HASH%</code><p class="listcontinue1">Hash of the object that was passed for scanning to Kaspersky Scan Engine. This field appears only in scan result events (<code class="programcharacter">ScanResultClean</code>, <code class="programcharacter">ScanResultDetect</code>, <code class="programcharacter">ScanResultOther</code> event types).</p>
</li><li class="listbullet1"><code class="programcharacter">%SCANNED_URL%</code><p class="listcontinue1">URL that was passed for scanning to Kaspersky Scan Engine. This field appears only in scan result events (<code class="programcharacter">ScanResultClean</code>, <code class="programcharacter">ScanResultDetect</code>, <code class="programcharacter">ScanResultOther</code> event types).</p>
</li><li class="listbullet1"><code class="programcharacter">%SCAN_RESULT%</code><p class="listcontinue1">Scan result. This field appears only in scan result events (<code class="programcharacter">ScanResultClean</code>, <code class="programcharacter">ScanResultDetect</code>, <code class="programcharacter">ScanResultOther</code> event types).</p>
</li><li class="listbullet1"><code class="programcharacter">cs1Label=Scan result</code><p class="listcontinue1">Field appears only if the value of <code class="programcharacter">%EVENT_CLASS_ID%</code> is <code class="programcharacter">3</code>.</p>
</li><li class="listbullet1"><code class="programcharacter">%VIRUS_NAME%</code><p class="listcontinue1">Name of the threat or legitimate software that can be used by intruders. This field appears only in scan result events (<code class="programcharacter">ScanResultClean</code>, <code class="programcharacter">ScanResultDetect</code>, <code class="programcharacter">ScanResultOther</code> event types).</p>
</li><li class="listbullet1"><code class="programcharacter">%SCANNED_FILE_SHA256_HASH%</code><p class="listcontinue1">SHA256 hash of object that was passed for scanning to Kaspersky Scan Engine. This field appears only when Kaspersky Scan Engine returns the scan result. </p>
</li><li class="listbullet1"><code class="programcharacter">%ICAP_MODE%</code><p class="listcontinue1">Specifies whether Kaspersky Scan Engine scanned an object in Request Modification Mode (REQMOD) or Response Modification Mode (RESPMOD). This field appears only in scan result events (<code class="programcharacter">ScanResultClean</code>, <code class="programcharacter">ScanResultDetect</code>, <code class="programcharacter">ScanResultOther</code> event types).</p>
</li><li class="listbullet1"><code class="programcharacter">%REQUEST_LENGTH%</code><p class="listcontinue1">Length of the body of the message in bytes. This field appears only in scan result events (<code class="programcharacter">ScanResultClean</code>, <code class="programcharacter">ScanResultDetect</code>, <code class="programcharacter">ScanResultOther</code> event types) and if the scanned object is not a URL.</p>
</li><li class="listbullet1"><code class="programcharacter">%SDK_VERSION%</code><p class="listcontinue1">Version of KAV SDK that Kaspersky Scan Engine is based on.</p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="186652"><p><a name=186652 style="display: none;">[Topic 186652]</a></p>
	<h3 id="t234364" class="heading3">Format of RAW logs in ICAP mode</h3>
<p class="bodytext">If Kaspersky Scan Engine is configured to write syslog messages in RAW format, the log records about events appear as follows:</p>
<p class="program">&lt;%PRIORITY%&gt;1 %TIMESTAMP% %ICAP_SERVICE_IP% KasperskyICAPServer %ICAP_SERVICE_PID% %MESSAGE_ID% [KL_ICAP@23668 icapMode=&quot;%ICAP_MODE%&quot; requestLength=&quot;%REQUEST_LENGTH%&quot; httpUserName=&quot;%HTTP_USER_NAME%&quot; httpUserIP=&quot;%HTTP_USER_IP%&quot; sha2=&quot;%SCANNED_FILE_SHA256_HASH%&quot; md5=&quot;%SCANNED_FILE_MD5_HASH%&quot; request=&quot;%SCANNED_URL%&quot;] BOM %MESSAGE%</p>
<p class="bodytext">A record has the following fields:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">%PRIORITY%</code><p class="listcontinue1">Importance level of the event. Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">163</code><p class="listcontinue2">This value is specified for errors.</p>
</li><li class="listbullet2"><code class="programcharacter">165</code><p class="listcontinue2">This value is specified if the scan result is something other than <code class="programcharacter">CLEAN</code>.</p>
</li><li class="listbullet2"><code class="programcharacter">166</code><p class="listcontinue2">This value is specified for service events or if the scan result is <code class="programcharacter">CLEAN</code>.</p>
</li></ul></li><li class="listbullet1"><code class="programcharacter">%TIMESTAMP%</code><p class="listcontinue1">Date and time of the event in the Coordinated Universal Time (UTC) time zone.</p>
</li><li class="listbullet1"><code class="programcharacter">%ICAP_SERVICE_IP%</code><p class="listcontinue1">IP address of the computer that Kaspersky Scan Engine runs on.</p>
</li><li class="listbullet1"><code class="programcharacter">%ICAP_SERVICE_PID%</code><p class="listcontinue1">PID of the Kaspersky Scan Engine. </p>
</li><li class="listbullet1"><code class="programcharacter">%MESSAGE_ID%</code><p class="listcontinue1">Class of the event. Possible values:</p>
<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">AUDIT_MESSAGE</code>&#8212;Audit event.</li><li class="listbullet2"><code class="programcharacter">INIT_MESSAGE</code>&#8212;KAV SDK initialized.</li><li class="listbullet2"><code class="programcharacter">DEINIT_MESSAGE</code>&#8212;KAV SDK deinitialized, a watchdog event occurred, or the service process is absent.</li><li class="listbullet2"><code class="programcharacter">UPDATE_MESSAGE</code>&#8212;Anti-malware databases update started or finished.</li><li class="listbullet2"><code class="programcharacter">LICENSE_MESSAGE</code>&#8212;License-related event.</li><li class="listbullet2"><code class="programcharacter">ENGINE_MESSAGE</code>&#8212;Antivirus engine event occurred.</li><li class="listbullet2"><code class="programcharacter">SCAN_RESULT_CLEAN_MESSAGE</code>&#8212;Scanned object considered clean.</li><li class="listbullet2"><code class="programcharacter">SCAN_RESULT_DETECT_MESSAGE</code>&#8212;Threat was detected.</li><li class="listbullet2"><code class="programcharacter">SCAN_RESULT_OTHER_MESSAGE</code>&#8212;Object was not scanned.</li></ul></li><li class="listbullet1"><code class="programcharacter">%ICAP_MODE%</code><p class="listcontinue1">Specifies whether Kaspersky Scan Engine scanned an object in Request Modification Mode (REQMOD) or Response Modification Mode (RESPMOD). This field appears only if the value of <code class="programcharacter">%MESSAGE_ID%</code> is <code class="programcharacter">SCAN_RESULT_MESSAGE</code>.</p>
</li><li class="listbullet1"><code class="programcharacter">%REQUEST_LENGTH%</code><p class="listcontinue1">Length of the body of the HTTP message scanned by Kaspersky Scan Engine. This field appears only if the value of <code class="programcharacter">%MESSAGE_ID%</code> is <code class="programcharacter">SCAN_RESULT_MESSAGE</code> and the scanned object is not a URL.</p>
</li><li class="listbullet1"><code class="programcharacter">%HTTP_USER_NAME%</code><p class="listcontinue1">Name of the HTTP client that was specified in the <code class="programcharacter">HTTPUserNameICAPHeader</code> parameter of the ICAP mode configuration file. The <code class="programcharacter">%HTTP_USER_NAME%</code> field appears only if the value of <code class="programcharacter">%MESSAGE_ID%</code> is <code class="programcharacter">SCAN_RESULT_MESSAGE</code>.</p>
</li><li class="listbullet1"><code class="programcharacter">%HTTP_USER_IP%</code><p class="listcontinue1">IP address of the HTTP client that was specified in the <code class="programcharacter">HTTPClientIpICAPHeader</code> parameter of the ICAP mode configuration file. The <code class="programcharacter">%HTTP_USER_IP%</code> field appears only if the value of <code class="programcharacter">%MESSAGE_ID%</code> is <code class="programcharacter">SCAN_RESULT_MESSAGE</code>.</p>
</li><li class="listbullet1"><code class="programcharacter">%SCANNED_FILE_SHA256_HASH%</code><p class="listcontinue1">SHA256 hash of the object that was passed for scanning to Kaspersky Scan Engine. This field appears only when Kaspersky Scan Engine returns the scan result.</p>
</li><li class="listbullet1"><code class="programcharacter">%SCANNED_FILE_MD5_HASH%</code><p class="listcontinue1">MD5 hash of the object that was passed for scanning to Kaspersky Scan Engine. This field appears only when Kaspersky Scan Engine returns the scan result. </p>
</li><li class="listbullet1"><code class="programcharacter">%SCANNED_URL%</code><p class="listcontinue1">URL address scanned by KAV SDK. The <code class="programcharacter">%SCANNED_URL% </code>field appears only in scan result events (<code class="programcharacter">SCAN_RESULT_CLEAN_MESSAGE</code>, <code class="programcharacter">SCAN_RESULT_DETECT_MESSAGE</code>, <code class="programcharacter">SCAN_RESULT_OTHER_MESSAGE</code> event types). </p>
</li><li class="listbullet1"><code class="programcharacter">%MESSAGE%</code><p class="listcontinue1">Description of the event. For example, the text of an error message.</p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="219958"><p><a name=219958 style="display: none;">[Topic 219958]</a></p>
	<h2 id="t234399" class="heading2">Integrating Kaspersky Scan Engine with other solutions</h2>
<p class="bodytext">The ICAP protocol provides the opportunity to integrate Kaspersky Scan Engine with other solutions. Support for most of the fields described in the ICAP specification makes it possible to integrate Kaspersky Scan Engine with almost any solution that supports communication over ICAP. For example, you can integrate Kaspersky Scan Engine with Manage File Transfer (MFT) solutions such as Cleo EDI, Cleo MFT, proxy-servers, Network Attached Storage (NAS) solutions, and NextGen Web Firewall (NGWF).</p>
<p class="bodytext">This section of the documentation describes only a small number of integrations. For  help with solutions not covered in the documentation, contact your Technical Account Manager (TAM).</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#179904" target="_self">Using Kaspersky Scan Engine in ICAP mode with Squid</a></p><p class="relateditem"><a href="#212974" target="_self">Using Kaspersky Scan Engine in ICAP mode with Oracle Solaris Vscan</a></p><p class="relateditem"><a href="#219959" target="_self">Using Kaspersky Scan Engine in ICAP mode with Dell EMC Isilon</a></p><p class="relateditem"><a href="#221109" target="_self">Using Kaspersky Scan Engine with F5 BIG-IP Application Security Manager</a></p><p class="relateditem"><a href="#221715" target="_self">Using Kaspersky Scan Engine in ICAP mode with GoAnywhere MFT</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179904"><p><a name=179904 style="display: none;">[Topic 179904]</a></p>
	<h3 id="t234581" class="heading3">Using Kaspersky Scan Engine in ICAP mode with Squid</h3>
<p class="bodytext">Squid is a caching and forwarding web proxy server for Windows and UNIX-like systems. You can use Kaspersky Scan Engine in ICAP mode to scan traffic that passes through the Squid proxy.</p>
<p class="introheading">Software requirements</p>
<ul class="listbullet1"><li class="listbullet1">Operating system Ubuntu 18.04 or later</li><li class="listbullet1">Squid 4.5 or later</li></ul><p class="introheading">Configuring Squid for working with Kaspersky Scan Engine</p>
<p class="bodytext">For Kaspersky Scan Engine to work with Squid in ICAP mode, you must specify Kaspersky Scan Engine as an ICAP service in the Squid configuration file (squid.conf). </p>
<p class="bodytext">In Squid, an ICAP service is defined in the following format: <code class="programcharacter">icap_service id vectoring_point [options] uri</code>.</p>
<p class="procedureheading">To specify Kaspersky Scan Engine as an ICAP service:</p>
<ol class="listnumber1"><li class="listnumber1">Open squid.conf for editing.</li><li class="listnumber1">Define the mandatory parameters <code class="programcharacter">id</code>, <code class="programcharacter">vectoring_point</code>, and <code class="programcharacter">uri</code>:<ol class="listalpha2"><li class="listalpha2">Set <code class="programcharacter">id</code> to any appropriate identifier. For example, <code class="programcharacter">srv_kl_resp</code> for request modification (REQMOD) mode and <code class="programcharacter">srv_kl_req</code> for response modification (RESPMOD) mode.</li><li class="listalpha2">Set <code class="programcharacter">vectoring_point</code> to an appropriate <code class="programcharacter">*_precache</code> value: <ul class="listbullet3"><li class="listbullet3">For request modification (REQMOD) mode, specify <code class="programcharacter">reqmod_precache</code>.</li><li class="listbullet3">For response modification (RESPMOD) mode, specify <code class="programcharacter">respmod_precache</code>.</li></ul></li><li class="listalpha2">Set <code class="programcharacter">uri</code> to the location of Kaspersky Scan Engine: <ul class="listbullet3"><li class="listbullet3">For REQMOD mode, the URI must have the following format: <code class="programcharacter">icap://servername:port/req</code>.</li><li class="listbullet3">For RESPMOD mode, the URI must have the following format: <code class="programcharacter">icap://servername:port/resp</code>.</li></ul></li></ol></li><li class="listnumber1">Add the following lines to the end of the Squid configuration file:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">icap_enable on</p>
<p class="program">adaptation_send_username on</p>
<p class="program">adaptation_send_client_ip on</p>
<p class="program">icap_service srv_kl_resp respmod_precache 0 icap://localhost:1344/resp</p>
<p class="program">icap_service srv_kl_req reqmod_precache 0 icap://localhost:1344/req</p>
<p class="program">adaptation_access srv_kl_resp allow all</p>
<p class="program">adaptation_access srv_kl_req allow all</p>
<p class="program">icap_service_failure_limit -1</p>
<p class="program">icap_service_revival_delay 30</p>
<p class="program">icap_preview_enable off</p>
</td>
</tr>

</table>
<p class="listcontinue1">In the example above, <code class="programcharacter">srv_kl_resp</code> and <code class="programcharacter">srv_kl_req</code> are examples of <code class="programcharacter">id</code>, <code class="programcharacter">respmod_precache</code> and <code class="programcharacter">reqmod_precache</code> are values of <code class="programcharacter">vectoring_point</code>, <code class="programcharacter">0</code> is the value of the Squid <code class="programcharacter">bypass</code> option, and <code class="programcharacter">vectoring_point</code> and <code class="programcharacter">icap://127.0.0.1:1344/req</code> are examples of <code class="programcharacter">uri</code>.</p>
<p class="attentioncontinue1">You can use <code class="programcharacter">127.0.0.1</code> in <code class="programcharacter">uri</code> only if Kaspersky Scan Engine is installed on the same computer as Squid. </p>
</li><li class="listnumber1">Save and close squid.conf.</li><li class="listnumber1">Restart the <code class="programcharacter">squid</code> service:<p class="listcontinue1"><code class="programcharacter">service squid restart</code></p>
</li></ol><p class="introheading">Configuring Squid for working with Kaspersky Scan Engine and enabling SSL scanning</p>
<p class="bodytext">By default, Kaspersky Scan Engine cannot scan SSL/TLS traffic, but you can configure Squid to decrypt it by using the SSL Bumping functionality.</p>
<p class="procedureheading">To configure Squid for working with Kaspersky Scan Engine and enable SSL Bumping:</p>
<ol class="listnumber1"><li class="listnumber1">Install the packages necessary to compile and configure Squid:<p class="listcontinue1"><code class="programcharacter">apt-get install build-essential openssl libssl-dev pkg-config</code></p>
</li><li class="listnumber1">Download source code for Squid 4.5 or later.</li><li class="listnumber1">Unzip the archive that contains the Squid source code to the required directory.</li><li class="listnumber1">Move to this directory.</li><li class="listnumber1">Compile Squid:<p class="listcontinue1"><code class="programcharacter">./configure --with-default-user=proxy --with-openssl --enable-ssl-crtd</code></p>
<p class="listcontinue1"><code class="programcharacter">make all</code></p>
<p class="listcontinue1"><code class="programcharacter">make install</code></p>
<p class="listcontinue1">Options <code class="programcharacter">--with-openssl</code> and <code class="programcharacter">--enable-ssl-crtd</code> are necessary to enable SSL Bumping.</p>
</li><li class="listnumber1">Set up the correct time and date on the server that is running Squid. The time and date are checked every time a client is trying to validate the certificate of this server.</li><li class="listnumber1">Configure OpenSSL:<ol class="listalpha2"><li class="listalpha2">Find the default OpenSSL configuration file <code class="programcharacter">openssl.cnf</code>. The location of this file depends on your operating system, but usually it is <code class="programcharacter">/etc/ssl/openssl.cnf</code>.</li><li class="listalpha2">Open <code class="programcharacter">openssl.cnf</code> for editing.</li><li class="listalpha2">Add the following line to the <code class="programcharacter">[v3_ca]</code> section of the configuration file:<p class="listcontinue2"><code class="programcharacter">keyUsage = cRLSign, keyCertSign</code></p>
</li><li class="listalpha2">Save and close <code class="programcharacter">openssl.cnf</code>.</li></ol></li><li class="listnumber1">Prepare the environment for storing SSL certificates:<ol class="listalpha2"><li class="listalpha2">Create a directory for storing SSL certificates:<p class="listcontinue2"><code class="programcharacter">mkdir /usr/local/squid/etc/ssl_cert -p</code></p>
</li><li class="listalpha2">Change the user and the group that own that directory to <code class="programcharacter">proxy</code>:<p class="listcontinue2"><code class="programcharacter">chown proxy:proxy /usr/local/squid/etc/ssl_cert -R</code></p>
</li><li class="listalpha2">Change the permissions for that directory:<p class="listcontinue2"><code class="programcharacter">chmod 700 /usr/local/squid/etc/ssl_cert -R</code></p>
</li></ol></li><li class="listnumber1">Move to the newly created directory:<p class="listcontinue1"><code class="programcharacter">cd /usr/local/squid/etc/ssl_cert</code></p>
</li><li class="listnumber1">Generate a new self-signed SSL certificate and a private key for the Squid server:<p class="listcontinue1"><code class="programcharacter">openssl req -new -newkey rsa:2048 -sha256 -days 365 -nodes -x509 -extensions v3_ca -keyout squid_ca.pem -out squid_ca.pem</code></p>
</li><li class="listnumber1">Convert the newly created certificate to DER format:<p class="listcontinue1"><code class="programcharacter">openssl x509 -in squid_ca.pem -outform DER -out squid_ca.der</code></p>
</li><li class="listnumber1">Export the generated certificate to the client computers and install it on them as a Certificate Authority certificate. The method of doing this depends on the browser and operating system of the client.</li><li class="listnumber1">Create a new SSL database for the Squid server:<p class="listcontinue1"><code class="programcharacter">/usr/local/squid/libexec/security_file_certgen -c -s /usr/local/squid/var/logs/ssl_db -M 4MB</code></p>
</li><li class="listnumber1">Change the user and the group that own that directory to <code class="programcharacter">proxy</code>:<p class="listcontinue1"><code class="programcharacter">chown proxy:proxy /usr/local/squid/var/logs/ssl_db -R</code></p>
</li><li class="listnumber1">Configure Squid:<ol class="listalpha2"><li class="listalpha2">Find the default Squid configuration file <code class="programcharacter">squid.conf</code>. The location of this file depends on your operating system, but usually it is<code class="programcharacter"> </code> <code class="programcharacter">/usr/local/squid/etc/squid.conf</code>.</li><li class="listalpha2">Open <code class="programcharacter">squid.conf</code> and make the following edits:</li><li class="listalpha2">Find the following line:<p class="listcontinue2"><code class="programcharacter">http_port 3128</code></p>
</li><li class="listalpha2">Replace it with the following line:<p class="listcontinue2"><code class="programcharacter">http_port 3128 ssl-bump cert=/usr/local/squid/etc/ssl_cert/squid_ca.pem generate-host-certificates=on dynamic_cert_mem_cache_size=4MB</code></p>
<p class="listcontinue2">This line enables SSL Bumping on port 3128.</p>
</li><li class="listalpha2">Add the following section:<p class="listcontinue2"><code class="programcharacter">acl step1 at_step SslBump1</code></p>
<p class="listcontinue2"><code class="programcharacter">ssl_bump peek step1</code></p>
<p class="listcontinue2"><code class="programcharacter">ssl_bump bump all</code></p>
<p class="listcontinue2"><code class="programcharacter">sslcrtd_program /usr/local/squid/libexec/security_file_certgen -s /usr/local/squid/var/logs/ssl_db -M 4MB</code></p>
</li><li class="listalpha2">Specify Kaspersky Scan Engine as an ICAP service in the Squid configuration file as described above in the subsection &quot;Configuring Squid for working with Kaspersky Scan Engine&quot;.</li><li class="listalpha2">Save and close <code class="programcharacter">squid.conf</code>.</li></ol></li><li class="listnumber1">Change the user and the group that own the <code class="programcharacter">/usr/local/squid</code> directory to <code class="programcharacter">proxy</code>:<p class="listcontinue1"><code class="programcharacter">chown -R proxy:proxy /usr/local/squid</code></p>
</li><li class="listnumber1">Start Squid and initialize the Squid cache:<p class="listcontinue1"><code class="programcharacter">/usr/local/squid/sbin/squid -z</code></p>
</li></ol><p class="bodytext">Following is an example of a Squid configuration file extract. In this example, Squid uses Kaspersky Scan Engine in ICAP mode to scan HTTP messages in both the REQMOD and RESPMOD modes.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program"># SSL bumping configuration</p>
<p class="program">&nbsp;</p>
<p class="program"><code class="programcharacter">acl step1 at_step SslBump1</code></p>
<p class="program"><code class="programcharacter">ssl_bump peek step1</code></p>
<p class="program"><code class="programcharacter">ssl_bump bump all</code></p>
<p class="program">http_port 3128 ssl-bump cert=/usr/local/squid/etc/ssl_cert/squid_ca.pem generate-hostcertificates=on dynamic_cert_mem_cache_size=4MB</p>
<p class="program"><code class="programcharacter">sslcrtd_program /usr/local/squid/libexec/security_file_certgen -s /usr/local/squid/var/logs/ssl_db -M 4MB</code></p>
<p class="program">&nbsp;</p>
<p class="program">&nbsp;</p>
<p class="program"># ICAP configuration</p>
<p class="program">&nbsp;</p>
<p class="program">icap_enable on</p>
<p class="program">adaptation_send_username on</p>
<p class="program">adaptation_send_client_ip on</p>
<p class="program">icap_service srv_kl_resp respmod_precache 0 icap://localhost:1344/resp</p>
<p class="program">icap_service srv_kl_req reqmod_precache 0 icap://localhost:1344/req</p>
<p class="program">adaptation_access srv_kl_resp allow all</p>
<p class="program">adaptation_access srv_kl_req allow all</p>
<p class="program">icap_service_failure_limit -1</p>
<p class="program">icap_service_revival_delay 30</p>
<p class="program">icap_preview_enable off</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="212974"><p><a name=212974 style="display: none;">[Topic 212974]</a></p>
	<h3 id="t234580" class="heading3">Using Kaspersky Scan Engine in ICAP mode with Oracle Solaris Vscan</h3>
<p class="bodytext">You can configure Kaspersky Scan Engine to work with Oracle Solaris Vscan.</p>
<p class="procedureheading">To configure Kaspersky Scan Engine for working with Oracle Solaris Vscan by using the Kaspersky Scan Engine GUI:</p>
<ol class="listnumber1"><li class="listnumber1">Navigate to the <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Service</span> page.</li><li class="listnumber1">In the <span class="guicharacter">Response mode address</span> field, specify <code class="programcharacter">avscan</code>.</li><li class="listnumber1">Save the changes.</li></ol><p class="procedureheading">To configure Kaspersky Scan Engine for working with Oracle Solaris Vscan by using the ICAP mode configuration file:</p>
<ol class="listnumber1"><li class="listnumber1">Open <code class="programcharacter">kavicapd.xml</code> for editing.</li><li class="listnumber1">In the <code class="programcharacter">ICAPSettings</code> &gt; <code class="programcharacter">RespModeAddress</code> element, specify <code class="programcharacter">avscan</code>.</li><li class="listnumber1">Save and close <code class="programcharacter">kavicapd.xml</code>.</li><li class="listnumber1">Restart Kaspersky Scan Engine by running the following command:<p class="listcontinue1"><code class="programcharacter">service kavicapd restart</code></p>
</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="219959"><p><a name=219959 style="display: none;">[Topic 219959]</a></p>
	<h3 id="t234572" class="heading3">Using Kaspersky Scan Engine in ICAP mode with Dell EMC Isilon</h3>
<p class="bodytext">You can configure Kaspersky Scan Engine to work with Dell EMC Isilon. For convenience, this process is separated into several steps.</p>
<p class="attentionbody">The instruction below applies to Dell EMC Isilon 9.1. For information about the interfaces of other versions, see Dell EMC Isilon documentation.</p>
<p class="introheading">Step I. Configuring Kaspersky Scan Engine</p>
<p class="procedureheading">To configure Kaspersky Scan Engine: </p>
<ol class="listnumber1"><li class="listnumber1">Allow Kaspersky Scan Engine to send the <code class="programcharacter">204 No Content</code> HTTP status code by doing one of the following:<ul class="listbullet2"><li class="listbullet2">Turn on the <span class="guicharacter">Send code 204</span> toggle in <a id="h201467" class="englishcrossreferencetemplate" href="#179698" target="_self">Kaspersky Scan Engine GUI</a>.</li><li class="listbullet2">Set the value of the <code class="programcharacter">Allow204</code> element to <code class="programcharacter">1</code> in the <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">ICAP mode configuration file</a>.</li></ul></li><li class="listnumber1"> Enable scanning of files in the response modification mode (RESPMOD) by doing one of the following:<ul class="listbullet2"><li class="listbullet2">Set the objects that must be scanned in RESPMOD to <span class="guicharacter">Files</span> in <a id="h182505" class="englishcrossreferencetemplate" href="#179699" target="_self">Kaspersky Scan Engine GUI</a>.</li><li class="listbullet2">Set the value of the <code class="programcharacter">ScanInRespMode</code> element to <code class="programcharacter">Content</code> in the <a id="h180154_2" class="englishcrossreferencetemplate" href="#192989" target="_self">ICAP mode configuration file</a>.</li></ul></li><li class="listnumber1">Set the address that Kaspersky Scan Engine uses to process responses in RESPMOD to <code class="programcharacter">avscan</code> by doing one of the following:<ul class="listbullet2"><li class="listbullet2">Set the value of <span class="guicharacter">Response mode address</span> field to <code class="programcharacter">avscan</code> in <a id="h201467_2" class="englishcrossreferencetemplate" href="#179698" target="_self">Kaspersky Scan Engine GUI</a>.</li><li class="listbullet2">Set the value of the RespModeAddress element to <code class="programcharacter">avscan</code> in the <a id="h180154_3" class="englishcrossreferencetemplate" href="#192989" target="_self">ICAP mode configuration file</a>.</li></ul></li></ol><p class="introheading">Step II. Configuring Dell EMC Isilon</p>
<p class="procedureheading">To configure Dell EMC Isilon:</p>
<ol class="listnumber1"><li class="listnumber1">In the Dell OneFS web administration interface, go to <span class="boldcharacter">Data Protection</span> &gt; <span class="boldcharacter">Antivirus</span> &gt; <span class="boldcharacter">ICAP</span>.<p class="picture"><img id="f220098" src="onefs-the-icap-tab.png" class="linkedpngfiletemplate" alt="&quot;ICAP&quot; tab and its elements: Policies, Detected threats, Servers, Settings." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">The <span class="boldcharacter">ICAP</span> tab</p>
</li><li class="listnumber1">In the <span class="boldcharacter">Servers</span> area, click <span class="boldcharacter">Add Server</span>.<p class="listcontinue1">The <span class="boldcharacter">Add ICAP antivirus server</span> dialog box appears.</p>
</li><li class="listnumber1">In the <span class="boldcharacter">Add ICAP antivirus server</span> dialog box, do the following:<ol class="listalpha2"><li class="listalpha2">In the <span class="boldcharacter">Server URL</span> field, type the address Kaspersky Scan Engine: <code class="programcharacter">icap://%KSE_IP%:1344/avscan</code>. Here <code class="programcharacter">%KSE_IP%</code> is the IPv4 address.</li><li class="listalpha2">In the <span class="boldcharacter">Server name</span> field, type the name for the server, for example <code class="programcharacter">KasperskyScanEngine</code>.</li><li class="listalpha2">Click <span class="boldcharacter">Add Server</span>.</li></ol><p class="picture"><img id="f220100" src="onefs-add-icap-antivirus-server.png" class="linkedpngfiletemplate" alt="&quot;Add ICAP antivirus server&quot; dialog box. Server URL = icap://hidden IP:1344/avscan, Server name = KasperskyScanEngine, Enable this server checkbox is on." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">The <span class="boldcharacter">Add ICAP antivirus server</span> dialog box</p>
</li><li class="listnumber1">In the <span class="boldcharacter">Settings</span> area, specify the following:<ol class="listalpha2"><li class="listalpha2">The action on detection. For example, you can choose <span class="boldcharacter">Attempt to truncate file when threat is found</span>.</li><li class="listalpha2">Optionally, you can specify the maximum size of the files to scan. The default value is 2 GB.</li><li class="listalpha2">Optionally, you can specify the path prefixes. <em class="emphasischaracter">Path prefixes</em> are the paths in the filesystem that will trigger scanning when files are added to them.</li><li class="listalpha2">Optionally, you can specify the filters for object names. Filters for object names define objects that should or should not be scanned in On-Access mode.</li><li class="listalpha2">Optionally, you can enable the <span class="boldcharacter">Enable scan of files on open, Enable file access when scanning fails</span>, and <span class="boldcharacter">Enable scan of files on closed</span> settings.</li><li class="listalpha2">Optionally, configure scan report retention.</li><li class="listalpha2">Click <span class="boldcharacter">Submit</span>.</li></ol><p class="picture"><img id="f220101" src="onefs-all-scans.png" class="linkedpngfiletemplate" alt="All Scans. Action on detection = Attempt to truncate file when a threat is found, Maximum filescan size = 2 GB. Selected options for On access scans: Enable scan of files on open, Enable file access when scanning fails, Enable scan of files on close." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">The <span class="boldcharacter">All scans </span>dialog box</p>
</li><li class="listnumber1">Click <span class="boldcharacter">Switch antivirus service</span>.</li><li class="listnumber1">Turn on <span class="boldcharacter">Switch ICAP antivirus</span>.</li><li class="listnumber1">Click <span class="boldcharacter">Confirm</span>.</li></ol><p class="introheading">Schedule scanning</p>
<p class="bodytext">You can configure scanning schedule to scan your storage on a regular basis.</p>
<p class="procedureheading">To configure scanning schedule:</p>
<ol class="listnumber1"><li class="listnumber1">In the Dell OneFS web administration interface, go to <span class="boldcharacter">Data protection</span> &gt; <span class="boldcharacter">Antivirus</span> &gt; <span class="boldcharacter">ICAP</span> &gt; <span class="boldcharacter">Policies</span>.</li><li class="listnumber1">Click the <span class="boldcharacter">Create an antivirus policy</span>.<p class="listcontinue1">The <span class="boldcharacter">Create a policy</span> dialog box appears.</p>
<p class="picture"><img id="f220103" src="onefs-create-a-policy.png" class="linkedpngfiletemplate" alt="&quot;Create a policy&quot; dialog box. Antivirus policy is enabled. Policy name = ScanEngineRegularScan, Paths = /ifs/home/ftp/incoming, Recursion depth = Full recursion. Impact Policy = DEFAULT, Scheduled daily at 12:00 AM." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">The <span class="boldcharacter">Create a policy</span> dialog box</p>
</li><li class="listnumber1">Select the <span class="boldcharacter">Enable antivirus policy</span>&nbsp;check box.</li><li class="listnumber1">Specify the name of the policy in the&nbsp;<span class="boldcharacter">Policy name</span>&nbsp;text field.</li><li class="listnumber1">Enter the description of the policy in the <span class="boldcharacter">Description</span> text field.</li><li class="listnumber1">Add paths to the directories that you want to scan.</li><li class="listnumber1">Optionally, you can set a limit on the recursion depth in the <span class="boldcharacter">Recursion depth</span> section, but this is not recommended.</li><li class="listnumber1">Specify the impact policy settings:<ol class="listalpha2"><li class="listalpha2">Optionally, you can select <span class="boldcharacter">Enable force run of policy regardless of impact policy</span>, but this is not recommended. </li><li class="listalpha2">Select the <code class="programcharacter">DEFAULT</code> impact policy from the <span class="boldcharacter">Impact Policy</span>&nbsp;drop-down list.</li></ol></li><li class="listnumber1">Select the <span class="boldcharacter">Scheduled</span> radio button.</li><li class="listnumber1">Specify the scheduling settings:<ol class="listalpha2"><li class="listalpha2">Choose the interval for running the policy.</li><li class="listalpha2">Configure the policy to run at the desired time.</li></ol></li><li class="listnumber1">Click <span class="boldcharacter">Submit</span>.</li></ol><p class="introheading">Reviewing the detect objects</p>
<p class="procedureheading">To review the detected objects,</p>
<p class="bodytextindent">In the Dell OneFS web administration interface, go to <span class="boldcharacter">Data Protection</span> &gt; <span class="boldcharacter">Antivirus</span> &gt; <span class="boldcharacter">ICAP</span> &gt; <span class="boldcharacter">Detected Threats</span>.</p>
<p class="picture"><img id="f220102" src="onefs-detected-objects.png" class="linkedpngfiletemplate" alt="Detected objects table. Columns: Name, Path, Remediation, Policy, Detected (date and time), Actions." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">The list of detected objects</p>
<p class="bodytextindent">This is the list of files that were quarantined or truncated, along with the name of the detected object, file path, remediation method, policy, and timestamp.</p>
<p class="bodytextindent">Click the <span class="boldcharacter">View details</span> button next to a detected object to view the detailed information.</p>
<p class="procedureheading">To restore a file from the list and allow user access to it:</p>
<ol class="listnumber1"><li class="listnumber1">Click the&nbsp;<span class="boldcharacter">More</span>&nbsp;drop-down list. </li><li class="listnumber1">Select&nbsp;<span class="boldcharacter">Release file</span>.</li></ol><p class="introheading">Recommendations</p>
<p class="bodytext">You must configure at least one copy of Kaspersky Scan Engine to provide virus scanning&nbsp;for each Isilon cluster. In a typical environment, a minimum of two Kaspersky Scan Engine instances are required to handle a NAS server. Having only one instance can cause denial of file access, in which case the instance does not respond. Isilon clusters handle load balancing across multiple Kaspersky Scan Engine instances automatically.</p>
<p class="warningbody">All Kaspersky Scan Engine instances that are registered with an Isilon cluster must have identical configurations.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221109"><p><a name=221109 style="display: none;">[Topic 221109]</a></p>
	<h3 id="t234573" class="heading3">Using Kaspersky Scan Engine with F5 BIG-IP Application Security Manager</h3>
<p class="bodytext">You can configure Kaspersky Scan Engine to work with F5 BIG-IP&reg; Application Security Manager&#8482; (hereinafter ASM). For convenience, this process is separated into several steps.</p>
<p class="introheading">Step I. Configuring Kaspersky Scan Engine</p>
<p class="procedureheading">To configure Kaspersky Scan Engine, do one of the following:</p>
<ul class="listbullet1"><li class="listbullet1">In the <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">ICAP mode configuration file</a>, set the value of the <code class="programcharacter">VirusNameICAPHeader</code> element to <code class="programcharacter">X-Virus-ID</code>.</li><li class="listbullet1">In the <span class="guicharacter">Service</span> page of Kaspersky Scan Engine GUI, set the value of the <span class="guicharacter">Detected object name HTTP header</span> field to <code class="programcharacter">X-Virus-ID</code>.</li></ul><p class="introheading">Step II. Configuring ASM</p>
<p class="procedureheading">To configure ASM:</p>
<ol class="listnumber1"><li class="listnumber1">Log in to the Configuration utility.</li><li class="listnumber1">Go to <span class="boldcharacter">Security &gt; Options &gt; Application Security &gt; Integrated Services &gt; Anti-Virus Protection</span>.<p class="picture"><img id="f221132" src="f5_1.png" class="linkedpngfiletemplate" alt="Anti-Virus Protection Configuration: Server Host Name/IP Address, Server Port Number, Guarantee Enforcement." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Anti-Virus Protection</p>
</li><li class="listnumber1">In the <span class="boldcharacter">Server Host Name/IP Address</span> field, specify the IP address of the Kaspersky Scan Engine ICAP server.</li><li class="listnumber1">In the <span class="boldcharacter">Server Port Number</span> field, specify the port of the Kaspersky Scan Engine ICAP server in or leave the default value of <code class="programcharacter">1344</code>.</li><li class="listnumber1">Select the <span class="boldcharacter">Guarantee Enforcement</span> check box if you want the system to perform virus checking even if this may slow your web application.</li><li class="listnumber1">Click <span class="boldcharacter">Save</span>.</li><li class="listnumber1">To apply the security policy changes immediately, click <span class="boldcharacter">Apply Policy</span>.</li><li class="listnumber1">Go to <span class="boldcharacter">Security &gt; Options &gt; Application Security &gt; Advanced Configuration &gt; System Variables</span>.</li><li class="listnumber1">Configure the internal variables:<ul class="listbullet2"><li class="listbullet2">In ASM 13.1.X - 16.X:<ol class="listalpha3"><li class="listalpha3">For the <span class="boldcharacter">icap_uri</span> setting, enter <code class="programcharacter">/req</code> in the <span class="boldcharacter">Parameter Value</span> setting. This is the default value in <code class="programcharacter"><a id="h207258" class="englishcrossreferencetemplate" href="#207194" target="_self">ReqModeAddress</a></code>.</li><li class="listalpha3">For the <span class="boldcharacter">virus_header_name</span> setting, enter <code class="programcharacter">X-Virus-ID</code> in the <span class="boldcharacter">Parameter Value</span> setting.</li><li class="listalpha3">Select <span class="boldcharacter">Update</span>.</li></ol></li><li class="listbullet2">In ASM 11.X - 13.0.X:<ol class="listalpha3"><li class="listalpha3">For the <span class="boldcharacter">icap_uri</span> setting, enter <code class="programcharacter">/req</code> in the <span class="boldcharacter">Parameter Value</span> setting. This is the default value in <code class="programcharacter"><a id="h207258_2" class="englishcrossreferencetemplate" href="#207194" target="_self">ReqModeAddress</a></code>.</li><li class="listalpha3">For the <span class="boldcharacter">virus_header_name</span> setting, enter <code class="programcharacter">X-Virus-ID</code>.</li><li class="listalpha3">Select <span class="boldcharacter">Save</span>.</li></ol></li></ul></li></ol><p class="introheading">Configuring blocking of detected objects</p>
<p class="procedureheading">To configure blocking of detected objects:</p>
<ul class="listbullet1"><li class="listbullet1">In ASM 13.1.X - 16.X:<ol class="listalpha2"><li class="listalpha2">Log in to the Configuration utility.</li><li class="listalpha2">Go to <span class="boldcharacter">Security &gt; Application Security &gt; Policy Building &gt; Learning and Blocking Settings</span>.</li><li class="listalpha2">Set the view to <span class="boldcharacter">Advanced</span>.</li><li class="listalpha2">Expand <span class="boldcharacter">Antivirus</span> (expand <span class="boldcharacter">Antivirus Protection</span> in versions earlier than 14.X) and select either or both of the <span class="boldcharacter">Alarm</span> and <span class="boldcharacter">Block</span> check boxes for the <span class="boldcharacter">Virus Detected</span> violation.</li><li class="listalpha2">Click <span class="boldcharacter">Save</span>.</li><li class="listalpha2">To activate the security policy changes immediately, select <span class="boldcharacter">Apply Policy</span>.</li></ol></li><li class="listbullet1">In ASM 12.X:<ol class="listalpha2"><li class="listalpha2">Log in to the Configuration utility.</li><li class="listalpha2">Go to <span class="boldcharacter">Security &gt; Application Security &gt; Policy Building &gt; Learning and Blocking Settings</span>.</li><li class="listalpha2">Set the view to <span class="boldcharacter">Advanced</span>.</li><li class="listalpha2">Expand <span class="boldcharacter">Policy General Features</span> and select either or both of the <span class="boldcharacter">Alarm</span> and <span class="boldcharacter">Block</span> check boxes for the <span class="boldcharacter">Virus Detected</span> violation.</li><li class="listalpha2">Click <span class="boldcharacter">Save</span>.</li><li class="listalpha2">To apply the security policy changes immediately, click <span class="boldcharacter">Apply Policy</span>.</li></ol></li><li class="listbullet1">In ASM 11.X:<ol class="listalpha2"><li class="listalpha2">Log in to the Configuration utility.</li><li class="listalpha2">Go to <span class="boldcharacter">Security &gt; Application Security &gt; Blocking.</span></li><li class="listalpha2">Under <span class="boldcharacter">Violations List</span>, for <span class="boldcharacter">Negative Security Violations</span> select either or both of the <span class="boldcharacter">Alarm</span> and <span class="boldcharacter">Block</span> check boxes for the <span class="boldcharacter">Virus Detected</span> violation.</li><li class="listalpha2">Click <span class="boldcharacter">Save</span>.</li><li class="listalpha2">To activate the security policy changes immediately, click <span class="boldcharacter">Apply Policy</span>.</li></ol></li></ul><p class="introheading">Configuring scanning of uploaded files and email attachments</p>
<p class="procedureheading">To configure scanning of uploaded files and email attachments:</p>
<ol class="listnumber1"><li class="listnumber1">Go to <span class="boldcharacter">Security &gt; Application Security &gt; Integrated Services &gt; Anti-Virus Protection</span>.</li><li class="listnumber1">Select the relevant security policy from the list.</li><li class="listnumber1">Select the <span class="boldcharacter">Inspect file uploads within HTTP requests</span> check box.</li><li class="listnumber1">To scan SOAP attachments, move the relevant XML profiles from the <span class="boldcharacter">Antivirus Protection Disabled</span> list to the<span class="boldcharacter"> Antivirus Protection Enabled</span> list.</li><li class="listnumber1">Click <span class="boldcharacter">Save</span>.</li><li class="listnumber1">To apply the security policy changes immediately, click <span class="boldcharacter">Apply Policy</span>.<p class="picture"><img id="f221134" src="f5_3.png" class="linkedpngfiletemplate" alt="&quot;Inspect file uploads within HTTP requests&quot; enabled. &quot;Antivirus Protection Disabled&quot; list contains the &quot;Default&quot; element." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Apply Policy</p>
</li></ol><p class="introheading">Reviewing the detect objects</p>
<p class="procedureheading">To view reports on detected objects:</p>
<ol class="listnumber1"><li class="listnumber1">Log in to the Configuration utility.</li><li class="listnumber1">Go to <span class="boldcharacter">Security &gt; Reporting &gt; Application &gt; Charts</span>.</li><li class="listnumber1">Select <span class="boldcharacter">Top Viruses Detected</span> in the charts list.<p class="listcontinue1">The system will display the detected viruses over time.</p>
</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221715"><p><a name=221715 style="display: none;">[Topic 221715]</a></p>
	<h3 id="t234579" class="heading3">Using Kaspersky Scan Engine in ICAP mode with GoAnywhere MFT</h3>
<p class="bodytext">You can configure Kaspersky Scan Engine to work with GoAnywhere MFT. For convenience, this process is separated into several steps.</p>
<p class="introheading">Configuring Kaspersky Scan Engine</p>
<p class="bodytext">To be integrated with GoAnywhere MFT, Kaspersky Scan Engine must be working in ICAP mode.</p>
<p class="procedureheading">To configure Kaspersky Scan Engine,</p>
<p class="bodytextindent">Enable sending a <code class="programcharacter">204 No Content HTTP</code> status code. You can do it in the following ways:</p>
<ul class="listbullet2"><li class="listbullet2">In the Kaspersky Scan Engine GUI, by turning on the <span class="guicharacter">Send code 204</span> toggle switch on the <a id="h201467" class="englishcrossreferencetemplate" href="#179698" target="_self">Service settings page</a>.</li><li class="listbullet2">In the ICAP mode configuration file, by specifying <code class="programcharacter">1</code> in the <code class="programcharacter"><a id="h201199" class="englishcrossreferencetemplate" href="#200720" target="_self">Allow204</a></code> element.</li></ul><p class="introheading">Configuring GoAnywhere MFT to work with Kaspersky Scan Engine</p>
<p class="procedureheading">To add Kaspersky Scan Engine into GoAnywhere MFT:</p>
<ol class="listnumber1"><li class="listnumber1">In the GoAnywhere MFT web console, open the <span class="boldcharacter">Resources</span> page.</li><li class="listnumber1">In the <span class="boldcharacter">Resource Types</span> list, choose <span class="boldcharacter">ICAP Servers</span>.<p class="picture"><img id="f221716" src="goanywhere_icap_servers.png" class="linkedpngfiletemplate" alt="&quot;ICAP servers&quot; selected in the &quot;Resource Types&quot; list." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">GoAnywhere MFT. ICAP servers</p>
</li><li class="listnumber1">Click the <span class="boldcharacter">Add ICAP Server</span> button.</li><li class="listnumber1">Fill out the form that opens:<ul class="listbullet2"><li class="listbullet2"><span class="boldcharacter">Name</span>. Specify any name for the Kaspersky Scan Engine server. For example, <em class="emphasischaracter">Kaspersky Scan Engine ICAP</em>.</li><li class="listbullet2"><span class="boldcharacter">URL</span>. Specify the URL that Kaspersky Scan Engine uses in response mode. That is, the URL must contain the part that specifies the RESP method. For example, <em class="emphasischaracter">icap://{KSE_ICAP}:1344/resp</em>.</li></ul><p class="picture"><img id="f221717" src="goanywhere_kse_server_settings.png" class="linkedpngfiletemplate" alt="ICAP server settings: Name = Kaspersky Scan Engine ICAP, URL = icap://IP_address:1344/resp." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">GoAnywhere MFT. Kaspersky Scan Engine ICAP server settings</p>
</li><li class="listnumber1">Click the <span class="boldcharacter">Test</span> button.<p class="listcontinue1">GoAnywhere MFT tests the connection with the newly added Kaspersky Scan Engine server. An example of a successful test is shown in the picture below.</p>
<p class="picture"><img id="f221718" src="goanywhere_resource_test_successful.png" class="linkedpngfiletemplate" alt="Test Results: Resource test was successful." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">GoAnywhere MFT. Successful connection to the Kaspersky Scan Engine ICAP server</p>
</li><li class="listnumber1">Click <span class="boldcharacter">Save</span>.</li></ol><p class="bodytext">You can now use Kaspersky Scan Engine to scan objects from GoAnywhere MFT.</p>
<p class="picture"><img id="f221719" src="goanywhere_configuration_result.png" class="linkedpngfiletemplate" alt="Resource &quot;Kaspersky Scan Engine ICAP&quot; was added successfully." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">GoAnywhere MFT configuration complete</p>
<p class="introheading">Creating a regular scan task</p>
<p class="bodytext">You can create a task to scan objects in Kaspersky Scan Engine on a regular basis.</p>
<p class="procedureheading">To create a regular scan task:</p>
<ol class="listnumber1"><li class="listnumber1">In the GoAnywhere MFT web console, open the <span class="boldcharacter">Workflow/Projects</span> page.</li><li class="listnumber1">Click the <span class="boldcharacter">Create a Project</span> button.</li><li class="listnumber1">In the form that opens, fill in the <span class="boldcharacter">Project Name</span> field (for example, <em class="emphasischaracter">Kaspersky Scan Engine regular scan</em>).</li><li class="listnumber1">Click <span class="boldcharacter">Save</span>.<p class="listcontinue1">The page with the <span class="boldcharacter">Component Library</span> list opens.</p>
<p class="picture"><img id="f221746" src="goanywhere_component_library.png" class="linkedpngfiletemplate" alt="&quot;Create File List&quot; selected." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">GoAnywhere MFT. Component Library</p>
</li><li class="listnumber1">In the <span class="boldcharacter">Component Library</span> list:<p class="listcontinue1">a. Double-click the <span class="boldcharacter">File System/Create File List</span> element, and then fill out the form that opens:</p>
<ul class="listbullet3"><li class="listbullet3"><span class="boldcharacter">File List Variable</span>. Specify <em class="emphasischaracter">files</em>.</li><li class="listbullet3"><span class="boldcharacter">Base Directory</span>. Specify the path to the directory that contains the objects to send for scanning in Kaspersky Scan Engine.</li></ul><p class="picture"><img id="f221745" src="goanywhere_file_list_settings.png" class="linkedpngfiletemplate" alt="File List Variable =  files, Base Directory = /opt/kaspersky/temp." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">GoAnywhere MFT. File List settings</p>
<p class="listcontinue1">b. Double-click the <span class="boldcharacter">Loops/For-Each Loop</span> element, and then fill out the form that opens:</p>
<ul class="listbullet3"><li class="listbullet3"><span class="boldcharacter">Items Variable</span>. Specify <em class="emphasischaracter">${files}</em>.</li><li class="listbullet3"><span class="boldcharacter">Current Item Variable</span>. Specify <em class="emphasischaracter">file</em>.</li></ul><p class="listcontinue1">c. Double-click the <span class="boldcharacter">Integration/ICAP</span> element, and then fill out the form that opens:</p>
<ul class="listbullet3"><li class="listbullet3"><span class="boldcharacter">ICAP Server</span>. Specify <em class="emphasischaracter">Kaspersky Scan Engine ICAP</em>.</li><li class="listbullet3"><span class="boldcharacter">Source File</span>. Specify <em class="emphasischaracter">${file}</em>.</li><li class="listbullet3"><span class="boldcharacter">Output Variables/ICAP Status Code Variable</span>. Specify <em class="emphasischaracter">icap_resp_code</em>.</li></ul><p class="picture"><img id="f221750" src="goanywhere_integration_icap_settings.png" class="linkedpngfiletemplate" alt="ICAP server integration. Label = SendtoScanEngine, ICAP Server = Kaspersky Scan Engine ICAP, Source File = ${file}, ICAP Status Code Variable = icap_resp_code." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">GoAnywhere MFT. ICAP server integration settings</p>
<p class="listcontinue1">d. Double-click the <span class="boldcharacter">Job Control/If</span> element, and then fill out the form that opens:</p>
<ul class="listbullet3"><li class="listbullet3"><span class="boldcharacter">Condition</span>. Specify <em class="emphasischaracter">${icap_resp_code == 200}</em>.</li></ul><p class="picture"><img id="f221751" src="goanywhere_job_control_if_settings.png" class="linkedpngfiletemplate" alt="&quot;If&quot; element. Label = IfMalicious, Condition = ${icap_resp_code == 200}." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">GoAnywhere MFT. &quot;If&quot; condition</p>
<p class="listcontinue1">e. Double-click the <span class="boldcharacter">File System/Delete</span> element, and then fill out the form that opens:</p>
<ul class="listbullet3"><li class="listbullet3"><span class="boldcharacter">Input Files Variable</span>. Specify <em class="emphasischaracter">${file}</em>.</li></ul><p class="picture"><img id="f221752" src="goanywhere_remove_malware.png" class="linkedpngfiletemplate" alt="&quot;Delete&quot; element. Input Files Variable = ${file}." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">GoAnywhere MFT. Input Files Variable</p>
<p class="attentioncontinue2">Kaspersky specialists recommend removing malware instantly, but you can specify a different action, such as moving the malware to another directory, renaming the malware, or configuring GoAnywhere MFT to send a notification to a security specialist.</p>
</li><li class="listnumber1">After creating these elements, arrange them in the following hierarchy:<ul class="listbullet2"><li class="listbullet2"><span class="boldcharacter">File System/Create File List</span></li><li class="listbullet2"><span class="boldcharacter">Loops/For-Each Loop </span><ul class="listbullet3"><li class="listbullet3"><span class="boldcharacter">Integration/ICAP </span></li><li class="listbullet3"><span class="boldcharacter">Job Control/If</span><ul class="listbullet4"><li class="listbullet4"><span class="boldcharacter"> File System/Delete</span></li></ul></li></ul></li></ul><p class="picture"><img id="f221753" src="goanywhere_settings_hierarchy.png" class="linkedpngfiletemplate" alt="TestProj, Main, CreateFileList, TestLoop, SendToScanEngine, IfMalicious, RemoveMalware." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">GoAnywhere MFT. Settings hierarchy</p>
</li><li class="listnumber1">Open the <span class="boldcharacter">Workflow/Schedule</span> page, and then fill out the form:<p class="listcontinue1">a. In the <span class="boldcharacter">Project</span> field, specify <em class="emphasischaracter">Kaspersky Scan Engine regular scan</em>.</p>
<p class="picture"><img id="f221754" src="goanywhere_kse_regular_scan_project.png" class="linkedpngfiletemplate" alt="Project settings. Name = KSE  regular scan, Project = /Kaspersky Scan Engine regular scan, Admin User = admin, Password hidden." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">GoAnywhere MFT. Regular scan project</p>
<p class="listcontinue1">b. In the <span class="boldcharacter">Schedule</span> tab, specify the required scanning frequency.</p>
<p class="picture"><img id="f221755" src="goanywhere_kse_regular_scan_schedule.png" class="linkedpngfiletemplate" alt="Scan schedule. Schedule Frequency = Daily." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">GoAnywhere MFT. Regular scan schedule</p>
<p class="listcontinue1">c. Click <span class="boldcharacter">Save</span>.</p>
<p class="spacer"></p>
</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179905"><p><a name=179905 style="display: none;">[Topic 179905]</a></p>
	<h2 id="t234287" class="heading2">Building executable files for Kaspersky Scan Engine used in ICAP mode</h2>
<p class="bodytext">You can compile the kavicapd service from the source code located in the <code class="programcharacter">%service_dir%/samples/kavicap/</code> directory.</p>
<p class="introheading">Software requirements</p>
<p class="bodytext">To compile the kavicapd service, you must install the following software on your computer:</p>
<ul class="listbullet1"><li class="listbullet1">Boost 1.72.0 or later. The kavicapd service source files are linked statically with Boost, which requires the boost-static.x86_64 package.</li><li class="listbullet1">GNU C Library and GNU Standard C++ Library with static variants of libraries.</li><li class="listbullet1">OpenSSL library (latest version). It is recommended to install the openssl-devel package.</li><li class="listbullet1">PostgreSQL libraries from 6.4.4 to 7 (non-inclusive). It is recommended to install the libpqxx-devel package.</li><li class="listbullet1">Brotli dynamic library.</li></ul><p class="bodytext">You will also need the GNU Compiler Collection (GCC) 7.3.0 or later. Use the same version of GCC to compile Boost and the kavicapd service.</p>
<p class="procedureheading">To compile Kaspersky Scan Engine for use in ICAP mode:</p>
<ol class="listnumber1"><li class="listnumber1">Navigate to the <code class="programcharacter">%service_dir%/samples/kavicap/</code> directory.</li><li class="listnumber1">Run <code class="programcharacter">gmake</code>.</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179683"><p><a name=179683 style="display: none;">[Topic 179683]</a></p>
	<h1 id="t234576" class="heading1">Using Kaspersky Scan Engine GUI</h1>
<p class="bodytext">This section describes the graphical user interface (GUI) provided by Kaspersky Scan Engine.</p>
<p class="listheading">Depending on the <a id="h219851" class="englishcrossreferencetemplate" href="#219850" target="_self">role</a>, the user of Kaspersky Scan Engine GUI can do the following:</p>
<ul class="listbullet1"><li class="listbullet1">Change Kaspersky Scan Engine settings</li><li class="listbullet1">Learn about the health of Kaspersky Scan Engine</li><li class="listbullet1">Browse service events and events with scan results</li><li class="listbullet1">Save service events and events with scan results to a file</li></ul><table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#219850" target="_self">User roles</a></p><p class="relateditem"><a href="#179694" target="_self">Signing in to Kaspersky Scan Engine</a></p><p class="relateditem"><a href="#179706" target="_self">Using the footer bar</a></p><p class="relateditem"><a href="#179695" target="_self">Kaspersky Scan Engine dashboard</a></p><p class="relateditem"><a href="#179696" target="_self">Kaspersky Scan Engine scan results page</a></p><p class="relateditem"><a href="#201264" target="_self">Managing Kaspersky Scan Engine cluster instances</a></p><p class="relateditem"><a href="#179697" target="_self">Kaspersky Scan Engine settings pages</a></p><p class="relateditem"><a href="#179705" target="_self">Changing password</a></p><p class="relateditem"><a href="#185278" target="_self">Working with the klScanEngineUI binary file</a></p><p class="relateditem"><a href="#192471" target="_self">Running the klScanEngineUI service with systemd unit file (Linux)</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="219850"><p><a name=219850 style="display: none;">[Topic 219850]</a></p>
	<h2 id="t234567" class="heading2">User roles</h2>
<p class="bodytext">The Kaspersky Scan Engine functionality includes differentiation of access rights for users. Access rights are defined by the <em class="emphasischaracter">user roles</em> assigned to each user of Kaspersky Scan Engine. Assigning the user role with limited access rights to ordinary information security employees allows them to monitor and analyze incidents, but they cannot change the configuration of Kaspersky Scan Engine.</p>
<p class="bodytext">There are two user roles In Kaspersky Scan Engine:</p>
<ul class="listbullet1"><li class="listbullet1"><em class="emphasischaracter">Administrator</em> has full access to the Kaspersky Scan Engine functionality.</li><li class="listbullet1"><em class="emphasischaracter">Operator</em> has limited access to the Kaspersky Scan Engine functionality.</li></ul><p class="bodytext">See the table below for more information on the functions available for each user role.</p>
<p class="tablename">Availability of Kaspersky Scan Engine functionality for different user roles</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="656" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="219"><p class="tableheading">Kaspersky Scan Engine GUI</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="219"><p class="tableheading">Administrator</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="219"><p class="tableheading">Operator</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext"><a id="h180278" class="englishcrossreferencetemplate" href="#179695" target="_self">Dashboard</a></p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Available</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Limited availability:</p>
<ul class="tablelistbullet"><li class="tablelistbullet">The following functions are unavailable:<ul class="listbullet2"><li class="listbullet2">Restarting Kaspersky Scan Engine (<span class="guicharacter">Restart</span> button).</li><li class="listbullet2">Updating anti-virus database (<span class="guicharacter">Update</span> button).</li><li class="listbullet2">Deleting all data from the anti-virus database and getting the new data (<span class="guicharacter">Update from scratch</span> button).</li><li class="listbullet2">Changing the key file or the activation code (<span class="guicharacter">Change</span> button).</li></ul></li><li class="tablelistbullet">Limited data set in the table of events. Operator can only view events related to scanning and events initiated by themselves. </li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext"><a id="h180597" class="englishcrossreferencetemplate" href="#179696" target="_self">Scan results</a></p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Available</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Limited availability.</p>
<p class="tablebodytext">Operator cannot reset scan results (the <span class="guicharacter">Reset statistics</span> button is not available).</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext"><a id="h180271" class="englishcrossreferencetemplate" href="#179697" target="_self">Settings</a></p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Available</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Unavailable</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext"><a id="h201478" class="englishcrossreferencetemplate" href="#201264" target="_self">Cluster</a></p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Available</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Unavailable</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179694"><p><a name=179694 style="display: none;">[Topic 179694]</a></p>
	<h2 id="t234519" class="heading2">Signing in to Kaspersky Scan Engine</h2>
<p class="bodytext">When you try to access Kaspersky Scan Engine GUI, the authentication page is displayed. You cannot use Kaspersky Scan Engine GUI if you are not authorized.</p>
<p class="bodytext">At the bottom of the page, you can find the current version of Kaspersky Scan Engine. </p>
<p class="picture"><img id="f182806" src="auth.png" class="linkedpngfiletemplate" alt="Login form." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Authentication page</p>
<p class="bodytext">On the authentication page, you specify a user name and password and click <span class="boldcharacter">Sign in</span>. After you are authorized, the <a id="h180278" class="englishcrossreferencetemplate" href="#179695" target="_self">Kaspersky Scan Engine dashboard</a> opens.</p>
<p class="bodytext">After you have installed Kaspersky Scan Engine, a preconfigured account, <code class="programcharacter">admin</code>, is created. The default password of this account is <code class="programcharacter">KAVAdmin!1</code>. We recommend that you change the password after you have logged in for the first time. If you changed the initial password and forgot it, you can <a id="h180277" class="englishcrossreferencetemplate" href="#179831" target="_self">restore it to its default value</a>.</p>
<p class="bodytext">If you are inactive for 2 hours, your session is closed and you have to log in again to continue using Kaspersky Scan Engine GUI.</p>
<p class="attentionbody">After several unsuccessful attempts to sign in into an account, Kaspersky Scan Engine temporarily blocks it. To access a blocked account, contact your Administrator and request that your password be reset.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179706"><p><a name=179706 style="display: none;">[Topic 179706]</a></p>
	<h2 id="t234584" class="heading2">Using the footer bar</h2>
<p class="bodytext">This section describes the<em class="emphasischaracter"> footer bar</em> of Kaspersky Scan Engine GUI. The footer bar is in the lower-left corner of every page of Kaspersky Scan Engine GUI.</p>
<p class="bodytext">The footer bar contains the current user split button (<img id="f183233" src="login.png" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0">). After clicking this button, you can choose one of the following actions:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h180236" class="englishcrossreferencetemplate" href="#179705" target="_self">Change password</a> and other settings of the current user profile.</li><li class="listbullet1">Log out.</li><li class="listbullet1">Open the page of the Kaspersky Scan Engine documentation where the current page of Kaspersky Scan Engine GUI is described.</li><li class="listbullet1">View the current version of Kaspersky Scan Engine.</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179695"><p><a name=179695 style="display: none;">[Topic 179695]</a></p>
	<h2 id="t234408" class="heading2">Kaspersky Scan Engine dashboard</h2>
<p class="bodytext">This section describes the Kaspersky Scan Engine dashboard. It opens when you click <span class="guicharacter">Dashboard</span> in Kaspersky Scan Engine GUI.</p>
<p class="attentionbody">All information is displayed in the UTC timezone. You can switch to your local timezone on the <span class="guicharacter"><a id="h221158" class="englishcrossreferencetemplate" href="#219610" target="_self">User</a></span> page.</p>
<p class="picture"><img id="f182807" src="dashboard.png" class="linkedpngfiletemplate" alt="Dashboard showing the status of Kaspersky Scan Engine and Anti-Virus database, information about KSN, license information, and the table of Kaspersky Scan Engine events." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Kaspersky Scan Engine dashboard</p>
<p class="bodytext">The Kaspersky Scan Engine dashboard displays the following information:</p>
<ul class="listbullet1"><li class="listbullet1">Information about Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">The current status of Kaspersky Scan Engine<p class="listcontinue2">The information displayed indicates whether Kaspersky Anti-Virus Engine is running or not.</p>
</li><li class="listbullet2">The Kaspersky Anti-Virus Engine initialization result<p class="listcontinue2">This result is displayed if the initialization of Kaspersky Anti-Virus Engine failed.</p>
</li><li class="listbullet2">The KAV SDK version</li><li class="listbullet2">Host name of the computer that Kaspersky Scan Engine was initialized on</li></ul></li><li class="listbullet1">Information about the license:<ul class="listbullet2"><li class="listbullet2">Information about the license key or activation code being used:<ul class="listbullet3"><li class="listbullet3">License key or activation code is valid.</li><li class="listbullet3">License key or activation code expires soon&#8212;Contact your TAM to purchase a new license key or get a new activation code.</li><li class="listbullet3">License key or activation code has expired&#8212;<a id="h180245" class="englishcrossreferencetemplate" href="#179702" target="_self">Replace the current license key or activation code</a> with a new one.</li></ul></li><li class="listbullet2">The license expiration date</li></ul></li><li class="listbullet1">Information about the anti-virus database:<ul class="listbullet2"><li class="listbullet2">The date of the last update of the anti-virus database</li><li class="listbullet2">The result of the last attempt of updating the anti-virus database</li><li class="listbullet2">The anti-virus database version</li><li class="listbullet2">The current state of the anti-virus database<p class="listcontinue2">One of the following database states is displayed:</p>
<ul class="listbullet3"><li class="listbullet3">Up to date.</li><li class="listbullet3">Out of date&#8212;You must launch the database update.</li><li class="listbullet3">Critically out of date&#8212;You must check your Internet connection and launch the database update as soon as possible.</li></ul></li></ul></li><li class="listbullet1">Information about KSN:<ul class="listbullet2"><li class="listbullet2">The current status of KSN (whether the KSN server to which Kaspersky Scan Engine transfers data is available)</li><li class="listbullet2">The date of the last KSN update</li></ul><p class="listcontinue1">This information displays only if KSN is turned on.</p>
</li></ul><p class="bodytext">This information is refreshed every several seconds.</p>
<p class="bodytext">The Kaspersky Scan Engine dashboard also contains a table with service events. The following Information about each event is included in the table:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Date</span>&#8212;Date and time of the event.</li><li class="listbullet1"><span class="guicharacter">Hostname</span>&#8212;Host name of the computer on which Kaspersky Scan Engine is working.</li><li class="listbullet1"><span class="guicharacter">Initiator</span>&#8212;Initiator of the event.<p class="attentioncontinue1">If you have upgraded Kaspersky Scan Engine from version 2.0 to a newer version, the <span class="guicharacter">Initiator</span> column does not contain information about the initiator of the events that occurred before the upgrade.</p>
</li><li class="listbullet1"><span class="guicharacter">Module</span>&#8212;Kaspersky Scan Engine module that processed the event.</li><li class="listbullet1"><span class="guicharacter">Severity</span>&#8212;Importance level of the event. The higher the level, the more important the event. </li><li class="listbullet1"><span class="guicharacter">Details</span>&#8212;Additional information about the event.</li></ul><p class="bodytext">The initial view of the table contains up to 50 last service events. You can scroll down the table to browse more service events. Using the table, you can do the following:</p>
<ul class="listbullet1"><li class="listbullet1">Select the time period during which the scan results are collected to be displayed in the table.<p class="listcontinue1">The time period you select is kept when you refresh the web page.</p>
</li><li class="listbullet1">Specify a filter for the data to be displayed:<ul class="listbullet2"><li class="listbullet2">You can choose one or several modules that issued the events:<ul class="listbullet3"><li class="listbullet3">Updater module<p class="listcontinue3">Events from this module are related to updating of the anti-virus database.</p>
</li><li class="listbullet3">Licensing module<p class="listcontinue3">Events from this module are related to the licensing functionality.</p>
</li><li class="listbullet3">Scanning module<p class="listcontinue3">Events from this module are related to errors that occurred during scanning of objects.</p>
</li><li class="listbullet3">Service<p class="listcontinue3">Events from this module can be either from HTTP Daemon or from ICAP Plug-in.</p>
</li><li class="listbullet3">Audit<p class="listcontinue3">Events from this module are related to the system audit functionality.</p>
</li></ul></li><li class="listbullet2">You can choose one or several host names of the computers on which instances of Kaspersky Scan Engine collect service events.</li></ul><p class="listcontinue1">You can also specify the severity of events to be displayed.</p>
<p class="listcontinue1">The filter you set is kept when you refresh the web page.</p>
</li><li class="listbullet1">Save the contents of the table to a file by clicking <span class="guicharacter">Export</span>.</li><li class="listbullet1">Refresh the contents of the table manually by clicking <span class="guicharacter">Refresh</span>.</li></ul><p class="bodytext">The Kaspersky Scan Engine dashboard also contains several buttons that allow you to do the following:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Restart</span>&#8212;Restart Kaspersky Scan Engine.</li><li class="listbullet1"><span class="guicharacter">Update</span>&#8212;Run the anti-virus database update.</li><li class="listbullet1"><span class="guicharacter">Update from scratch</span>&#8212;Download the anti-virus database from scratch.<p class="listcontinue1">This process occurs as follows:</p>
<ol class="listnumber2"><li class="listnumber2">Kaspersky Scan Engine stops.</li><li class="listnumber2">The anti-virus database is deleted.</li><li class="listnumber2">The anti-virus database is downloaded from the update server.</li><li class="listnumber2">Kaspersky Scan Engine starts.</li></ol></li><li class="listbullet1"><span class="guicharacter">Change</span>&#8212;(The button appears when the license has expired.) Navigate to the form that allows you to <a id="h180245_2" class="englishcrossreferencetemplate" href="#179702" target="_self">change the key file or activation code</a>.</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179696"><p><a name=179696 style="display: none;">[Topic 179696]</a></p>
	<h2 id="t234411" class="heading2">Kaspersky Scan Engine scan results page</h2>
<p class="bodytext">The <span class="boldcharacter">Scan results</span> page displays information about events with scan results generated by Kaspersky Scan Engine.</p>
<p class="attentionbody">All information is displayed in the UTC timezone. You can switch to your local timezone on the <span class="guicharacter"><a id="h221158" class="englishcrossreferencetemplate" href="#219610" target="_self">User</a></span> page.</p>
<p class="bodytext">The <span class="boldcharacter">Scan results</span> page contains the following tables:</p>
<ul class="listbullet1"><li class="listbullet1">Table with statistics about objects scanned by all instances of Kaspersky Scan Engine in a cluster</li><li class="listbullet1">Table with statistics about objects scanned by the current instance of Kaspersky Scan Engine<p class="listcontinue1">The following information is displayed for both tables:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Total</span>&#8212;The number of objects scanned by Kaspersky Scan Engine</li><li class="listbullet2"><span class="guicharacter">Detections / Total</span>&#8212;The ratio between detected objects and all scanned objects</li><li class="listbullet2"><span class="guicharacter">Malware</span>&#8212;The number of objects detected as malicious</li><li class="listbullet2"><span class="guicharacter">Adware, etc.</span>&#8212;The number of objects detected as legitimate software that can be used by intruders to damage computers or data</li><li class="listbullet2"><span class="guicharacter">Clean</span>&#8212;The number of clean objects</li></ul></li><li class="listbullet1">Table with scan results for every object scanned by Kaspersky Anti-Virus Engine<p class="listcontinue1">The following information is displayed:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Date</span>&#8212;Date and time when the scan result is received</li><li class="listbullet2"><span class="guicharacter">Hostname</span>&#8212;Host name of the computer on which the instance of Kaspersky Scan Engine performed scanning</li><li class="listbullet2"><span class="guicharacter">Client</span>&#8212;IP address of the HTTP or ICAP client that sent the object to scan.</li><li class="listbullet2"><span class="guicharacter">Danger level </span>(<img id="f184069" src="dangerlevel.png" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0">)&#8212;Danger level of the scanned object</li><li class="listbullet2"><span class="guicharacter">Info</span>&#8212;Name of the scanned file or the scanned URL</li><li class="listbullet2"><span class="guicharacter">Scan result</span>&#8212;Category of the scanned object:<ul class="listbullet3"><li class="listbullet3">Threat name or the name of legitimate software that can be used by intruders</li><li class="listbullet3">Action&#8212;Action that was performed after a threat or legitimate software that can be used by intruders was detected:<ul class="listbullet4"><li class="listbullet4">Disinfected&#8212;Scanned object was disinfected</li><li class="listbullet4">Deleted&#8212;Scanned object was deleted</li><li class="listbullet4">Skipped&#8212;Scanned object was skipped</li></ul></li></ul><p class="listcontinue2">This information appears if Kaspersky Scan Engine works in HTTP mode, the scanned object is not a URL, and you did not select the Skip in the Action on detected objects setting of the Scanning settings page</p>
</li><li class="listbullet2"><span class="guicharacter">Details</span>&#8212;Additional information about the scanned object:<ul class="listbullet3"><li class="listbullet3">Version of the Kaspersky Scan Engine database </li><li class="listbullet3">MD5 hash of the scanned object (if a file was scanned)</li><li class="listbullet3">SHA256 hash of the scanned object (if a file was scanned)</li></ul></li></ul><p class="listcontinue1">You can do the following:</p>
<ul class="listbullet2"><li class="listbullet2">Select the time period during which the scan results are collected for display in the table.<p class="listcontinue2">To do this, click the <span class="guicharacter">Date</span> link.</p>
<p class="listcontinue2">This setting is retained and is not reset to its default value when the page is refreshed.</p>
</li><li class="listbullet2">Specify a filter for the data to be displayed.<p class="listcontinue2">To do this, click the <span class="guicharacter">Danger level</span> (<img id="f184069_1" src="dangerlevel.png" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0">) icon.</p>
<p class="listcontinue2">Select the types of objects that you want to be displayed by selecting the corresponding check boxes:</p>
<ul class="listbullet3"><li class="listbullet3">Clean objects</li><li class="listbullet3">Objects of High danger level</li><li class="listbullet3">Objects of Medium danger level</li><li class="listbullet3">Objects of Low danger level</li></ul><p class="listcontinue2">This setting is retained and is not reset to its default value when the web page is refreshed.</p>
</li><li class="listbullet2">Select the host names to be displayed.<p class="listcontinue2">To do this, click the <span class="guicharacter">Hostname</span> link.</p>
</li><li class="listbullet2">Click the <span class="guicharacter">Export</span> button to save the table contents to a file.</li><li class="listbullet2">Click the <span class="guicharacter">Refresh</span> button to refresh the table contents manually.</li></ul><p class="listcontinue1">The initial view of the table contains up to the last 50 scan results. You can scroll down the table to browse more scan results.</p>
</li></ul><p class="bodytext">In the top right area of the <span class="boldcharacter">Scan results</span> page, you can click the <span class="boldcharacter">Reset statistics</span> button to clear the statistics of service events and events that have scan results.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="201264"><p><a name=201264 style="display: none;">[Topic 201264]</a></p>
	<h2 id="t234440" class="heading2">Managing Kaspersky Scan Engine cluster instances</h2>
<p class="bodytext">The <span class="boldcharacter">Cluster</span> page allows you to manage Kaspersky Scan Engine instances that are part of a cluster.</p>
<p class="introheading">Adding an instance of Kaspersky Scan Engine to a cluster</p>
<p class="bodytext">You can add a new or previously removed instance of Kaspersky Scan Engine to a cluster in the following ways:</p>
<ul class="listbullet1"><li class="listbullet1">During <a id="h193036" class="englishcrossreferencetemplate" href="#192977" target="_self">automatic installation</a>.</li><li class="listbullet1">During <a id="h181517" class="englishcrossreferencetemplate" href="#180652" target="_self">manual installation</a>.</li><li class="listbullet1">After the installation, by specifying the appropriate settings in the <code class="programcharacter">DatabaseSettings &gt; ConnectionString</code>, <code class="programcharacter">DatabaseSettings &gt; User</code>, and <code class="programcharacter">DatabaseSettings &gt; Password</code> elements of klScanEngineUI.xml. The changes will take effect after you restart the service.</li></ul><p class="introheading">Cluster page contents</p>
<p class="bodytext">The <span class="guicharacter">Cluster</span> page contains the following tabs:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Hosts</span></li><li class="listbullet1"><span class="guicharacter">Settings profiles</span></li><li class="listbullet1"><span class="guicharacter">Cluster settings</span></li></ul><p class="introheading">Hosts</p>
<p class="bodytext">The <span class="guicharacter">Hosts</span> tab displays a continuously updated (every five seconds) table of Kaspersky Scan Engine clustered instances. This table contains the following columns:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Hostname</span>&#8212;Host name of the computer that Kaspersky Scan Engine initialized on.</li><li class="listbullet1"><span class="guicharacter">Status</span>&#8212;Initialization result.</li><li class="listbullet1"><span class="guicharacter">Integration mode</span>&#8212;The mode of the Kaspersky Scan Engine instance: either <a id="h193041" class="englishcrossreferencetemplate" href="#192979" target="_self">HTTP mode</a> or <a id="h180141" class="englishcrossreferencetemplate" href="#184798" target="_self">ICAP mode</a>.</li><li class="listbullet1"><span class="guicharacter">Anti-virus database version</span>&#8212;Version of the Kaspersky Scan Engine anti-virus databases.<p class="listcontinue1">Also, this column may contain the update status with the following information:</p>
<ul class="listbullet2"><li class="listbullet2">Update is currently being performed</li><li class="listbullet2">An error occurred during update</li></ul></li><li class="listbullet1"><span class="guicharacter">Settings profile</span>&#8212;Name of the settings profile that is used in the Kaspersky Scan Engine instance.<p class="listcontinue1">If the name of the settings profile is <em class="emphasischaracter">Default</em>, Kaspersky Scan Engine uses the preset settings. If the name is <em class="emphasischaracter">Custom</em>, Kaspersky Scan Engine uses its own custom settings and does not use any settings profile.</p>
</li></ul><p class="bodytext">On this tab, click the <span class="boldcharacter">Options</span> icon (<img id="f209074" src="cluster_button_small.png" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0">) to the left of the instance that you need, and then select any of the following actions:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Change profile settings</span>&#8212;Specifies which settings profile must be used</li><li class="listbullet1"><span class="guicharacter">Launch database update</span>&#8212;Updates the Kaspersky Scan Engine anti-virus database<p class="listcontinue1">You cannot launch the update if it is currently running and if the instance of Kaspersky Scan Engine is deinitialized.</p>
</li><li class="listbullet1"><span class="guicharacter">Enable logging</span>&#8212;Enables debug logging in the instance of Kaspersky Scan Engine<p class="listcontinue1">Also, you can disable launched debug logging.</p>
<p class="listcontinue1">You cannot enable debug logging if the instance of Kaspersky Scan Engine is deinitialized.</p>
</li><li class="listbullet1"><span class="guicharacter">Remove from cluster</span>&#8212;Removes the instance from the cluster. If the cluster instance does not exist, it can take up to 5 minutes before this cluster instance is removed.<p class="listcontinue1">You cannot remove the instance of Kaspersky Scan Engine that is currently used.</p>
</li></ul><p class="introheading">Settings profiles</p>
<p class="bodytext">This tab displays a list of Kaspersky Scan Engine settings profiles created by a Kaspersky Scan Engine user. You can view the following data for each settings profile:</p>
<ul class="listbullet1"><li class="listbullet1">Name of the settings profile</li><li class="listbullet1">Description of the settings profile <p class="listcontinue1">The description may be absent if you have not specified it.</p>
</li><li class="listbullet1">Service mode<p class="listcontinue1">Kaspersky Scan Engine mode (either ICAP or HTTP) for which the settings profile has been created.</p>
</li><li class="listbullet1">List of host names of Kaspersky Scan Engine instances that use the selected settings profile<p class="listcontinue1">It is allowed that the profile is not used by any of the Kaspersky Scan Engine instances.</p>
</li></ul><p class="bodytext">You can add a new settings profile, or edit or delete an existing profile.</p>
<p class="procedureheading">To add a new settings profile:</p>
<ol class="listnumber1"><li class="listnumber1">Click the <span class="guicharacter">Add</span> button above the list of all settings profiles.<p class="listcontinue1">The wizard for adding a new settings profile opens.</p>
</li><li class="listnumber1">In the <span class="guicharacter">Profile info</span> tab, specify the following settings:<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Name</span>&#8212;Name of the settings profile<p class="listcontinue2">This setting is mandatory. The name must differ from the ones created previously and the ones reserved by Kaspersky Scan Engine (<em class="emphasischaracter">Default</em> and <em class="emphasischaracter">Custom</em>), and it must contain up to 16 symbols.</p>
</li><li class="listbullet2"><span class="guicharacter">Description</span>&#8212;Description of the settings profile<p class="listcontinue2">This setting is optional. The description must contain up to 256 symbols.</p>
</li><li class="listbullet2"><span class="guicharacter">Service mode</span>&#8212;The mode of the Kaspersky Scan Engine instance: either <a id="h193041_2" class="englishcrossreferencetemplate" href="#192979" target="_self">HTTP mode</a> or <a id="h180141_2" class="englishcrossreferencetemplate" href="#184798" target="_self">ICAP mode</a>.<p class="listcontinue2">This setting is mandatory.</p>
</li><li class="listbullet2">If needed, select the <span class="guicharacter">Use these host settings as base</span> checkbox to configure the profile by using the settings of the Kaspersky Scan Engine instance that is currently running.<p class="listcontinue2">If this checkbox is not selected, the default settings are used depending on the working mode (HTTP or ICAP).</p>
</li></ul></li><li class="listnumber1">Click <span class="guicharacter">Next</span>.</li><li class="listnumber1">In further steps, specify Kaspersky Scan Engine settings of different types, depending on the working mode (HTTP or ICAP). You can configure most of the parameters located on the <span class="guicharacter"><a id="h180271" class="englishcrossreferencetemplate" href="#179697" target="_self">Settings</a></span> page, except for the settings from the <span class="guicharacter">License</span> and <span class="guicharacter">Password</span> sections, and the connection settings in the <span class="guicharacter">Service</span> section:<ul class="listbullet2"><li class="listbullet2">In the <span class="guicharacter">Service</span> tab, specify <a id="h201467" class="englishcrossreferencetemplate" href="#179698" target="_self">service settings</a></li><li class="listbullet2">In the <span class="guicharacter">Scanning</span> tab, specify <a id="h182505" class="englishcrossreferencetemplate" href="#179699" target="_self">scanning settings</a></li><li class="listbullet2">In the <span class="guicharacter">Update</span> tab, specify <a id="h201469" class="englishcrossreferencetemplate" href="#179701" target="_self">update settings</a></li><li class="listbullet2">In the <span class="guicharacter">ICAP rules</span> tab, specify <a id="h180831" class="englishcrossreferencetemplate" href="#180283" target="_self">ICAP rules</a></li><li class="listbullet2">In the <span class="guicharacter">Logging</span> tab, specify <a id="h180220" class="englishcrossreferencetemplate" href="#179703" target="_self">logging settings</a></li><li class="listbullet2">In the <span class="guicharacter">Proxy</span> tab, specify <a id="h201470" class="englishcrossreferencetemplate" href="#179704" target="_self">proxy settings</a></li></ul></li><li class="listnumber1">In the <span class="guicharacter">Summary</span> tab, check the summary information about the settings profile.</li><li class="listnumber1">Click <span class="guicharacter">Save</span>.<p class="listcontinue1">You can also save current changes at each step of the procedure.</p>
</li></ol><p class="procedureheading">To edit an existing settings profile:</p>
<ol class="listnumber1"><li class="listnumber1">Locate a settings profile that you want to edit, and then click the <span class="guicharacter">Edit</span> button above the section with a brief description of the profile.<p class="listcontinue1">The wizard for editing the settings profile opens.</p>
</li><li class="listnumber1">Edit the settings that you need.<p class="listcontinue1">You can edit all of the settings that are described in the procedure for adding a new settings profile above.</p>
</li></ol><p class="procedureheading">To delete an existing settings profile:</p>
<ol class="listnumber1"><li class="listnumber1">Click the <span class="guicharacter">Delete</span> (<img id="f201473" src="delete_settings_profile.png" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0">) icon next to the settings profile that you need to delete.</li><li class="listnumber1">Click <span class="guicharacter">Confirm</span> to confirm the action.</li></ol><p class="bodytext">After the deletion is complete, the instances that use the settings of the deleted profile will continue using its configuration.</p>
<p class="introheading">Cluster settings</p>
<p class="bodytext">On this tab, you can configure Kaspersky Scan Engine to automatically remove from the cluster those instances that are inactive for a specified period of time. </p>
<p class="bodytext">An instance is considered inactive if no service events have been registered from that instance. After removing an instance from a cluster, Kaspersky Scan Engine also deletes all service events associated with the instance. Kaspersky Scan Engine does not delete events with scan results.</p>
<p class="procedureheading">To configure automatic removal of inactive cluster instances:</p>
<ol class="listnumber1"><li class="listnumber1">Turn on the <span class="guicharacter">Enable automatic removal</span> toggle switch.</li><li class="listnumber1">Specify the inactivity period in hours.<p class="warningcontinue1">To avoid accidental removal of a cluster instance, do not set the inactivity period to less than 24 hours.</p>
</li><li class="listnumber1">Click <span class="guicharacter">Save</span>.</li></ol><p class="bodytext">If a previously removed instance becomes active, it can reconnect to the cluster. </p>
<p class="procedureheading">To reconnect an instance to a cluster:</p>
<ol class="listnumber1"><li class="listnumber1">Change the instance host name.</li><li class="listnumber1">Restart the Kaspersky Scan Engine services:<ul class="listbullet2"><li class="listbullet2">For HTTPD mode, restart the kavhttpd service: <p class="listcontinue2"><code class="programcharacter">systemctl restart kavhttpd</code></p>
</li><li class="listbullet2">For ICAP  mode, restart the kavicapd service: <p class="listcontinue2"><code class="programcharacter">systemctl restart kavicapd</code></p>
</li><li class="listbullet2">If you are using the Kaspersky Scan Engine GUI, restart the klScanEngineUI service: <p class="listcontinue2"><code class="programcharacter">systemctl restart klScanEngineUI</code></p>
</li></ul></li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179697"><p><a name=179697 style="display: none;">[Topic 179697]</a></p>
	<h2 id="t234412" class="heading2">Kaspersky Scan Engine settings pages</h2>
<p class="bodytext">This section describes web pages that contain Kaspersky Scan Engine settings of different types.</p>
<p class="attentionbody">If you change any parameters on the <span class="guicharacter">Settings</span> page when using a specific <a id="h201478" class="englishcrossreferencetemplate" href="#201264" target="_self">settings profile</a> in the current Kaspersky Scan Engine instance, you will be prompted to stop using this settings profile for the instance. If you agree, the instance will use its own custom settings and the name of the settings profile for this instance will be displayed as <em class="emphasischaracter">Custom</em><span class="guicharacter"> </span>in the <span class="guicharacter"><a id="h201478_2" class="englishcrossreferencetemplate" href="#201264" target="_self">Hosts</a></span> table. This applies for most changes on the <span class="guicharacter">Settings</span> page, except for changes in the <span class="guicharacter">License</span> and <span class="guicharacter">Password</span> sections, and changes in the connection settings in the <span class="guicharacter">Service</span> section.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#179698" target="_self">Service settings</a></p><p class="relateditem"><a href="#179699" target="_self">Scanning settings</a></p><p class="relateditem"><a href="#224195" target="_self">Authorization settings</a></p><p class="relateditem"><a href="#180283" target="_self">ICAP rules</a></p><p class="relateditem"><a href="#179701" target="_self">Update settings</a></p><p class="relateditem"><a href="#179702" target="_self">License settings</a></p><p class="relateditem"><a href="#179703" target="_self">Logging settings</a></p><p class="relateditem"><a href="#179704" target="_self">Proxy settings</a></p><p class="relateditem"><a href="#219610" target="_self">Users settings</a></p><p class="relateditem"><a href="#221467" target="_self">Exporting the settings</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179698"><p><a name=179698 style="display: none;">[Topic 179698]</a></p>
	<h3 id="t234515" class="heading3">Service settings</h3>
<p class="bodytext">This section describes the <span class="guicharacter">Service</span> section of the <span class="guicharacter">Settings</span><span class="boldcharacter"> </span>page.</p>
<p class="picture"><img id="f182810" src="settings_service.png" class="linkedpngfiletemplate" alt="Several service settings for HTTP mode: Protocol, IP address and port, Keep-alive connection." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Service settings</p>
<p class="bodytext">If Kaspersky Scan Engine is initialized in HTTP mode, you can specify the following settings:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Protocol</span>&#8212;Select HTTP, HTTPS, or a UNIX domain socket.</li><li class="listbullet1">Address that Kaspersky Anti-Virus Engine listens on for incoming objects to check.<p class="listcontinue1">It can be either a UNIX socket, or an IP address and port.</p>
</li><li class="listbullet1"><span class="guicharacter">Private key path</span>&#8212;Path to the private key file for connection over HTTPS (TLS) protocol.<p class="listcontinue1">This can be either an absolute or a relative path. A relative path is calculated relative to the kavhttpd binary file.</p>
<p class="listcontinue1">You must specify this setting if the HTTPS protocol is selected.</p>
<p class="attentioncontinue1">When you configure this parameter, the following message may appear in the table with service events of the Kaspersky Scan Engine dashboard: &quot;Your private key has a low security level. Please check the permissions for the file &lt;path&gt;.&quot; In this case, you must configure access to the private key file so that only the root user and the user account under which the service is running can have the read permission.</p>
</li><li class="listbullet1"><span class="guicharacter">Certificate</span>&#8212;Path to the certificate file for connection over HTTPS (TLS) protocol.<p class="listcontinue1">This can be either an absolute or a relative path. A relative path is calculated relative to the kavhttpd binary file.</p>
<p class="listcontinue1">You must specify this setting if the HTTPS protocol is selected.</p>
</li><li class="listbullet1"><span class="guicharacter">Keep-alive connection</span>&#8212;Indicates whether <a id="h207358" class="englishcrossreferencetemplate" href="#207348" target="_self">Keep-Alive</a> must be used.</li><li class="listbullet1"><span class="guicharacter">Connection timeout</span>&#8212;The amount of time an idle connection has to be kept open (in milliseconds), waiting for a new request from an HTTP client.<p class="listcontinue1">The range of possible values is from 0 to 18000. If this parameter is set to 0, there is no time limit for the connection.</p>
</li><li class="listbullet1"><span class="guicharacter">Maximum requests per connection</span>&#8212;The maximum number of requests for one connection before the connection is closed.<p class="listcontinue1">The range of possible values is from 0 to 1000. If this parameter is set to 0, the number of requests for one connection is not limited.</p>
</li><li class="listbullet1">Under <span class="guicharacter">Locations where remote scanning is allowed</span>, you can specify paths to the locations where scanning is allowed when an HTTP client sends scan requests over a TCP socket from a remote computer. Scanning in other locations is prohibited. These paths are located in the file system of the computer with the Kaspersky Scan Engine server. Restricting the scan area prevents scanning the whole file system of the Kaspersky Scan Engine server by a command from the outside.<p class="listcontinue1">It is not recommended to use links as paths, due to security reasons. Use absolute paths instead.</p>
<p class="attentioncontinue1">Kaspersky Scan Engine does not add or remove objects in the directories specified in <span class="guicharacter">Locations where remote scanning is allowed</span>. The HTTP client has to send objects to scan, then remove them after scanning.</p>
<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2">Absolute paths to a directory<p class="listcontinue2">This value allows you to scan files that are located inside this directory and all its subdirectories.</p>
<p class="listcontinue2">The directory must be located on the same computer as Kaspersky Scan Engine or on a remote hard disk mounted on that computer. </p>
<p class="listcontinue2">The path must start from the root directory of the computer that Kaspersky Scan Engine is installed on.</p>
<p class="listcontinue2">The kavhttpd service must have permissions to read files in the directory and its subdirectories.</p>
</li><li class="listbullet2">Absolute path to a file<p class="listcontinue2">Allows you to scan the specified file.</p>
<p class="listcontinue2">The file must be located on the same computer as Kaspersky Scan Engine or on a remote hard disk mounted on that computer. </p>
<p class="listcontinue2">The path must start from the root directory of the computer that Kaspersky Scan Engine is installed on.</p>
<p class="listcontinue2">The kavhttpd service must have permissions to read the file.</p>
</li><li class="listbullet2"><code class="programcharacter">/</code> (forward slash)<p class="listcontinue2">Allows you to scan all files.</p>
</li></ul></li><li class="listbullet1"><span class="guicharacter">Cross-origin resource sharing</span>&#8212;Specifies the list of origins (IP addresses or host names with a protocol) to which access to the kavhttpd service must be provided.<p class="listcontinue1">Possible values:</p>
<ul class="listbullet2"><li class="listbullet2">IP address or host name with a protocol </li><li class="listbullet2"><code class="programcharacter">*</code><p class="listcontinue2">This value allows any origin to access the kavhttpd service.</p>
</li><li class="listbullet2">Empty value</li></ul><p class="listcontinue1">This setting is stored in the <code class="programcharacter"><a id="h201539" class="englishcrossreferencetemplate" href="#201900" target="_self">CORS</a></code> element of the HTTP mode configuration file.</p>
</li></ul><p class="attentionbody">In Windows, we recommend specifying the full path to a file. In particular, it is strongly recommended to specify the full paths to the certificate (<span class="guicharacter">Certificate</span>) and the key file (<span class="guicharacter">Private key path</span>).</p>
<p class="bodytext">If Kaspersky Scan Engine is initialized in ICAP mode, you can set the following settings:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Port number</span>&#8212;Specifies the port that Kaspersky Scan Engine listens on for ICAP requests with contents to scan.</li><li class="listbullet1"><span class="guicharacter">Send code 204</span>&#8212;Specifies whether Kaspersky Anti-Virus Engine must send the 204 code.</li><li class="listbullet1"><span class="guicharacter">Request mode address</span>&#8212;The address that kavicapd uses to process requests in the request mode. <p class="listcontinue1">The default value is <code class="programcharacter">req</code>.</p>
<p class="listcontinue1">Kaspersky Scan Engine includes the value from <span class="guicharacter">Request mode address</span> in the URL, for example:</p>
<p class="listcontinue1"><code class="programcharacter">icap://icap-server.example.com:1344/req</code></p>
<p class="attentioncontinue1">Do not use the same value for <span class="guicharacter">Request mode address</span> and <span class="guicharacter">Response mode address</span>.</p>
</li><li class="listbullet1"><span class="guicharacter">Response mode address</span>&#8212;The address that kavicapd uses to process requests in the response mode.<p class="listcontinue1">The default value is <code class="programcharacter">resp</code>.</p>
<p class="listcontinue1">Kaspersky Scan Engine includes the value from <span class="guicharacter">Response mode address</span> in the URL, for example:</p>
<p class="listcontinue1"><code class="programcharacter">icap://icap-server.example.com:1344/resp</code></p>
</li><li class="listbullet1"><span class="guicharacter">Keep-alive connection</span>&#8212;Indicates whether <a id="h207296" class="englishcrossreferencetemplate" href="#207291" target="_self">Keep-Alive</a> must be used.</li><li class="listbullet1"><span class="guicharacter">Use Keep-alive unconditionally</span>&#8212;Indicates whether Kaspersky Scan Engine always uses a Keep-Alive connection, even when ICAP clients do not request it.</li><li class="listbullet1"><span class="guicharacter">Connection timeout</span>&#8212;The amount of time an idle connection has to be kept open (in milliseconds), while waiting for a new request from an ICAP client.<p class="listcontinue1">The range of possible values is from 1 to 10000.</p>
</li><li class="listbullet1"><span class="guicharacter">Maximum requests per connection</span>&#8212;The maximum number of requests for one connection before the connection is closed.<p class="listcontinue1">The range of possible values is from 1 to 1000.</p>
</li><li class="listbullet1"><span class="guicharacter">Partial mode</span>&#8212;Allows scanning of files as a whole and partially sending them to a user before the scan is finished.<p class="listcontinue1">Possible settings for partial mode:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Delay</span>&#8212;Specifies the interval (in seconds) between the start of receiving an object and the start of sending its first part.</li><li class="listbullet2"><span class="guicharacter">Chunk size</span>&#8212;Specifies the size of object chunks transferred in the period between the start of receiving an object and the end of scanning.</li><li class="listbullet2"><span class="guicharacter">Prevent re-downloading</span>&#8212;Prevents a browser attempt to re-download a blocked file after the connection is broken.</li><li class="listbullet2"><span class="guicharacter">Maximum cache size</span>&#8212;Maximum cache size for blocked URLs, in KB.<p class="listcontinue2">This is the maximum amount of RAM that can be allocated for a blocked URL's cache.</p>
<p class="listcontinue2">The range of possible values is from 1 to 100000.</p>
<p class="listcontinue2">The preset value is 5000.</p>
</li><li class="listbullet2"><span class="guicharacter">Lifetime for blocked URLs</span>&#8212;Lifetime for blocked URLs in the cache, in seconds.<p class="listcontinue2">The range of possible values is from 1 to 604800 (one week).</p>
<p class="listcontinue2">The preset value is 1800.</p>
</li></ul></li><li class="listbullet1">Additional headers:<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">User name HTTP header</span>&#8212;The name of the HTTP header in which the username of the HTTP client is passed to the ICAP service.<p class="listcontinue2">The ICAP service will write this value to logs.</p>
<p class="listcontinue2">The preset value is <code class="programcharacter">X-Client-Username</code>.</p>
</li><li class="listbullet2"><span class="guicharacter">IP address HTTP header</span>&#8212;The name of the HTTP header in which the IP address of the HTTP client is passed to the ICAP service.<p class="listcontinue2">The ICAP service will write this value to logs.</p>
<p class="listcontinue2">The preset value is <code class="programcharacter">X-Client-IP</code>.</p>
</li><li class="listbullet2"><span class="guicharacter">Detected object name HTTP header</span>&#8212;The name of the header field that contains the name of the detected threat.<p class="listcontinue2">The ICAP service will write this value to logs.</p>
<p class="listcontinue2">By default, the value of this setting is empty.</p>
</li><li class="listbullet2"><span class="guicharacter">Database version name HTTP header</span>&#8212;The name of the header field that contains information about the anti-virus database version used by Kaspersky Scan Engine to scan objects.</li><li class="listbullet2"><span class="guicharacter">Send X-Include</span>&#8212;Specifies whether Kaspersky Scan Engine includes the <code class="programcharacter">X-Include</code> header in its response to the OPTIONS request from the ICAP client. To enable sending the <code class="programcharacter">X-Include</code> header, select one or both of the following checkboxes:<ul class="listbullet3"><li class="listbullet3"><span class="guicharacter">Request user name HTTP header</span>&#8212;The value specified in <span class="guicharacter">User name HTTP header</span>. If <span class="guicharacter">User name HTTP header</span> is empty, the <span class="guicharacter">Request user name HTTP header</span> checkbox is disabled.</li><li class="listbullet3"><span class="guicharacter">Request IP address HTTP header</span>&#8212;The value specified in <span class="guicharacter">IP address HTTP header</span>. If <span class="guicharacter">IP address HTTP header</span> is empty, the <span class="guicharacter">Request IP address HTTP header</span> checkbox is disabled.</li></ul><p class="listcontinue2">If none of these elements is selected, Kaspersky Scan Engine does not include the <code class="programcharacter">X-Include</code> header to responses.</p>
</li><li class="listbullet2"><span class="guicharacter">Send X-Infection-Found header</span>&#8212;Specifies whether Kaspersky Scan Engine includes the <code class="programcharacter">X-Infection-Found</code> header in its response to the ICAP client.<p class="listcontinue2">By default, Kaspersky Scan Engine does not include the <code class="programcharacter">X-Infection-Found</code> header to responses.</p>
</li><li class="listbullet2"><span class="guicharacter">Send X-Violations-Found header</span>&#8212;Specifies whether Kaspersky Scan Engine includes the <code class="programcharacter">X-Violations-Found</code> header in its response to the ICAP client.<p class="listcontinue2">By default, Kaspersky Scan Engine does not include the<code class="programcharacter"> X-Violations-Found</code> header to responses.</p>
</li><li class="listbullet2"><span class="guicharacter">Send X-Response-Info header</span>&#8212;Specifies whether Kaspersky Scan Engine includes the <code class="programcharacter">X-Response-Info</code> header in its response to the ICAP client.<p class="listcontinue2">By default, Kaspersky Scan Engine does not include the <code class="programcharacter">X-Response-Info</code> header to responses.</p>
</li><li class="listbullet2"><span class="guicharacter">Send X-Response-Desc header</span>&#8212;Specifies whether Kaspersky Scan Engine includes the <code class="programcharacter">X-Response-Desc</code> header in its response to the ICAP client.<p class="listcontinue2">By default, Kaspersky Scan Engine does not include the <code class="programcharacter">X-Response-Desc</code> header to responses.</p>
</li></ul></li><li class="listbullet1"><span class="guicharacter">Action on signal</span>&#8212;An action that must be performed on receiving the <code class="programcharacter">SIGUSR1</code> and <code class="programcharacter">SIGUSR2</code> signals.<p class="listcontinue1">In the <span class="guicharacter">SIGUSR1 signal</span> and <span class="guicharacter">SIGUSR2 signal</span> drop-down lists, you can select the following actions for both signals:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Update and reload the anti-virus database</span>&#8212;Updates and reloads the database by using built-in functionality of Kaspersky Scan Engine.<span class="guicharacter">  </span></li><li class="listbullet2"><span class="guicharacter">Reload the anti-virus database without updating</span>&#8212;Reloads the database without updating it.<p class="listcontinue2">It is assumed that the files in the database directory are already up to date and must be reloaded.</p>
</li><li class="listbullet2"><span class="guicharacter">Close log files in syslog format, then reopen them</span>&#8212;Closes all log files in the syslog format that are being opened, then opens them again for writing logs at the end of these files.<p class="listcontinue2">If the files are missing, the ICAP plug-in will create them. This setting allows rotating the logs by using the logrotate utility in default mode or when the create directive is used.</p>
</li></ul></li></ul><p class="bodytext">For either mode you can specify the following settings under <span class="guicharacter">Maximum values</span>:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Sessions</span>&#8212;Maximum number of sessions.<p class="listcontinue1">The default value is <code class="programcharacter">10</code>.</p>
<p class="attentioncontinue1">It is not recommended to specify a value greater than the number of TCP connections that your HTTP client can simultaneously maintain with Kaspersky Scan Engine.</p>
</li><li class="listbullet1"><span class="guicharacter">Connections</span>&#8212;Maximum number of active TCP connections that KAV HTTP can maintain simultaneously.<p class="listcontinue1">The default value is <code class="programcharacter">100</code>.</p>
</li><li class="listbullet1"><span class="guicharacter">Threads</span>&#8212;Maximum number of scanning threads. You can have up to 256 scanning threads. <p class="listcontinue1">The default value is <code class="programcharacter">8</code>.</p>
</li><li class="listbullet1"><span class="guicharacter">Processes</span>&#8212;Maximum number of scanning processes. You can have up to 256 scanning processes. <p class="listcontinue1">The default value is <code class="programcharacter">4</code>.</p>
</li></ul><p class="bodytext">When you apply new service settings, Kaspersky Anti-Virus Engine restarts.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179699"><p><a name=179699 style="display: none;">[Topic 179699]</a></p>
	<h3 id="t234500" class="heading3">Scanning settings</h3>
<p class="bodytext">This section describes the <span class="boldcharacter">Scanning</span> section of the <span class="boldcharacter">Settings </span>page.</p>
<p class="bodytext">If an error occurred during loading of the web page and the settings are unavailable, reload the page.</p>
<p class="bodytext">The <span class="boldcharacter">Scanning</span> section contains the following settings:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Enable reputation checking</span>&#8212;Indicates whether Kaspersky Security Network (KSN) must be used.<p class="listcontinue1">If this toggle switch is turned to <span class="guicharacter">On</span> and the End-User License Agreement (EULA) for KSN is not accepted, the EULA will be displayed and you must accept it in order to use KSN.</p>
</li><li class="listbullet1"><span class="guicharacter">Enable Phishing Protection</span>&#8212;Indicates whether the anti-phishing protection is turned <span class="guicharacter">On</span> or <span class="guicharacter">Off</span>.</li><li class="listbullet1"><span class="guicharacter">Object scan timeout</span>&#8212;Timeout period, in milliseconds, for scanning a single object</li><li class="listbullet1"><span class="guicharacter">Heuristic analysis level</span>&#8212;Drop-down list provides levels of heuristic analysis<p class="listcontinue1">The level can be one of the following:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Disabled</span></li><li class="listbullet2"><span class="guicharacter">Low</span></li><li class="listbullet2"><span class="guicharacter">Medium</span></li><li class="listbullet2"><span class="guicharacter">High</span></li></ul></li><li class="listbullet1"><span class="guicharacter">Actions on detected objects</span>&#8212;To be performed after a threat or legitimate software that can be used by intruders is detected<p class="listcontinue1">This setting is available if Kaspersky Anti-Virus Engine is initialized in HTTP mode. You can select one of the following actions:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Disinfect and delete if cannot be disinfected</span></li><li class="listbullet2"><span class="guicharacter">Disinfect and skip if cannot be disinfected</span></li><li class="listbullet2"><span class="guicharacter">Delete</span></li></ul><p class="attentioncontinue1">The above actions will be performed only if Kaspersky Anti-Virus Engine detects a threat while processing a <code class="programcharacter">scanfile</code> request. In all other cases, Kaspersky Scan Engine will only notify if the specified actions can be applied to the detected object.</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Skip</span></li></ul></li><li class="listbullet1"><span class="guicharacter">Size limit for the received file</span>&#8212;Specifies the maximum size (in kilobytes) of a file that Kaspersky Scan Engine can scan. If this parameter is set to 0, Kaspersky Scan Engine scans files of any size. The maximum value for this parameter is 1073741824.</li><li class="listbullet1"><span class="guicharacter">Maximum depth</span>&#8212;Specifies the maximum depth of nested archives to be unpacked during scanning.<p class="listcontinue1">This parameter is available only if the <span class="guicharacter">Archives</span> check box is selected in the <span class="guicharacter">Types of files to scan</span> section below.</p>
</li><li class="listbullet1">Under <span class="guicharacter">Types of files to scan</span>, you will find check boxes for the following settings:<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Packed objects</span>&#8212;Indicates whether packed objects must be scanned</li><li class="listbullet2"><span class="guicharacter">Archives</span>&#8212;Indicates whether archives must be scanned</li><li class="listbullet2"><span class="guicharacter">Email databases</span>&#8212;Indicates whether email clients' databases must be scanned</li><li class="listbullet2"><span class="guicharacter">Emails</span>&#8212;Indicates whether email messages must be scanned</li><li class="listbullet2"><span class="guicharacter">Macros in Microsoft Office documents</span>&#8212;Indicates whether Microsoft Office macros and documents must be scanned</li></ul></li><li class="listbullet1">Types of objects that must be scanned in request modification (REQMOD) mode<p class="listcontinue1">This setting is available if KAV Engine is initialized in ICAP mode. You can select one of the following object types:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">URLs</span></li><li class="listbullet2"><span class="guicharacter">Files</span></li></ul></li><li class="listbullet1">Types of objects that must be scanned in response modification (RESPMOD) mode<p class="listcontinue1">This setting is available if KAV Engine is initialized in ICAP mode. You can select one of the following object types:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">URLs</span></li><li class="listbullet2"><span class="guicharacter">Files</span></li></ul></li><li class="listbullet1">Formats of objects that must not be scanned<p class="listcontinue1">Clicking the <span class="guicharacter">Exclusions by file formats</span> link opens the <span class="guicharacter">File formats to exclude</span> window.</p>
</li><li class="listbullet1">Types of objects that must not be scanned<p class="listcontinue1">This setting is available if KAV Engine is initialized in ICAP mode. To specify exclusions by object type:</p>
<ol class="listnumber2"><li class="listnumber2">Click the <span class="guicharacter">Exclusions by Content-Type</span> link.<p class="listcontinue2">The <span class="guicharacter">Object types to exclude</span> window opens.</p>
</li><li class="listnumber2">Set the object types that must not be scanned.<p class="listcontinue2">Kaspersky Scan Engine matches the Content-Type HTTP header to the values of this exclusion rule. If the Content-Type HTTP header contains the specified value, the ICAP plug-in does not scan this object.</p>
</li><li class="listnumber2">Click <span class="guicharacter">Add</span>, if you need to add another exclusion rule.</li><li class="listnumber2">Click <span class="guicharacter">Apply</span> to apply this setting.</li></ol><p class="listcontinue1">To apply this setting, you have to configure a proxy server to send previews to the ICAP server.</p>
</li><li class="listbullet1">URLs that must not be scanned<p class="listcontinue1">This setting is available if KAV Engine is initialized in ICAP mode. To specify exclusions by URL:</p>
<ol class="listnumber2"><li class="listnumber2">Click the <span class="guicharacter">Exclusions by URL</span> link.<p class="listcontinue2">The <span class="guicharacter">Exclusion rules for URLs </span>window opens.</p>
</li><li class="listnumber2">Set the URLs to skip.<p class="listcontinue2">Kaspersky Scan Engine will skip these URLs. Specified URLs must not include scheme, query, and fragment components. </p>
<p class="listcontinue2">It is allowed to use masks. You can specify the asterisk (*) wildcard character as a substitute for a sequence of characters that constitute an entire domain name from the third level of the domain and above. For example, <code class="programcharacter">*.domain.com</code>. This value includes all subdomains of <code class="programcharacter">domain.com</code>. The asterisk (*) and question mark (?) wildcard characters can be used in a path component of the URL to substitute for any sequence of characters, or a single character, respectively. For example, <code class="programcharacter">domain.com/test/page/*</code>. </p>
</li><li class="listnumber2">Click <span class="guicharacter">Add</span>, if you need to add another exclusion rule.</li><li class="listnumber2">Click <span class="guicharacter">Apply</span> to apply this setting.</li></ol><p class="listcontinue1">To apply this setting, you have to configure a proxy server to send previews to the ICAP server.</p>
</li><li class="listbullet1">Maximum object size that can be scanned<p class="listcontinue1">This setting is available if KAV Engine is initialized in ICAP mode. To specify exclusions by object size:</p>
<ol class="listnumber2"><li class="listnumber2">Click the <span class="guicharacter">Skip large objects</span> toggle button.</li><li class="listnumber2">Set the maximum object size that can be scanned in kilobytes (KB).<p class="listcontinue2">If this setting is specified, Kaspersky Scan Engine expects to receive previews and compares the value of the Content-Length HTTP header to the value of this setting and also checks the actual object size. If either the header value or the actual object size is greater than the specified value, the ICAP plug-in does not scan the object. This applies both to requests made in preview mode and regular requests.</p>
</li></ol><p class="listcontinue1">To apply this setting, you have to configure a proxy server to send previews to the ICAP server.</p>
</li></ul><p class="bodytext">When you apply new scanning settings, KAV Engine restarts.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="224195"><p><a name=224195 style="display: none;">[Topic 224195]</a></p>
	<h3 id="t234277" class="heading3">Authorization settings</h3>
<p class="bodytext">This section describes the <span class="boldcharacter">Authorization</span> section of the <span class="boldcharacter">Settings </span>page.</p>
<p class="bodytext">If an error occurred during the loading of the web page and the settings are unavailable, reload the page.</p>
<p class="bodytext">The <span class="boldcharacter">Authorization</span> section contains the following settings:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Enable HTTP clients authorization</span>. Indicates whether Kaspersky Scan Engine should use API token authorization.<p class="attentioncontinue1"><a id="h211898" class="englishcrossreferencetemplate" href="#210245" target="_self">HTTPS connection</a> is required for API token authorization.</p>
</li><li class="listbullet1"><span class="guicharacter">Authorization header field</span>. The name of the request header field that contains the API token. The value you specify here must meet the following requirements:<ul class="listbullet2"><li class="listbullet2">3 to 40 characters long.</li><li class="listbullet2">Consists of characters allowed for header field names according to <a class="hyperlinktemplate" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" target="_blank">RFC 7230</a>.</li></ul><p class="listcontinue1">The default value is <span class="guicharacter">Authorization</span>.</p>
</li><li class="listbullet1"><span class="guicharacter">Add bearer prefix</span>. Indicates whether Kaspersky Scan Engine supports the Bearer authentication scheme. If this toggle switch is turned on, Kaspersky Scan Engine expects that the request header field, named as specified in <span class="guicharacter">Authorization header field</span>, starts with the <code class="programcharacter">Bearer</code> prefix.</li></ul><p class="introheading">Managing tokens</p>
<p class="bodytext">The <span class="guicharacter">API Tokens</span> table contains the following information about API tokens:</p>
<ul class="listbullet1"><li class="listbullet1">Token name. Each token has a unique name.</li><li class="listbullet1">Description. Some descriptions may be missing. This property is optional.</li><li class="listbullet1">Status. Kaspersky Scan Engine authorizes an HTTP client only if its token is enabled.</li></ul><p class="bodytext"> From the table, you can edit (<img id="f219908" src="edit_settings_profile.png" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0">) or delete (<img id="f201473" src="delete_settings_profile.png" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0">) an existing token. Editing a token is similar to adding a token (see the instruction below).</p>
<p class="procedureheading">To add a new token:</p>
<ol class="listnumber1"><li class="listnumber1">Click the <span class="guicharacter">Add token</span> button.</li><li class="listnumber1">Specify the parameters of the new token:<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Name</span>. The unique name of the token. The name must contain from 1 to 40 Unicode characters.</li><li class="listbullet2"><span class="guicharacter">Description</span>. Additional information about the token. For example, the name of the token owner. The description can contain up to 1000 Unicode characters.</li><li class="listbullet2"><span class="guicharacter">Token</span>. The token that the client must send to the Kaspersky Scan Engine API for authorization. The value must be unique and contain from 4 to 100 ASCII characters. There must be at least one uppercase Latin letter, one lowercase Latin letter, one digit, and one of the following special characters: <code class="programcharacter">-._~+/).</code><p class="listcontinue2">To make Kaspersky Scan Engine generate a unique token for you, click the <span class="guicharacter">Generate token</span> button. The generated token appears in the <span class="guicharacter">Token</span> field. You can change this value if you want.</p>
<p class="attentioncontinue2">Copy the token somewhere you can find it later. After you click <span class="guicharacter">Save</span>, the token will not be available in the Kaspersky Scan Engine GUI. In the <code class="programcharacter">kavhttpd.xml</code> configuration file, the token value is encrypted. If you have forgotten or lost a token, you can generate a new token instead.</p>
</li><li class="listbullet2"><span class="guicharacter">Enable token</span>. Turn on this toggle switch if you want Kaspersky Scan Engine to authorize clients that specified the token in the request header. If the toggle switch is turned off, Kaspersky Scan Engine does not authorize clients that specified the token in the request header.<p class="attentioncontinue2">If you have enabled API token authorization and the kavhttpd service is not running, starting klScanEngineUI will also initiate the start of the kavhttpd service.</p>
</li></ul></li><li class="listnumber1">Click <span class="guicharacter">Save</span>.</li></ol><p class="bodytext">The new token appears in the <span class="guicharacter">API Tokens</span> table.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180283"><p><a name=180283 style="display: none;">[Topic 180283]</a></p>
	<h3 id="t234386" class="heading3">ICAP rules</h3>
<p class="bodytext">This section describes the <span class="boldcharacter">ICAP rules</span> page of Kaspersky Scan Engine GUI. Using the <span class="boldcharacter">ICAP rules</span> page, you can add, remove, and edit ICAP rules. You can create as many ICAP rules as you want.</p>
<p class="bodytext">This page is available if Kaspersky Scan Engine is initialized in ICAP mode.</p>
<p class="picture"><img id="f182816" src="settings_icap_rules.png" class="linkedpngfiletemplate" alt="Several lines of ICAP rules. Each line contains settings: ICAP mode, Scan result, Response pattern, Script to execute." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">ICAP rules page</p>
<p class="bodytext">If an error occurred while loading the web page and the settings are unavailable, reload the page.</p>
<p class="bodytext">When you open the <span class="boldcharacter">ICAP rules</span> page, Kaspersky Scan Engine reads the following data, which is to be used when editing ICAP rules:</p>
<ul class="listbullet1"><li class="listbullet1">Names of the response patterns that are stored in the directory specified in the <code class="programcharacter">ResponsesPath</code> element of the ICAP Plug-in configuration file</li><li class="listbullet1">Names of the scripts that are stored in the directory specified in the <code class="programcharacter">CmdPath</code> element of the ICAP Plug-in configuration file</li></ul><p class="bodytext">A single ICAP rule contains the following fields:</p>
<ul class="listbullet1"><li class="listbullet1">ICAP mode that is relevant for the rule<p class="listcontinue1">You can select one of the following ICAP modes:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Request mode</span></li><li class="listbullet2"><span class="guicharacter">Response mode</span></li><li class="listbullet2"><span class="guicharacter">Any</span></li></ul></li><li class="listbullet1">Scan result after which the rule is activated<p class="listcontinue1">You can select one of the following <a id="h180152" class="englishcrossreferencetemplate" href="#179893" target="_self">scan results</a>:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Detected</span></li><li class="listbullet2"><span class="guicharacter">Not scanned</span></li><li class="listbullet2"><span class="guicharacter">Failed</span></li><li class="listbullet2"><span class="guicharacter">Macro</span></li><li class="listbullet2"><span class="guicharacter">Phishing</span></li><li class="listbullet2"><span class="guicharacter">Any</span></li><li class="listbullet2"><span class="guicharacter">Clean</span></li></ul></li><li class="listbullet1">Response pattern<p class="listcontinue1">This response pattern is used on a blocked web page after the rule is activated.</p>
<p class="listcontinue1">When the <span class="boldcharacter">ICAP rules</span> web page is loaded, you can choose one of the response patterns received by Kaspersky Scan Engine. In an ICAP rule, you can specify either the response pattern or the script to execute, but not both.</p>
<p class="listcontinue1">You can leave this field empty.</p>
</li><li class="listbullet1">Script to execute<p class="listcontinue1">This script is executed after the rule is activated.</p>
<p class="listcontinue1">When the <span class="boldcharacter">ICAP rules</span> web page is loaded, you can choose one of the scripts got by Kaspersky Scan Engine. In an ICAP rule, you can specify either the response pattern or the script to execute, but not both.</p>
<p class="listcontinue1">You can leave this field empty.</p>
</li></ul><p class="bodytext">Kaspersky Scan Engine does not process the rules where <span class="guicharacter">Scan result</span> is set to <span class="guicharacter">Any</span> and <span class="guicharacter">Action</span> is set to <span class="guicharacter">None</span>. You must avoid using these rules (see the table below).</p>
<p class="tablename">Incorrect ICAP rules</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="656" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="219"><p class="tableheading">ICAP mode</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="219"><p class="tableheading">Scan result</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="219"><p class="tableheading">Action</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Response mode</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Any</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">None</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Request mode</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Any</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">None</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Any</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Any</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">None</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179701"><p><a name=179701 style="display: none;">[Topic 179701]</a></p>
	<h3 id="t234544" class="heading3">Update settings</h3>
<p class="bodytext">This section describes the <span class="guicharacter">Update</span> section of the <span class="boldcharacter">Settings</span> page.</p>
<p class="bodytext">If an error occurred during loading of the web page and the settings are unavailable, reload the page.</p>
<p class="bodytext">The <span class="boldcharacter">Update</span> section contains the following settings:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Enable automatic updates</span>&#8212;Indicates whether Kaspersky Anti-Virus Engine must periodically update the anti-virus database</li><li class="listbullet1"><span class="guicharacter">Automatic update period</span>&#8212;Duration (in minutes) of the automatic update of the anti-virus database<p class="listcontinue1">You can set this period only if the anti-virus database is updated automatically.</p>
<p class="listcontinue1">We recommend that you set this period to 30 minutes. We do not recommend that you specify a lesser value: a lower value will not increase the detection rate, but rather can cause instability of Kaspersky Scan Engine.</p>
</li><li class="listbullet1"><span class="guicharacter">Update from Kaspersky servers</span>&#8212;Indicates whether KAV Engine must use only Kaspersky update servers</li><li class="listbullet1"><span class="guicharacter">Custom sources</span>&#8212;Web addresses of the custom update source<p class="listcontinue1">Setting these web addresses (and clicking the <span class="guicharacter">Add source</span> button) is mandatory if KAV Engine must use only custom update sources.</p>
<p class="listcontinue1">If Kaspersky Scan Engine must use TLS when connecting to a custom update source, you must specify the <code class="programcharacter">https://</code> protocol in the address of this custom update source.</p>
</li><li class="listbullet1"><span class="guicharacter">Use Kaspersky servers if custom sources are unavailable</span>&#8212;Select this check box if you want Kaspersky Scan Engine to use this option.</li><li class="listbullet1"><span class="guicharacter">Back up the anti-virus database</span>&#8212;In the <span class="guicharacter">On</span> position, the toggle switch indicates that KAV Engine will back up the anti-virus database. By default, this setting is enabled.</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179702"><p><a name=179702 style="display: none;">[Topic 179702]</a></p>
	<h3 id="t234423" class="heading3">License settings</h3>
<p class="bodytext">This section describes the <span class="guicharacter">License</span> section of the <span class="guicharacter">Settings</span> page.</p>
<p class="bodytext">If an error occurred during loading of the web page and the settings are unavailable, reload the page.</p>
<p class="attentionbody">When Kaspersky Scan Engine works in a cluster containing multiple instances, the imported license will be applied to all instances of this cluster.</p>
<p class="bodytext">The <span class="boldcharacter">License</span> section displays the following information:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Key file</span>:<ul class="listbullet2"><li class="listbullet2">Key file name<p class="listcontinue2">This name is available in Simple licensing mode&#8212;that is, if Kaspersky Scan Engine uses a key file.</p>
</li><li class="listbullet2">Activation code<p class="listcontinue2">It is available in Online licensing mode&#8212;that is, if Kaspersky Scan Engine uses an activation code.</p>
</li></ul></li><li class="listbullet1"><span class="guicharacter">Expiration date</span><p class="listcontinue1">Date on which the license expires.</p>
<p class="picture"><img id="f182809" src="settings_license_status.png" class="linkedpngfiletemplate" alt="Licensing information: activation status, key file name, expiration date. &quot;Change&quot; button." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Licensing web page</p>
</li></ul><p class="procedureheading">To replace the current key file or activation code with a new one:</p>
<ol class="listnumber1"><li class="listnumber1">Click the <span class="guicharacter">Change</span> button.<p class="listcontinue1">The License Replacement Wizard starts.</p>
</li><li class="listnumber1">Specify the new licensing mode.<ul class="listbullet2"><li class="listbullet2">To specify Simple licensing mode, select the <span class="guicharacter">Key file</span> option.</li><li class="listbullet2">To specify Online licensing mode, select the <span class="guicharacter">Activation code</span> option.</li></ul></li><li class="listnumber1">Specify either the new key file or activation code depending on the licensing mode that you selected.</li><li class="listnumber1">Click <span class="boldcharacter">Activate</span>.<p class="picture"><img id="f182808" src="settings_license_change.png" class="linkedpngfiletemplate" alt="Form for choosing a key file or entering an activation code." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">License replacement page</p>
</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179703"><p><a name=179703 style="display: none;">[Topic 179703]</a></p>
	<h3 id="t234435" class="heading3">Logging settings</h3>
<p class="bodytext">This section describes the <span class="boldcharacter">Logging</span> section of the <span class="boldcharacter">Settings </span>page.</p>
<p class="bodytext">If an error occurred during loading of the web page and the settings are unavailable, reload the page.</p>
<p class="bodytext">The <span class="boldcharacter">Logging</span> section contains two subsections: <span class="guicharacter">Syslog</span> and <span class="guicharacter">Log files</span>.</p>
<p class="bodytext">The <span class="guicharacter">Syslog</span> section allows you to do the following:</p>
<ul class="listbullet1"><li class="listbullet1">Start or stop syslog logging<p class="warningcontinue1">If you enable sending syslog messages, consider that these messages will contain sensitive data, such as personal data as defined by GDPR, configuration data of the product, and licensing information.</p>
</li><li class="listbullet1">Specify syslog logging settings<p class="listcontinue1">The settings for HTTP mode and ICAP mode are different.</p>
</li></ul><p class="procedureheading">To add and configure the destination for syslog messages in HTTP or ICAP mode:</p>
<ol class="listnumber1"><li class="listnumber1">Choose the types of events that will be logged into the specified destination.<p class="attentioncontinue1">When syslog logging is enabled, the Audit events cannot be completely excluded from syslog messages.</p>
</li><li class="listnumber1">Specify the format of syslog messages:<ul class="listbullet2"><li class="listbullet2">CEF<p class="listcontinue2">The format of CEF logs is different in <a id="h194736" class="englishcrossreferencetemplate" href="#186767" target="_self">HTTP mode</a> and <a id="h193363" class="englishcrossreferencetemplate" href="#186631" target="_self">ICAP mode</a>.</p>
</li><li class="listbullet2">RAW<p class="listcontinue2">The format of RAW logs is different in <a id="h194737" class="englishcrossreferencetemplate" href="#186769" target="_self">HTTP mode</a> and <a id="h193364" class="englishcrossreferencetemplate" href="#186652" target="_self">ICAP mode</a>.</p>
</li></ul></li><li class="listnumber1">Choose the destination that will be used for writing logs:<ul class="listbullet2"><li class="listbullet2">syslog daemon</li><li class="listbullet2">file<p class="listcontinue2">Specify the path to the directory where the log file will be created. This path could be absolute or relative to the directory that holds the executable file of the service (<code class="programcharacter">kavhttpd</code> for HTTP mode and <code class="programcharacter">kavicapd</code> for ICAP mode).</p>
</li><li class="listbullet2">remote syslog<p class="listcontinue2">Specify the <code class="programcharacter">%PROTOCOL%%IP%:%PORT%</code> value, where <code class="programcharacter">%PROTOCOL%</code> is a network protocol (use tcp:// or udp:// for this value), <code class="programcharacter">%IP%</code> is an IPv4 address that receives syslog messages, and <code class="programcharacter">%PORT%</code> is a port that receives syslog messages.</p>
</li></ul></li></ol><p class="bodytext">The <span class="guicharacter">Log files</span> section allows you to do the following:</p>
<ul class="listbullet1"><li class="listbullet1">Start or stop debug logging<p class="warningcontinue1">If you enable debug logging, consider that the log messages will contain sensitive data, such as personal data as defined by GDPR, configuration data of the product, and licensing information.</p>
</li><li class="listbullet1">Export log files<p class="listcontinue1">This action is available if debug logging is stopped.</p>
</li><li class="listbullet1">Delete logs<p class="listcontinue1">This button is available if debug logging is stopped.</p>
</li></ul><p class="bodytext">The <span class="guicharacter">Log files</span> section also displays:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Log directory</span>&#8212;Path to the directory where log files will be stored</li></ul><p class="bodytext">You cannot change this setting by using the Kaspersky Scan Engine GUI. You must edit the corresponding configuration file. Depending on the mode that you chose in the <a id="h183008" class="englishcrossreferencetemplate" href="#179825" target="_self">Kaspersky Scan Engine configuration file</a>, specify the path in httpdkavlog.ini or icapdkavlog.conf for <a id="h180157" class="englishcrossreferencetemplate" href="#179879" target="_self">HTTP mode</a> and <a id="h190568" class="englishcrossreferencetemplate" href="#179896" target="_self">ICAP mode</a>, respectively.</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Log size (MB)</span>&#8212;Current log size in megabytes.</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179704"><p><a name=179704 style="display: none;">[Topic 179704]</a></p>
	<h3 id="t234466" class="heading3">Proxy settings</h3>
<p class="bodytext">This section describes the <span class="guicharacter">Proxy</span> section of the <span class="guicharacter">Settings</span><span class="boldcharacter"> </span>page.</p>
<p class="bodytext">If an error occurred during loading of the web page and the settings are unavailable, reload the page.</p>
<p class="bodytext">The <span class="guicharacter">Proxy</span> section contains the following settings:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="guicharacter">Use proxy server</span>&#8212;Indicates whether Kaspersky Anti-Virus Engine must use a proxy server</li><li class="listbullet1"><span class="guicharacter">Proxy address</span>&#8212;IP address or host of the proxy server<p class="listcontinue1">This setting is available if a proxy server is used.</p>
</li><li class="listbullet1"><span class="guicharacter">Port</span>&#8212;Port of the proxy server<p class="listcontinue1">This setting is available if a proxy server is used.</p>
</li><li class="listbullet1"><span class="guicharacter">User name (optional)</span>&#8212;Proxy login<p class="listcontinue1">This setting is available if a proxy server is used. The login is hidden, and asterisks are displayed instead of its characters. The proxy login is stored encrypted.</p>
</li><li class="listbullet1"><span class="guicharacter">Password (optional)</span>&#8212;Proxy password<p class="listcontinue1">This setting is available if a proxy server is used. The password is hidden, and asterisks are displayed instead of its characters. The proxy password is stored encrypted.</p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="219610"><p><a name=219610 style="display: none;">[Topic 219610]</a></p>
	<h3 id="t234571" class="heading3">Users settings</h3>
<p class="bodytext">This section describes the <span class="guicharacter">Users</span> section of the <span class="guicharacter">Settings</span> page.</p>
<p class="bodytext">If an error occurred during loading of the web page and the settings are unavailable, reload the page.</p>
<p class="bodytext">The <span class="guicharacter">Users</span> section displays the following information:</p>
<ul class="listbullet1"><li class="listbullet1">List of the existing user profiles<p class="listcontinue1">The following information is displayed for every user profile:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Login</span>&#8212;the unique name of the user.</li><li class="listbullet2"><span class="guicharacter">Full name</span>&#8212;the full name of the user. Does not have to be unique.</li><li class="listbullet2"><span class="guicharacter">Role</span>&#8212;the role of the user.<p class="listcontinue2">Possible values:</p>
<ul class="listbullet3"><li class="listbullet3"><span class="guicharacter">Administrator</span></li><li class="listbullet3"><span class="guicharacter">Operator</span></li></ul></li><li class="listbullet2"><span class="guicharacter">Last login</span>&#8212;the time and date when the user logged in the last time.</li></ul></li></ul><p class="bodytext">You can add a new user profile, or edit or delete an existing user profile.</p>
<p class="introheading">Adding a new user profile</p>
<p class="procedureheading">To add a new user profile:</p>
<ol class="listnumber1"><li class="listnumber1">Click the <span class="guicharacter">Add new user</span> button to the top right of the user list.<p class="listcontinue1">A <span class="guicharacter">User</span> sidebar appears on the right.<span class="guicharacter"> </span></p>
</li><li class="listnumber1">Fill in the required fields:<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Login</span><p class="listcontinue2">The unique name of the user. This is a mandatory field.</p>
</li><li class="listbullet2"><span class="guicharacter">Full name</span><p class="listcontinue2">The full name of the user. This is an optional field.</p>
</li><li class="listbullet2"><span class="guicharacter">Password</span><p class="listcontinue2">The password. This is a mandatory field. The value must meet <a id="h180236" class="englishcrossreferencetemplate" href="#179705" target="_self">password requirements</a>.</p>
</li><li class="listbullet2"><span class="guicharacter">Confirm password</span><p class="listcontinue2">Same as the above. This is a mandatory field.</p>
</li><li class="listbullet2"><span class="guicharacter">Role</span><p class="listcontinue2">The role of the user. This is a mandatory field.</p>
</li></ul></li><li class="listnumber1">If you want Kaspersky Scan Engine to display the local date and time instead of the date and time in UTC, turn on the <span class="guicharacter">Use local timezone</span> toggle switch. This change will only affects the user that you are editing.</li><li class="listnumber1">Click <span class="guicharacter">Save</span>.</li></ol><p class="introheading">Editing a user profile</p>
<p class="attentionbody">You cannot change the user role for the profile you are currently working under.</p>
<p class="procedureheading">To edit a user profile:</p>
<ol class="listnumber1"><li class="listnumber1">On the row with the user profile that you want to change, click the <span class="guicharacter">Edit</span> (<img id="f219908" src="edit_settings_profile.png" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0">) button.<p class="listcontinue1"> A <span class="guicharacter">User</span> sidebar appears on the right.</p>
</li><li class="listnumber1">Edit the settings that you need.<p class="attentioncontinue1">When you change login or password of a user profile, Kaspersky Scan Engine GUI logs out this profile. When you change the role of a user profile, the changes are applied the next time someone logs in with this profile.</p>
</li><li class="listnumber1">Click <span class="guicharacter">Save</span>.</li></ol><p class="introheading">Deleting a user profile</p>
<p class="attentionbody">You cannot delete the user profile that you are currently working under.</p>
<p class="procedureheading">To delete a user profile:</p>
<ol class="listnumber1"><li class="listnumber1">On the row with the user profile that you want to delete, click the <span class="guicharacter">Delete</span> (<img id="f201473" src="delete_settings_profile.png" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0">) button.<p class="listcontinue1">A <span class="guicharacter">Delete user</span> sidebar appears on the right.</p>
</li><li class="listnumber1">Click <span class="guicharacter">Confirm</span>.<p class="attentioncontinue1">When you delete a user profile, Kaspersky Scan Engine GUI logs out this profile.</p>
</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221467"><p><a name=221467 style="display: none;">[Topic 221467]</a></p>
	<h3 id="t234355" class="heading3">Exporting the settings</h3>
<p class="bodytext">You can export Kaspersky Scan Engine settings as a ZIP archive with a set of configuration files. </p>
<p class="bodytext">The archive contains the following configuration files:</p>
<ul class="listbullet1"><li class="listbullet1"><a id="h183008" class="englishcrossreferencetemplate" href="#179825" target="_self">klScanEngineUI.xml</a></li><li class="listbullet1">For HTTP mode:<ul class="listbullet2"><li class="listbullet2"><a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">kavhttpd.xml</a></li><li class="listbullet2"><a id="h180157" class="englishcrossreferencetemplate" href="#179879" target="_self">httpdkavlog.ini</a></li></ul></li><li class="listbullet1">For ICAP mode:<ul class="listbullet2"><li class="listbullet2"><a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">kavicapd.xml</a></li><li class="listbullet2"><a id="h190568" class="englishcrossreferencetemplate" href="#179896" target="_self">icapdkavlog.conf</a></li></ul></li></ul><p class="procedureheading">To export the settings,</p>
<p class="bodytextindent">Click the <span class="guicharacter">Export configuration files</span> button on the bottom left of any Kaspersky Scan Engine setting page. </p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179705"><p><a name=179705 style="display: none;">[Topic 179705]</a></p>
	<h2 id="t234293" class="heading2">Changing password </h2>
<p class="procedureheading">To change the password for gaining access to the Kaspersky Scan Engine GUI:</p>
<ol class="listnumber1"><li class="listnumber1">Click  the current user split button (<img id="f183233" src="login.png" class="linkedpngfiletemplate" alt="" vspace="0" hspace="0" align="bottom" border="0">) on the footer bar, and then click <span class="guicharacter">Profile</span>.<p class="listcontinue1"> Your profile opens on the right.</p>
</li><li class="listnumber1">Fill out the input fields:<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Current password</span>&#8212;Specify the current password.</li><li class="listbullet2"><span class="guicharacter">New password</span>&#8212;Specify the new password.</li><li class="listbullet2"><span class="guicharacter">Confirm new password</span>&#8212;Confirm the new password.</li></ul><p class="listcontinue1">All passwords are hidden, and asterisks are displayed instead of their characters.</p>
</li><li class="listnumber1">Click <span class="guicharacter">Save</span>.</li></ol><p class="bodytext">After you change the password, all the sessions for the active account except the current one will be closed.</p>
<p class="introheading">Password requirements</p>
<p class="bodytext">A password for gaining access to Kaspersky Scan Engine GUI must meet the following requirements:</p>
<ul class="listbullet1"><li class="listbullet1">Password must contain only ASCII letters, digits, and the following special symbols:<p class="listcontinue1"><code class="programcharacter">! &quot; # $ % &amp; ' ( ) * + , - . / : ; &lt; = &gt; ? @ [ \ ] ^ _ ` { | } ~</code></p>
</li><li class="listbullet1">Password must contain at least one Latin lowercase letter.</li><li class="listbullet1">Password must contain at least one Latin uppercase letter.</li><li class="listbullet1">Password must contain at least one digit.</li><li class="listbullet1">A password must contain at least one special symbol (<code class="programcharacter">!</code>, <code class="programcharacter">#</code>, <code class="programcharacter">@</code>, and so on).</li><li class="listbullet1">Password length must be from 6 to 16 symbols inclusive.</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="185278"><p><a name=185278 style="display: none;">[Topic 185278]</a></p>
	<h2 id="t234597" class="heading2">Working with the klScanEngineUI binary file</h2>
<p class="bodytext">You can run the klScanEngineUI.exe binary file manually.</p>
<p class="introheading">Working with the klScanEngineUI binary file in Linux</p>
<p class="bodytext">Linux syntax:</p>
<p class="bodytext"><code class="programcharacter">./klScanEngineUI [[-c &lt;path&gt;] [-p &lt;path&gt;] | [-w] | [-n] | [-v] | [-h]]</code></p>
<p class="bodytext">The table below describes the klScanEngineUI options in Linux.</p>
<p class="tablename">The klScanEngineUI options in Linux</p>
<table class="tableintopic" width="624" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="234"><p class="tableheading">Option</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="390"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="bodytext"><code class="programcharacter">-c &lt;path&gt;</code></p>
<p class="bodytext"><code class="programcharacter">--config &lt;path&gt;</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Specifies the path to the configuration file for the klScanEngine UI service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="bodytext"><code class="programcharacter">-p &lt;path&gt;</code></p>
<p class="bodytext"><code class="programcharacter">--pidfile &lt;path&gt;</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Specifies the path to the PID file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">-w</code></p>
<p class="tablebodytext"><code class="programcharacter">--watchdog</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Runs the klScanEngine UI service in watchdog mode.</p>
<p class="tablebodytext">In this mode, the klScanEngine UI automatically restarts if it freezes or crashes.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">-n</code></p>
<p class="tablebodytext"><code class="programcharacter">--no-daemon</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Enables nodaemon mode for the klScanEngine UI service.</p>
<p class="tablebodytext">Specifying this parameter forces the klScanEngine UI service to run in the foreground.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">-v</code></p>
<p class="tablebodytext"><code class="programcharacter">--version</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Shows the Kaspersky Scan Engine version.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">-h</code></p>
<p class="tablebodytext"><code class="programcharacter">--help</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Shows Help.</p>
</td>
</tr>

</table>
<p class="introheading">Working with the klScanEngineUI binary file in Windows</p>
<p class="bodytext">Windows syntax:</p>
<p class="bodytext"><code class="programcharacter">klScanEngineUI.exe [[--svc] | [--reg] | [--del] | [-v] | [-h]]</code></p>
<p class="bodytext">The table below describes the klScanEngineUI options in Windows.</p>
<p class="tablename">The klScanEngineUI options in Windows</p>
<table class="tableintopic" width="624" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="234"><p class="tableheading">Option</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="390"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="bodytext"><code class="programcharacter">--svc</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Starts the service.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="bodytext"><code class="programcharacter">--reg</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Adds the klScanEngine UI service to the list of Windows services.</p>
<p class="tablebodytext">The name of the service and its displayed name is <code class="programcharacter">Kaspersky ScanEngine UI</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">--del</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Deletes the klScanEngine UI service from the list of Windows services.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">-v</code></p>
<p class="tablebodytext"><code class="programcharacter">--version </code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Shows the Kaspersky Scan Engine version.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">-h</code></p>
<p class="tablebodytext"><code class="programcharacter">--help</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Optional parameter.</p>
<p class="tablebodytext">Shows Help.</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192471"><p><a name=192471 style="display: none;">[Topic 192471]</a></p>
	<h2 id="t234602" class="heading2">Running the klScanEngineUI service with systemd unit file (Linux)</h2>
<p class="attentionbody">For Linux systems only.</p>
<p class="bodytext">You can run the Kaspersky Scan Engine GUI service by using the klScanEngineUI.service unit file for <code class="programcharacter">systemd</code>. The unit file allows you to add the klScanEngineUI service to the service startup list and to manage the service manually from the command line.</p>
<p class="attentionbody">This section assumes that you want to add the klScanEngineUI service for all users. For information on how to add and manage a service under a specific user, please see the official documentation for <code class="programcharacter">systemd</code> and <code class="programcharacter">systemctl</code>.</p>
<p class="introheading">Starting Kaspersky Scan Engine automatically</p>
<p class="bodytext">To start Kaspersky Scan Engine automatically, add klScanEngineUI to the service startup list.</p>
<p class="procedureheading">To add klScanEngineUI to the service startup list:</p>
<ol class="listnumber1"><li class="listnumber1">Place the klScanEngineUI.service unit file in the <code class="programcharacter">/etc/systemd/system/</code> directory.</li><li class="listnumber1">If necessary, <a id="h192506" class="englishcrossreferencetemplate" href="#192481" target="_self">edit the unit file</a>.</li><li class="listnumber1">Reload <code class="programcharacter">systemd</code> by running the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl daemon-reload</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Make sure that the klScanEngineUI.service unit file is installed by running the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl list-unit-files</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Enable klScanEngineUI to launch when the system starts by running the following command:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl enable klScanEngineUI.service</p>
</td>
</tr>

</table>
</li></ol><p class="introheading">Remove Kaspersky Scan Engine from the service startup list</p>
<p class="bodytext">To remove klScanEngineUI from the service startup list, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl disable klScanEngineUI.service</p>
</td>
</tr>

</table>
<p class="introheading">Managing Kaspersky Scan Engine with systemd from the terminal</p>
<p class="bodytext">To start klScanEngineUI without rebooting the computer, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl start klScanEngineUI</p>
</td>
</tr>

</table>
<p class="attentionbody">After this command is executed, the script prints the <code class="programcharacter">[OK]</code> message and immediately returns control to the terminal, but it will take the <code class="programcharacter">klScanEngineUI</code> service some time to start.</p>
<p class="bodytext">To stop klScanEngineUI without rebooting the computer, run the following command:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl stop klScanEngineUI</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192481"><p><a name=192481 style="display: none;">[Topic 192481]</a></p>
	<h3 id="t234296" class="heading3">Changing variables in the klScanEngineUI unit file (Linux)</h3>
<p class="attentionbody">For Linux systems only.</p>
<p class="bodytext">You can configure Kaspersky Scan Engine by changing one or more variables in its unit file, <code class="programcharacter">%distr_kit%/etc/klScanEngineUI.service</code>.</p>
<p class="introheading">Changing the path to the Kaspersky Scan Engine PID file</p>
<p class="bodytext">You can change this variable if you want to create a PID file of Kaspersky Scan Engine in a directory other than <code class="programcharacter">/var/run/klScanEngineUI.pid</code>.</p>
<p class="bodytext">The following example shows how this variable is set in the unit file:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">PIDFile=/var/run/klScanEngineUI.pid</p>
</td>
</tr>

</table>
<p class="introheading">Changing environment variables</p>
<p class="bodytext">You must change these environment variables if Kaspersky Scan Engine is located in a directory other than <code class="programcharacter">/opt/kaspersky/ScanEngine</code>.</p>
<p class="bodytext">The unit file uses the following environment variables:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">SDKPATH</code>&#8212;Specifies the directory where Kaspersky Scan Engine is located. The following example shows how this variable is set in the unit file:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">Environment=SDKPATH=/opt/kaspersky/ScanEngine</p>
</td>
</tr>

</table>
</li><li class="listbullet1"><code class="programcharacter">KL_PLUGINS_PATH</code>&#8212;Specifies the path to the directory containing the PPL plug-in files used by Kaspersky Scan Engine. The following example shows how this variable is set in the unit file:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">Environment=KL_PLUGINS_PATH=/ppl</p>
</td>
</tr>

</table>
</li><li class="listbullet1"><code class="programcharacter">LD_LIBRARY_PATH</code>&#8212;Specifies the path to the directory containing the shared libraries used by Kaspersky Scan Engine. The following block shows how this variable is set in the unit file:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">Environment=LD_LIBRARY_PATH=/lib:/ppl</p>
</td>
</tr>

</table>
</li></ul><p class="introheading">Changing paths in the command executed on klScanEngineUI startup</p>
<p class="bodytext">You must change paths in the command executed on klScanEngineUI startup if you put the <code class="programcharacter">klScanEngineUI</code> executable file or the klScanEngineUI configuration file in directories different from the ones specified in the unit file, or if you want to create a PID file of Kaspersky Scan Engine in a directory other than <code class="programcharacter">/var/run/klScanEngineUI.pid</code>.</p>
<p class="bodytext">The following example shows how this command is set in the unit file:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">ExecStart=/bin/sh -c 'cd ${SDKPATH}/bin; ./klScanEngineUI -c /etc/klScanEngineUI.xml -p /var/run/klScanEngineUI.pid'</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="206592"><p><a name=206592 style="display: none;">[Topic 206592]</a></p>
	<h1 id="t234407" class="heading1">Kaspersky Scan Engine configuration</h1>
<p class="bodytext">This section describes common configuration details of Kaspersky Scan Engine.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#179825" target="_self">Manually editing Kaspersky Scan Engine configuration file</a></p><p class="relateditem"><a href="#180222" target="_self">Recognizable file formats</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179825"><p><a name=179825 style="display: none;">[Topic 179825]</a></p>
	<h2 id="t234446" class="heading2">Manually editing Kaspersky Scan Engine configuration file</h2>
<p class="bodytext">This section describes the Kaspersky Scan Engine configuration file.</p>
<p class="bodytext">The Kaspersky Scan Engine configuration file is an XML file named klScanEngineUI.xml. It resides in the <code class="programcharacter">etc</code> subdirectory of the Kaspersky Scan Engine installation directory.</p>
<p class="bodytext">The table below describes the elements of the Kaspersky Scan Engine configuration file.</p>
<p class="tablename">Scan Engine configuration file elements</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="672" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="264"><p class="tableheading">Element</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="408"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="264"><p class="tablebodytext"><code class="programcharacter">EULA/Common</code></p>
</td>
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext">Specifies whether the End User License Agreement (EULA) for Kaspersky Scan Engine is accepted:</p>
<ul class="tablelistbullet"><li class="tablelistbullet"><code class="programcharacter">accepted</code><p class="tablelistcontinue">EULA for Kaspersky Scan Engine is accepted.</p>
</li><li class="tablelistbullet"><code class="programcharacter">rejected</code><p class="tablelistcontinue">EULA for Kaspersky Scan Engine is not accepted.</p>
</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="264"><p class="tablebodytext"><code class="programcharacter">EULA/KSN</code></p>
</td>
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext">Specifies whether the EULA for Kaspersky Security Network (KSN) is accepted:</p>
<ul class="tablelistbullet"><li class="tablelistbullet"><code class="programcharacter">accepted</code><p class="tablelistcontinue">EULA for KSN is accepted.</p>
</li><li class="tablelistbullet"><code class="programcharacter">rejected</code><p class="tablelistcontinue">EULA for KSN is not accepted.</p>
</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="264"><p class="tablebodytext"><code class="programcharacter">ServerSettings/EnableUI</code></p>
</td>
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext">Specifies whether the web service that implements Kaspersky Scan Engine GUI must be turned on:</p>
<ul class="tablelistbullet"><li class="tablelistbullet"><code class="programcharacter">0</code> (or <code class="programcharacter">false</code>)<p class="tablelistcontinue">Web Service will not be initialized.</p>
<p class="tablelistcontinue">In this case all the settings in the <code class="programcharacter">ServerSettings</code> and <code class="programcharacter">DatabaseSettings</code> elements do not affect anything.</p>
</li><li class="tablelistbullet"><code class="programcharacter">1</code> (or <code class="programcharacter">true</code>)<p class="tablelistcontinue">An attempt to initialize Web Service will be made.</p>
</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="264"><p class="tablebodytext"><code class="programcharacter">ServerSettings/Mode</code></p>
</td>
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext">Kaspersky Scan Engine mode:</p>
<ul class="tablelistbullet"><li class="tablelistbullet"><code class="programcharacter">httpd</code><p class="tablelistcontinue">Kaspersky Anti-Virus Engine will be initialized as HTTPD.</p>
</li><li class="tablelistbullet"><code class="programcharacter">icap</code><p class="tablelistcontinue">Kaspersky Anti-Virus Engine will be initialized as an ICAP plug-in.</p>
</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="264"><p class="tablebodytext"><code class="programcharacter">ServerSettings/ConnectionString</code></p>
</td>
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext">IP address (or host) and port at which Kaspersky Scan Engine GUI will be available.</p>
<p class="tablebodytext">You must access Kaspersky Scan Engine GUI from a computer on which Kaspersky Scan Engine is installed. In this case the Kaspersky Scan Engine documentation will also be available for you.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="264"><p class="tablebodytext"><code class="programcharacter">ServerSettings/SSLCertificatePath</code></p>
</td>
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext">Path to a Kaspersky Scan Engine certificate in PEM format.</p>
<p class="tablebodytext">This can be either absolute or a relative path. A relative path is calculated relative to the Kaspersky Scan Engine binary file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="264"><p class="tablebodytext"><code class="programcharacter">ServerSettings/SSLPrivatePath</code></p>
</td>
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext">Path to a Kaspersky Scan Engine private key in PEM format.</p>
<p class="tablebodytext">This can be either absolute or a relative path. A relative path is calculated relative to the Kaspersky Scan Engine binary file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="264"><p class="tablebodytext"><code class="programcharacter">ServerSettings/TemplatesPath</code></p>
</td>
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext">Path to the directory in which the templates for Kaspersky Scan Engine GUI are stored.</p>
<p class="tablebodytext">This can be either absolute or a relative path. A relative path is calculated relative to the Kaspersky Scan Engine binary file.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="264"><p class="tablebodytext"><code class="programcharacter">DatabaseSettings/ConnectionString</code></p>
</td>
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext">IP address and port at which the database that Kaspersky Scan Engine uses for storing data is available.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="264"><p class="tablebodytext"><code class="programcharacter">DatabaseSettings/User</code></p>
</td>
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext">Encrypted user name used to authenticate in the database that Kaspersky Scan Engine uses for storing data. The user name is encrypted by the kav_encrypt utility.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="264"><p class="tablebodytext"><code class="programcharacter">DatabaseSettings/Password</code></p>
</td>
<td style="border:1px solid #010101;" width="408"><p class="tablebodytext">Encrypted password used to authenticate in the database that Kaspersky Scan Engine uses for storing data. The password is encrypted by the kav_encrypt utility.</p>
</td>
</tr>

</table>
<p class="bodytext">Below is an example of the Kaspersky Scan Engine configuration file.</p>
<table class="tableintopic" width="636" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="636"><p class="program">&lt;Settings&gt;</p>
<p class="program2">&lt;EULA&gt;</p>
<p class="program3">&lt;Common&gt;rejected&lt;/Common&gt;</p>
<p class="program3">&lt;KSN&gt;rejected&lt;/KSN&gt;</p>
<p class="program2">&lt;/EULA&gt;</p>
<p class="program2">&lt;ServerSettings&gt;</p>
<p class="program3">&lt;EnableUI&gt;true&lt;/EnableUI&gt;</p>
<p class="program3">&lt;Mode&gt;httpd&lt;/Mode&gt;</p>
<p class="program3">&lt;ConnectionString&gt;127.0.0.1:9443&lt;/ConnectionString&gt;</p>
<p class="program3">&lt;SSLCertificatePath&gt;../ssl/cert.pem&lt;/SSLCertificatePath&gt;</p>
<p class="program3">&lt;SSLPrivatePath&gt;../ssl/priv.pem&lt;/SSLPrivatePath&gt;</p>
<p class="program3">&lt;TemplatesPath&gt;../httpsrv/templates/&lt;/TemplatesPath&gt;</p>
<p class="program2">&lt;/ServerSettings&gt;</p>
<p class="program2">&lt;DatabaseSettings&gt; </p>
<p class="program3">&lt;ConnectionString&gt;10.65.81.3:8443&lt;/ConnectionString&gt;</p>
<p class="program3">&lt;User&gt;=a3Afasd+&lt;/User&gt;</p>
<p class="program3">&lt;Password&gt;=df2AfBB1&lt;/Password&gt;</p>
<p class="program2">&lt;/DatabaseSettings&gt;</p>
<p class="program">&lt;/Settings&gt;</p>
</td>
</tr>

</table>
<p class="spacer"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180222"><p><a name=180222 style="display: none;">[Topic 180222]</a></p>
	<h2 id="t234471" class="heading2">Recognizable file formats</h2>
<p class="bodytext">This group of constants defines file formats that can be recognized by Format Recognizer. You can configure Format Recognizer for use <a id="h180155" class="englishcrossreferencetemplate" href="#179868" target="_self">in HTTP mode</a>, as well as <a id="h180156" class="englishcrossreferencetemplate" href="#206590" target="_self">in ICAP mode</a>.</p>
<p class="introheading">Text formats</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">KAV_FF_GENERAL_TXT</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_GENERAL_CSV</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_GENERAL_HTML</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_GENERAL_HTML_STRICT</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_TEXT_REG</code></li></ul><p class="introheading">Multimedia formats</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">KAV_FF_VIDEO_FLV</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_VIDEO_F4V</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_VIDEO_AVI</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_VIDEO_3GPP</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_VIDEO_DIVX</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_VIDEO_MKV</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_VIDEO_MOV</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_VIDEO_ASF</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_VIDEO_RM</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_VIDEO_VOB</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_VIDEO_BIK</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_VIDEO_RTMP</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_AUDIO_MP3</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_AUDIO_FLAC</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_AUDIO_APE</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_AUDIO_OGG</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_AUDIO_AAC</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_AUDIO_WMA</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_AUDIO_AC3</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_AUDIO_WAV</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_AUDIO_MKA</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_AUDIO_RA</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_AUDIO_MIDI</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_AUDIO_CDA</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_IMAGE_JPEG</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_IMAGE_GIF</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_IMAGE_PNG</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_IMAGE_BMP</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_IMAGE_TIFF</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_IMAGE_EMF</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_IMAGE_EPS</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_IMAGE_PSD</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_IMAGE_CDR</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MULTIMEDIA_SWF</code></li></ul><p class="introheading">Executable formats</p>
<table class="tableintopic" width="894" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="468"><p class="tableheading">Format</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="174"><p class="tableheading">Description</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="156"><p class="tableheading">Operating system</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="96"><p class="tableheading">Extensions</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_WIN32PE_EXE</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">32-bit executable files (exe only)</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">32-bit Windows systems</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">exe</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_WIN32PE_EXEUI</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Executable files of programs with a user interface, and executable files for the Microsoft POSIX subsystem</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">32-bit Windows systems</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">exe</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_WIN32PE_DLL</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Dynamic libraries</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">32-bit Windows systems</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">dll, ocx, scr</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_WIN32PE_RESOURCE</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Resource-only libraries</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">32-bit Windows systems</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">dll</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_WIN32PE_NET</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_WIN32PE_ILONLY</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Executable files that contain only Common Intermediate Language (CIL)</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">32-bit Windows systems</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">exe, dll, ocx, scr</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_WIN32PE_ILLIBRARY</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Common Intermediate Language libraries</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">32-bit Windows systems</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">exe, dll, ocx, scr</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_WIN32PE</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">32-bit executable files</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">32-bit Windows systems</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">exe, dll, ocx, scr</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_WIN32PE_SYS</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">System files</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">32-bit Windows systems</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">sys</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_WIN32PE_NET_RESOURCE_WITH_POSSIBLE_TRIVIAL_CODE</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">.NET resource-only libraries (may contain trivial code)</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">32-bit Windows systems</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">dll</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_DOS</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">Executable files that are not based on a Win32 or Win64 API</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">16-bit Windows systems, DOS, OS/2</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">exe, dll</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_DOS_NE_RESOURCE</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">New Executable (NE) resource-only libraries</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">16-bit Windows systems, DOS, OS/2</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">exe, dll</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_COM</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_JAVA</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_ELF</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_JS</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_VBS</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_BAT</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_MSI</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_DEB</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_RPM</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_SCRIPTS</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_MACHO</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_DEX</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_APK</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_PYC</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_APPLE_SCRIPT</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="468"><p class="tablebodytext"><code class="programcharacter">KAV_FF_EXECUTABLE_WINDOWS_SHELLLINK</code></p>
</td>
<td style="border:1px solid #010101;" width="174"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="156"><p class="tablebodytext">&nbsp;</p>
</td>
<td style="border:1px solid #010101;" width="96"><p class="tablebodytext">&nbsp;</p>
</td>
</tr>

</table>
<p class="introheading">Office suite formats</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_OPENXML</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_MSOFFICE_MACRO</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_MSOFFICE</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_RTF</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_PDF</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_MSG</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_EML</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_VSD</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_VDX</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_XPS</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_ONE</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_ONEPKG</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_XSN</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_ODT</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_ODS</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_ODP</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_OFFICE_SXW</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_DOC</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_DOT</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_DOCX</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_DOTX</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_DOCM</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_DOTM</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_XLS</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_XLSX</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_XLTX</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_XLSM</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_XLTM</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_XLAM</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_XLSB</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_PPT</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_PPTX</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_POTX</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_PPTM</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_POTM</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_PPSX</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_PPSM</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_PUB</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_MSOFFICE_SCRAP</code></li></ul><p class="introheading">Database files</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">KAV_FF_DATABASE_MDB</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_DATABASE_ACCDB</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_DATABASE_ACCDC</code></li></ul><p class="introheading">Archive files</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_ZIP</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_7Z</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_RAR</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_ISO</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_CAB</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_JAR</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_BZIP2</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_GZIP</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_ARJ</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_DMG</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_XAR</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_TAR</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_ARCHIVE_ACE</code></li></ul><p class="introheading">Web archive files</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">KAV_FF_TEXT_CHM</code></li><li class="listbullet1"><code class="programcharacter">KAV_FF_TEXT_MHT</code></li></ul><p class="introheading">Miscellaneous</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">KAV_FF_CRYPTO_CAT</code></li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179826"><p><a name=179826 style="display: none;">[Topic 179826]</a></p>
	<h1 id="t234592" class="heading1">Verifying virus detection capabilities</h1>
<p class="bodytext">This section explains how to verify that Kaspersky Scan Engine is detecting malicious objects correctly. </p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#180178" target="_self">About EICAR Standard Anti-Virus Test File</a></p><p class="relateditem"><a href="#180193" target="_self">Verifying detection capabilities in HTTP mode</a></p><p class="relateditem"><a href="#179903" target="_self">Verifying detection capabilities in ICAP mode</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180178"><p><a name=180178 style="display: none;">[Topic 180178]</a></p>
	<h2 id="t234267" class="heading2">About EICAR Standard Anti-Virus Test File</h2>
<p class="bodytext">Because it is unacceptable to use real malware for test purposes, there is a need for a file that contains no malicious code and can be safely passed around&#8212;but that must be detected by anti-virus software as a malicious object or, more specifically, as a test file.</p>
<p class="bodytext">The European Institute for Computer Anti-virus Research (EICAR) distributes such a file for testing anti-virus functionality. It is known as the &quot;EICAR Standard Anti-Virus Test File&quot; and can be downloaded from the EICAR official web site.</p>
<p class="bodytext">To download the test file or to read more about it, follow this link: <a class="directhyperlinktemplate" href="https://www.eicar.org/?page_id=3950" target="_blank">https://www.eicar.org/?page_id=3950</a>.</p>
<p class="warningbody">If your computer already has anti-virus software, disable it before you download the test file.</p>
<p class="bodytext">The EICAR Standard Anti-Virus Test File contains the ASCII string which, when interpreted by command processor, returns the message string to the standard output and exits back to the command prompt.</p>
<p class="bodytext">Kaspersky Scan Engine will detect this test file, label it as infected and perform the action specified in the scan settings.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180193"><p><a name=180193 style="display: none;">[Topic 180193]</a></p>
	<h2 id="t234590" class="heading2">Verifying detection capabilities in HTTP mode</h2>
<p class="bodytext">This section explains how to verify that Kaspersky Scan Engine works correctly in HTTP mode.</p>
<p class="introheading">Verifying that Kaspersky Scan Engine detects malicious files correctly</p>
<p class="procedureheading">To verify that Kaspersky Scan Engine detects malicious file correctly:</p>
<ol class="listnumber1"><li class="listnumber1">Run the kavhttpd service.</li><li class="listnumber1">Start your HTTP client.</li><li class="listnumber1">Scan the <a id="h180192" class="englishcrossreferencetemplate" href="#180178" target="_self">EICAR test file</a> by using your HTTP client in <a id="h180274" class="englishcrossreferencetemplate" href="#179884" target="_self">scanfile mode</a>.<p class="listcontinue1">The following example shows how to do this with the sample HTTP client:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">./kavhttp_client -f eicar.txt</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Verify that the EICAR test file is detected.</li></ol><p class="introheading">Verifying that Kaspersky Scan Engine detects malicious files in system memory correctly</p>
<p class="procedureheading">To verify that Kaspersky Scan Engine detects malicious files in system memory correctly:</p>
<ol class="listnumber1"><li class="listnumber1">Run the kavhttpd service.</li><li class="listnumber1">Start your HTTP client.</li><li class="listnumber1">Scan the content of the <a id="h180192_2" class="englishcrossreferencetemplate" href="#180178" target="_self">EICAR test file</a> by using your HTTP client in <a id="h180274_2" class="englishcrossreferencetemplate" href="#179884" target="_self">scanmemory mode</a>.<p class="listcontinue1">The following example shows how to do this with the sample HTTP client:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">./kavhttp_client eicar.txt</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Verify that the EICAR test file is detected.</li></ol><p class="introheading">Verifying that Kaspersky Scan Engine detects malicious and phishing URLs correctly</p>
<p class="procedureheading">To verify that Kaspersky Scan Engine detects malicious and phishing URLs correctly:</p>
<ol class="listnumber1"><li class="listnumber1">Run the kavhttpd service.</li><li class="listnumber1">Start your HTTP client.</li><li class="listnumber1">To verify that Kaspersky Scan Engine detects malicious URLs correctly, scan <code class="programcharacter">http://bug.qainfo.ru/TesT/Wmuf_w</code> by using your HTTP client.<p class="listcontinue1">This URL is not malicious. Kaspersky is using this URL to test the detection capabilities of anti-virus software.</p>
<p class="listcontinue1">The following example shows how to do this with the sample HTTP client:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">./kavhttp_client -u <code class="programcharacter">http://bug.qainfo.ru/TesT/Wmuf_w</code></p>
</td>
</tr>

</table>
</li><li class="listnumber1">Verify that the URL is detected.</li><li class="listnumber1">To verify that Kaspersky Scan Engine detects phishing URLs correctly, scan <code class="programcharacter">http://bug.qainfo.ru/TesT/Aphish_w</code> by using your HTTP client.<p class="listcontinue1">This URL is not phishing. Kaspersky is using this URL to test the detection capabilities of anti-virus software.</p>
<p class="listcontinue1">The following example shows how to do this with the sample HTTP client:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">./kavhttp_client -u <code class="programcharacter">http://bug.qainfo.ru/TesT/Aphish_w</code></p>
</td>
</tr>

</table>
</li><li class="listnumber1">Verify that the URL is detected.</li></ol><p class="introheading">Verifying that File and URL Reputation Checking works correctly</p>
<p class="procedureheading">To verify that File and URL Reputation Checking works correctly:</p>
<ol class="listnumber1"><li class="listnumber1">Request the KSN test file from your technical account manager (TAM). This file is not malicious, and is only used to verify that File and URL reputation checking works properly.</li><li class="listnumber1">Make sure that the <code class="programcharacter">KAV_SHT_ENGINE_KSN</code> flag is not specified in the <code class="programcharacter">Flags</code> element of the <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">HTTP mode configuration file</a>.</li><li class="listnumber1">Run the kavhttpd service.</li><li class="listnumber1">Start your HTTP client.</li><li class="listnumber1">Scan the KSN test file by using your HTTP client in <a id="h180274_3" class="englishcrossreferencetemplate" href="#179884" target="_self">scanfile mode</a>.</li><li class="listnumber1">Verify that the KSN test file is not detected.</li><li class="listnumber1">Specify the KAV_SHT_ENGINE_KSN flag in the <code class="programcharacter">Flags</code> element of the HTTP mode configuration file.</li><li class="listnumber1">Restart the kavhttpd service.</li><li class="listnumber1">Rescan the KSN test file by using your HTTP client in scanfile mode.</li><li class="listnumber1">Verify that the KSN test file is detected.</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179903"><p><a name=179903 style="display: none;">[Topic 179903]</a></p>
	<h2 id="t234591" class="heading2">Verifying detection capabilities in ICAP mode</h2>
<p class="bodytext">This section explains how to verify that Kaspersky Scan Engine works correctly in ICAP mode.</p>
<p class="introheading">Verifying that Kaspersky Scan Engine detects malicious and phishing URLs correctly</p>
<p class="procedureheading">To verify that Kaspersky Scan Engine detects malicious URLs correctly:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure that the directory with response templates contains the <a id="h180188" class="englishcrossreferencetemplate" href="#179895" target="_self">detect_req default template</a>.</li><li class="listnumber1"><a id="h193107" class="englishcrossreferencetemplate" href="#192988" target="_self">Configure Kaspersky Scan Engine</a>. Set the value of the <code class="programcharacter">RulesFilePath</code> parameter to the directory that contains kavicapd_gui_rules.conf, sample service rules file that is included in the distribution kit. </li><li class="listnumber1"><a id="h193044" class="englishcrossreferencetemplate" href="#192990" target="_self">Start the kavicapd service</a>.</li><li class="listnumber1">Create a .txt file with the following content:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">REQMOD icap://icap-server.example.com/req ICAP/1.0</p>
<p class="program">Host: icap-server.example.com</p>
<p class="program">Encapsulated: req-hdr=0, null-body=110</p>
<p class="program">&nbsp;</p>
<p class="program">GET /TesT/Wmuf_w HTTP/1.1</p>
<p class="program">Host: www.bug.qainfo.ru</p>
<p class="program">Accept: text/html, text/plain</p>
<p class="program">Accept-Encoding: compress</p>
<p class="program">&nbsp;</p>
</td>
</tr>

</table>
<p class="listcontinue1">Make sure that every line ends with CRLF, as required by RFC 2616. Also, make sure that the file ends with an empty line (a line consisting of CRLF symbols).</p>
<p class="listcontinue1">This is a REQMOD GET ICAP request message. </p>
<p class="listcontinue1">This message requests a test page that does not contain any real malicious content.</p>
</li><li class="listnumber1">Save the file with an appropriate name. In the following example this file is named icap_reqmod_malicious_detect.txt.</li><li class="listnumber1">Send the message to the port that the kavicapd service listens on (port 1344 by default).<p class="listcontinue1">The exact method may vary depending on the operating system. This example shows how to send the message using netcat:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program"> cat icap_reqmod_malicious_detect_.txt | nc localhost 1344</p>
</td>
</tr>

</table>
<p class="listcontinue1">The kavicapd service will answer with the modified message headers and a response message that shows information about the blocked URL.</p>
</li><li class="listnumber1">Verify that the test web page was blocked.<p class="listcontinue1">When the web page is blocked, the kavicapd service returns the <a id="h180188_2" class="englishcrossreferencetemplate" href="#179895" target="_self">detect_req HTML response template</a>. The response template contains the following information about the blocked web page:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">Mode:            REQMOD</p>
<p class="program">Object name:</p>
<p class="program">Date:            2017-May-31 14:13:29.295710</p>
<p class="program">ICAPD version:   KL ICAP Service v1.0 (KAV SDK v8.5.1.83)</p>
<p class="program">KAV SDK Version: KAV SDK v8.5.1.83</p>
<p class="program">URL:             <code class="programcharacter">http://bug.qainfo.ru/TesT/Wmuf_w</code></p>
</td>
</tr>

</table>
<p class="spacer"></p>
<p class="spacer"></p>
</li><li class="listnumber1">Create a .txt file with the following content:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">REQMOD icap://icap-server.example.com/req ICAP/1.0</p>
<p class="program">Host: icap-server.example.com</p>
<p class="program">Encapsulated: req-hdr=0, null-body=110</p>
<p class="program">&nbsp;</p>
<p class="program">GET <code class="programcharacter">/TesT/Aphish_w</code> HTTP/1.1</p>
<p class="program">Host: <code class="programcharacter">www.bug.qainfo.ru</code></p>
<p class="program">Accept: text/html, text/plain</p>
<p class="program">Accept-Encoding: compress</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Save the file with an appropriate name. In the following example this file is named icap_reqmod_phishing_detect.txt.</li><li class="listnumber1">Send the message to the port that the kavicapd service listens on.<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">cat icap_reqmod_phishing_detect_.txt | nc localhost 1344</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Verify that the test web page was blocked.<p class="listcontinue1">When the web page is blocked, the kavicapd service returns the <a id="h180188_3" class="englishcrossreferencetemplate" href="#179895" target="_self">detect_req HTML response template</a>. The response template contains the following information about the blocked web page:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">Mode:            REQMOD</p>
<p class="program">Object name:</p>
<p class="program">Date:            2017-May-31 14:13:29.295710</p>
<p class="program">ICAPD version:   KL ICAP Service v1.0 (KAV SDK v8.5.1.83)</p>
<p class="program">KAV SDK Version: KAV SDK v8.5.1.83</p>
<p class="program">URL:             <code class="programcharacter">http://bug.qainfo.ru/TesT/Aphish_w</code></p>
</td>
</tr>

</table>
</li></ol><p class="introheading">Verifying that Kaspersky Scan Engine detects malicious content in HTTP traffic correctly</p>
<p class="procedureheading">To verify that Kaspersky Scan Engine detects malicious content in HTTP traffic correctly:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure that the directory with response templates contains the <a id="h180188_4" class="englishcrossreferencetemplate" href="#179895" target="_self">detect_req default template</a>.</li><li class="listnumber1"><a id="h193107_2" class="englishcrossreferencetemplate" href="#192988" target="_self">Configure Kaspersky Scan Engine</a>. Set the value of the <code class="programcharacter">RulesFilePath</code> parameter to the directory that contains kavicapd_gui_rules.conf, sample service rules file that is included in the distribution kit. </li><li class="listnumber1"><a id="h193044_2" class="englishcrossreferencetemplate" href="#192990" target="_self">Start the kavicapd service</a>.</li><li class="listnumber1">Create a .txt file with the following content:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">REQMOD icap://icap-server.example.com/req?arg=87 ICAP/1.0</p>
<p class="program">Host: icap-server.example.com</p>
<p class="program">Encapsulated: req-hdr=0, req-body=155</p>
<p class="program">&nbsp;</p>
<p class="program">POST /origin-resource/form.pl HTTP/1.1</p>
<p class="program">Host: www.origin-server.example.com</p>
<p class="program">Accept: text/html, text/plain</p>
<p class="program">Accept-Encoding: compress</p>
<p class="program">Pragma: no-cache</p>
<p class="program">&nbsp;</p>
<p class="program">44</p>
<p class="program">X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*</p>
<p class="program">0</p>
</td>
</tr>

</table>
<p class="listcontinue1">Make sure that every line ends with CRLF, as required by RFC 2616.</p>
<p class="listcontinue1">This is a REQMOD POST ICAP request message. </p>
<p class="listcontinue1">This message contains <a id="h180192" class="englishcrossreferencetemplate" href="#180178" target="_self">EICAR Standard Anti-Virus Test File</a>. The EICAR Standard Anti-Virus Test File is not a virus and is often used for testing anti-virus software.</p>
</li><li class="listnumber1">Save the file with an appropriate name. In the following example this file is named icap_reqmod_detect.txt.</li><li class="listnumber1">Send the message to the port that the kavicapd service listens to (port 1344 by default).<p class="listcontinue1">The exact method may vary depending on the operating system. This example shows how to send the message using netcat:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">cat icap_reqmod_detect.txt | nc localhost 1344</p>
</td>
</tr>

</table>
<p class="listcontinue1">The kavicapd service will answer with the modified message headers and a response message that shows information about the detected object.</p>
</li><li class="listnumber1">Verify that EICAR Standard Anti-Virus Test File was detected.<p class="listcontinue1">When the EICAR file is detected, the kavicapd service returns the detect_req HTML response template. The response template contains the following information about the detected object:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">Mode:            REQMOD</p>
<p class="program">Object name:     EICAR-Test-File</p>
<p class="program">Date:            2017-May-31 14:17:12.077704</p>
<p class="program">ICAPD version:   KL ICAP Service v1.0 (KAV SDK v8.5.1.83)</p>
<p class="program">KAV SDK Version: KAV SDK v8.5.1.83</p>
<p class="program">URL:             www.origin-server.example.com/origin-resource/form.pl</p>
</td>
</tr>

</table>
<p class="spacer"></p>
</li></ol><p class="introheading">Verifying that File and URL Reputation Checking works correctly</p>
<p class="procedureheading">To verify that File and URL Reputation Checking works correctly:</p>
<ol class="listnumber1"><li class="listnumber1">Request the KSN test file from your Technical Account Manager. This file is not malicious, and is only used to verify that File and URL Reputation Checking works properly.</li><li class="listnumber1">Make sure that the directory with response templates contains the <a id="h180188_5" class="englishcrossreferencetemplate" href="#179895" target="_self">detect_req default template</a>.</li><li class="listnumber1"><a id="h193107_3" class="englishcrossreferencetemplate" href="#192988" target="_self">Configure Kaspersky Scan Engine</a>: <ul class="listbullet2"><li class="listbullet2">Set the value of the <code class="programcharacter">RulesFilePath</code> parameter to the directory that contains kavicapd_gui_rules.conf, sample service rules file that is included in the distribution kit.</li><li class="listbullet2">Make sure that the <code class="programcharacter">UseKSN</code> parameter is set to <code class="programcharacter">0</code>.</li></ul></li><li class="listnumber1"><a id="h193044_3" class="englishcrossreferencetemplate" href="#192990" target="_self">Start the kavicapd service</a>.</li><li class="listnumber1">Create a .txt file with the following content:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">REQMOD icap://icap-server.example.com/req?arg=87 ICAP/1.0</p>
<p class="program">Host: icap-server.example.com</p>
<p class="program">Encapsulated: req-hdr=0, req-body=155</p>
<p class="program">&nbsp;</p>
<p class="program">POST /origin-resource/form.pl HTTP/1.1</p>
<p class="program">Host: www.origin-server.example.com</p>
<p class="program">Accept: text/html, text/plain</p>
<p class="program">Accept-Encoding: compress</p>
<p class="program">Pragma: no-cache</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Below the content you added to the .txt file, insert a new line.</li><li class="listnumber1">Below the new line, insert the contents of the KSN test file.<p class="listcontinue1">Make sure that every line ends with CRLF, as required by RFC 2616.</p>
</li><li class="listnumber1">Save the file with an appropriate name. In the following example this file is named icap_reqmod_detect_ksn.txt.</li><li class="listnumber1">Send the message to the port that the kavicapd service listens on (port 1344 by default).<p class="listcontinue1">The exact method may vary depending on the operating system. This example shows how to send the message by using the netcat utility:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">cat icap_reqmod_detect_ksn.txt | nc localhost 1344</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Verify that the KSN test file is not detected.</li><li class="listnumber1">Set the value of the <code class="programcharacter">UseKSN</code> parameter of the ICAP mode configuration file to <code class="programcharacter">1</code>.</li><li class="listnumber1">Restart the kavicapd service.</li><li class="listnumber1">Send icap_reqmod_detect_ksn.txt to the kavicapd service again.</li><li class="listnumber1">Verify that the KSN test file is detected.</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221141"><p><a name=221141 style="display: none;">[Topic 221141]</a></p>
	<h1 id="t234526" class="heading1">System audit</h1>
<p class="attentionbody">For Linux systems only.</p>
<p class="bodytext">Kaspersky Scan Engine includes the system audit functionality. If the Kaspersky Scan Engine GUI is used, system audit is enabled by default and cannot be disabled. Also, when you turn on syslog logging, Kaspersky Scan Engine prompts you to turn on system audit as well.</p>
<p class="bodytext">With the system audit, it is much easier to monitor the functioning Kaspersky Scan Engine and to analyze security incidents when they happen.</p>
<p class="bodytext">In order to analyze incidents, you might need to gather the following information:</p>
<ul class="listbullet1"><li class="listbullet1">Who or what initiated the events related to the incident.</li><li class="listbullet1">What actions did the initiator take, and whether or not they were successful.</li><li class="listbullet1">If a Kaspersky Scan Engine user is the initiator, then who granted the user access rights.</li><li class="listbullet1">How the Kaspersky Scan Engine settings have changed.</li></ul><p class="bodytext">On the Kaspersky Scan Engine dashboard, you can find information about <a id="h221187" class="englishcrossreferencetemplate" href="#221146" target="_self">initiators of events</a> and <a id="h221188" class="englishcrossreferencetemplate" href="#221150" target="_self">events details</a>. </p>
<p class="attentionbody">Users that have the role <em class="emphasischaracter">Operator</em> can only view events related to scanning and events initiated by themselves. Users that have the role <em class="emphasischaracter">Administrator</em> can view information without limitations. See also the detailed information about the <a id="h219851" class="englishcrossreferencetemplate" href="#219850" target="_self">user roles</a>.</p>
<p class="bodytext">If you do not use the Kaspersky Scan Engine GUI, you can find information about events in the <a id="h221488" class="englishcrossreferencetemplate" href="#221189" target="_self">syslog messages</a>. </p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#221146" target="_self">Identification of the event initiator</a></p><p class="relateditem"><a href="#221150" target="_self">Getting detailed information about events on the dashboard</a></p><p class="relateditem"><a href="#221189" target="_self">Getting detailed information about events from the syslog</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221146"><p><a name=221146 style="display: none;">[Topic 221146]</a></p>
	<h2 id="t234389" class="heading2">Identification of the event initiator</h2>
<p class="bodytext">Each event in Kaspersky Scan Engine has an <em class="emphasischaracter">Initiator</em>&#8212;someone or something that triggered the event. </p>
<p class="bodytext">You can find information about the initiator on the <a id="h180278" class="englishcrossreferencetemplate" href="#179695" target="_self">Kaspersky Scan Engine dashboard</a>, in the <span class="guicharacter">Initiator</span> column of the events table. If you want to display events triggered by a certain initiator, you can use the <span class="guicharacter">Initiator</span> filter. </p>
<p class="bodytext">In the <span class="guicharacter">Initiator</span> column, the following values are possible:</p>
<ul class="listbullet1"><li class="listbullet1"><span class="boldcharacter">The name of the user (the login)</span>. This value means that the user has initiated the event through the Kaspersky Scan Engine GUI. For example, logged in or restarted Kaspersky Scan Engine by clicking the <span class="guicharacter">Restart</span> button.</li><li class="listbullet1"><span class="boldcharacter">Service Scan Engine</span>. This value means that Kaspersky Scan Engine initiated the event, either itself or by user command. For example, Kaspersky Scan Engine itself can run an update on a schedule or run an update after a user has clicked the <span class="guicharacter">Update</span> button. Clicking the <span class="guicharacter">Update</span> button here is an event initiated by a user, and running the update is a separate event initiated by Kaspersky Scan Engine.</li><li class="listbullet1"><span class="boldcharacter">IP address</span>. This value means that an HTTP or ICAP client sent a request to the Kaspersky Scan Engine API. For example, sent a file to scan.<p class="attentioncontinue1">The IP address of a scan request initiator is also displayed in the <span class="guicharacter">Client</span> column of the scan results table. You can find this table on the <span class="guicharacter"><a id="h180597" class="englishcrossreferencetemplate" href="#179696" target="_self">Scan results</a></span> page of the Kaspersky Scan Engine GUI.</p>
</li></ul><p class="bodytext">You can also find information about the initiator in <a id="h221488" class="englishcrossreferencetemplate" href="#221189" target="_self">syslog messages</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221150"><p><a name=221150 style="display: none;">[Topic 221150]</a></p>
	<h2 id="t234370" class="heading2">Getting detailed information about events on the dashboard</h2>
<p class="bodytext">You can find detailed information about any event on the <a id="h180278" class="englishcrossreferencetemplate" href="#179695" target="_self">Kaspersky Scan Engine dashboard</a>, in the <span class="guicharacter">Details</span> column of the events table.</p>
<p class="listheading">The detailed information includes the following data:</p>
<ul class="listbullet1"><li class="listbullet1">What action was taken.</li><li class="listbullet1">Whether the action was successful or not.</li><li class="listbullet1">Additional information, if any.</li></ul><p class="listheading">From a security point of view, the most important events are those that contain information about the following actions:</p>
<ul class="listbullet1"><li class="listbullet1">User login to the Kaspersky Scan Engine GUI.</li><li class="listbullet1">An attempt to login with incorrect credentials.</li><li class="listbullet1">Turning on or turning off the scan engine.</li><li class="listbullet1">Creating, changing, or deleting a user account.</li><li class="listbullet1">Changing Kaspersky Scan Engine settings.</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="221189"><p><a name=221189 style="display: none;">[Topic 221189]</a></p>
	<h2 id="t234369" class="heading2">Getting detailed information about events from the syslog</h2>
<p class="bodytext">If <a id="h179951" class="englishcrossreferencetemplate" href="#179926" target="_self">Syslog logging is enabled</a>, Kaspersky Scan Engine sends information about events to the syslog daemon, in CEF or RAW format. </p>
<p class="bodytext">In CEF format, the information includes:</p>
<ul class="listbullet1"><li class="listbullet1">Name of the event.</li><li class="listbullet1">Importance level of the event. The higher the level, the higher the importance of the event.</li><li class="listbullet1">IP address of the computer on which Kaspersky Scan Engine is running, in IPv4 format.</li><li class="listbullet1">Hostname of the computer on which Kaspersky Scan Engine is running.</li><li class="listbullet1">Description of the event.</li></ul><p class="bodytext">In RAW format, the information includes a description of the event.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">See also:</p><p class="relateditem"><a href="#179879" target="_self">Configuring logging in HTTP mode</a></p><p class="relateditem"><a href="#186767" target="_self">Format of CEF logs in HTTP mode</a></p><p class="relateditem"><a href="#186769" target="_self">Format of RAW logs in HTTP mode</a></p><p class="relateditem"><a href="#179896" target="_self">Configuring logging in ICAP mode</a></p><p class="relateditem"><a href="#186631" target="_self">Format of CEF logs in ICAP mode</a></p><p class="relateditem"><a href="#186652" target="_self">Format of RAW logs in ICAP mode</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179684"><p><a name=179684 style="display: none;">[Topic 179684]</a></p>
	<h1 id="t234431" class="heading1">Logging</h1>
<p class="bodytext">This section explains how to configure and enable logging in Kaspersky Scan Engine. </p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#179928" target="_self">Manually enabling logging</a></p><p class="relateditem"><a href="#179926" target="_self">Logging configuration file</a></p><p class="relateditem"><a href="#179925" target="_self">Logged user data</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179928"><p><a name=179928 style="display: none;">[Topic 179928]</a></p>
	<h2 id="t234447" class="heading2">Manually enabling logging</h2>
<p class="bodytext">This section describes how to enable logging manually.</p>
<p class="bodytext">You can separately enable logging for Kaspersky Anti-Virus Engine</p>
<p class="attentionbody">Logging significantly reduces Kaspersky Scan Engine performance. You are advised to use logging only for debugging purposes.</p>
<p class="introheading">Enabling logging for Kaspersky Anti-Virus Engine</p>
<p class="bodytext">By default, Kaspersky Scan Engine does not log KAV Engine events.</p>
<p class="procedureheading">To enable logging in Kaspersky Anti-Virus Engine:</p>
<ol class="listnumber1"><li class="listnumber1">Create a file named kave.ini in the ppl subdirectory of the installation directory.</li><li class="listnumber1">Add the following lines to kave.ini:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">[LOGGING]</p>
<p class="program">WriteLog=9 </p>
</td>
</tr>

</table>
</li><li class="listnumber1">Specify other <a id="h179951" class="englishcrossreferencetemplate" href="#179926" target="_self">parameters</a>, if they are needed.</li><li class="listnumber1">Save and close kave.ini.</li><li class="listnumber1">Restart the Kaspersky Scan Engine service:<ul class="listbullet2"><li class="listbullet2">In HTTP mode, <a id="h193043" class="englishcrossreferencetemplate" href="#192981" target="_self">restart the kavhttpd service</a>.</li><li class="listbullet2">In ICAP mode, <a id="h193044" class="englishcrossreferencetemplate" href="#192990" target="_self">restart the kavicapd service</a>.</li></ul></li></ol><p class="attentionbody">Logging settings for the kavicapd/kavhttpd service and Kaspersky Anti-Virus Engine are synchronized on start and restart of the klScanEngineUI service. Kaspersky Scan Engine sets the logging level (<code class="programcharacter">WriteLog</code>) and log directory (<code class="programcharacter">LogsFolder</code>) in kave.ini to be the same as specified in the <code class="programcharacter">DebugLogging</code> section of icapdkavlog.conf (for ICAP mode) or httpdkavlog.ini (for HTTP mode).</p>
<p class="introheading">Enabling logging in HTTP mode</p>
<p class="bodytext">By default, logging in HTTP mode is disabled. Kaspersky Scan Engine checks for the httpdkavlog.ini logging configuration file when the kavhttpd service starts. If this file exists, Kaspersky Scan Engine reads parameters from it.</p>
<p class="procedureheading">To enable logging for the kavhttpd service:</p>
<ol class="listnumber1"><li class="listnumber1">Create a file named httpdkavlog.ini in the directory where the kavhttpd binary file is located.</li><li class="listnumber1">Change the value of the <code class="programcharacter">&lt;LogLevel&gt;</code> element to <code class="programcharacter">1</code>.</li><li class="listnumber1">Specify the rest of the <a id="h180157" class="englishcrossreferencetemplate" href="#179879" target="_self">parameters</a>, if needed.</li><li class="listnumber1">Save and close httpdkavlog.ini.</li><li class="listnumber1">Restart the kavhttpd service.</li></ol><p class="introheading">Enabling logging in ICAP mode</p>
<p class="bodytext">By default, logging in ICAP mode is disabled. Kaspersky Scan Engine checks the icapdkavlog.conf logging configuration file when the kavicapd service starts.</p>
<p class="procedureheading">To enable logging for the kavicapd service:</p>
<ol class="listnumber1"><li class="listnumber1">Open the icapdkavlog.conf logging configuration file.</li><li class="listnumber1">Specify <code class="programcharacter">debug</code> or <code class="programcharacter">dbg</code> in the <code class="programcharacter">&lt;Level&gt;</code> element.</li><li class="listnumber1">Specify other <a id="h190568" class="englishcrossreferencetemplate" href="#179896" target="_self">parameters</a>, if they are needed.</li><li class="listnumber1">Save and close icapdkavlog.conf.</li><li class="listnumber1">Restart the kavicapd service.</li></ol><p class="introheading">Enabling logging in Kaspersky Scan Engine GUI</p>
<p class="procedureheading">To enable logging in Kaspersky Scan Engine GUI:</p>
<ol class="listnumber1"><li class="listnumber1">Enable logging in the configuration file that corresponds to the selected Kaspersky Scan Engine mode (HTTP or ICAP).<ul class="listbullet2"><li class="listbullet2">If HTTP mode is used, enable logging in the <a id="h180157_2" class="englishcrossreferencetemplate" href="#179879" target="_self">httpdkavlog.ini</a> logging configuration file.</li><li class="listbullet2">If ICAP mode is used, enable logging in the <a id="h190568_2" class="englishcrossreferencetemplate" href="#179896" target="_self">icapdkavlog.conf</a> logging configuration file.</li></ul></li><li class="listnumber1">In Kaspersky Scan Engine GUI, go to <span class="guicharacter">Settings</span>&nbsp; <span class="guicharacter">Logging</span> and enable logging.<p class="attentioncontinue1">You can enable or disable logging in Kaspersky Scan Engine GUI without restarting the kavicapd or kavhttpd service.</p>
</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179926"><p><a name=179926 style="display: none;">[Topic 179926]</a></p>
	<h2 id="t234432" class="heading2">Logging configuration file</h2>
<p class="bodytext">This section describes properties of the kave.ini logging configuration file. The kave.ini logging configuration file defines the logging settings for Kaspersky Anti-Virus Engine. Logging is configured separately for the <a id="h180157" class="englishcrossreferencetemplate" href="#179879" target="_self">kavhttpd</a> and <a id="h190568" class="englishcrossreferencetemplate" href="#179896" target="_self">kavicapd</a> services.</p>
<p class="attentionbody">Logging settings for the kavicapd/kavhttpd service and Kaspersky Anti-Virus Engine are synchronized on start and restart of the klScanEngineUI service. Kaspersky Scan Engine sets the logging level (<code class="programcharacter">WriteLog</code>) and log directory (<code class="programcharacter">LogsFolder</code>) in kave.ini to be the same as specified in the <code class="programcharacter">DebugLogging</code> section of icapdkavlog.conf (for ICAP mode) or httpdkavlog.ini (for HTTP mode).</p>
<p class="bodytext">The following table describes properties of the kave.ini logging configuration file.</p>
<p class="tablename">Logging configuration file properties</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="642" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="114"><p class="tableheading">Property</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="528"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="114"><p class="tablebodytext"><code class="programcharacter">Append</code></p>
</td>
<td style="border:1px solid #010101;" width="528"><p class="tablebodytext">Specifies whether previous log files are kept intact or are deleted on each initialization of Kaspersky Scan Engine.</p>
<p class="tablebodytext">Possible values:</p>
<ul class="tablelistbullet"><li class="tablelistbullet"><code class="programcharacter">0</code><p class="tablelistcontinue">Automatically remove existing log files.</p>
<p class="tablelistcontinue">Existing log files in the log directory are automatically removed when Kaspersky Scan Engine is initialized.</p>
</li><li class="tablelistbullet"><code class="programcharacter">1</code><p class="tablelistcontinue">Keep existing log files.</p>
<p class="tablelistcontinue">Kaspersky Scan Engine writes logging information to new log files, each corresponding to a specific process. The option does not make the Kaspersky Scan Engine append information to an existing log.</p>
</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="114"><p class="tablebodytext"><code class="programcharacter">SizeLimit</code></p>
</td>
<td style="border:1px solid #010101;" width="528"><p class="attentionbody">Only for Windows platforms. On Unix-like platforms, this parameter is ignored even if it is specified in kave.ini.</p>
<p class="tablebodytext">Sets the maximum possible size of a log file (in megabytes).</p>
<p class="tablebodytext">Possible values:</p>
<p class="tablebodytext">Any positive integer in the range 0 to 4095.</p>
<p class="tablebodytext">Special cases:</p>
<ul class="tablelistbullet"><li class="tablelistbullet">0<p class="tablelistcontinue">No limit for the size of a log file. The log files can grow indefinitely.</p>
</li></ul><p class="attentionbody">Setting the limit to a non-zero value automatically turns on the append mode regardless of the value specified for the <code class="programcharacter">Append</code> property.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="114"><p class="tablebodytext"><code class="programcharacter">WriteLog</code></p>
</td>
<td style="border:1px solid #010101;" width="528"><p class="tablebodytext">Logging level.</p>
<p class="tablebodytext">Recommended values:</p>
<ul class="tablelistbullet"><li class="tablelistbullet">0<p class="tablelistcontinue">Logging is disabled.</p>
</li><li class="tablelistbullet">9<p class="tablelistcontinue">Debug level.</p>
</li></ul><p class="bodytext">Using other values is not recommended.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="114"><p class="tablebodytext"><code class="programcharacter">LogsFolder</code></p>
</td>
<td style="border:1px solid #010101;" width="528"><p class="tablebodytext">Path to the log directory.</p>
<p class="tablebodytext">Do not enclose the path in quotation marks and do not use the escape sequence for whitespace.</p>
<p class="tablebodytext">Possible values:</p>
<p class="introheading">Relative path</p>
<p class="tablebodytext">A path is calculated relative to the directory that contains the kave.ini logging configuration file.</p>
<p class="tablebodytext">If you specify a nonexistent directory, log files are created in a directory that contains the binary file of the service in use (<code class="programcharacter">kavhttpd</code> in HTTP mode, and <code class="programcharacter">kavicapd</code> in the ICAP mode).</p>
<p class="introheading">Absolute path</p>
<p class="tablebodytext">If you specify a nonexistent directory, log files are created in a directory that contains the binary file of the service in use (<code class="programcharacter">kavhttpd</code> in HTTP mode, and <code class="programcharacter">kavicapd</code> in the ICAP mode).</p>
<p class="introheading">Local path</p>
<p class="tablebodytext">The directory that contains kave.ini. A local path can be specified by either setting the value of the <code class="programcharacter">LogsFolder</code> parameter to <code class="programcharacter">&quot;.&quot; </code>(without quotation marks) or leaving the value blank.</p>
<p class="attentionbody">The full custom path for the log files must not exceed the limit of 260 characters, applied by <code class="programcharacter">MAX_PATH</code> macro.<br>This integer number does not include additional length restrictions such as a null terminator used in C strings and other restrictions imposed by platforms: for example, when the file system stores an additional short name in 8.3 format with the original file name, to maintain compatibility with legacy applications.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="114"><p class="tablebodytext"><code class="programcharacter">Syslog</code></p>
</td>
<td style="border:1px solid #010101;" width="528"><p class="tablebodytext">This property specifies whether Kaspersky Scan Engine sends logging data to a syslog daemon.</p>
<p class="tablebodytext">When using a syslog daemon, you can write logging data to log files, other programs, or redirect them to another host, as configured the configuration file for the syslog daemon.</p>
<p class="tablebodytext">Possible values:</p>
<ul class="tablelistbullet"><li class="tablelistbullet">0<p class="tablelistcontinue">Do not send syslog messages to the syslog daemon. Logging data is written directly to the location specified in the <code class="programcharacter">LogsFolder</code> parameter.</p>
</li><li class="tablelistbullet">1<p class="tablelistcontinue">Redirect logging data to a syslog daemon. In this case, logging data is stored at the location specified in the configuration file of the syslog daemon. The value of the <code class="programcharacter">LogsFolder</code> parameter is ignored.</p>
</li></ul><p class="attentionbody">Before redirecting logging data to a syslog daemon, make sure to configure your syslog daemon for debug logging. Add the following line to the <code class="programcharacter">syslog.conf</code> configuration file:<br><code class="programcharacter">*.=debug -/var/log/debug</code><br>The syslog configuration file is typically located at <code class="programcharacter">/etc/syslog.conf</code> and controls the output of the syslogd daemon.</p>
</td>
</tr>

</table>
<p class="spacer"></p>
<p class="introheading">Remarks</p>
<p class="bodytext">In some cases, your technical account manager (TAM) may ask you to enable advanced logging. Advanced logging may help Kaspersky specialists investigate troublesome issues.</p>
<p class="procedureheading">To enable advanced logging:</p>
<ol class="listnumber1"><li class="listnumber1">Open the <code class="programcharacter">kave.ini</code> file (create a new one in the folder with <code class="programcharacter">kavehost</code> binary if needed)</li><li class="listnumber1">In the <code class="programcharacter">Logging</code> section add the <code class="programcharacter">BssLogsFolder</code> option and specify a location to store the files with advanced logging data.<p class="listcontinue1">This location must be separate from your standard logging data location (specified in <code class="programcharacter">LogsFolder</code>).</p>
</li></ol><p class="introheading">Examples</p>
<p class="bodytext">The following example lists a sample configuration file for each of the target platforms. </p>
<p class="bodytext">The following sample configuration file may be used on a UNIX-like platform.</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">[LOGGING]</p>
<p class="program">WriteLog=9</p>
<p class="program">Append=0</p>
<p class="program">LogsFolder=./logs</p>
<p class="program">Syslog=0</p>
</td>
</tr>

</table>
<p class="spacer"></p>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179925"><p><a name=179925 style="display: none;">[Topic 179925]</a></p>
	<h2 id="t234430" class="heading2">Logged user data</h2>
<p class="bodytext">When Kaspersky Scan Engine runs diagnostic logging, some user data may be stored locally in the log files created by Kaspersky Scan Engine. The data is added to the log files without making any changes. Kaspersky Scan Engine does not edit or alter this data, or otherwise send it anywhere. Logged data is stored locally on your computer with the running copy of Kaspersky Scan Engine in the location specified by the <a id="h179951" class="englishcrossreferencetemplate" href="#179926" target="_self">kave.ini file</a>.</p>
<p class="bodytext">If protection of logged data is important to you, you must implement a method of protection yourself. For example, you may want to grant only specific user accounts access to the logged data.</p>
<p class="bodytext">The following types of user data are written in a plain text format to log files:</p>
<ul class="listbullet1"><li class="listbullet1">Paths to scanned objects</li><li class="listbullet1">Scanned URLs</li><li class="listbullet1">Addresses of scanned memory blocks</li><li class="listbullet1">Contents of the Kaspersky Scan Engine user agent string:<ul class="listbullet2"><li class="listbullet2">Version of the user agent string format</li><li class="listbullet2">Identifier of Kaspersky Scan Engine</li><li class="listbullet2">Licensing mode</li><li class="listbullet2">Identifier of the license</li><li class="listbullet2">Update session identifier</li><li class="listbullet2">Full version of Kaspersky Scan Engine: major, minor, build, revision, and hotfix</li></ul></li></ul><p class="bodytext">If Kaspersky Scan Engine uses a proxy to establish connection to the Internet, Kaspersky Scan Engine also may log the following information:</p>
<ul class="listbullet1"><li class="listbullet1">Proxy server IP address (IPv4 or IPv6) or host name</li><li class="listbullet1">Port number of the proxy server</li><li class="listbullet1">User name for the proxy authentication</li></ul><p class="bodytext">Kaspersky Scan Engine does not log passwords for the proxy authentication.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="220775"><p><a name=220775 style="display: none;">[Topic 220775]</a></p>
	<h1 id="t234402" class="heading1">Integration with SIEM solutions</h1>
<p class="bodytext">This section explains how to integrate Kaspersky Scan Engine with SIEM solutions such as Splunk, KUMA, or ArcSight ESM. </p>
<p class="bodytext">To be integrated with a SIEM solution, Kaspersky Scan Engine has to send Syslog events in CEF or SYSLOG format to the SIEM solution. </p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#220777" target="_self">Integration with Splunk</a></p><p class="relateditem"><a href="#220779" target="_self">Integration with ArcSight ESM</a></p><p class="relateditem"><a href="#220778" target="_self">Integration with KUMA</a></p><p class="relateditem"><a href="#220786" target="_self">Configuring Kaspersky Scan Engine to interact with a SIEM</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="220777"><p><a name=220777 style="display: none;">[Topic 220777]</a></p>
	<h2 id="t234403" class="heading2">Integration with Splunk</h2>
<p class="procedureheading">To integrate Kaspersky Scan Engine with Splunk</p>
<ol class="listnumber1"><li class="listnumber1"><a id="h220989" class="englishcrossreferencetemplate" href="#220780" target="_self">Configure Splunk</a>.</li><li class="listnumber1"><a id="h220794" class="englishcrossreferencetemplate" href="#220786" target="_self">Configure Kaspersky Scan Engine</a>.</li></ol><p class="bodytext">After you integrate Kaspersky Scan Engine with Splunk, you can <a id="h220990" class="englishcrossreferencetemplate" href="#220782" target="_self">search for information about events that Kaspersky Scan Engine sent to Splunk</a>.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#220780" target="_self">Configuring Splunk</a></p><p class="relateditem"><a href="#220782" target="_self">Searching for Kaspersky Scan Engine events in Splunk</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="220780"><p><a name=220780 style="display: none;">[Topic 220780]</a></p>
	<h3 id="t234308" class="heading3">Configuring Splunk</h3>
<p class="bodytext">For better parsing of Kaspersky Scan Engine events in CEF format, install <a class="hyperlinktemplate" href="https://splunkbase.splunk.com/app/487/" target="_blank">CEF Extraction Add-on</a> to your Splunk instance.</p>
<p class="procedureheading">To configure Splunk:</p>
<ol class="listnumber1"><li class="listnumber1">Open the Splunk web interface.</li><li class="listnumber1">Go to <span class="boldcharacter">Settings</span> &gt; <span class="boldcharacter">Data inputs</span>.<p class="picture"><img id="f220992" src="splunk_menu.png" class="linkedpngfiletemplate" alt="Splunk &quot;Settings&quot; menu." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Selecting <span class="boldcharacter">Settings</span> &gt; <span class="boldcharacter">Data inputs</span></p>
</li><li class="listnumber1">In <span class="boldcharacter">Local inputs</span>, locate the <span class="boldcharacter">TCP</span> element in the list, and then click <span class="boldcharacter">Add new</span>.</li><li class="listnumber1">Fill out the form that opens:<ul class="listbullet2"><li class="listbullet2"><span class="boldcharacter">Port</span>. Specify the port to which Kaspersky Scan Engine must send logs. For example, <span class="boldcharacter">9998</span>.</li><li class="listbullet2"><span class="boldcharacter">Source name override</span>. Specify <span class="boldcharacter">scanengine</span>.</li></ul><p class="picture"><img id="f220993" src="splunk_port_and_source_name.png" class="linkedpngfiletemplate" alt="Port = 9998, Source name override = scanengine." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Adding a new TCP input</p>
<p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">In the next window in <span class="boldcharacter">Select Source Type</span>, specify the source type:<ul class="listbullet2"><li class="listbullet2">Specify <span class="boldcharacter">cefevents</span> if you installed the <a class="hyperlinktemplate" href="https://splunkbase.splunk.com/app/487/" target="_blank">CEF Extraction Add-on for Splunk</a>.</li></ul><p class="picture"><img id="f220994" src="splunk_cefevents.png" class="linkedpngfiletemplate" alt="&quot;cefevents&quot; selected." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Selecting <span class="boldcharacter">cefevents</span></p>
<ul class="listbullet2"><li class="listbullet2">Specify <span class="boldcharacter">syslog</span> if you did not install CEF Extraction Add-on for Splunk.</li></ul><p class="listcontinue1">You can specify the <span class="boldcharacter">App Context</span> and <span class="boldcharacter">Index</span> fields according to your needs. For example, you can specify the index of the events sent by Kaspersky Scan Engine.</p>
</li><li class="listnumber1">Click <span class="boldcharacter">Review</span> to check the settings, and then click <span class="boldcharacter">Submit</span>.</li></ol><p class="bodytext">After <a id="h220794" class="englishcrossreferencetemplate" href="#220786" target="_self">Kaspersky Scan Engine is configured</a>, you can check if the Splunk configuration is correct.</p>
<p class="procedureheading">To check if Splunk is configured correctly:</p>
<ol class="listnumber1"><li class="listnumber1">In the Splunk web interface, open <span class="boldcharacter">Search &amp; Reporting</span>.</li><li class="listnumber1">Specify the search parameters as follows:<ul class="listbullet2"><li class="listbullet2">If you specified <span class="boldcharacter">cefevents</span> in <span class="boldcharacter">Source Type</span> earlier, enter the following search string:<p class="listcontinue2"><code class="programcharacter">source=&quot;scanengine&quot; sourcetype=&quot;cefevents&quot; </code></p>
</li><li class="listbullet2">If you specified <span class="boldcharacter">syslog</span> in <span class="boldcharacter">Source Type</span> earlier, enter the following search string:<p class="listcontinue2"><code class="programcharacter">source=&quot;scanengine&quot; sourcetype=&quot;syslog&quot; </code></p>
</li><li class="listbullet2"><span class="boldcharacter">Time filter</span>: specify <span class="boldcharacter">All time (real-time)</span></li></ul></li><li class="listnumber1"> Run search.</li></ol><p class="bodytextindent">If Splunk is configured correctly, it displays events sent by Kaspersky Scan Engine in real time.</p>
<p class="picture"><img id="f221003" src="splunk_search_results.png" class="linkedpngfiletemplate" alt="Kaspersky Scan Engine events search form and search results." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Events sent by Kaspersky Scan Engine</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="220782"><p><a name=220782 style="display: none;">[Topic 220782]</a></p>
	<h3 id="t234507" class="heading3">Searching for Kaspersky Scan Engine events in Splunk</h3>
<p class="introheading">Searching for object scan results</p>
<p class="procedureheading">To display events containing object scan results, </p>
<p class="bodytextindent">Use the following search query:</p>
<p class="bodytextindent"><code class="programcharacter">source=&quot;scanengine&quot; &quot;Scan result&quot; msg=*scan* | eval cs2=coalesce(cs2,&quot;-&quot;) | rename cs1 as &quot;Scan Result&quot;, cs2 as &quot;Virus Name&quot;, fname as &quot;Object&quot;, src as &quot;Source Address&quot;, fileHash as &quot;Object Hashsum&quot; |table _time, &quot;Object Hashsum&quot;,Object,&quot;Scan Result&quot;,&quot;Virus Name&quot;,&quot;Source Address&quot;</code></p>
<p class="picture"><img id="f221029" src="splunk_object_scan_results.png" class="linkedpngfiletemplate" alt="Kaspersky Scan Engine objects scan search form and search results." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Searching for object scan results</p>
<p class="introheading">Searching for URL check results</p>
<p class="procedureheading">To display events containing URL check results, </p>
<p class="bodytextindent">Use the following search query:</p>
<p class="bodytextindent"><code class="programcharacter">source=&quot;scanengine&quot; &quot;Scan result&quot; msg=URL* | rename cs1 as &quot;Scan Result&quot;, request as &quot;Scanned URL&quot;, src as &quot;Source Address&quot; | table _time, &quot;Scanned URL&quot;, &quot;Scan Result&quot;, &quot;Source Address&quot;</code></p>
<p class="picture"><img id="f221030" src="splunk_url_check_results.png" class="linkedpngfiletemplate" alt="Kaspersky Scan Engine URL check search form and search results." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Searching for URL check results</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="220779"><p><a name=220779 style="display: none;">[Topic 220779]</a></p>
	<h2 id="t234400" class="heading2">Integration with ArcSight ESM</h2>
<p class="procedureheading">To integrate Kaspersky Scan Engine with ArcSight ESM:</p>
<ol class="listnumber1"><li class="listnumber1"><a id="h220899" class="englishcrossreferencetemplate" href="#220896" target="_self">Configure ArcSight ESM</a>.</li><li class="listnumber1"><a id="h220794" class="englishcrossreferencetemplate" href="#220786" target="_self">Configure Kaspersky Scan Engine</a>.</li></ol><p class="bodytext">After you integrate Kaspersky Scan Engine with ArcSight ESM, you can <a id="h220901" class="englishcrossreferencetemplate" href="#220898" target="_self">search for information about events that Kaspersky Scan Engine sent to ArcSight ESM</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="220896"><p><a name=220896 style="display: none;">[Topic 220896]</a></p>
	<h3 id="t234298" class="heading3">Configuring ArcSight ESM</h3>
<p class="bodytext">For ArcSight ESM to receive events from Kaspersky Scan Engine, an ArcSight SmartConnector of the Syslog Daemon type must be installed. You can install ArcSight SmartConnector on any computer that can connect to Kaspersky Scan Engine and to ArcSight ESM.</p>
<p class="procedureheading">To install an ArcSight SmartConnector:</p>
<ol class="listnumber1"><li class="listnumber1">Run the ArcSight SmartConnector installation application.<p class="attentioncontinue1">This application is a component of HP ArcSight and is not included in Kaspersky Scan Engine.</p>
</li><li class="listnumber1">Specify the ArcSight SmartConnector installation directory (hereinafter referred to as <code class="programcharacter">%ARCSIGHT_HOME%</code>).</li><li class="listnumber1">Select <span class="boldcharacter">Don't create links</span>.</li><li class="listnumber1">After unpacking the contents of the binary file, select <span class="boldcharacter">Add a Connector</span>.<p class="picture"><img id="f220907" src="arcsight_add_connector.png" class="linkedpngfiletemplate" alt="&quot;Connector Setup&quot; window. Selected variant &quot;Add a Connector&quot;." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Selecting <span class="boldcharacter">Add a Connector</span></p>
<p class="listcontinue2">If this window is not displayed, run the following command:</p>
<p class="listcontinue2"><code class="programcharacter">%ARCSIGHT_HOME%/current/bin/runagentsetup.sh</code></p>
</li><li class="listnumber1">Select <span class="boldcharacter">Syslog Daemon</span> as the connector type.</li><li class="listnumber1">Specify the parameters of the connector in the <span class="boldcharacter">Enter the parameter details</span> form as follows:<ul class="listbullet2"><li class="listbullet2"><span class="boldcharacter">Network port</span>. Specify the port to which Kaspersky Scan Engine must send detection events.<p class="listcontinue2">You specify the same port in the <a id="h220794" class="englishcrossreferencetemplate" href="#220786" target="_self">Kaspersky Scan Engine Syslog settings</a>.</p>
</li><li class="listbullet2"><span class="boldcharacter">IP Address</span>. Specify the IP address to which Kaspersky Scan Engine must send detection events.<p class="listcontinue2">You specify the same IP address in the <a id="h220794_2" class="englishcrossreferencetemplate" href="#220786" target="_self">Kaspersky Scan Engine Syslog settings</a>.</p>
<p class="attentioncontinue2">You can specify <span class="boldcharacter">(ALL)</span> if you want Arcsight SmartConnector to receive events from all network interfaces of the computer on which it runs. Note that you cannot specify (ALL) in the Kaspersky Scan Engine configuration file.</p>
</li><li class="listbullet2"><span class="boldcharacter">Protocol</span>. Specify <span class="boldcharacter">Raw TCP</span>.</li><li class="listbullet2"><span class="boldcharacter">Forwarder</span>. Specify <span class="boldcharacter">false</span>.</li></ul><p class="picture"><img id="f220912" src="arcsight_connector_details.png" class="linkedpngfiletemplate" alt="&quot;Connector Setup&quot; window. Network port = 9998, IP Address = (ALL), Protocol = Raw TCP, Forwarder = false." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Defining connector parameters</p>
<p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">Specify <span class="boldcharacter">ArcSight Manager (encrypted)</span> as the type of destination.<p class="picture"><img id="f220950" src="arcsight_destination_type.png" class="linkedpngfiletemplate" alt="&quot;Connector Setup&quot; window. Type of destination. Selected variant &quot;ArcSight Manager (encrypted)&quot;." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Selecting the type of destination</p>
<p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">Specify the parameters of the destination:<ul class="listbullet2"><li class="listbullet2"><span class="boldcharacter">Manager Hostname</span>. Specify the host where ArcSight Manager is running.</li><li class="listbullet2"><span class="boldcharacter">Manager Port</span>. Specify the port where ArcSight Manager is available. The default value is 8443.</li><li class="listbullet2"><span class="boldcharacter">User</span>. Specify the name of the ArcSight ESM user that has rights to register the connector.</li><li class="listbullet2"><span class="boldcharacter">Password</span>. Specify the password of the ArcSight ESM user.</li><li class="listbullet2"><span class="boldcharacter">AUP Master Destination</span>. Specify <span class="boldcharacter">false</span>.</li><li class="listbullet2"><span class="boldcharacter">Filter Out All Events</span>. Specify <span class="boldcharacter">false</span>.</li><li class="listbullet2"><span class="boldcharacter">Enable Demo CA</span>. Specify <span class="boldcharacter">false</span>.</li></ul><p class="picture"><img id="f220984" src="arcsight_destination_parameters.png" class="linkedpngfiletemplate" alt="&quot;Connector Setup&quot; window. Manager Hostname = 127.0.0.1, Manager Port = 8443, User = admin, Password is hidden, AUP Master Destination = false, Filter Out All Events = false, Enable Demo CA = false." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Defining destination parameters</p>
<p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">Specify the connector details:<ul class="listbullet2"><li class="listbullet2">Name (you can specify an arbitrary value).</li><li class="listbullet2">Location (you can specify an arbitrary value).</li><li class="listbullet2">Location of the device that must send events to the connector (you can specify an arbitrary value or leave it empty).</li><li class="listbullet2">Comment about the connector (you can specify an arbitrary value or leave it empty).</li></ul><p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">If the ArcSight Manager parameters are valid, accept importing the certificate from the destination.</li><li class="listnumber1">If the certificate is imported successfully, install the ArcSight SmartConnector service. <p class="listcontinue1">If you do not run the installation as root, the following warning is displayed:</p>
<p class="picture"><img id="f220985" src="arcsight_root_needed.png" class="linkedpngfiletemplate" alt="&quot;Connector Setup&quot; window. Root privileges needed." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">If you do not run the installation as root</p>
<p class="listcontinue1">The <code class="programcharacter">%ARCSIGHT_HOME%/current/logs/agent.log</code> file contains messages about the installation process.</p>
<p class="listcontinue1">You can skip the next step that describes how to specify the service parameters.</p>
<p class="listcontinue1">If you run the installation as root, select <span class="boldcharacter">Install as a service</span>.</p>
<p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">Specify the service parameters.<p class="listcontinue1">We recommend that you set the service name, specified in <span class="boldcharacter">Service Internal Name</span>, to be the same as the connector name.</p>
<p class="picture"><img id="f220986" src="arcsight_service_parameters.png" class="linkedpngfiletemplate" alt="&quot;Connector Setup&quot; window. Service Internal Name = smartConnector, Service Display Name = KL Smart Connector, Start the service automatically = Yes." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Defining service parameters</p>
<p class="listcontinue1">Click <span class="boldcharacter">Next</span>.</p>
</li><li class="listnumber1">To start ArcSight SmartConnector, run the following command:<p class="listcontinue1"><code class="programcharacter">/etc/init.d/arc_$service_name start</code></p>
<p class="listcontinue1">In this command, <code class="programcharacter">$service_name</code> is the service internal name.</p>
</li></ol><p class="bodytext">After the ArcSight ESM configuration is complete, you can <a id="h220794_3" class="englishcrossreferencetemplate" href="#220786" target="_self">configure Kaspersky Scan Engine</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="220898"><p><a name=220898 style="display: none;">[Topic 220898]</a></p>
	<h3 id="t234505" class="heading3">Searching for Kaspersky Scan Engine events in ArcSight ESM </h3>
<p class="introheading">Searching for events from Kaspersky Scan Engine version 2.0</p>
<p class="procedureheading">To search ArcSight ESM for events sent by Kaspersky Scan Engine version 2.0,</p>
<p class="bodytextindent">Specify the parameters of the search query as follows:</p>
<ul class="listbullet2"><li class="listbullet2">If Kaspersky Scan Engine works in ICAP mode:<p class="listcontinue2"><span class="boldcharacter">DeviceVendor = Kaspersky Lab</span></p>
<p class="listcontinue2"><span class="boldcharacter">AND</span></p>
<p class="listcontinue2"><span class="boldcharacter">DeviceProduct = Kaspersky ICAP Server</span></p>
</li></ul><p class="picture"><img id="f220988" src="arcsight_events_filter.png" class="linkedpngfiletemplate" alt="Events conditions. DeviceProduct = Kaspersky ICAP Server AND DeviceVendor = Kaspersky Lab." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Defining parameters of the search query</p>
<ul class="listbullet2"><li class="listbullet2">If Kaspersky Scan Engine works in HTTP mode:<p class="listcontinue2"><span class="boldcharacter">DeviceVendor = Kaspersky Lab</span></p>
<p class="listcontinue2"><span class="boldcharacter">AND</span></p>
<p class="listcontinue2"><span class="boldcharacter">DeviceProduct = Kaspersky HTTP Service</span></p>
</li></ul><p class="introheading">Searching for events from Kaspersky Scan Engine version 2.1</p>
<p class="procedureheading">To search ArcSight ESM for events sent by Kaspersky Scan Engine version 2.1,</p>
<p class="bodytextindent">Specify the parameters of the search query as follows:</p>
<ul class="listbullet2"><li class="listbullet2">If Kaspersky Scan Engine works in ICAP mode:<p class="listcontinue2"><span class="boldcharacter">DeviceVendor = Kaspersky</span></p>
<p class="listcontinue2"><span class="boldcharacter">AND</span></p>
<p class="listcontinue2"><span class="boldcharacter">DeviceProduct = Scan Engine ICAP Service</span></p>
</li><li class="listbullet2">If Kaspersky Scan Engine works in HTTP mode:<p class="listcontinue2"><span class="boldcharacter">DeviceVendor = Kaspersky</span></p>
<p class="listcontinue2"><span class="boldcharacter">AND</span></p>
<p class="listcontinue2"><span class="boldcharacter">DeviceProduct = Scan Engine HTTP Service</span></p>
</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="220778"><p><a name=220778 style="display: none;">[Topic 220778]</a></p>
	<h2 id="t234401" class="heading2">Integration with KUMA</h2>
<p class="bodytext">To integrate Kaspersky Scan Engine with KUMA:</p>
<ol class="listnumber1"><li class="listnumber1"><a id="h220793" class="englishcrossreferencetemplate" href="#220785" target="_self">Configure KUMA</a></li><li class="listnumber1"><a id="h220794" class="englishcrossreferencetemplate" href="#220786" target="_self">Configure Kaspersky Scan Engine</a></li></ol><p class="bodytext">After you integrate Kaspersky Scan Engine with KUMA, you can <a id="h220795" class="englishcrossreferencetemplate" href="#220787" target="_self">search for information about events that Kaspersky Scan Engine sent to KUMA</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="220785"><p><a name=220785 style="display: none;">[Topic 220785]</a></p>
	<h3 id="t234304" class="heading3">Configuring KUMA</h3>
<p class="bodytext">For KUMA to receive events from Kaspersky Scan Engine, add a new <a class="hyperlinktemplate" href="https://support.kaspersky.com/KUMA/1.0/en-US/194370.htm" target="_blank">Collector in KUMA</a>.</p>
<p class="bodytext">Configure the new Collector as follows:</p>
<ul class="listbullet1"><li class="listbullet1">In the <span class="boldcharacter">Transport</span> settings, set the <span class="boldcharacter">Kind</span> parameter to <span class="boldcharacter">tcp</span>.<p class="picture"><img id="f220789" src="kuma_transport.png" class="linkedpngfiletemplate" alt="Transport basic settings: Connector - ScanEngine, Kind = tcp, Tenant = General, URL = :9991." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Transport settings</p>
</li><li class="listbullet1">In the <span class="boldcharacter">Event parsing</span> settings, set the <span class="boldcharacter">Parsing method</span> parameter to <span class="boldcharacter">cef</span>.<p class="picture"><img id="f220790" src="kuma_event_parsing.png" class="linkedpngfiletemplate" alt="Event parsing settings. Normalization scheme: Normalizer = [Example] CEF, Name = [Example] CEF, Tenant = General, Parsing method = cef, Store extra fields = Only errors." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Event parsing settings</p>
</li></ul><p class="bodytext">The parameters above are essential for the integration of Kaspersky Scan Engine and KUMA. Configure other parameters according to the KUMA documentation.</p>
<p class="bodytext">After KUMA configuration is complete, you can <a id="h220794" class="englishcrossreferencetemplate" href="#220786" target="_self">configure Kaspersky Scan Engine</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="220787"><p><a name=220787 style="display: none;">[Topic 220787]</a></p>
	<h3 id="t234506" class="heading3">Searching for Kaspersky Scan Engine events in KUMA</h3>
<p class="introheading">Searching for events from Kaspersky Scan Engine version 2.1</p>
<p class="procedureheading">To search KUMA for events sent by Kaspersky Scan Engine version 2.1:</p>
<ol class="listnumber1"><li class="listnumber1">In KUMA, go to the <span class="boldcharacter">Events</span> page.</li><li class="listnumber1">Specify the parameters of the search query as follows:<ul class="listbullet2"><li class="listbullet2">If Kaspersky Scan Engine works in ICAP mode:<p class="listcontinue2"><span class="boldcharacter">DeviceVendor = Kaspersky</span></p>
<p class="listcontinue2"><span class="boldcharacter">AND</span></p>
<p class="listcontinue2"><span class="boldcharacter">DeviceProduct = Scan Engine ICAP Service</span></p>
</li></ul><p class="picture"><img id="f220797" src="kuma_kse_events_search_for_icap.png" class="linkedpngfiletemplate" alt="Search query: DeviceVendor = Kaspersky AND DeviceProduct = Scan Engine ICAP Service." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">KUMA search query for Kaspersky Scan Engine in ICAP mode</p>
<ul class="listbullet2"><li class="listbullet2">If Kaspersky Scan Engine works in HTTP mode:<p class="listcontinue2"><span class="boldcharacter">DeviceVendor = Kaspersky</span></p>
<p class="listcontinue2"><span class="boldcharacter">AND</span></p>
<p class="listcontinue2"><span class="boldcharacter">DeviceProduct = Scan Engine HTTP Service</span></p>
</li></ul><p class="picture"><img id="f220798" src="kuma_kse_events_search_for_http.png" class="linkedpngfiletemplate" alt="Search query: DeviceVendor = Kaspersky AND DeviceProduct = Scan Engine HTTP Service." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">KUMA search query for Kaspersky Scan Engine in HTTP mode</p>
</li></ol><p class="introheading">Searching for events from Kaspersky Scan Engine version 2.0</p>
<p class="procedureheading">To search KUMA for events sent by Kaspersky Scan Engine version 2.0:</p>
<ol class="listnumber1"><li class="listnumber1">In KUMA, go to the <span class="boldcharacter">Events</span> page.</li><li class="listnumber1">Specify the parameters of the search query as follows:<ul class="listbullet2"><li class="listbullet2">If Kaspersky Scan Engine works in ICAP mode:<p class="listcontinue2"><span class="boldcharacter">DeviceVendor = Kaspersky Lab</span></p>
<p class="listcontinue2"><span class="boldcharacter">AND</span></p>
<p class="listcontinue2"><span class="boldcharacter">DeviceProduct = Kaspersky ICAP Server</span></p>
</li><li class="listbullet2">If Kaspersky Scan Engine works in HTTP mode:<p class="listcontinue2"><span class="boldcharacter">DeviceVendor = Kaspersky Lab</span></p>
<p class="listcontinue2"><span class="boldcharacter">AND</span></p>
<p class="listcontinue2"><span class="boldcharacter">DeviceProduct = Kaspersky HTTP Service</span></p>
</li></ul></li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="220786"><p><a name=220786 style="display: none;">[Topic 220786]</a></p>
	<h2 id="t234303" class="heading2">Configuring Kaspersky Scan Engine to interact with a SIEM</h2>
<p class="procedureheading">To configure Kaspersky Scan Engine to interact with a SIEM solution:</p>
<ol class="listnumber1"><li class="listnumber1">Open Kaspersky Scan Engine GUI.</li><li class="listnumber1">Go to <span class="guicharacter">Settings</span> &gt; <span class="guicharacter">Logging</span>.</li><li class="listnumber1">Enable <span class="guicharacter">Syslog</span> and set the following parameters:<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Format</span>: <span class="boldcharacter">CEF</span>.</li><li class="listbullet2"><span class="guicharacter">Target</span>: <span class="boldcharacter">Remote host</span>.</li><li class="listbullet2"><span class="guicharacter">Events</span>: Specify the types of events that Kaspersky Scan Engine must send to the SIEM solution. For more information on event types, see the description of the <code class="programcharacter">LoggedEvent</code> element in section &quot;<a id="h190568" class="englishcrossreferencetemplate" href="#179896" target="_self">Configuring logging in ICAP mode</a>&quot;.</li><li class="listbullet2">The SIEM solution IP address and port.</li></ul><p class="picture"><img id="f220792" src="kse_syslog_settings.png" class="linkedpngfiletemplate" alt="Syslog enabled. Settings: Events = ScanResultClean, ScanResultDetect, ScanResultOther; Format = CEF; Target = Remote host; SIEM solution IP address and port." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Kaspersky Scan Engine Syslog settings</p>
</li><li class="listnumber1">Save the settings.</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="235568"><p><a name=235568 style="display: none;">[Topic 235568]</a></p>
	<h1 id="t235569" class="heading1">Integration with Docker and Kubernetes</h1>
<p class="bodytext">To deploy and use Kaspersky Scan Engine with Docker and Kubernetes, refer to the documentation on <a class="hyperlinktemplate" href="https://support.kaspersky.com/ScanEngine/docker_2.1/en-US/" target="_blank">integrating Kaspersky Scan Engine with cloud Kubernetes services</a>.</p>
<p class="bodytext">The documentation also describes integration with Amazon&#8482; Elastic Kubernetes Service and Microsoft&reg; Azure Kubernetes Service.</p>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179827"><p><a name=179827 style="display: none;">[Topic 179827]</a></p>
	<h1 id="t234286" class="heading1">Boosting performance of Kaspersky Scan Engine</h1>
<p class="bodytext">Kaspersky Scan Engine supports multithreading. This feature allows you to use Kaspersky Scan Engine on high-load systems. </p>
<p class="bodytext">This section describes best practices for boosting performance of Kaspersky Scan Engine.</p>
<p class="introheading">General recommendations on raising performance</p>
<p class="bodytext">To achieve optimal performance:</p>
<ul class="listbullet1"><li class="listbullet1">Use the number of scanning processes equal to the number of CPU cores and two threads per process.</li><li class="listbullet1">Enable Keep-Alive for <a id="h207296" class="englishcrossreferencetemplate" href="#207291" target="_self">ICAP</a> and <a id="h207358" class="englishcrossreferencetemplate" href="#207348" target="_self">HTTP</a> connections.</li></ul><p class="introheading">Recommendations for raising performance of Kaspersky Scan Engine in HTTP mode</p>
<p class="bodytext">The following list presents the recommended order of configuring Kaspersky Scan Engine for peak performance:</p>
<ol class="listnumber1"><li class="listnumber1">Specify the number of scan processes and scan threads that you want in the <code class="programcharacter">ScannersCount</code> parameter and the <code class="programcharacter">ThreadsCount</code> parameter, respectively.<p class="listcontinue1"> The threads process scan tasks from the scan queue. The length of the scan queue is specified in the <code class="programcharacter">QueueLen</code> parameter of the <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">HTTP mode configuration file</a>.</p>
</li><li class="listnumber1">Specify the maximum number of active TCP connections to Kaspersky Scan Engine in the <code class="programcharacter">MaxHTTPSessionsNum</code> parameter.<p class="listcontinue1">When Kaspersky Scan Engine works in a high-load environment, it is recommended to make the value of this parameter greater than the value of <code class="programcharacter">ThreadsCount</code>, so that the scan queue is filled faster and scan threads do not stand idle. Please notice that Kaspersky Scan Engine loads files into system memory while scanning. The more active sessions Kaspersky Scan Engine has, the more system memory it consumes. You can limit the maximum allowed size of headers and bodies of HTTP messages that are sent to KAV HTTPD by specifying their maximum size in the <code class="programcharacter">MaxTCPFileSize</code> parameter.</p>
</li><li class="listnumber1">Specify the desired number of pending TCP connections to Kaspersky Scan Engine in the <code class="programcharacter">MaxIncomingConnectionsNum</code> parameter. Notice that this value is passed to the <code class="programcharacter">listen(2)</code> system function and may be changed depending on the operating system.</li></ol><p class="bodytext">It is recommended to set the value of <code class="programcharacter">MaxIncomingConnectionsNum</code> several times greater than the value of <code class="programcharacter">MaxHTTPSessionsNum</code>. This way, the pending connections will be put in the connection queue and scan tasks from these clients will not be lost.</p>
<p class="attentionbody">Using TLS significantly reduces the performance of Kaspersky Scan Engine. For best results, use TLS 1.3 as it is the most productive.</p>
<p class="introheading">Recommendations for raising performance of Kaspersky Scan Engine in ICAP mode</p>
<p class="bodytext">Specify the number of scan processes and scan threads that you want in the <code class="programcharacter">ScannersCount</code> parameter and the <code class="programcharacter">ThreadsCount</code> parameter, respectively.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192993"><p><a name=192993 style="display: none;">[Topic 192993]</a></p>
	<h1 id="t234541" class="heading1">Uninstalling Kaspersky Scan Engine</h1>
<p class="bodytext">This section explains how to uninstall Kaspersky Scan Engine.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#192994" target="_self">Uninstallation using the uninstaller (Linux and Windows)</a></p><p class="relateditem"><a href="#199825" target="_self">Uninstalling Kaspersky Scan Engine on Linux</a></p><p class="relateditem"><a href="#199826" target="_self">Uninstalling Kaspersky Scan Engine on Windows</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192994"><p><a name=192994 style="display: none;">[Topic 192994]</a></p>
	<h2 id="t234540" class="heading2">Uninstallation using the uninstaller (Linux and Windows)</h2>
<p class="bodytext">This section describes how to uninstall Kaspersky Scan Engine using the <code class="programcharacter">uninstall</code> (Linux) and <code class="programcharacter">uninstall.exe</code> (Windows).</p>
<p class="bodytext">Before uninstalling Kaspersky Scan Engine, make sure that files from the <code class="programcharacter">%service_dir%</code> are not used by any processes.</p>
<p class="procedureheading">To uninstall Kaspersky Scan Engine:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure you have root (administrator) privileges.</li><li class="listnumber1">Go to a directory other than <code class="programcharacter">%service_dir%</code> and run <code class="programcharacter">uninstall</code> from there, for example, from the command line.<p class="listcontinue1">If there is a Kaspersky Scan Engine instance running on the computer, the uninstaller stops it.</p>
</li><li class="listnumber1">Choose whether to delete the database that contains Kaspersky Scan Engine data.<p class="attentioncontinue1">The uninstaller skips this step if the Kaspersky Scan Engine instance you are deleting is part of a cluster containing other instances. You can delete the database when the last Kaspersky Scan Engine instance in the cluster is being deleted.</p>
</li></ol><p class="bodytext">After this the <code class="programcharacter">uninstall</code> removes the following objects:</p>
<ul class="listbullet1"><li class="listbullet1">The database that contains Kaspersky Scan Engine data (if you have chosen this)<p class="attentioncontinue1">The PostgreSQL installation will not be removed, nor will the PostgreSQL database user account that you created during installation. Only the Kaspersky Scan Engine <code class="programcharacter">kavebase</code> database will be removed. If you want to re-install Kaspersky Scan Engine, remove this database user account.</p>
<p class="listcontinue1">To remove the database user account, run the following command:</p>
<p class="listcontinue1"><code class="programcharacter">DROP ROLE &quot;%account_name%&quot;;</code></p>
<p class="listcontinue1">Here, <code class="programcharacter">%account_name%</code> is the name of the database user account that you created during installation.</p>
</li><li class="listbullet1">The directory to which Kaspersky Scan Engine is installed</li><li class="listbullet1">The directory that contains temporary files used by Kaspersky Scan Engine</li><li class="listbullet1">The Kaspersky Scan Engine service (from the list of services)</li></ul>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="199825"><p><a name=199825 style="display: none;">[Topic 199825]</a></p>
	<h2 id="t234542" class="heading2">Uninstalling Kaspersky Scan Engine on Linux </h2>
<p class="bodytext">This section explains how to uninstall Kaspersky Scan Engine on Linux operating systems.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#180699" target="_self">Manual uninstallation (Linux)</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180699"><p><a name=180699 style="display: none;">[Topic 180699]</a></p>
	<h3 id="t234443" class="heading3">Manual uninstallation (Linux)</h3>
<p class="bodytext">This section describes how to manually uninstall Kaspersky Scan Engine.</p>
<p class="introheading">Manually uninstalling Kaspersky Scan Engine 2.1 and later</p>
<p class="procedureheading">To manually uninstall Kaspersky Scan Engine 2.1 and later:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure you have root (administrator) privileges.</li><li class="listnumber1">Stop Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">If you used Kaspersky Scan Engine in ICAP mode, run this command:<p class="listcontinue2"><code class="programcharacter">service kavicapd stop</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine in HTTP mode, run this command:<p class="listcontinue2"><code class="programcharacter">service kavhttpd stop</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine GUI, run this command:<p class="listcontinue2">s<code class="programcharacter">ervice klScanEngineUI stop</code></p>
</li></ul></li><li class="listnumber1">Remove Kaspersky Scan Engine from the list of system services:<ul class="listbullet2"><li class="listbullet2">If you used Kaspersky Scan Engine in ICAP mode, run this command:<p class="listcontinue2"><code class="programcharacter">systemctl disable kavicapd</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine in HTTP mode, run this command:<p class="listcontinue2"><code class="programcharacter">systemctl disable kavhttpd</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine GUI, run this command:<p class="listcontinue2"><code class="programcharacter">systemctl disable klScanEngineUI</code></p>
</li></ul></li><li class="listnumber1">Delete symbolic links to Kaspersky Scan Engine configuration files:<ul class="listbullet2"><li class="listbullet2">If you used Kaspersky Scan Engine in ICAP mode, run this command:<p class="listcontinue2"><code class="programcharacter">rm /etc/kavicapd.xml</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine in HTTP mode, run this command:<p class="listcontinue2"><code class="programcharacter">rm /etc/kavhttpd.xml</code></p>
</li><li class="listbullet2">If you used Kaspersky Scan Engine GUI, run this command:<p class="listcontinue2"><code class="programcharacter">rm /etc/klScanEngineUI.xml</code></p>
</li></ul></li><li class="listnumber1">If you used Kaspersky Scan Engine GUI, open the PostgreSQL database, and then delete the <code class="programcharacter">kavebase</code> database and the database user.<p class="attentioncontinue1">Skip this step if you want to use the database later or if the Kaspersky Scan Engine instance you are uninstalling is part of a cluster containing other instances.</p>
<p class="listcontinue1">To delete the<code class="programcharacter">kavebase</code> database, run the following command:</p>
<p class="listcontinue1"><code class="programcharacter">DROP DATABASE kavebase;</code></p>
<p class="listcontinue1">To delete thedatabase user, run the following command:</p>
<p class="listcontinue1"><code class="programcharacter">DROP ROLE %user_name%;</code></p>
<p class="listcontinue1">where <code class="programcharacter">%user_name%</code> is the name of the database user created during Kaspersky Scan Engine installation.</p>
<p class="listcontinue1">For example, to delete the default <code class="programcharacter">scanengine</code>database user, run the following command:</p>
<p class="listcontinue1"><code class="programcharacter">DROP ROLE scanengine;</code></p>
<p class="attentioncontinue1">Only the superuser can delete a database and its user.</p>
</li><li class="listnumber1">Remove the <code class="programcharacter">/opt/kaspersky/ScanEngine</code> directory:<p class="listcontinue1"><code class="programcharacter">rm &#8211;rf /opt/kaspersky/ScanEngine</code></p>
</li><li class="listnumber1">Remove the directory that contains temporary files used by Kaspersky Scan Engine:<p class="listcontinue1"><code class="programcharacter">rm &#8211;rf %temp_dir%</code></p>
<p class="listcontinue1">Here <code class="programcharacter">%temp_dir%</code> is the temporary directory.</p>
</li></ol><p class="introheading">Manually uninstalling Kaspersky Scan Engine 2.0</p>
<p class="procedureheading">To manually uninstall Kaspersky Scan Engine 2.0:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure you have root (administrator) privileges.</li><li class="listnumber1">Stop Kaspersky Scan Engine:<ul class="listbullet2"><li class="listbullet2">If you use Kaspersky Scan Engine in ICAP mode, run this command:<p class="listcontinue2"><code class="programcharacter">/etc/init.d/kavicapd stop</code></p>
</li><li class="listbullet2">If you use Kaspersky Scan Engine in HTTP mode, run this command:<p class="listcontinue2"><code class="programcharacter">/etc/init.d/kavhttpd stop</code></p>
</li><li class="listbullet2">If you use Kaspersky Scan Engine GUI, run this command:<p class="listcontinue2"> <code class="programcharacter">/etc/init.d/klScanEngineUI stop</code></p>
</li></ul></li><li class="listnumber1">Remove the executable file and the configuration file:<ul class="listbullet2"><li class="listbullet2">If you use Kaspersky Scan Engine in ICAP mode, run this command:<p class="listcontinue2"><code class="programcharacter">rm /etc/init.d/kavicapd /etc/kavicapd.xml</code></p>
</li><li class="listbullet2">If you use Kaspersky Scan Engine in HTTP mode, run this command:<p class="listcontinue2"><code class="programcharacter">rm /etc/init.d/kavhttpd /etc/kavhttpd.xml</code></p>
</li><li class="listbullet2">If you use Kaspersky Scan Engine GUI, run this command:<p class="listcontinue2"><code class="programcharacter">rm /etc/init.d/klScanEngineUI /etc/klScanEngineUI.xml</code></p>
</li></ul></li><li class="listnumber1">If you used Kaspersky Scan Engine GUI, open the PostgreSQL database and  delete the <code class="programcharacter">kavebase</code> database and the database user.<p class="attentioncontinue1">Skip this step if you want to use the database later or if the Kaspersky Scan Engine instance you are uninstalling is part of a cluster containing other instances.</p>
<p class="listcontinue1">To delete the<code class="programcharacter">kavebase</code> database, run the following command:</p>
<p class="listcontinue1"><code class="programcharacter">DROP DATABASE kavebase;</code></p>
<p class="listcontinue1">To remove the<code class="programcharacter">scanengine</code>database user, run the following command:</p>
<p class="listcontinue1"><code class="programcharacter">DROP ROLE scanengine;</code></p>
</li><li class="listnumber1">Remove the <code class="programcharacter">/opt/kaspersky/ScanEngine</code> directory:<p class="listcontinue1"><code class="programcharacter">rm &#8211;rf /opt/kaspersky/ScanEngine</code></p>
</li><li class="listnumber1">Remove the directory that contains temporary files used by Kaspersky Scan Engine:<p class="listcontinue1"><code class="programcharacter">rm &#8211;rf %temp_dir%</code></p>
<p class="listcontinue1">Here <code class="programcharacter">%temp_dir%</code> is the temporary directory.</p>
</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="199826"><p><a name=199826 style="display: none;">[Topic 199826]</a></p>
	<h2 id="t234543" class="heading2">Uninstalling Kaspersky Scan Engine on Windows</h2>
<p class="bodytext">This section explains how to uninstall Kaspersky Scan Engine on Windows operating systems.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td>
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#184741" target="_self">Manual uninstallation (Windows)</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="184741"><p><a name=184741 style="display: none;">[Topic 184741]</a></p>
	<h3 id="t234444" class="heading3">Manual uninstallation (Windows)</h3>
<p class="bodytext">This section describes how to manually uninstall Kaspersky Scan Engine.</p>
<p class="procedureheading">To manually uninstall Kaspersky Scan Engine:</p>
<ol class="listnumber1"><li class="listnumber1">Make sure that you have administrator privileges.</li><li class="listnumber1">Stop Kaspersky Scan Engine, run the following command:<p class="listcontinue1"><code class="programcharacter">sc stop &quot;Kaspersky ScanEngine&quot;</code></p>
</li><li class="listnumber1">If you use Kaspersky Scan Engine GUI, run the following command:<p class="listcontinue1"><code class="programcharacter">sc stop &quot;Kaspersky ScanEngine UI&quot;</code></p>
</li><li class="listnumber1">If you added Kaspersky Scan Engine to the list of Windows services, delete it by running the following command:<p class="listcontinue1"><code class="programcharacter">sc delete &quot;Kaspersky ScanEngine&quot;</code></p>
</li><li class="listnumber1">If you used Kaspersky Scan Engine GUI and added it to the list of Windows services, delete it by running the following command:<p class="listcontinue1"><code class="programcharacter">sc delete &quot;Kaspersky ScanEngine UI&quot;</code></p>
</li><li class="listnumber1">If you use Kaspersky Scan Engine GUI, open the PostgreSQL database and execute the following query:<p class="listcontinue1"><code class="programcharacter">DROP DATABASE kavebase;</code></p>
<p class="listcontinue1">To remove the<code class="programcharacter">scanengine</code>database user, run the following command:</p>
<p class="listcontinue1"><code class="programcharacter">DROP ROLE scanengine;</code></p>
</li><li class="listnumber1">Remove the <code class="programcharacter">%service_dir%</code> directory. You can do this either by using Windows Explorer, or by running the following command:<p class="listcontinue1"><code class="programcharacter">del /F %service_dir%</code></p>
</li><li class="listnumber1">Remove the directory that contains temporary files used by Kaspersky Scan Engine. You can do this either by using Windows Explorer, or by running the following command:<p class="listcontinue1"><code class="programcharacter">del /F %temp_dir%</code></p>
<p class="listcontinue1">Here <code class="programcharacter">%temp_dir%</code> is the temporary directory.</p>
</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179831"><p><a name=179831 style="display: none;">[Topic 179831]</a></p>
	<h1 id="t234586" class="heading1">Using the password utility</h1>
<p class="bodytext">This section describes how to use the kl_access_util utility. With this utility, you can do the following:</p>
<ul class="listbullet1"><li class="listbullet1">Reset the password for the <code class="programcharacter">admin</code> account. After the reset, you can change the password in the <a id="h180236" class="englishcrossreferencetemplate" href="#179705" target="_self">Kaspersky Scan Engine GUI</a>.</li><li class="listbullet1">Set an API token used for authentication.</li></ul><p class="bodytext">The kl_access_util utility is run from the command line as follows:</p>
<p class="program">./kl_access_util [-r] | [<code class="programcharacter">-n</code> &lt;token-name&gt; <code class="programcharacter">-t &lt;token-value&gt;</code>] | [-v] | [-h]</p>
<p class="bodytext">The table below describes the kl_access_util options.</p>
<p class="tablename">kl_access_util options</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="624" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="282"><p class="tableheading">Option</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="342"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="282"><p class="tablebodytext"><code class="programcharacter">-r</code></p>
<p class="tablebodytext">or</p>
<p class="tablebodytext"><code class="programcharacter">--reset_default_user</code></p>
</td>
<td style="border:1px solid #010101;" width="342"><p class="tablebodytext">Sets the password for the <code class="programcharacter">admin</code> account to its default value <code class="programcharacter">KAVAdmin!1</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="282"><p class="tablebodytext"><code class="programcharacter">-n &lt;token-name&gt; </code></p>
<p class="tablebodytext">or</p>
<p class="tablebodytext"><code class="programcharacter">--access-token-name &lt;token-name&gt; </code></p>
</td>
<td style="border:1px solid #010101;" width="342"><p class="tablebodytext">Specifies the name of an API token used for authentication.</p>
<p class="tablebodytext">If the token with the specified name already exists, Kaspersky Scan Engine updates this token (replaces the old value with the new one specified in <code class="programcharacter">-t</code> or <code class="programcharacter">--access-token</code>).</p>
<p class="tablebodytext">If the token with the specified name does not exist, Kaspersky Scan Engine creates a new token with the given name and value.</p>
<p class="tablebodytext">Combine this option only with <code class="programcharacter">-t</code> or <code class="programcharacter">--access-token</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="282"><p class="tablebodytext"><code class="programcharacter">-t &lt;token-value&gt;</code></p>
<p class="tablebodytext">or</p>
<p class="tablebodytext"><code class="programcharacter">--access-token &lt;token-value&gt;</code></p>
</td>
<td style="border:1px solid #010101;" width="342"><p class="tablebodytext">Specifies the value of an API token used for authentication. The value is assigned to the token with the name specified in <code class="programcharacter">-n</code> or <code class="programcharacter">--access-token-name</code>. It can be either an existing token that the utility updates or a new token (see the description of the <code class="programcharacter">-n</code> option).</p>
<p class="bodytext">The value must be unique and contain from 4 to 100 ASCII characters. There must be at least one uppercase Latin letter, one lowercase Latin letter, one digit, and one of the following special characters: <code class="programcharacter">-._~+/).</code></p>
<p class="tablebodytext">When creating or updating a token, the utility encrypts the token value.</p>
<p class="tablebodytext">Combine this option only with <code class="programcharacter">-n</code> or <code class="programcharacter">--access-token-name</code>.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="282"><p class="tablebodytext"><code class="programcharacter">-v</code></p>
<p class="tablebodytext">or</p>
<p class="tablebodytext"><code class="programcharacter">--version</code></p>
</td>
<td style="border:1px solid #010101;" width="342"><p class="tablebodytext">Prints the version of Kaspersky Scan Engine to the command line.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="282"><p class="tablebodytext"><code class="programcharacter">-h</code></p>
<p class="tablebodytext">or</p>
<p class="tablebodytext"><code class="programcharacter">--help</code></p>
</td>
<td style="border:1px solid #010101;" width="342"><p class="tablebodytext">Prints the Help information about the kl_access_util utility to the command line.</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="181814"><p><a name=181814 style="display: none;">[Topic 181814]</a></p>
	<h1 id="t234582" class="heading1">Using the encrypting utility</h1>
<p class="bodytext">The kav_encrypt utility allows you to encrypt the user names and passwords stored in kavhttpd.xml, kavicapd.xml, and klScanEngineUI.xml.</p>
<p class="bodytext">The utility is run from the command line as follows:</p>
<p class="program">./kav_encrypt [-m <code class="programcharacter">&lt;httpd | icap&gt;</code> -p &lt;user_name:password&gt;] | [-d &lt;user_name:password&gt;] | [-h]</p>
<p class="bodytext">The table below describes the kav_encrypt options.</p>
<p class="tablename">The kav_encrypt options</p>
<table class="tableintopic" width="624" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="234"><p class="tableheading">Option</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="390"><p class="tableheading">Description</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">-m &lt;httpd | icap&gt;</code></p>
<p class="tablebodytext"><code class="programcharacter">--mode &lt;httpd | icap&gt;</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="bodytext">Specifies the working mode of Kaspersky Scan Engine.</p>
<p class="bodytext">Possible values:</p>
<ul class="tablelistbullet"><li class="tablelistbullet"><code class="programcharacter">httpd</code><p class="tablelistcontinue">HTTP mode </p>
</li><li class="tablelistbullet"><code class="programcharacter">icap</code><p class="tablelistcontinue">ICAP mode</p>
<p class="tablelistcontinue">For Linux systems only.</p>
</li></ul></td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">-p &lt;user_name:password&gt;</code></p>
<p class="tablebodytext"><code class="programcharacter">--proxy &lt;user_name:password&gt;</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="bodytext">Specifies the user name and password of the proxy server that Kaspersky Scan Engine uses to gain access to the Internet.</p>
<p class="bodytext">This option must be used together with the <code class="programcharacter">-m</code> option. </p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">-d &lt;user_name:password&gt;</code></p>
<p class="tablebodytext"><code class="programcharacter">--database &lt;user_name:password&gt;</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Specifies the user name and password of the user that owns the kavebase database.</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="234"><p class="tablebodytext"><code class="programcharacter">-h</code></p>
<p class="tablebodytext"><code class="programcharacter">--help</code></p>
</td>
<td style="border:1px solid #010101;" width="390"><p class="tablebodytext">Prints the Help information about the kav_encrypt utility to the command line.</p>
</td>
</tr>

</table>
<p class="tablebodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="209025"><p><a name=209025 style="display: none;">[Topic 209025]</a></p>
	<h1 id="t234585" class="heading1">Using the integrity check tool</h1>
<p class="bodytext">Kaspersky Scan Engine contains a multitude of various binary modules in the form of dynamic-link libraries, executable files, configuration files, and interface files. A hacker can replace one or more application executable modules or files with other files containing malicious code. To prevent the replacement of modules and files, Kaspersky Scan Engine can check the integrity of application components.</p>
<p class="bodytext">The application checks modules and files for the presence of unauthorized changes or corruption. If an application module or file has an incorrect checksum, it is considered to be corrupted.</p>
<p class="bodytext">The application also checks the integrity of the <em class="emphasischaracter">manifest file</em> containing a list of application files whose integrity is critical for the correct operation of application components.</p>
<p class="bodytext">Starting from Kaspersky Scan Engine version 2.1, KAV SDK objects are delivered as a separate package. For this reason, there are two manifest files in Kaspersky Scan Engine:</p>
<ul class="listbullet1"><li class="listbullet1">integrity_check.xml is used to check the integrity of the Kaspersky Scan Engine files.</li><li class="listbullet1">integrity_check_sdk.xml is used to check the integrity of the KAV SDK files. This file is delivered in the KAV SDK package.</li></ul><p class="bodytext">The integrity of the application components is checked by using the integrity check tool located in the directory %service_dir%, where %service_dir% is the directory of Kaspersky Scan Engine. </p>
<p class="bodytext">The manifest files integrity_check.xml and integrity_check_sdk.xml (starting from Kaspersky Scan Engine version 2.1) are protected by the cryptographic signature of Kaspersky. The manifest files are located in the %service_dir% directory.</p>
<p class="attentionbody">Root user account privileges are required to run the integrity check tool.</p>
<p class="procedureheading">To check the integrity of application components, run the following command:</p>
<p class="program2"><code class="programcharacter">integrity_checker [options]</code></p>
<p class="bodytextindent">By default, the tool uses the integrity_check.xml file located in the directory %service_dir%.</p>
<p class="procedureheading">To check the integrity of application components using the manifest file located in a directory other than the default one, run the following command:</p>
<p class="program2"><code class="programcharacter">integrity_checker [options] %path%</code></p>
<p class="bodytextindent">where <code class="programcharacter">%path%</code> is the path to the manifest file.</p>
<p class="bodytext">You can run the integrity check tool with the following optional settings:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">--help</code>&#8212;display Help for tool settings.</li><li class="listbullet1"><code class="programcharacter">--version</code>&#8212;display tool version.</li><li class="listbullet1"><code class="programcharacter">--verbose</code>&#8212;expanded output of performed actions and results. If you specify this setting, the output will contain both successful and unsuccessful results of checking the objects listed in the manifest file. If you do not specify this setting, only objects that did not pass the check will be provided.</li><li class="listbullet1"><code class="programcharacter">--trace &lt;filename&gt;</code>, where <code class="programcharacter">&lt;filename&gt;</code> is the name of the file used for logging events that occur during a scan. The events will be logged at the DEBUG level.</li></ul><p class="bodytext">The result of checking each manifest file is displayed next to the name of the manifest file in the following format:</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">SUCCEEDED</code>&#8212;integrity of the files is confirmed (return code <code class="programcharacter">0</code>).</li><li class="listbullet1"><code class="programcharacter">FAILED</code>&#8212;integrity of the files is not confirmed (return code is not <code class="programcharacter">0</code>).</li></ul><p class="warningbody">If you build executable files for <a id="h210511" class="englishcrossreferencetemplate" href="#179888" target="_self">HTTP mode</a> or <a id="h210512" class="englishcrossreferencetemplate" href="#179905" target="_self">ICAP mode</a> from the source code, the integrity check tool will always return <code class="programcharacter">FAILED</code> when checking %service_dir%/bin/kavhttpd and %service_dir%/bin/kavhttp_client  (HTTP mode), or  %service_dir%/bin/kavicapd (ICAP mode).</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179686"><p><a name=179686 style="display: none;">[Topic 179686]</a></p>
	<h1 id="t234426" class="heading1">Licensing</h1>
<p class="bodytext">This section describes how to activate Kaspersky Scan Engine.</p>
<p class="introheading">Licensing modes</p>
<p class="bodytext">Kaspersky Scan Engine supports the following licensing modes:</p>
<ul class="listbullet1"><li class="listbullet1">Offline licensing mode<p class="listcontinue1">In this mode, the Kaspersky Scan Engine licensing system uses a key file to activate Kaspersky Scan Engine.</p>
<p class="listcontinue1">You do not have to be connected to the Internet to use this mode. However, you have to renew the key file regularly to avoid <a id="h179861" class="englishcrossreferencetemplate" href="#179860" target="_self">licensing limitations</a>.</p>
</li><li class="listbullet1">Online licensing mode<p class="listcontinue1">In this mode, the Kaspersky Scan Engine licensing system uses an activation code to activate Kaspersky Scan Engine.</p>
<p class="listcontinue1">You must have a stable connection to the Internet to use this mode. When necessary, Kaspersky Scan Engine will connect to the Kaspersky servers and renew the activation code automatically. </p>
</li></ul><table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#179852" target="_self">Activating Kaspersky Scan Engine in offline licensing mode</a></p><p class="relateditem"><a href="#179855" target="_self">Activating Kaspersky Scan Engine in online licensing mode</a></p><p class="relateditem"><a href="#179860" target="_self">Licensing limitations</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179852"><p><a name=179852 style="display: none;">[Topic 179852]</a></p>
	<h2 id="t234272" class="heading2">Activating Kaspersky Scan Engine in offline licensing mode</h2>
<p class="bodytext">This section describes how to activate Kaspersky Scan Engine in offline licensing mode after Kaspersky Scan Engine is installed.</p>
<p class="bodytext">You can activate Kaspersky Scan Engine on the <a id="h180245" class="englishcrossreferencetemplate" href="#179702" target="_self">license settings</a> page of the Kaspersky Scan Engine GUI.</p>
<p class="bodytext">To activate Kaspersky Scan Engine in offline licensing mode, you need a key file. The key file is provided to you by your Technical Account Manager (TAM).</p>
<p class="procedureheading">To activate Kaspersky Scan Engine in offline licensing mode:</p>
<ol class="listnumber1"><li class="listnumber1">Open the configuration file that corresponds to the mode you chose:<ul class="listbullet2"><li class="listbullet2">If you are using Kaspersky Scan Engine in HTTP mode, open the <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">kavhttpd.xml configuration file</a>.</li><li class="listbullet2">If you are using Kaspersky Scan Engine in ICAP mode, open the <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">kavicapd.xml configuration file</a>.</li></ul></li><li class="listnumber1">Do one of the following:<ul class="listbullet2"><li class="listbullet2">Copy the key file to the directory specified in the <code class="programcharacter">LicensePath</code> element of the configuration file.<p class="listcontinue2">For a list of the other directories that Kaspersky Scan Engine automatically searches for the key file, see the description of the <code class="programcharacter">LicensePath</code> element:</p>
<ul class="listbullet3"><li class="listbullet3">In kavhttpd.xml (HTTP mode): DirectorySettings &gt; <a id="h201074" class="englishcrossreferencetemplate" href="#201044" target="_self">LicensePath</a>.</li><li class="listbullet3">In kavicapd.xml (ICAP mode): SDKSettings &gt; <a id="h201169" class="englishcrossreferencetemplate" href="#201118" target="_self">LicensePath</a>.</li></ul></li><li class="listbullet2">If you want to store the key file in a different directory, specify the path to this directory in the <code class="programcharacter">LicensePath</code> element of the configuration file and copy the appinfo.kli file there.The appinfo.kli file is located in the /bin directory of the distribution kit.</li></ul></li><li class="listnumber1">In the <code class="programcharacter">LicensingMode</code> element of the configuration file, specify <code class="programcharacter">1</code>.</li><li class="listnumber1">Save the configuration file.</li><li class="listnumber1">Restart the Kaspersky Scan Engine service:<ul class="listbullet2"><li class="listbullet2">In HTTP mode, <a id="h193043" class="englishcrossreferencetemplate" href="#192981" target="_self">restart the kavhttpd service</a>.</li><li class="listbullet2">In ICAP mode, <a id="h193044" class="englishcrossreferencetemplate" href="#192990" target="_self">restart the kavicapd service</a>.</li></ul></li></ol><p class="bodytext">If the activation is successful, Kaspersky Scan Engine will start normally and you will be able to update the anti-virus database. Otherwise, Kaspersky Scan Engine will return an error to the command line.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179855"><p><a name=179855 style="display: none;">[Topic 179855]</a></p>
	<h2 id="t234273" class="heading2">Activating Kaspersky Scan Engine in online licensing mode</h2>
<p class="bodytext">This section describes how to activate Kaspersky Scan Engine in online licensing mode after Kaspersky Scan Engine is installed.</p>
<p class="bodytext">You can activate Kaspersky Scan Engine on the <a id="h180245" class="englishcrossreferencetemplate" href="#179702" target="_self">license settings</a> page of the Kaspersky Scan Engine GUI.</p>
<p class="bodytext">To activate Kaspersky Scan Engine in online licensing mode, you need an activation code. The activation code is provided to you by your technical account manager (TAM).</p>
<p class="warningbody">Your computer must be connected to the Internet to activate Kaspersky Scan Engine in online licensing mode. When you use online licensing mode, Kaspersky Scan Engine transfers to Kaspersky information about the installed copy of Kaspersky Scan Engine and activation code. See also the full list of data that is <a id="h180251" class="englishcrossreferencetemplate" href="#180002" target="_self">transferred to Kaspersky in online licensing mode</a>.</p>
<p class="procedureheading">To activate Kaspersky Scan Engine in online licensing mode:</p>
<ol class="listnumber1"><li class="listnumber1">Create a text file named &quot;license&quot;.</li><li class="listnumber1">Copy your activation code to the newly created file.<p class="attentioncontinue1">Make sure that the format of the activation code is correct. The correct format is XXXXX-XXXXX-XXXXX-XXXXX, where X is a number (0-9) or an uppercase Latin letter (A-Z), excluding &quot;I&quot; and &quot;O&quot;. </p>
<p class="listcontinue1">The file must not contain any other characters.</p>
</li><li class="listnumber1">Save the file. </li><li class="listnumber1">Open the configuration file that corresponds to the your working mode:<ul class="listbullet2"><li class="listbullet2">If you are using Kaspersky Scan Engine in HTTP mode, open the <a id="h179927" class="englishcrossreferencetemplate" href="#184799" target="_self">kavhttpd.xml configuration file</a>.</li><li class="listbullet2">If you are using Kaspersky Scan Engine in ICAP mode, open the <a id="h180154" class="englishcrossreferencetemplate" href="#192989" target="_self">kavicapd.xml configuration file</a>.</li></ul></li><li class="listnumber1">Do one of the following:<ul class="listbullet2"><li class="listbullet2">Copy the license file to the directory specified in the <code class="programcharacter">LicensePath</code> element of the configuration file.<p class="listcontinue2">For a list of the other directories that Kaspersky Scan Engine automatically searches for the license file, see the description of the <code class="programcharacter">LicensePath</code> element:</p>
<ul class="listbullet3"><li class="listbullet3">In kavhttpd.xml (HTTP mode): DirectorySettings &gt; <a id="h201074" class="englishcrossreferencetemplate" href="#201044" target="_self">LicensePath</a>.</li><li class="listbullet3">In kavicapd.xml (ICAP mode): SDKSettings &gt; <a id="h201169" class="englishcrossreferencetemplate" href="#201118" target="_self">LicensePath</a>.</li></ul></li><li class="listbullet2">If you want to store the license file in a different directory, specify the path to this directory in the <code class="programcharacter">LicensePath</code> element and copy the appinfo.kli file to that directory. The appinfo.kli file is located in the /bin directory of the distribution kit.</li></ul></li><li class="listnumber1">In the <code class="programcharacter">LicensingMode</code> element of the configuration file, specify <code class="programcharacter">2</code>.</li><li class="listnumber1">Save the configuration file.</li><li class="listnumber1">Restart the Kaspersky Scan Engine service:<ul class="listbullet2"><li class="listbullet2">In HTTP mode, <a id="h193043" class="englishcrossreferencetemplate" href="#192981" target="_self">restart the kavhttpd service</a>.</li><li class="listbullet2">In ICAP mode, <a id="h193044" class="englishcrossreferencetemplate" href="#192990" target="_self">restart the kavicapd service</a>.</li></ul></li></ol><p class="bodytext">If the activation is successful, Kaspersky Scan Engine will start normally and you will be able to update the anti-virus database. Otherwise Kaspersky Scan Engine will return an error to the command line.</p>
<p class="bodytext">After successful activation in online licensing mode, the licensing information is synchronized with Kaspersky servers. This synchronization can be used, for example, to change the expiration date for the activation code (thus removing the need for a new online activation) or to change the available functionality.</p>
<p class="bodytext">This is done automatically once per day. Maximum time without Internet connection is 15 to 30 days.</p>
<p class="warningbody">In order to synchronize licensing information with Kaspersky servers, your computer must be connected to the Internet.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="179860"><p><a name=179860 style="display: none;">[Topic 179860]</a></p>
	<h2 id="t234427" class="heading2">Licensing limitations</h2>
<p class="bodytext">The license lifecycle in the offline and online licensing modes is the same. Kaspersky Scan Engine can be used until a certain date, which is called the <em class="emphasischaracter">expiration date</em>. Kaspersky Scan Engine uses a key file or an activation code to determine the expiration date.</p>
<p class="bodytext">If the expiration date has passed, the key file or the activation code expires and you can only use Kaspersky Scan Engine with licensing limitations.</p>
<p class="introheading">Licensing limitations</p>
<p class="bodytext">Kaspersky Scan Engine can have the following licensing limitations:</p>
<ul class="listbullet1"><li class="listbullet1">If the time received from KSN is at least one day later than the expiration date of your key file or activation code, Kaspersky Scan Engine will work but you will not be able to use File and URL Reputation Checking. Make sure <span class="guicharacter">Enable reputation checking</span> and <span class="guicharacter">Enable Phishing Protection</span> are turned off (see <span class="guicharacter">Settings</span> -&gt; <span class="guicharacter">Scanning</span> in the Kaspersky Scan Engine GUI), otherwise you will not be able to start the kavhttpd and kavicapd services.</li><li class="listbullet1">If the release date of the anti-virus database is later than the expiration date of your key file or activation code, Kaspersky Scan Engine does not update the anti-virus database.</li></ul><p class="introheading">Removing licensing limitations in online licensing mode</p>
<p class="bodytext">To remove the licensing limitations, you can do the following:</p>
<ul class="listbullet1"><li class="listbullet1">If your copy of Kaspersky Scan Engine was not connected to the Internet for the last 15 days or more, the licensing limitations are most likely caused by outdated licensing information. To remove licensing limitations, allow Kaspersky Scan Engine to connect to the Internet.<p class="attentioncontinue1">To prevent this problem, make sure that Kaspersky Scan Engine always has access to the Internet.</p>
</li><li class="listbullet1">If your activation code has expired, obtain a new activation code and activate Kaspersky Scan Engine with it. To activate Kaspersky Scan Engine with a new code, your copy of Kaspersky Scan Engine must be connected to the Internet.</li><li class="listbullet1">If other options are not possible, use an earlier version of the anti-virus database to initialize Kaspersky Scan Engine. This method does not remove limitations placed on File and URL Reputation Checking functionality.</li></ul><p class="introheading">Removing licensing limitations in offline licensing mode</p>
<p class="bodytext">To remove the licensing limitations, obtain a new key file and activate Kaspersky Scan Engine with it.</p>
<p class="bodytext"></p>
<p class="introheading"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="182982"><p><a name=182982 style="display: none;">[Topic 182982]</a></p>
	<h1 id="t234410" class="heading1">Kaspersky Scan Engine GUI and SSL certificates</h1>
<p class="bodytext">The SSL certificate and a private key that are generated during the installation of Kaspersky Scan Engine allow you to use Kaspersky Scan Engine GUI via HTTPS. The certificate is self-signed, so the browser you use informs you about an untrusted connection. We recommend that you <a id="h182985" class="englishcrossreferencetemplate" href="#182983" target="_self">use a certificate that is trusted in your infrastructure</a>. However if you cannot use a trusted certificate, you can <a id="h182986" class="englishcrossreferencetemplate" href="#182984" target="_self">add the self-signed certificate as trusted</a> to your browser or operating system.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#182983" target="_self">Generating SSL certificates for Kaspersky Scan Engine GUI</a></p><p class="relateditem"><a href="#182984" target="_self">Adding the self-signed certificate as trusted to a browser (Linux)</a></p><p class="relateditem"><a href="#186925" target="_self">Adding the self-signed certificate as trusted to a browser (Windows)</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="182983"><p><a name=182983 style="display: none;">[Topic 182983]</a></p>
	<h2 id="t234367" class="heading2">Generating SSL certificates for Kaspersky Scan Engine GUI</h2>
<p class="bodytext">Kaspersky Scan Engine GUI uses an SSL certificate for HTTPS connections. By default, Kaspersky Scan Engine GUI uses a self-signed certificate and a private key that are generated during <a id="h193042" class="englishcrossreferencetemplate" href="#192974" target="_self">installation of Kaspersky Scan Engine</a>. The generated certificate is valid for two years.</p>
<p class="bodytext">We recommend that you generate a certificate that will be trusted in your infrastructure and configure Kaspersky Scan Engine GUI to use this certificate instead of the self-signed certificate.</p>
<p class="attentionbody">Before making changes, create a backup copy of the existing private key, certificate, and Kaspersky Scan Engine configuration file.</p>
<p class="procedureheading">To generate a trusted certificate for Kaspersky Scan Engine GUI:</p>
<ol class="listnumber1"><li class="listnumber1">Create a private key and a trusted certificate:<ol class="listalpha2"><li class="listalpha2">Create a new private and public key pair.</li><li class="listalpha2">Use the public key to generate an SSL Certificate Signing Request (CSR).</li><li class="listalpha2">Sign the CSR by using the trusted certificate authority (CA).<p class="listcontinue2">This creates a trusted certificate for the private key.</p>
</li></ol></li><li class="listnumber1">Convert the private key and the trusted certificate to PEM format.</li><li class="listnumber1">Copy both the private key and the certificate to the <code class="programcharacter">%service_dir%/httpsrv</code> directory.<p class="attentioncontinue1">You must configure access to the private key file for ScanEngine GUI so that only the root user and the user account under which the service is running can have the read permission.</p>
</li><li class="listnumber1">Edit the <code class="programcharacter">Settings &gt; ServerSettings &gt; SSLCertificatePath</code> and <code class="programcharacter">Settings &gt; ServerSettings &gt; SSLPrivatePath</code> elements of the <a id="h183008" class="englishcrossreferencetemplate" href="#179825" target="_self">Kaspersky Scan Engine configuration file</a> if necessary so that they will contain the paths to the certificate and private key respectively.<p class="listcontinue1">Save the Kaspersky Scan Engine configuration file.</p>
</li><li class="listnumber1">Restart Kaspersky Scan Engine.<p class="spacer"></p>
</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="182984"><p><a name=182984 style="display: none;">[Topic 182984]</a></p>
	<h2 id="t234274" class="heading2">Adding the self-signed certificate as trusted to a browser (Linux)</h2>
<p class="bodytext">The procedures in this section show you how to add the self-signed certificates generated during Kaspersky Scan Engine installation to the trusted storage. This will remove the security warnings generated by browsers.</p>
<p class="bodytext">The information in this section is applicable to the situation when the user gains access to Kaspersky Scan Engine GUI from the same computer on which Kaspersky Scan Engine GUI runs. If the <code class="programcharacter">Settings &gt; ServerSettings &gt; ConnectionString</code> element of the <a id="h183008" class="englishcrossreferencetemplate" href="#179825" target="_self">Kaspersky Scan Engine configuration file</a> refers to an external interface, the Kaspersky Scan Engine GUI website will not be considered trusted, because the self-signed certificate can be used only with <code class="programcharacter">https://127.0.0.1</code> and <code class="programcharacter">https://localhost</code> addresses.</p>
<p class="bodytext">To avoid potential security risks, it is recommended to use a<a id="h182985" class="englishcrossreferencetemplate" href="#182983" target="_self"> trusted certificate signed by a certificate authority (CA)</a>.</p>
<p class="introheading">Causing a self-signed certificate to be trusted by a browser (Kaspersky Scan Engine GUI opens in Mozilla Firefox)</p>
<p class="bodytext">You add Kaspersky Scan Engine GUI to the list of Mozilla Firefox trusted sites so that the browser will not display warnings about the certificate.</p>
<p class="introheading">Causing a self-signed certificate to be trusted by a browser (Kaspersky Scan Engine GUI opens in a browser for Linux)</p>
<p class="bodytext">Procedures for using a browser to import a certificate as trusted (on Linux systems) vary depending on the browser and Linux distribution used. But the procedures share common steps: to open the browser settings form and use the form to import the certificate to a store.</p>
<p class="procedureheading">To manually cause a self-signed certificate to be trusted by a browser on a Linux system:</p>
<ol class="listnumber1"><li class="listnumber1">Create a <code class="programcharacter">/usr/local/share/ca-certificates/</code> directory if it does not exist on your computer:<p class="listcontinue1"><code class="programcharacter">mkdir /usr/local/share/ca-certificates/</code></p>
</li><li class="listnumber1">Copy your root certificate (.crt file) to the created directory:<p class="listcontinue1"><code class="programcharacter">cp &lt;full_path_to_the_certificate&gt; /usr/local/share/ca-certificates/</code></p>
</li><li class="listnumber1">Update the certificates:<p class="listcontinue1"><code class="programcharacter">sudo update-ca-certificates</code></p>
<p class="attentioncontinue1">If you do not have the ca-certificates package, install it with your package manager.</p>
</li></ol><p class="introheading">Removing a certificate from the list of trusted ones</p>
<p class="bodytext">After you have reconfigured or uninstalled Kaspersky Scan Engine, old certificates are no longer used by Kaspersky Scan Engine GUI. You can remove them from the list of trusted certificates.</p>
<p class="bodytext">On a Linux system, the removal procedure is performed in a way that is similar to the addition of a certificate: open the list of the trusted certificates and remove those that you do not need.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="186925"><p><a name=186925 style="display: none;">[Topic 186925]</a></p>
	<h2 id="t234275" class="heading2">Adding the self-signed certificate as trusted to a browser (Windows)</h2>
<p class="bodytext">The procedures in this section show you how to add the self-signed certificates generated during Kaspersky Scan Engine installation to the trusted storage. This will remove the security warnings generated by browsers.</p>
<p class="bodytext">The information in this section is applicable to the situation when the user gains access to Kaspersky Scan Engine GUI from the same computer on which Kaspersky Scan Engine GUI runs. If the <code class="programcharacter">Settings &gt; ServerSettings &gt; ConnectionString</code> element of the <a id="h183008" class="englishcrossreferencetemplate" href="#179825" target="_self">Kaspersky Scan Engine configuration file</a> refers to an external interface, the Kaspersky Scan Engine GUI website will not be considered trusted, because the self-signed certificate can be used only with <code class="programcharacter">https://127.0.0.1</code> and <code class="programcharacter">https://localhost</code> addresses.</p>
<p class="bodytext">To avoid potential security risks, it is recommended to use a <a id="h182985" class="englishcrossreferencetemplate" href="#182983" target="_self">trusted certificate signed by a certificate authority (CA)</a>.</p>
<p class="introheading">Causing a self-signed certificate to be trusted by a browser (Kaspersky Scan Engine GUI is opened in Internet Explorer)</p>
<p class="bodytext">Gaining the browser's trust requires that you perform, in sequence, the following three procedures:</p>
<p class="bodytext"><span class="boldcharacter">Save the certificate to a local file</span></p>
<p class="procedureheading">To save the certificate to a local file:</p>
<ol class="listnumber1"><li class="listnumber1">Open the <code class="programcharacter">https://127.0.0.1</code> or <code class="programcharacter">https://localhost</code> address in Internet Explorer.<p class="listcontinue1">The browser informs you of a problem with the security certificate of the website.</p>
<p class="picture"><img id="f174164" src="adding_trusted_1.png" class="linkedpngfiletemplate" alt="There is a problem with this website's security certificate." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Certificate error message</p>
</li><li class="listnumber1">Select the <span class="boldcharacter">Continue to this website (not recommended)</span> link.<p class="listcontinue1">The <span class="boldcharacter">Certificate Error</span> message appears in the address bar.</p>
</li><li class="listnumber1">Click <span class="boldcharacter">Certificate Error</span>.<p class="listcontinue1">The <span class="boldcharacter">Untrusted Certificate</span> window opens.</p>
<p class="picture"><img id="f174165" src="adding_trusted_2.png" class="linkedpngfiletemplate" alt="Untrusted Certificate. About certificate errors. View certificates." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename"><span class="boldcharacter">Untrusted Certificate</span> window</p>
</li><li class="listnumber1">Select the <span class="boldcharacter">View certificates</span> link.<p class="listcontinue1">The <span class="boldcharacter">Certificate</span> window opens with information about the Kaspersky Scan Engine certificate.</p>
<p class="picture"><img id="f174166" src="adding_trusted_3.png" class="linkedpngfiletemplate" alt="&quot;General&quot; tab. Certificate information." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename"><span class="boldcharacter">Certificate</span> window</p>
</li><li class="listnumber1">Select the <span class="boldcharacter">Details</span> tab and click <span class="boldcharacter">Copy to File</span> to create a local copy of the certificate.<p class="listcontinue1">The Certificate Export Wizard starts.</p>
<p class="picture"><img id="f174173" src="adding_trusted_10.png" class="linkedpngfiletemplate" alt="Welcome window." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Certificate Export Wizard</p>
</li><li class="listnumber1">Follow the Wizard instructions.<p class="listcontinue1">Use the default Wizard settings during the certificate export.</p>
</li></ol><p class="bodytext"><span class="boldcharacter">Start the certificate import process</span></p>
<p class="procedureheading">To start the certificate import process through Microsoft Management Console (MMC):</p>
<ol class="listnumber1"><li class="listnumber1">From the <span class="boldcharacter">Search</span> box, navigate to the <span class="boldcharacter">Run</span> box and enter <em class="emphasischaracter">mmc</em>.<p class="listcontinue1">You can now run MMC as Administrator.</p>
<p class="picture"><img id="f180513" src="run_mmc.png" class="linkedpngfiletemplate" alt="&quot;Run&quot; window. Open: mmc." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Running the MMC</p>
</li><li class="listnumber1">In the MMC-based console that opens, select <span class="boldcharacter">File</span> &gt; <span class="boldcharacter">Add/Remove Snap-in</span>.<p class="picture"><img id="f180514" src="add_remove_snap_in.png" class="linkedpngfiletemplate" alt="MMC-based console. &quot;File&quot; menu." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Selecting <span class="boldcharacter">Add/Remove Snap-in</span></p>
<p class="listcontinue1">The <span class="boldcharacter">Add or Remove Snap-ins</span> window opens.</p>
</li><li class="listnumber1">In the <span class="boldcharacter">Available snap-ins</span> list, select <span class="boldcharacter">Certificates</span> and click <span class="boldcharacter">Add</span>.<p class="picture"><img id="f180516" src="add_certificates.png" class="linkedpngfiletemplate" alt="&quot;Add or Remove Snap-ins&quot; window. Available snap-ins on the left, Selected snap-ins on the right." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Adding the <span class="boldcharacter">Certificates</span> snap-in</p>
<p class="listcontinue1">The <span class="boldcharacter">Certificates snap-in</span> window opens.</p>
</li><li class="listnumber1">Select <span class="boldcharacter">Computer account</span> and click <span class="boldcharacter">Next</span>.<p class="picture"><img id="f180517" src="select_computer_account.png" class="linkedpngfiletemplate" alt="&quot;Certificates snap-in&quot; window." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Selecting <span class="boldcharacter">Computer account</span></p>
<p class="listcontinue1">In the <span class="boldcharacter">Select Computer</span> window that opens, click <span class="boldcharacter">Finish</span>.</p>
<p class="picture"><img id="f180518" src="select_local_computer.png" class="linkedpngfiletemplate" alt="&quot;Select Computer&quot; window." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Selecting <span class="boldcharacter">Local computer</span></p>
</li><li class="listnumber1">In the tree pane, select <span class="boldcharacter">Certificates (Local Computer)</span> &gt; <span class="boldcharacter">Trusted Root Certification Authorities</span>, right-click <span class="boldcharacter">Certificates</span>, and select <span class="boldcharacter">All Tasks</span> &gt; <span class="boldcharacter">Import</span>.<p class="picture"><img id="f180521" src="import_certificate.png" class="linkedpngfiletemplate" alt="MMC-based console. Certificates list. Certificate context menu." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Selecting <span class="boldcharacter">Import</span></p>
<p class="listcontinue1">The Certificate Import Wizard starts.</p>
</li></ol><p class="bodytext"><span class="boldcharacter">Import the saved certificate</span></p>
<p class="procedureheading">To add the saved certificate to the Trusted Root Certification Authorities store:</p>
<ol class="listnumber1"><li class="listnumber1">On the Welcome page of the Wizard, click <span class="boldcharacter">Next</span>.<p class="picture"><img id="f180522" src="cert_import_wizard.png" class="linkedpngfiletemplate" alt="Welcome window." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Certificate Import Wizard</p>
</li><li class="listnumber1">Click <span class="boldcharacter">Browse</span> and select the certificate that was saved in the &quot;Save the certificate to a local file&quot; procedure above.<p class="picture"><img id="f180525" src="import_saved_certificate.png" class="linkedpngfiletemplate" alt="Certificate Import Wizard. CER file specified." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Importing the previously saved certificate</p>
</li><li class="listnumber1">On the next page of the Certificate Import Wizard, click <span class="boldcharacter">Next</span>.<p class="picture"><img id="f180526" src="select_certificate_store.png" class="linkedpngfiletemplate" alt="Certificate Import Wizard. &quot;Trusted Root Certification Authorities&quot; specified." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Selecting a certificate store</p>
</li><li class="listnumber1">On the last page of the Certificate Import Wizard, click <span class="boldcharacter">Finish</span>.<p class="picture"><img id="f180552" src="complete_cert_import.png" class="linkedpngfiletemplate" alt="Certificate Import Wizard. Final window." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Completing the certificate import</p>
</li><li class="listnumber1">Close the MMC-based console and restart the browser.<p class="listcontinue1">The security problem (untrusted certificate) is resolved, as shown in the figure below.</p>
<p class="picture"><img id="f174170" src="adding_trusted_7.png" class="linkedpngfiletemplate" alt="&quot;Website Identification&quot; window." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Website identification</p>
</li></ol><p class="introheading">Causing a self-signed certificate to be trusted by a browser (Kaspersky Scan Engine GUI opens in Google Chrome)</p>
<p class="procedureheading">To make the self-signed certificate for Kaspersky Scan Engine GUI trusted when using Google Chrome:</p>
<ol class="listnumber1"><li class="listnumber1">Open the <code class="programcharacter">https://127.0.0.1</code> or <code class="programcharacter">https://localhost</code> address in Google Chrome.<p class="listcontinue1">A warning is displayed in the address bar that the connection to the site is not secure.</p>
</li><li class="listnumber1">Click the <span class="boldcharacter">Not secure</span> message.<p class="listcontinue1">A window opens with security details about the website.</p>
</li><li class="listnumber1">Click <span class="boldcharacter">Certificate</span> to view the certificate information. (When the mouse pauses over <span class="boldcharacter">Certificate</span>, a <span class="boldcharacter">Show certificate</span> tooltip appears.)</li><li class="listnumber1">In the <span class="boldcharacter">Certificate</span> window that opens, select the <span class="boldcharacter">Details</span> tab and click <span class="boldcharacter">Copy to File</span> to create a local copy of the certificate.<p class="listcontinue1">The Certificate Export Wizard starts.</p>
<p class="picture"><img id="f174173_1" src="adding_trusted_10.png" class="linkedpngfiletemplate" alt="Welcome window." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Certificate Export Wizard</p>
</li><li class="listnumber1">Follow the Wizard instructions.<p class="listcontinue1">Use the default Wizard settings during the certificate export.</p>
</li><li class="listnumber1">After the certificate is saved to a local disk, open it and add it to the Trusted Root Certification Authorities store as described in the procedure for Internet Explorer.</li><li class="listnumber1">Restart the browser.</li></ol><p class="introheading">Causing a self-signed certificate to be trusted by a browser (Kaspersky Scan Engine GUI opens in Mozilla Firefox)</p>
<p class="bodytext">You add Kaspersky Scan Engine GUI to the list of Mozilla Firefox trusted sites so that the browser will not display warnings about the certificate.</p>
<p class="introheading">Removing a certificate from the list of trusted ones</p>
<p class="bodytext">After you have reconfigured or uninstalled Kaspersky Scan Engine, old certificates are no longer used by Kaspersky Scan Engine. You can remove them from the list of trusted certificates.</p>
<p class="procedureheading">To remove a certificate from the list of trusted certificates:</p>
<ol class="listnumber1"><li class="listnumber1">Open the Certificates management console by running the following command:<p class="listcontinue1"><code class="programcharacter">certmgr.msc</code></p>
</li><li class="listnumber1">In the tree pane, select <span class="boldcharacter">Trusted Root Certification Authorities &gt; Certificates</span>.<p class="picture"><img id="f174171" src="adding_trusted_8.png" class="linkedpngfiletemplate" alt="Certificates list. &quot;Certificates&quot; in &quot;Trusted Root Certification Authorities&quot; selected." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">Certificates management console</p>
</li><li class="listnumber1">In the results pane, right-click the added certificate and select <span class="boldcharacter">Delete</span>.</li></ol>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="182962"><p><a name=182962 style="display: none;">[Topic 182962]</a></p>
	<h1 id="t234539" class="heading1">Troubleshooting</h1>
<p class="bodytext">This section provides information to help you solve problems you might encounter when using Kaspersky Scan Engine.</p>
<p class="bodytext">If you encounter a problem that is not mentioned in this section, turn on logging, repeat the actions that preceded the problem, and then send the logs and configuration files to your TAM.</p>
<p class="introheading">Problem: Kaspersky Scan Engine does not start after system reboot and could not be started with systemctl</p>
<p class="bodytext">The cause of this problem might be that the <code class="programcharacter">/opt/</code> directory is located on a mounted device. When Kaspersky Scan Engine initializes after reboot, the device is not yet mounted and the operating system cannot find systemd unit files for Kaspersky Scan Engine.</p>
<p class="bodytext">To solve this problem, try the following actions:</p>
<ol class="listnumber1"><li class="listnumber1">Disable Kaspersky Scan Engine services:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">systemctl disable klScanEngineUI</code></li><li class="listbullet2">For HTTP mode:<p class="listcontinue2"><code class="programcharacter">systemctl disable kavhttpd</code></p>
</li><li class="listbullet2">For ICAP mode:<p class="listcontinue2"><code class="programcharacter">systemctl disable kavicapd</code></p>
</li></ul></li><li class="listnumber1">Delete symbolic links to Kaspersky Scan Engine configuration files:<p class="listcontinue1"><code class="programcharacter">rm /etc/klScanEngineUI.xml /etc/kavhttpd.xml /etc/kavicapd.xml</code></p>
</li><li class="listnumber1">Copy Kaspersky Scan Engine unit files to <code class="programcharacter">/etc/systemd/system/</code>:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">cp /opt/kaspersky/ScanEngine/etc/klScanEngineUI.service /etc/systemd/system/klScanEngineUI.service</code></li><li class="listbullet2">For HTTP mode:<p class="listcontinue2"><code class="programcharacter">cp /opt/kaspersky/ScanEngine/etc/kavhttpd.service /etc/systemd/system/kavhttpd.service</code></p>
</li><li class="listbullet2">For ICAP mode:<p class="listcontinue2"><code class="programcharacter">cp /opt/kaspersky/ScanEngine/etc/kavicapd.service /etc/systemd/system/kavicapd.service</code></p>
</li></ul></li><li class="listnumber1">Copy Kaspersky Scan Engine configuration files to /etc/:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">cp /opt/kaspersky/ScanEngine/etc/klScanEngineUI.xml /etc/klScanEngineUI.xml</code></li><li class="listbullet2">For HTTP mode:<p class="listcontinue2"><code class="programcharacter">cp /opt/kaspersky/ScanEngine/etc/kavhttpd.xml /etc/kavhttpd.xml</code></p>
</li><li class="listbullet2">For ICAP mode:<p class="listcontinue2"><code class="programcharacter">cp /opt/kaspersky/ScanEngine/etc/kavicapd.xml /etc/kavicapd.xml</code></p>
</li></ul></li><li class="listnumber1">Reload systemd:<p class="listcontinue1"><code class="programcharacter">systemctl daemon-reload</code></p>
</li><li class="listnumber1">Enable the Kaspersky Scan Engine services to start on system boot:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">systemctl enable klScanEngineUI</code></li><li class="listbullet2">For HTTP mode:<p class="listcontinue2"><code class="programcharacter">systemctl enable kavhttpd</code></p>
</li><li class="listbullet2">For ICAP mode:<p class="listcontinue2"><code class="programcharacter">systemctl enable kavicapd</code></p>
</li></ul></li><li class="listnumber1">Start Kaspersky Scan Engine services:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">service klScanEngineUI start</code></li><li class="listbullet2">For HTTP mode:<p class="listcontinue2"><code class="programcharacter">service kavhttpd start</code></p>
</li><li class="listbullet2">For ICAP mode:<p class="listcontinue2"><code class="programcharacter">service kavicapd start</code></p>
</li></ul></li></ol><p class="introheading">Problem: Kaspersky Scan Engine does start and does not print logs</p>
<p class="bodytext">The cause of this problem might be that Kaspersky Scan Engine cannot find <code class="programcharacter">klScanEngineUI.xml</code>, or that the file is corrupted and Kaspersky Scan Engine cannot read it. </p>
<ul class="listbullet1"><li class="listbullet1">To find the solution to this problem, check the log files that are created in the <code class="programcharacter">/tmp/</code> subdirectory of the Kaspersky Scan Engine installation directory.</li></ul><p class="introheading">Problem: An error occurred while loading data by the Kaspersky Scan Engine GUI (the dashboard or scan results page)</p>
<p class="bodytext">The cause of this problem is a failure of Kaspersky Scan Engine to connect to the <code class="programcharacter">kavebase</code> database or read data from it.</p>
<p class="bodytext">To solve this problem, try the following actions:</p>
<ul class="listbullet1"><li class="listbullet1">Check whether the PostgreSQL instance is running.</li><li class="listbullet1">Check whether the PostgreSQL instance is accessible from your Kaspersky Scan Engine instance.</li><li class="listbullet1">Check whether the <code class="programcharacter">kavebase</code> database persists in the PostgreSQL instance.<p class="listcontinue1">If not, create the <code class="programcharacter">kavebase</code> database as described in section &quot;<a id="h181517" class="englishcrossreferencetemplate" href="#180652" target="_self">Manual installation (Linux)</a>&quot;.</p>
</li><li class="listbullet1">Check whether the <code class="programcharacter">scanengine</code> database user persists in the PostgreSQL instance.<p class="listcontinue1">If not, create the <code class="programcharacter">scanengine</code> database user as described in section &quot;<a id="h181517_2" class="englishcrossreferencetemplate" href="#180652" target="_self">Manual installation (Linux)</a>&quot;.</p>
</li></ul><p class="introheading">Problem: The Kaspersky Scan Engine GUI is not displayed in a browser</p>
<p class="bodytext">To solve this problem, try the following actions:</p>
<ul class="listbullet1"><li class="listbullet1">Check that the Kaspersky Scan Engine instance and the klScanEngineUI service are running.</li><li class="listbullet1">Check that you are using a <a id="h193112" class="englishcrossreferencetemplate" href="#184795" target="_self">supported browser</a>.</li><li class="listbullet1">Check that the klScanEngineUI.xml configuration file contains the following:<ul class="listbullet2"><li class="listbullet2">The value specified in the <code class="programcharacter">ServerSettings &gt; EnableUI</code> field is <code class="programcharacter">true</code>.</li><li class="listbullet2">The <code class="programcharacter">ServerSettings &gt; ConnectionString</code> element contains one of the following IP addresses:<ul class="listbullet3"><li class="listbullet3"><code class="programcharacter">127.0.0.1</code><p class="listcontinue3">In this case, the Kaspersky Scan Engine GUI is accessible from the same computer on which Kaspersky Scan Engine is installed.</p>
</li><li class="listbullet3">A network IP address<p class="listcontinue3">In this case, the Kaspersky Scan Engine GUI is accessible over the network.</p>
<p class="listcontinue3">Make sure that the firewall does not block access to the computer on which Kaspersky Scan Engine is installed.</p>
</li></ul></li></ul></li></ul><p class="introheading">Problem: Untrusted connection error when connecting to the Kaspersky Scan Engine GUI</p>
<p class="bodytext">The SSL certificates that are generated during the installation of Kaspersky Scan Engine are self-signed, so the browser you use informs you of an untrusted connection.</p>
<p class="bodytext">To solve this problem, try the following:</p>
<ul class="listbullet1"><li class="listbullet1">(Recommended) <a id="h182985" class="englishcrossreferencetemplate" href="#182983" target="_self">Use other certificates that are trusted</a> in your infrastructure.</li><li class="listbullet1">If you cannot use other certificates, you can <a id="h182986" class="englishcrossreferencetemplate" href="#182984" target="_self">add the initially generated certificates as trusted</a> to your browser or operating system.</li></ul><p class="introheading">Problem: An error occurred while saving settings in the Kaspersky Scan Engine GUI</p>
<ul class="listbullet1"><li class="listbullet1">Check whether the settings that you have specified are correct.</li><li class="listbullet1">Check the status of the <code class="programcharacter">kavhttpd</code> or <code class="programcharacter">kavicapd</code> service by running one of the commands:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">service kavhttpd status</code></li><li class="listbullet2"><code class="programcharacter">service kavicapd status</code></li></ul></li></ul><p class="introheading">Problem: An error occurred while deleting the database during uninstallation, database &quot;kavebase&quot; is being accessed by other users</p>
<p class="bodytext">Probable cause: someone else is connected to the <code class="programcharacter">kavebase</code> database (for example, using pgAdmin).</p>
<p class="bodytext">Solution: run the following query to <code class="programcharacter">kavebase</code>:</p>
<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">SELECT *, pg_terminate_backend(pid)</p>
<p class="program">FROM pg_stat_activity</p>
<p class="program">WHERE pid &lt;&gt; pg_backend_pid()</p>
<p class="program">AND datname = 'kavebase';</p>
</td>
</tr>

</table>
<p class="introheading">Problem: psql not recognized as an internal or external command</p>
<p class="bodytext">This problem may occur in Windows. To solve it, add the PostgreSQL bin directory to the PATH environment variable.</p>
<p class="procedureheading">In Windows, do the following:</p>
<ol class="listnumber1"><li class="listnumber1">Go to <span class="boldcharacter">Control Panel</span> -&gt; <span class="boldcharacter">System and Security</span> -&gt; <span class="boldcharacter">System</span> -&gt; <span class="boldcharacter">Advanced system settings</span> -&gt; <span class="boldcharacter">Environment variables...</span><p class="listcontinue1">The <span class="boldcharacter">Environment variables</span> dialog opens.</p>
</li><li class="listnumber1">In the list of System Variables (the lower half of the dialog), select <span class="boldcharacter">Path</span>, and then click <span class="boldcharacter">Edit</span>.</li><li class="listnumber1">Click <span class="boldcharacter">New</span>, and then type in the path to the PostgreSQL bin directory (for example <code class="programcharacter">C:\Program Files\PostgreSQL\13\bin</code>).</li><li class="listnumber1">Save changes by clicking <span class="boldcharacter">OK</span> in all of the dialogs.</li></ol><p class="introheading">Problem: SCRAM authentication requires libpq version 10 or above</p>
<p class="bodytext">This problem can occur when installing Kaspersky Scan Engine if you are using PostgreSQL 13 and the <code class="programcharacter">password_encryption</code> value differs from <code class="programcharacter">md5</code>.</p>
<p class="procedureheading">To solve this problem, do the following:</p>
<ol class="listnumber1"><li class="listnumber1">In the <code class="programcharacter">postgresql.conf</code> configuration file, set the <code class="programcharacter">password_encryption</code> parameter to <code class="programcharacter">md5</code>. <p class="listcontinue1">Save changes.</p>
</li><li class="listnumber1">Restart PostgreSQL:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">systemctl restart postgresql-13</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Update the password for the database user with administrator rights (for example, the user <code class="programcharacter">postgres</code>), which will be used when installing Kaspersky Scan Engine:<table class="tableintopic" width="1131" cellpadding="2" cellspacing="0" border="0" style="border-collapse:collapse" bgcolor="#E5F1FB">
<tr align="left" valign="top">
<td bgcolor="#E5F1FB" width="1131"><p class="program">alter user postgres with password '%PASSWORD%';</p>
</td>
</tr>

</table>
</li><li class="listnumber1">Make sure that the authentication method is set to <code class="programcharacter">md5</code> <a id="h198591" class="englishcrossreferencetemplate" href="#192975" target="_self">in the pg_hba.conf file</a>.</li><li class="listnumber1">Retry the installation of Kaspersky Scan Engine.</li></ol><p class="introheading">Problem: The Kaspersky Scan Engine GUI does not display events (the dashboard or scan results page)</p>
<p class="bodytext">This problem can occur if the <code class="programcharacter">kavebase</code> database is damaged.</p>
<p class="procedureheading">To solve this problem, do the following:</p>
<ol class="listnumber1"><li class="listnumber1">Stop the following processes:<ul class="listbullet2"><li class="listbullet2"><code class="programcharacter">klScanEngineUI</code></li><li class="listbullet2"><code class="programcharacter">kavhttpd</code> (HTTP mode) or <code class="programcharacter">kavicapd</code> (ICAP mode)</li></ul></li><li class="listnumber1">Delete the kavebase database by running the following command:<p class="listcontinue1"><code class="programcharacter">DROP DATABASE kavebase;</code></p>
</li><li class="listnumber1">Create a new <code class="programcharacter">kavebase</code> database by running the following command:<p class="listcontinue1"><code class="programcharacter">CREATE DATABASE kavebase OWNER %owner%;</code></p>
<p class="listcontinue1">Here,  <code class="programcharacter">%owner%</code> is the user that was created for working with <code class="programcharacter">kavebase</code> during the installation of Kaspersky Scan Engine.</p>
</li><li class="listnumber1">Import the <code class="programcharacter">tables.sql</code> file from the <code class="programcharacter">%service_dir%/samples</code> directory by running the following command:<p class="listcontinue1"><code class="programcharacter">psql -d kavebase -a -f tables.sql</code></p>
</li><li class="listnumber1">Restart the processes that you stopped in step 1.</li></ol><p class="warningbody">After this operation, the <code class="programcharacter">admin</code> password for Kaspersky Scan Engine GUI will be restored to the default one and all previous events will be deleted.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192996"><p><a name=192996 style="display: none;">[Topic 192996]</a></p>
	<h1 id="t234314" class="heading1">Data transferred to Kaspersky</h1>
<p class="bodytext">This section provides information about data transferred to Kaspersky during operation of Kaspersky Scan Engine.</p>
<p class="bodytext">Kaspersky protects any information received in accordance with law and applicable Kaspersky rules. Data is transmitted over a secure channel.</p>
<table class="relatedtopics belowtopictext" cellpadding="0" cellspacing="0" border="0">
<tr valign="top">
<td width= "321">
<p class="relatedheading">In this section</p><p class="relateditem"><a href="#180001" target="_self">Data transferred to Kaspersky during an update</a></p><p class="relateditem"><a href="#180002" target="_self">Data transferred to Kaspersky in online licensing mode</a></p><p class="relateditem"><a href="#192997" target="_self">Data transferred to Kaspersky during File and URL Reputation Checking</a></p><p class="relateditem"><a href="#180772" target="_self">Statistics submitted to KSN</a></p><p class="relateditem"><a href="#185034" target="_self">About data provisioning</a></p></td>
</tr>
</table>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180001"><p><a name=180001 style="display: none;">[Topic 180001]</a></p>
	<h2 id="t234315" class="heading2">Data transferred to Kaspersky during an update</h2>
<p class="bodytext">During an update, Kaspersky Scan Engine transfers its encrypted user agent string to Kaspersky.</p>
<p class="bodytext">Purpose of data provisioning: calculating Kaspersky's product usage statistics and update statistics.</p>
<p class="bodytext">Region where the data is processed: Moscow, Russia.</p>
<p class="bodytext">Data protection method: secure encryption.</p>
<p class="bodytext">The following information is transferred in the user agent string:</p>
<ul class="listbullet1"><li class="listbullet1">Version of the user agent string format</li><li class="listbullet1">Identifier of Kaspersky Scan Engine </li><li class="listbullet1">Licensing mode</li><li class="listbullet1">Identifier of the license</li><li class="listbullet1">Update session identifier</li><li class="listbullet1">Full version of Kaspersky Scan Engine: major, minor, build, revision, and hotfix</li></ul><p class="bodytext">Storage period:</p>
<ul class="listbullet1"><li class="listbullet1">While statistic data is processed: 24 hours. </li><li class="listbullet1">After the statistic data is processed: <ul class="listbullet2"><li class="listbullet2">License identifier: only the top 1000 identifiers are stored indefinitely.</li><li class="listbullet2">Other parameters are stored indefinitely. These parameters are not personal data.</li></ul></li></ul><p class="bodytext">See also the detailed information <a id="h180046" class="englishcrossreferencetemplate" href="#185034" target="_self">about data provisioning</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180002"><p><a name=180002 style="display: none;">[Topic 180002]</a></p>
	<h2 id="t234317" class="heading2">Data transferred to Kaspersky in online licensing mode</h2>
<p class="bodytext">In <a id="h180819" class="englishcrossreferencetemplate" href="#179855" target="_self">online licensing mode</a>, Kaspersky Scan Engine automatically updates licensing information once per day. When licensing information is updated, Kaspersky Scan Engine transfers to Kaspersky information about the installed copy of Kaspersky Scan Engine and the activation code. This information is necessary to perform online activation.</p>
<p class="bodytext">The following information is transferred:</p>
<ul class="listbullet1"><li class="listbullet1">Activation code provided during the online activation</li><li class="listbullet1">Identifier of Kaspersky Scan Engine</li><li class="listbullet1">Identifier of the locale used by Kaspersky Scan Engine </li><li class="listbullet1">Full version of the Kaspersky Scan Engine: major, minor, build, revision, and hotfix</li><li class="listbullet1">System date and time</li><li class="listbullet1">Unique identifier of the Kaspersky Scan Engine installation</li><li class="listbullet1">Current activation code status (active or blocked)</li><li class="listbullet1">Expiration date for the activation code</li><li class="listbullet1">The functionality that is available with this activation code</li><li class="listbullet1">The status of the activations limit (if it applies to the activation code)</li></ul><p class="bodytext">See also the detailed information <a id="h180046" class="englishcrossreferencetemplate" href="#185034" target="_self">about data provisioning</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192997"><p><a name=192997 style="display: none;">[Topic 192997]</a></p>
	<h2 id="t234316" class="heading2">Data transferred to Kaspersky during File and URL Reputation Checking</h2>
<p class="bodytext">When you use the File and URL Reputation Checking feature, Kaspersky Scan Engine transfers to Kaspersky information about the installed copy of Kaspersky Scan Engine and detected objects.</p>
<p class="bodytext">The following information is transferred:</p>
<ul class="listbullet1"><li class="listbullet1">Identifier of Kaspersky Scan Engine</li><li class="listbullet1">Full version of Kaspersky Scan Engine: major, minor, build, revision, and hotfix</li><li class="listbullet1">Identifier of the license owner</li><li class="listbullet1">Checksums of processed files (MD5, SHA256)</li><li class="listbullet1">Version of KSN</li><li class="listbullet1">Checksums of the detected object name (MD5, SHA256)</li><li class="listbullet1">Normalized URL</li></ul><p class="bodytext">See also the detailed information <a id="h180046" class="englishcrossreferencetemplate" href="#185034" target="_self">about data provisioning</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="180772"><p><a name=180772 style="display: none;">[Topic 180772]</a></p>
	<h2 id="t234521" class="heading2">Statistics submitted to KSN</h2>
<p class="bodytext">You can submit a set of statistics to KSN.</p>
<p class="bodytext">This statistics set includes the following:</p>
<ul class="listbullet1"><li class="listbullet1">Information about the version of Kaspersky Scan Engine used</li><li class="listbullet1">Information about the operating system version of the statistics sender</li><li class="listbullet1">Identifier of the license owner</li><li class="listbullet1">Information about detected objects</li></ul><p class="bodytext">See also the detailed information <a id="h180046" class="englishcrossreferencetemplate" href="#185034" target="_self">about data provisioning</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="185034"><p><a name=185034 style="display: none;">[Topic 185034]</a></p>
	<h2 id="t234266" class="heading2">About data provisioning</h2>
<p class="bodytext">The files containing information about the procedure of data provisioning used in Kaspersky Scan Engine are included in the KAV SDK distribution kit (hereinafter <code class="programcharacter">%SDK_kit%</code>):</p>
<ul class="listbullet1"><li class="listbullet1"><code class="programcharacter">%SDK_kit%/doc/About data provision.txt</code>&#8212;Describes the procedure of data provisioning for <a id="h180137" class="englishcrossreferencetemplate" href="#180133" target="_self">File and URL Reputation Checking</a>.</li><li class="listbullet1"><code class="programcharacter">%SDK_kit%/doc/About data provision - online licensing.txt</code>&#8212;Describes the procedure of data provisioning for <a id="h180819" class="englishcrossreferencetemplate" href="#179855" target="_self">online licensing mode</a>.</li><li class="listbullet1"><code class="programcharacter">%SDK_kit%/doc/About data provision extended.txt</code>&#8212;Describes the procedure of data provisioning when you submit <a id="h180773" class="englishcrossreferencetemplate" href="#180772" target="_self">statistical information</a> to KSN in Kaspersky Scan Engine for Windows systems.</li></ul><p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="234774"><p><a name=234774 style="display: none;">[Topic 234774]</a></p>
	<h1 id="t234774" class="heading1">Contacting Technical Support</h1>
<p class="bodytext">If you haven't found the solution for your issue in this documentation or other sources, create a request for Kaspersky Technical Support. When contacting Kaspersky Technical Support, <a class="hyperlinktemplate" href="https://support.kaspersky.com/corporate/before_request?topic=scanengine" target="_blank">provide the necessary information about Kaspersky Scan Engine</a>.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192998"><p><a name=192998 style="display: none;">[Topic 192998]</a></p>
	<h1 id="t234392" class="heading1">Information about third-party code</h1>
<p class="bodytext">Information about third-party code is contained in two files named legal_notices.txt. One of these files is stored in the <code class="programcharacter">doc</code> subdirectory of the Kaspersky Scan Engine installation directory. The other is stored in the <code class="programcharacter">doc</code> subdirectory of the KAV SDK installation directory.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="192999"><p><a name=192999 style="display: none;">[Topic 192999]</a></p>
	<h1 id="t234537" class="heading1">Trademark notices</h1>
<p class="bodytext">Registered trademarks and service marks are the property of their respective owners.</p>
<p class="bodytext">Safari is a trademark of Apple Inc.</p>
<p class="bodytext">Dell Technologies, Dell, EMC,  and other trademarks are trademarks of Dell Inc. or its subsidiaries.</p>
<p class="bodytext">F5 is a trademark of F5 Networks, Inc. in the U.S. and in certain other countries.</p>
<p class="bodytext">Chrome, Google, Google Chrome are trademarks of Google LLC.</p>
<p class="bodytext">Linux is the registered trademark of Linus Torvalds in the U.S. and other countries.</p>
<p class="bodytext">Internet Explorer, Microsoft, Microsoft Edge, Visual Studio, Win32, Windows, Windows Server are trademarks of the Microsoft group of companies.</p>
<p class="bodytext">Firefox and Mozilla are trademarks of the Mozilla Foundation in the U.S. and other countries.</p>
<p class="bodytext">Oracle and Solaris are registered trademarks of Oracle and/or its affiliates.</p>
<p class="bodytext">Red Hat is a trademark or registered trademark of Red Hat, Inc. or its subsidiaries in the United States and other countries.</p>
<p class="bodytext">Debian is a registered trademark of Software in the Public Interest, Inc.</p>
<p class="bodytext">Splunk is a trademark and registered trademark of Splunk Inc. in the United States and other countries.</p>
<p class="bodytext">UNIX is a registered trademark in the United States and other countries, licensed exclusively through X/Open Company Limited.</p>


	<a href="#" class="bt-home">Page top</a>
	</div><div class="cont" id="55937"><p><a name=55937 style="display: none;">[Topic 55937]</a></p>
	<h1 id="t131989" class="heading1">Copyright</h1>
<p class="bodytext"> </p>
<p class="bodytext">&nbsp;</p>
<p class="bodytext">&nbsp;</p>
<p class="bodytext">&nbsp;</p>
<p class="bodytext">Dear User, </p>
<p class="bodytext">Thank you for choosing Kaspersky as your security software provider. We hope that this document helps you to use our product.</p>
<p class="bodytext">Attention! This document is the property of AO Kaspersky Lab (herein also referred to as Kaspersky): all rights to this document are reserved by the copyright laws of the Russian Federation and by international treaties. Illegal reproduction and distribution of this document or parts hereof incur civil, administrative, or criminal liability under applicable law. </p>
<p class="bodytext">Any type of reproduction or distribution of any materials, including translations, is allowed only with the written permission of Kaspersky.</p>
<p class="bodytext">This document, and graphic images related to it, may be used for informational, non-commercial, and personal purposes only.</p>
<p class="bodytext">Kaspersky reserves the right to amend this document without additional notification.</p>
<p class="bodytext">Kaspersky assumes no liability for the content, quality, relevance, or accuracy of any materials used in this document to which rights are held by third parties, or for any potential harms associated with use of the document.</p>
<p class="revisiondate">Document revision date: 10/24/2023</p>
<p class="returnaddress">&copy; 2023 AO Kaspersky Lab</p>
<p class="revisiondate"><a class="hyperlinktemplate" href="https://www.kaspersky.com" target="_blank">https://www.kaspersky.com</a><br><a class="hyperlinktemplate" href="https://support.kaspersky.com" target="_blank">https://support.kaspersky.com</a></p>
<p class="revisiondate"><a class="namedhyperlinktemplate" href="https://www.kaspersky.com/about/company" target="_blank">About Kaspersky</a></p>


	<a href="#" class="bt-home">Page top</a>
	</div>