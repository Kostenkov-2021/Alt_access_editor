<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="description" content=""/>
    <meta name="viewport" content="maximum-scale=1.0" />
    <title> ICAP rules </title>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-MPK6ZG');</script>
	<!-- End Google Tag Manager -->
    <script type="text/javascript" src="../langs.js"></script>
    <script type="text/javascript">
        !function ( w, d ) {
            var scriptsPath="/localization/";
            if(w.location.pathname.match(/title\.htm$/)){scriptsPath="./js/"}d.writeln("\x3Cscript type='text/javascript' src='"+scriptsPath+d.documentElement.lang+".js'>\x3C/script>");
        }( window, document );
    </script>	
    <script type="text/javascript" src="toc.js"></script>
    
    <script type="text/javascript" src="aiconverter_result.js"></script>
    <link rel="stylesheet" type='text/css' href="typography.css"/>
    <link rel="stylesheet" type='text/css' href="styles.css"/>
    <link rel="shortcut icon" href="favicon.ico"/>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
    <link rel="icon" href="favicon.png" type="image/png"/>

            <!--[if lte IE 9]>
                <link rel="stylesheet" type="text/css" href="bootstrap.css">
            <![endif]-->
            <!--[if lte IE 8]>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.js"></script>
            <![endif]-->
            </head>

<body id="who-content" class="no-js">
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MPK6ZG" style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->
	<noscript class="no-js__message">
	<a href="https://support.microsoft.com/en-us/kb/3135465" class="no-js__link">Please enable JavaScript in your browser!</a>
	</noscript>
	<div class="cont">
	<h3 id="t234386" class="heading3">ICAP rules</h3>
<p class="bodytext">This section describes the <span class="boldcharacter">ICAP rules</span> page of Kaspersky Scan Engine GUI. Using the <span class="boldcharacter">ICAP rules</span> page, you can add, remove, and edit ICAP rules. You can create as many ICAP rules as you want.</p>
<p class="bodytext">This page is available if Kaspersky Scan Engine is initialized in ICAP mode.</p>
<p class="picture"><img id="f182816" src="settings_icap_rules.png" class="linkedpngfiletemplate" alt="Several lines of ICAP rules. Each line contains settings: ICAP mode, Scan result, Response pattern, Script to execute." vspace="0" hspace="0" align="bottom" border="0"></p>
<p class="picturename">ICAP rules page</p>
<p class="bodytext">If an error occurred while loading the web page and the settings are unavailable, reload the page.</p>
<p class="bodytext">When you open the <span class="boldcharacter">ICAP rules</span> page, Kaspersky Scan Engine reads the following data, which is to be used when editing ICAP rules:</p>
<ul class="listbullet1"><li class="listbullet1">Names of the response patterns that are stored in the directory specified in the <code class="programcharacter">ResponsesPath</code> element of the ICAP Plug-in configuration file</li><li class="listbullet1">Names of the scripts that are stored in the directory specified in the <code class="programcharacter">CmdPath</code> element of the ICAP Plug-in configuration file</li></ul><p class="bodytext">A single ICAP rule contains the following fields:</p>
<ul class="listbullet1"><li class="listbullet1">ICAP mode that is relevant for the rule<p class="listcontinue1">You can select one of the following ICAP modes:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Request mode</span></li><li class="listbullet2"><span class="guicharacter">Response mode</span></li><li class="listbullet2"><span class="guicharacter">Any</span></li></ul></li><li class="listbullet1">Scan result after which the rule is activated<p class="listcontinue1">You can select one of the following <a id="h180152" class="englishcrossreferencetemplate" href="179893.htm" target="_self">scan results</a>:</p>
<ul class="listbullet2"><li class="listbullet2"><span class="guicharacter">Detected</span></li><li class="listbullet2"><span class="guicharacter">Not scanned</span></li><li class="listbullet2"><span class="guicharacter">Failed</span></li><li class="listbullet2"><span class="guicharacter">Macro</span></li><li class="listbullet2"><span class="guicharacter">Phishing</span></li><li class="listbullet2"><span class="guicharacter">Any</span></li><li class="listbullet2"><span class="guicharacter">Clean</span></li></ul></li><li class="listbullet1">Response pattern<p class="listcontinue1">This response pattern is used on a blocked web page after the rule is activated.</p>
<p class="listcontinue1">When the <span class="boldcharacter">ICAP rules</span> web page is loaded, you can choose one of the response patterns received by Kaspersky Scan Engine. In an ICAP rule, you can specify either the response pattern or the script to execute, but not both.</p>
<p class="listcontinue1">You can leave this field empty.</p>
</li><li class="listbullet1">Script to execute<p class="listcontinue1">This script is executed after the rule is activated.</p>
<p class="listcontinue1">When the <span class="boldcharacter">ICAP rules</span> web page is loaded, you can choose one of the scripts got by Kaspersky Scan Engine. In an ICAP rule, you can specify either the response pattern or the script to execute, but not both.</p>
<p class="listcontinue1">You can leave this field empty.</p>
</li></ul><p class="bodytext">Kaspersky Scan Engine does not process the rules where <span class="guicharacter">Scan result</span> is set to <span class="guicharacter">Any</span> and <span class="guicharacter">Action</span> is set to <span class="guicharacter">None</span>. You must avoid using these rules (see the table below).</p>
<p class="tablename">Incorrect ICAP rules</p>
<p class="spacerfortables"></p>
<table class="tableintopic" width="656" cellpadding="2" cellspacing="0" border="1" style="border-collapse:collapse; border:1px solid #010101">
<tr align="left" valign="top">
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="219"><p class="tableheading">ICAP mode</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="219"><p class="tableheading">Scan result</p>
</th>
<th bgcolor="#C0C0C0" style="border:1px solid #010101;" width="219"><p class="tableheading">Action</p>
</th>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Response mode</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Any</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">None</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Request mode</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Any</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">None</p>
</td>
</tr>
<tr align="left" valign="top">
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Any</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">Any</p>
</td>
<td style="border:1px solid #010101;" width="219"><p class="tablebodytext">None</p>
</td>
</tr>

</table>
<p class="bodytext"></p>


	<a href="#" class="bt-home">Page top</a>
	</div>
</body>

</html>
